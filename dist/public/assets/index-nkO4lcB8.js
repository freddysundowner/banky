function JU(t,n){for(var r=0;r<n.length;r++){const s=n[r];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(s,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var qp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Gj={exports:{}},Cm={},Yj={exports:{}},un={};var AA;function e9(){if(AA)return un;AA=1;var t=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function x(W){return W===null||typeof W!="object"?null:(W=f&&W[f]||W["@@iterator"],typeof W=="function"?W:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,g={};function y(W,H,fe){this.props=W,this.context=H,this.refs=g,this.updater=fe||j}y.prototype.isReactComponent={},y.prototype.setState=function(W,H){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,H,"setState")},y.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=y.prototype;function k(W,H,fe){this.props=W,this.context=H,this.refs=g,this.updater=fe||j}var N=k.prototype=new C;N.constructor=k,b(N,y.prototype),N.isPureReactComponent=!0;var P=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function R(W,H,fe){var Pe,Re={},Ie=null,Ce=null;if(H!=null)for(Pe in H.ref!==void 0&&(Ce=H.ref),H.key!==void 0&&(Ie=""+H.key),H)w.call(H,Pe)&&!E.hasOwnProperty(Pe)&&(Re[Pe]=H[Pe]);var Y=arguments.length-2;if(Y===1)Re.children=fe;else if(1<Y){for(var ie=Array(Y),Ee=0;Ee<Y;Ee++)ie[Ee]=arguments[Ee+2];Re.children=ie}if(W&&W.defaultProps)for(Pe in Y=W.defaultProps,Y)Re[Pe]===void 0&&(Re[Pe]=Y[Pe]);return{$$typeof:t,type:W,key:Ie,ref:Ce,props:Re,_owner:S.current}}function T(W,H){return{$$typeof:t,type:W.type,key:H,ref:W.ref,props:W.props,_owner:W._owner}}function U(W){return typeof W=="object"&&W!==null&&W.$$typeof===t}function M(W){var H={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(fe){return H[fe]})}var L=/\/+/g;function q(W,H){return typeof W=="object"&&W!==null&&W.key!=null?M(""+W.key):H.toString(36)}function $(W,H,fe,Pe,Re){var Ie=typeof W;(Ie==="undefined"||Ie==="boolean")&&(W=null);var Ce=!1;if(W===null)Ce=!0;else switch(Ie){case"string":case"number":Ce=!0;break;case"object":switch(W.$$typeof){case t:case n:Ce=!0}}if(Ce)return Ce=W,Re=Re(Ce),W=Pe===""?"."+q(Ce,0):Pe,P(Re)?(fe="",W!=null&&(fe=W.replace(L,"$&/")+"/"),$(Re,H,fe,"",function(Ee){return Ee})):Re!=null&&(U(Re)&&(Re=T(Re,fe+(!Re.key||Ce&&Ce.key===Re.key?"":(""+Re.key).replace(L,"$&/")+"/")+W)),H.push(Re)),1;if(Ce=0,Pe=Pe===""?".":Pe+":",P(W))for(var Y=0;Y<W.length;Y++){Ie=W[Y];var ie=Pe+q(Ie,Y);Ce+=$(Ie,H,fe,ie,Re)}else if(ie=x(W),typeof ie=="function")for(W=ie.call(W),Y=0;!(Ie=W.next()).done;)Ie=Ie.value,ie=Pe+q(Ie,Y++),Ce+=$(Ie,H,fe,ie,Re);else if(Ie==="object")throw H=String(W),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return Ce}function D(W,H,fe){if(W==null)return W;var Pe=[],Re=0;return $(W,Pe,"","",function(Ie){return H.call(fe,Ie,Re++)}),Pe}function z(W){if(W._status===-1){var H=W._result;H=H(),H.then(function(fe){(W._status===0||W._status===-1)&&(W._status=1,W._result=fe)},function(fe){(W._status===0||W._status===-1)&&(W._status=2,W._result=fe)}),W._status===-1&&(W._status=0,W._result=H)}if(W._status===1)return W._result.default;throw W._result}var J={current:null},I={transition:null},X={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:I,ReactCurrentOwner:S};function ne(){throw Error("act(...) is not supported in production builds of React.")}return un.Children={map:D,forEach:function(W,H,fe){D(W,function(){H.apply(this,arguments)},fe)},count:function(W){var H=0;return D(W,function(){H++}),H},toArray:function(W){return D(W,function(H){return H})||[]},only:function(W){if(!U(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},un.Component=y,un.Fragment=r,un.Profiler=a,un.PureComponent=k,un.StrictMode=s,un.Suspense=u,un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,un.act=ne,un.cloneElement=function(W,H,fe){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var Pe=b({},W.props),Re=W.key,Ie=W.ref,Ce=W._owner;if(H!=null){if(H.ref!==void 0&&(Ie=H.ref,Ce=S.current),H.key!==void 0&&(Re=""+H.key),W.type&&W.type.defaultProps)var Y=W.type.defaultProps;for(ie in H)w.call(H,ie)&&!E.hasOwnProperty(ie)&&(Pe[ie]=H[ie]===void 0&&Y!==void 0?Y[ie]:H[ie])}var ie=arguments.length-2;if(ie===1)Pe.children=fe;else if(1<ie){Y=Array(ie);for(var Ee=0;Ee<ie;Ee++)Y[Ee]=arguments[Ee+2];Pe.children=Y}return{$$typeof:t,type:W.type,key:Re,ref:Ie,props:Pe,_owner:Ce}},un.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:i,_context:W},W.Consumer=W},un.createElement=R,un.createFactory=function(W){var H=R.bind(null,W);return H.type=W,H},un.createRef=function(){return{current:null}},un.forwardRef=function(W){return{$$typeof:c,render:W}},un.isValidElement=U,un.lazy=function(W){return{$$typeof:h,_payload:{_status:-1,_result:W},_init:z}},un.memo=function(W,H){return{$$typeof:m,type:W,compare:H===void 0?null:H}},un.startTransition=function(W){var H=I.transition;I.transition={};try{W()}finally{I.transition=H}},un.unstable_act=ne,un.useCallback=function(W,H){return J.current.useCallback(W,H)},un.useContext=function(W){return J.current.useContext(W)},un.useDebugValue=function(){},un.useDeferredValue=function(W){return J.current.useDeferredValue(W)},un.useEffect=function(W,H){return J.current.useEffect(W,H)},un.useId=function(){return J.current.useId()},un.useImperativeHandle=function(W,H,fe){return J.current.useImperativeHandle(W,H,fe)},un.useInsertionEffect=function(W,H){return J.current.useInsertionEffect(W,H)},un.useLayoutEffect=function(W,H){return J.current.useLayoutEffect(W,H)},un.useMemo=function(W,H){return J.current.useMemo(W,H)},un.useReducer=function(W,H,fe){return J.current.useReducer(W,H,fe)},un.useRef=function(W){return J.current.useRef(W)},un.useState=function(W){return J.current.useState(W)},un.useSyncExternalStore=function(W,H,fe){return J.current.useSyncExternalStore(W,H,fe)},un.useTransition=function(){return J.current.useTransition()},un.version="18.3.1",un}var EA;function Wg(){return EA||(EA=1,Yj.exports=e9()),Yj.exports}var OA;function t9(){if(OA)return Cm;OA=1;var t=Wg(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,m){var h,f={},x=null,j=null;m!==void 0&&(x=""+m),u.key!==void 0&&(x=""+u.key),u.ref!==void 0&&(j=u.ref);for(h in u)s.call(u,h)&&!i.hasOwnProperty(h)&&(f[h]=u[h]);if(c&&c.defaultProps)for(h in u=c.defaultProps,u)f[h]===void 0&&(f[h]=u[h]);return{$$typeof:n,type:c,key:x,ref:j,props:f,_owner:a.current}}return Cm.Fragment=r,Cm.jsx=o,Cm.jsxs=o,Cm}var TA;function n9(){return TA||(TA=1,Gj.exports=t9()),Gj.exports}var e=n9(),Bp={},Qj={exports:{}},Hs={},Xj={exports:{}},Zj={};var MA;function r9(){return MA||(MA=1,(function(t){function n(I,X){var ne=I.length;I.push(X);e:for(;0<ne;){var W=ne-1>>>1,H=I[W];if(0<a(H,X))I[W]=X,I[ne]=H,ne=W;else break e}}function r(I){return I.length===0?null:I[0]}function s(I){if(I.length===0)return null;var X=I[0],ne=I.pop();if(ne!==X){I[0]=ne;e:for(var W=0,H=I.length,fe=H>>>1;W<fe;){var Pe=2*(W+1)-1,Re=I[Pe],Ie=Pe+1,Ce=I[Ie];if(0>a(Re,ne))Ie<H&&0>a(Ce,Re)?(I[W]=Ce,I[Ie]=ne,W=Ie):(I[W]=Re,I[Pe]=ne,W=Pe);else if(Ie<H&&0>a(Ce,ne))I[W]=Ce,I[Ie]=ne,W=Ie;else break e}}return X}function a(I,X){var ne=I.sortIndex-X.sortIndex;return ne!==0?ne:I.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],m=[],h=1,f=null,x=3,j=!1,b=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(I){for(var X=r(m);X!==null;){if(X.callback===null)s(m);else if(X.startTime<=I)s(m),X.sortIndex=X.expirationTime,n(u,X);else break;X=r(m)}}function P(I){if(g=!1,N(I),!b)if(r(u)!==null)b=!0,z(w);else{var X=r(m);X!==null&&J(P,X.startTime-I)}}function w(I,X){b=!1,g&&(g=!1,C(R),R=-1),j=!0;var ne=x;try{for(N(X),f=r(u);f!==null&&(!(f.expirationTime>X)||I&&!M());){var W=f.callback;if(typeof W=="function"){f.callback=null,x=f.priorityLevel;var H=W(f.expirationTime<=X);X=t.unstable_now(),typeof H=="function"?f.callback=H:f===r(u)&&s(u),N(X)}else s(u);f=r(u)}if(f!==null)var fe=!0;else{var Pe=r(m);Pe!==null&&J(P,Pe.startTime-X),fe=!1}return fe}finally{f=null,x=ne,j=!1}}var S=!1,E=null,R=-1,T=5,U=-1;function M(){return!(t.unstable_now()-U<T)}function L(){if(E!==null){var I=t.unstable_now();U=I;var X=!0;try{X=E(!0,I)}finally{X?q():(S=!1,E=null)}}else S=!1}var q;if(typeof k=="function")q=function(){k(L)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,D=$.port2;$.port1.onmessage=L,q=function(){D.postMessage(null)}}else q=function(){y(L,0)};function z(I){E=I,S||(S=!0,q())}function J(I,X){R=y(function(){I(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){b||j||(b=!0,z(w))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(I){switch(x){case 1:case 2:case 3:var X=3;break;default:X=x}var ne=x;x=X;try{return I()}finally{x=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,X){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var ne=x;x=I;try{return X()}finally{x=ne}},t.unstable_scheduleCallback=function(I,X,ne){var W=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,I){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=ne+H,I={id:h++,callback:X,priorityLevel:I,startTime:ne,expirationTime:H,sortIndex:-1},ne>W?(I.sortIndex=ne,n(m,I),r(u)===null&&I===r(m)&&(g?(C(R),R=-1):g=!0,J(P,ne-W))):(I.sortIndex=H,n(u,I),b||j||(b=!0,z(w))),I},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(I){var X=x;return function(){var ne=x;x=X;try{return I.apply(this,arguments)}finally{x=ne}}}})(Zj)),Zj}var RA;function s9(){return RA||(RA=1,Xj.exports=r9()),Xj.exports}var DA;function a9(){if(DA)return Hs;DA=1;var t=Wg(),n=s9();function r(l){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+l,p=1;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function i(l,d){o(l,d),o(l+"Capture",d)}function o(l,d){for(a[l]=d,l=0;l<d.length;l++)s.add(d[l])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function x(l){return u.call(f,l)?!0:u.call(h,l)?!1:m.test(l)?f[l]=!0:(h[l]=!0,!1)}function j(l,d,p,_){if(p!==null&&p.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return _?!1:p!==null?!p.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function b(l,d,p,_){if(d===null||typeof d>"u"||j(l,d,p,_))return!0;if(_)return!1;if(p!==null)switch(p.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function g(l,d,p,_,A,O,K){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=_,this.attributeNamespace=A,this.mustUseProperty=p,this.propertyName=l,this.type=d,this.sanitizeURL=O,this.removeEmptyString=K}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){y[l]=new g(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var d=l[0];y[d]=new g(d,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){y[l]=new g(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){y[l]=new g(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){y[l]=new g(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){y[l]=new g(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){y[l]=new g(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){y[l]=new g(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){y[l]=new g(l,5,!1,l.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function k(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var d=l.replace(C,k);y[d]=new g(d,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var d=l.replace(C,k);y[d]=new g(d,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var d=l.replace(C,k);y[d]=new g(d,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){y[l]=new g(l,1,!1,l.toLowerCase(),null,!1,!1)}),y.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){y[l]=new g(l,1,!1,l.toLowerCase(),null,!0,!0)});function N(l,d,p,_){var A=y.hasOwnProperty(d)?y[d]:null;(A!==null?A.type!==0:_||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(b(d,p,A,_)&&(p=null),_||A===null?x(d)&&(p===null?l.removeAttribute(d):l.setAttribute(d,""+p)):A.mustUseProperty?l[A.propertyName]=p===null?A.type===3?!1:"":p:(d=A.attributeName,_=A.attributeNamespace,p===null?l.removeAttribute(d):(A=A.type,p=A===3||A===4&&p===!0?"":""+p,_?l.setAttributeNS(_,d,p):l.setAttribute(d,p))))}var P=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),M=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),I=Symbol.iterator;function X(l){return l===null||typeof l!="object"?null:(l=I&&l[I]||l["@@iterator"],typeof l=="function"?l:null)}var ne=Object.assign,W;function H(l){if(W===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);W=d&&d[1]||""}return`
`+W+l}var fe=!1;function Pe(l,d){if(!l||fe)return"";fe=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(De){var _=De}Reflect.construct(l,[],d)}else{try{d.call()}catch(De){_=De}l.call(d.prototype)}else{try{throw Error()}catch(De){_=De}l()}}catch(De){if(De&&_&&typeof De.stack=="string"){for(var A=De.stack.split(`
`),O=_.stack.split(`
`),K=A.length-1,ue=O.length-1;1<=K&&0<=ue&&A[K]!==O[ue];)ue--;for(;1<=K&&0<=ue;K--,ue--)if(A[K]!==O[ue]){if(K!==1||ue!==1)do if(K--,ue--,0>ue||A[K]!==O[ue]){var he=`
`+A[K].replace(" at new "," at ");return l.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",l.displayName)),he}while(1<=K&&0<=ue);break}}}finally{fe=!1,Error.prepareStackTrace=p}return(l=l?l.displayName||l.name:"")?H(l):""}function Re(l){switch(l.tag){case 5:return H(l.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return l=Pe(l.type,!1),l;case 11:return l=Pe(l.type.render,!1),l;case 1:return l=Pe(l.type,!0),l;default:return""}}function Ie(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case E:return"Fragment";case S:return"Portal";case T:return"Profiler";case R:return"StrictMode";case q:return"Suspense";case $:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case M:return(l.displayName||"Context")+".Consumer";case U:return(l._context.displayName||"Context")+".Provider";case L:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case D:return d=l.displayName||null,d!==null?d:Ie(l.type)||"Memo";case z:d=l._payload,l=l._init;try{return Ie(l(d))}catch{}}return null}function Ce(l){var d=l.type;switch(l.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=d.render,l=l.displayName||l.name||"",d.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ie(d);case 8:return d===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function Y(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function ie(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Ee(l){var d=ie(l)?"checked":"value",p=Object.getOwnPropertyDescriptor(l.constructor.prototype,d),_=""+l[d];if(!l.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var A=p.get,O=p.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return A.call(this)},set:function(K){_=""+K,O.call(this,K)}}),Object.defineProperty(l,d,{enumerable:p.enumerable}),{getValue:function(){return _},setValue:function(K){_=""+K},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function Ke(l){l._valueTracker||(l._valueTracker=Ee(l))}function Te(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var p=d.getValue(),_="";return l&&(_=ie(l)?l.checked?"true":"false":l.value),l=_,l!==p?(d.setValue(l),!0):!1}function ct(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function ut(l,d){var p=d.checked;return ne({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??l._wrapperState.initialChecked})}function Dt(l,d){var p=d.defaultValue==null?"":d.defaultValue,_=d.checked!=null?d.checked:d.defaultChecked;p=Y(d.value!=null?d.value:p),l._wrapperState={initialChecked:_,initialValue:p,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function be(l,d){d=d.checked,d!=null&&N(l,"checked",d,!1)}function pt(l,d){be(l,d);var p=Y(d.value),_=d.type;if(p!=null)_==="number"?(p===0&&l.value===""||l.value!=p)&&(l.value=""+p):l.value!==""+p&&(l.value=""+p);else if(_==="submit"||_==="reset"){l.removeAttribute("value");return}d.hasOwnProperty("value")?G(l,d.type,p):d.hasOwnProperty("defaultValue")&&G(l,d.type,Y(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(l.defaultChecked=!!d.defaultChecked)}function te(l,d,p){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var _=d.type;if(!(_!=="submit"&&_!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+l._wrapperState.initialValue,p||d===l.value||(l.value=d),l.defaultValue=d}p=l.name,p!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,p!==""&&(l.name=p)}function G(l,d,p){(d!=="number"||ct(l.ownerDocument)!==l)&&(p==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+p&&(l.defaultValue=""+p))}var F=Array.isArray;function Ue(l,d,p,_){if(l=l.options,d){d={};for(var A=0;A<p.length;A++)d["$"+p[A]]=!0;for(p=0;p<l.length;p++)A=d.hasOwnProperty("$"+l[p].value),l[p].selected!==A&&(l[p].selected=A),A&&_&&(l[p].defaultSelected=!0)}else{for(p=""+Y(p),d=null,A=0;A<l.length;A++){if(l[A].value===p){l[A].selected=!0,_&&(l[A].defaultSelected=!0);return}d!==null||l[A].disabled||(d=l[A])}d!==null&&(d.selected=!0)}}function Z(l,d){if(d.dangerouslySetInnerHTML!=null)throw Error(r(91));return ne({},d,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function xe(l,d){var p=d.value;if(p==null){if(p=d.children,d=d.defaultValue,p!=null){if(d!=null)throw Error(r(92));if(F(p)){if(1<p.length)throw Error(r(93));p=p[0]}d=p}d==null&&(d=""),p=d}l._wrapperState={initialValue:Y(p)}}function Ae(l,d){var p=Y(d.value),_=Y(d.defaultValue);p!=null&&(p=""+p,p!==l.value&&(l.value=p),d.defaultValue==null&&l.defaultValue!==p&&(l.defaultValue=p)),_!=null&&(l.defaultValue=""+_)}function Je(l){var d=l.textContent;d===l._wrapperState.initialValue&&d!==""&&d!==null&&(l.value=d)}function ae(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Me(l,d){return l==null||l==="http://www.w3.org/1999/xhtml"?ae(d):l==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var lt,Zt=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,p,_,A){MSApp.execUnsafeLocalFunction(function(){return l(d,p,_,A)})}:l})(function(l,d){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=d;else{for(lt=lt||document.createElement("div"),lt.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=lt.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;d.firstChild;)l.appendChild(d.firstChild)}});function sn(l,d){if(d){var p=l.firstChild;if(p&&p===l.lastChild&&p.nodeType===3){p.nodeValue=d;return}}l.textContent=d}var _n={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ka=["Webkit","ms","Moz","O"];Object.keys(_n).forEach(function(l){Ka.forEach(function(d){d=d+l.charAt(0).toUpperCase()+l.substring(1),_n[d]=_n[l]})});function Wa(l,d,p){return d==null||typeof d=="boolean"||d===""?"":p||typeof d!="number"||d===0||_n.hasOwnProperty(l)&&_n[l]?(""+d).trim():d+"px"}function Fs(l,d){l=l.style;for(var p in d)if(d.hasOwnProperty(p)){var _=p.indexOf("--")===0,A=Wa(p,d[p],_);p==="float"&&(p="cssFloat"),_?l.setProperty(p,A):l[p]=A}}var Oo=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ta(l,d){if(d){if(Oo[l]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(r(137,l));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(r(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(r(61))}if(d.style!=null&&typeof d.style!="object")throw Error(r(62))}}function Hr(l,d){if(l.indexOf("-")===-1)return typeof d.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ls=null;function wi(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Is=null,as=null,Gr=null;function To(l){if(l=um(l)){if(typeof Is!="function")throw Error(r(280));var d=l.stateNode;d&&(d=tp(d),Is(l.stateNode,l.type,d))}}function Mo(l){as?Gr?Gr.push(l):Gr=[l]:as=l}function Vc(){if(as){var l=as,d=Gr;if(Gr=as=null,To(l),d)for(l=0;l<d.length;l++)To(d[l])}}function na(l,d){return l(d)}function nr(){}var wa=!1;function ys(l,d,p){if(wa)return l(d,p);wa=!0;try{return na(l,d,p)}finally{wa=!1,(as!==null||Gr!==null)&&(nr(),Vc())}}function Sr(l,d){var p=l.stateNode;if(p===null)return null;var _=tp(p);if(_===null)return null;p=_[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(l=l.type,_=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!_;break e;default:l=!1}if(l)return null;if(p&&typeof p!="function")throw Error(r(231,d,typeof p));return p}var is=!1;if(c)try{var ra={};Object.defineProperty(ra,"passive",{get:function(){is=!0}}),window.addEventListener("test",ra,ra),window.removeEventListener("test",ra,ra)}catch{is=!1}function Ln(l,d,p,_,A,O,K,ue,he){var De=Array.prototype.slice.call(arguments,3);try{d.apply(p,De)}catch(tt){this.onError(tt)}}var Cr=!1,qs=null,_a=!1,sa=null,Ro={onError:function(l){Cr=!0,qs=l}};function Ha(l,d,p,_,A,O,K,ue,he){Cr=!1,qs=null,Ln.apply(Ro,arguments)}function Do(l,d,p,_,A,O,K,ue,he){if(Ha.apply(this,arguments),Cr){if(Cr){var De=qs;Cr=!1,qs=null}else throw Error(r(198));_a||(_a=!0,sa=De)}}function Yr(l){var d=l,p=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(p=d.return),l=d.return;while(l)}return d.tag===3?p:null}function _i(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function Ni(l){if(Yr(l)!==l)throw Error(r(188))}function $o(l){var d=l.alternate;if(!d){if(d=Yr(l),d===null)throw Error(r(188));return d!==l?null:l}for(var p=l,_=d;;){var A=p.return;if(A===null)break;var O=A.alternate;if(O===null){if(_=A.return,_!==null){p=_;continue}break}if(A.child===O.child){for(O=A.child;O;){if(O===p)return Ni(A),l;if(O===_)return Ni(A),d;O=O.sibling}throw Error(r(188))}if(p.return!==_.return)p=A,_=O;else{for(var K=!1,ue=A.child;ue;){if(ue===p){K=!0,p=A,_=O;break}if(ue===_){K=!0,_=A,p=O;break}ue=ue.sibling}if(!K){for(ue=O.child;ue;){if(ue===p){K=!0,p=O,_=A;break}if(ue===_){K=!0,_=O,p=A;break}ue=ue.sibling}if(!K)throw Error(r(189))}}if(p.alternate!==_)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?l:d}function ce(l){return l=$o(l),l!==null?At(l):null}function At(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var d=At(l);if(d!==null)return d;l=l.sibling}return null}var $t=n.unstable_scheduleCallback,Tn=n.unstable_cancelCallback,St=n.unstable_shouldYield,dn=n.unstable_requestPaint,nt=n.unstable_now,xn=n.unstable_getCurrentPriorityLevel,En=n.unstable_ImmediatePriority,Xn=n.unstable_UserBlockingPriority,ir=n.unstable_NormalPriority,Bs=n.unstable_LowPriority,Lr=n.unstable_IdlePriority,kr=null,Mn=null;function In(l){if(Mn&&typeof Mn.onCommitFiberRoot=="function")try{Mn.onCommitFiberRoot(kr,l,void 0,(l.current.flags&128)===128)}catch{}}var or=Math.clz32?Math.clz32:et,Qr=Math.log,se=Math.LN2;function et(l){return l>>>=0,l===0?32:31-(Qr(l)/se|0)|0}var Mt=64,Ht=4194304;function on(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Zn(l,d){var p=l.pendingLanes;if(p===0)return 0;var _=0,A=l.suspendedLanes,O=l.pingedLanes,K=p&268435455;if(K!==0){var ue=K&~A;ue!==0?_=on(ue):(O&=K,O!==0&&(_=on(O)))}else K=p&~A,K!==0?_=on(K):O!==0&&(_=on(O));if(_===0)return 0;if(d!==0&&d!==_&&(d&A)===0&&(A=_&-_,O=d&-d,A>=O||A===16&&(O&4194240)!==0))return d;if((_&4)!==0&&(_|=p&16),d=l.entangledLanes,d!==0)for(l=l.entanglements,d&=_;0<d;)p=31-or(d),A=1<<p,_|=l[p],d&=~A;return _}function Ga(l,d){switch(l){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pr(l,d){for(var p=l.suspendedLanes,_=l.pingedLanes,A=l.expirationTimes,O=l.pendingLanes;0<O;){var K=31-or(O),ue=1<<K,he=A[K];he===-1?((ue&p)===0||(ue&_)!==0)&&(A[K]=Ga(ue,d)):he<=d&&(l.expiredLanes|=ue),O&=~ue}}function Na(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Wi(){var l=Mt;return Mt<<=1,(Mt&4194240)===0&&(Mt=64),l}function Tt(l){for(var d=[],p=0;31>p;p++)d.push(l);return d}function mt(l,d,p){l.pendingLanes|=d,d!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,d=31-or(d),l[d]=p}function dr(l,d){var p=l.pendingLanes&~d;l.pendingLanes=d,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=d,l.mutableReadLanes&=d,l.entangledLanes&=d,d=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<p;){var A=31-or(p),O=1<<A;d[A]=0,_[A]=-1,l[A]=-1,p&=~O}}function pr(l,d){var p=l.entangledLanes|=d;for(l=l.entanglements;p;){var _=31-or(p),A=1<<_;A&d|l[_]&d&&(l[_]|=d),p&=~A}}var vn=0;function Gu(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var l2,vy,c2,d2,u2,yy=!1,qf=[],Fo=null,Lo=null,Io=null,Yu=new Map,Qu=new Map,qo=[],bV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function m2(l,d){switch(l){case"focusin":case"focusout":Fo=null;break;case"dragenter":case"dragleave":Lo=null;break;case"mouseover":case"mouseout":Io=null;break;case"pointerover":case"pointerout":Yu.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qu.delete(d.pointerId)}}function Xu(l,d,p,_,A,O){return l===null||l.nativeEvent!==O?(l={blockedOn:d,domEventName:p,eventSystemFlags:_,nativeEvent:O,targetContainers:[A]},d!==null&&(d=um(d),d!==null&&vy(d)),l):(l.eventSystemFlags|=_,d=l.targetContainers,A!==null&&d.indexOf(A)===-1&&d.push(A),l)}function wV(l,d,p,_,A){switch(d){case"focusin":return Fo=Xu(Fo,l,d,p,_,A),!0;case"dragenter":return Lo=Xu(Lo,l,d,p,_,A),!0;case"mouseover":return Io=Xu(Io,l,d,p,_,A),!0;case"pointerover":var O=A.pointerId;return Yu.set(O,Xu(Yu.get(O)||null,l,d,p,_,A)),!0;case"gotpointercapture":return O=A.pointerId,Qu.set(O,Xu(Qu.get(O)||null,l,d,p,_,A)),!0}return!1}function h2(l){var d=Il(l.target);if(d!==null){var p=Yr(d);if(p!==null){if(d=p.tag,d===13){if(d=_i(p),d!==null){l.blockedOn=d,u2(l.priority,function(){c2(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){l.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Bf(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var p=by(l.domEventName,l.eventSystemFlags,d[0],l.nativeEvent);if(p===null){p=l.nativeEvent;var _=new p.constructor(p.type,p);Ls=_,p.target.dispatchEvent(_),Ls=null}else return d=um(p),d!==null&&vy(d),l.blockedOn=p,!1;d.shift()}return!0}function f2(l,d,p){Bf(l)&&p.delete(d)}function _V(){yy=!1,Fo!==null&&Bf(Fo)&&(Fo=null),Lo!==null&&Bf(Lo)&&(Lo=null),Io!==null&&Bf(Io)&&(Io=null),Yu.forEach(f2),Qu.forEach(f2)}function Zu(l,d){l.blockedOn===d&&(l.blockedOn=null,yy||(yy=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,_V)))}function Ju(l){function d(A){return Zu(A,l)}if(0<qf.length){Zu(qf[0],l);for(var p=1;p<qf.length;p++){var _=qf[p];_.blockedOn===l&&(_.blockedOn=null)}}for(Fo!==null&&Zu(Fo,l),Lo!==null&&Zu(Lo,l),Io!==null&&Zu(Io,l),Yu.forEach(d),Qu.forEach(d),p=0;p<qo.length;p++)_=qo[p],_.blockedOn===l&&(_.blockedOn=null);for(;0<qo.length&&(p=qo[0],p.blockedOn===null);)h2(p),p.blockedOn===null&&qo.shift()}var Uc=P.ReactCurrentBatchConfig,zf=!0;function NV(l,d,p,_){var A=vn,O=Uc.transition;Uc.transition=null;try{vn=1,jy(l,d,p,_)}finally{vn=A,Uc.transition=O}}function SV(l,d,p,_){var A=vn,O=Uc.transition;Uc.transition=null;try{vn=4,jy(l,d,p,_)}finally{vn=A,Uc.transition=O}}function jy(l,d,p,_){if(zf){var A=by(l,d,p,_);if(A===null)Ly(l,d,_,Vf,p),m2(l,_);else if(wV(A,l,d,p,_))_.stopPropagation();else if(m2(l,_),d&4&&-1<bV.indexOf(l)){for(;A!==null;){var O=um(A);if(O!==null&&l2(O),O=by(l,d,p,_),O===null&&Ly(l,d,_,Vf,p),O===A)break;A=O}A!==null&&_.stopPropagation()}else Ly(l,d,_,null,p)}}var Vf=null;function by(l,d,p,_){if(Vf=null,l=wi(_),l=Il(l),l!==null)if(d=Yr(l),d===null)l=null;else if(p=d.tag,p===13){if(l=_i(d),l!==null)return l;l=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null);return Vf=l,null}function p2(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xn()){case En:return 1;case Xn:return 4;case ir:case Bs:return 16;case Lr:return 536870912;default:return 16}default:return 16}}var Bo=null,wy=null,Uf=null;function x2(){if(Uf)return Uf;var l,d=wy,p=d.length,_,A="value"in Bo?Bo.value:Bo.textContent,O=A.length;for(l=0;l<p&&d[l]===A[l];l++);var K=p-l;for(_=1;_<=K&&d[p-_]===A[O-_];_++);return Uf=A.slice(l,1<_?1-_:void 0)}function Kf(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function Wf(){return!0}function g2(){return!1}function aa(l){function d(p,_,A,O,K){this._reactName=p,this._targetInst=A,this.type=_,this.nativeEvent=O,this.target=K,this.currentTarget=null;for(var ue in l)l.hasOwnProperty(ue)&&(p=l[ue],this[ue]=p?p(O):O[ue]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?Wf:g2,this.isPropagationStopped=g2,this}return ne(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Wf)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Wf)},persist:function(){},isPersistent:Wf}),d}var Kc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_y=aa(Kc),em=ne({},Kc,{view:0,detail:0}),CV=aa(em),Ny,Sy,tm,Hf=ne({},em,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ky,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==tm&&(tm&&l.type==="mousemove"?(Ny=l.screenX-tm.screenX,Sy=l.screenY-tm.screenY):Sy=Ny=0,tm=l),Ny)},movementY:function(l){return"movementY"in l?l.movementY:Sy}}),v2=aa(Hf),kV=ne({},Hf,{dataTransfer:0}),PV=aa(kV),AV=ne({},em,{relatedTarget:0}),Cy=aa(AV),EV=ne({},Kc,{animationName:0,elapsedTime:0,pseudoElement:0}),OV=aa(EV),TV=ne({},Kc,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),MV=aa(TV),RV=ne({},Kc,{data:0}),y2=aa(RV),DV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$V={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LV(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=FV[l])?!!d[l]:!1}function ky(){return LV}var IV=ne({},em,{key:function(l){if(l.key){var d=DV[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=Kf(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?$V[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ky,charCode:function(l){return l.type==="keypress"?Kf(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Kf(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),qV=aa(IV),BV=ne({},Hf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j2=aa(BV),zV=ne({},em,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ky}),VV=aa(zV),UV=ne({},Kc,{propertyName:0,elapsedTime:0,pseudoElement:0}),KV=aa(UV),WV=ne({},Hf,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),HV=aa(WV),GV=[9,13,27,32],Py=c&&"CompositionEvent"in window,nm=null;c&&"documentMode"in document&&(nm=document.documentMode);var YV=c&&"TextEvent"in window&&!nm,b2=c&&(!Py||nm&&8<nm&&11>=nm),w2=" ",_2=!1;function N2(l,d){switch(l){case"keyup":return GV.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function S2(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Wc=!1;function QV(l,d){switch(l){case"compositionend":return S2(d);case"keypress":return d.which!==32?null:(_2=!0,w2);case"textInput":return l=d.data,l===w2&&_2?null:l;default:return null}}function XV(l,d){if(Wc)return l==="compositionend"||!Py&&N2(l,d)?(l=x2(),Uf=wy=Bo=null,Wc=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return b2&&d.locale!=="ko"?null:d.data;default:return null}}var ZV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function C2(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!ZV[l.type]:d==="textarea"}function k2(l,d,p,_){Mo(_),d=Zf(d,"onChange"),0<d.length&&(p=new _y("onChange","change",null,p,_),l.push({event:p,listeners:d}))}var rm=null,sm=null;function JV(l){K2(l,0)}function Gf(l){var d=Xc(l);if(Te(d))return l}function eU(l,d){if(l==="change")return d}var P2=!1;if(c){var Ay;if(c){var Ey="oninput"in document;if(!Ey){var A2=document.createElement("div");A2.setAttribute("oninput","return;"),Ey=typeof A2.oninput=="function"}Ay=Ey}else Ay=!1;P2=Ay&&(!document.documentMode||9<document.documentMode)}function E2(){rm&&(rm.detachEvent("onpropertychange",O2),sm=rm=null)}function O2(l){if(l.propertyName==="value"&&Gf(sm)){var d=[];k2(d,sm,l,wi(l)),ys(JV,d)}}function tU(l,d,p){l==="focusin"?(E2(),rm=d,sm=p,rm.attachEvent("onpropertychange",O2)):l==="focusout"&&E2()}function nU(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Gf(sm)}function rU(l,d){if(l==="click")return Gf(d)}function sU(l,d){if(l==="input"||l==="change")return Gf(d)}function aU(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var Ya=typeof Object.is=="function"?Object.is:aU;function am(l,d){if(Ya(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var p=Object.keys(l),_=Object.keys(d);if(p.length!==_.length)return!1;for(_=0;_<p.length;_++){var A=p[_];if(!u.call(d,A)||!Ya(l[A],d[A]))return!1}return!0}function T2(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function M2(l,d){var p=T2(l);l=0;for(var _;p;){if(p.nodeType===3){if(_=l+p.textContent.length,l<=d&&_>=d)return{node:p,offset:d-l};l=_}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=T2(p)}}function R2(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?R2(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function D2(){for(var l=window,d=ct();d instanceof l.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)l=d.contentWindow;else break;d=ct(l.document)}return d}function Oy(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}function iU(l){var d=D2(),p=l.focusedElem,_=l.selectionRange;if(d!==p&&p&&p.ownerDocument&&R2(p.ownerDocument.documentElement,p)){if(_!==null&&Oy(p)){if(d=_.start,l=_.end,l===void 0&&(l=d),"selectionStart"in p)p.selectionStart=d,p.selectionEnd=Math.min(l,p.value.length);else if(l=(d=p.ownerDocument||document)&&d.defaultView||window,l.getSelection){l=l.getSelection();var A=p.textContent.length,O=Math.min(_.start,A);_=_.end===void 0?O:Math.min(_.end,A),!l.extend&&O>_&&(A=_,_=O,O=A),A=M2(p,O);var K=M2(p,_);A&&K&&(l.rangeCount!==1||l.anchorNode!==A.node||l.anchorOffset!==A.offset||l.focusNode!==K.node||l.focusOffset!==K.offset)&&(d=d.createRange(),d.setStart(A.node,A.offset),l.removeAllRanges(),O>_?(l.addRange(d),l.extend(K.node,K.offset)):(d.setEnd(K.node,K.offset),l.addRange(d)))}}for(d=[],l=p;l=l.parentNode;)l.nodeType===1&&d.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<d.length;p++)l=d[p],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var oU=c&&"documentMode"in document&&11>=document.documentMode,Hc=null,Ty=null,im=null,My=!1;function $2(l,d,p){var _=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;My||Hc==null||Hc!==ct(_)||(_=Hc,"selectionStart"in _&&Oy(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),im&&am(im,_)||(im=_,_=Zf(Ty,"onSelect"),0<_.length&&(d=new _y("onSelect","select",null,d,p),l.push({event:d,listeners:_}),d.target=Hc)))}function Yf(l,d){var p={};return p[l.toLowerCase()]=d.toLowerCase(),p["Webkit"+l]="webkit"+d,p["Moz"+l]="moz"+d,p}var Gc={animationend:Yf("Animation","AnimationEnd"),animationiteration:Yf("Animation","AnimationIteration"),animationstart:Yf("Animation","AnimationStart"),transitionend:Yf("Transition","TransitionEnd")},Ry={},F2={};c&&(F2=document.createElement("div").style,"AnimationEvent"in window||(delete Gc.animationend.animation,delete Gc.animationiteration.animation,delete Gc.animationstart.animation),"TransitionEvent"in window||delete Gc.transitionend.transition);function Qf(l){if(Ry[l])return Ry[l];if(!Gc[l])return l;var d=Gc[l],p;for(p in d)if(d.hasOwnProperty(p)&&p in F2)return Ry[l]=d[p];return l}var L2=Qf("animationend"),I2=Qf("animationiteration"),q2=Qf("animationstart"),B2=Qf("transitionend"),z2=new Map,V2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zo(l,d){z2.set(l,d),i(d,[l])}for(var Dy=0;Dy<V2.length;Dy++){var $y=V2[Dy],lU=$y.toLowerCase(),cU=$y[0].toUpperCase()+$y.slice(1);zo(lU,"on"+cU)}zo(L2,"onAnimationEnd"),zo(I2,"onAnimationIteration"),zo(q2,"onAnimationStart"),zo("dblclick","onDoubleClick"),zo("focusin","onFocus"),zo("focusout","onBlur"),zo(B2,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var om="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dU=new Set("cancel close invalid load scroll toggle".split(" ").concat(om));function U2(l,d,p){var _=l.type||"unknown-event";l.currentTarget=p,Do(_,d,void 0,l),l.currentTarget=null}function K2(l,d){d=(d&4)!==0;for(var p=0;p<l.length;p++){var _=l[p],A=_.event;_=_.listeners;e:{var O=void 0;if(d)for(var K=_.length-1;0<=K;K--){var ue=_[K],he=ue.instance,De=ue.currentTarget;if(ue=ue.listener,he!==O&&A.isPropagationStopped())break e;U2(A,ue,De),O=he}else for(K=0;K<_.length;K++){if(ue=_[K],he=ue.instance,De=ue.currentTarget,ue=ue.listener,he!==O&&A.isPropagationStopped())break e;U2(A,ue,De),O=he}}}if(_a)throw l=sa,_a=!1,sa=null,l}function Kn(l,d){var p=d[Uy];p===void 0&&(p=d[Uy]=new Set);var _=l+"__bubble";p.has(_)||(W2(d,l,2,!1),p.add(_))}function Fy(l,d,p){var _=0;d&&(_|=4),W2(p,l,_,d)}var Xf="_reactListening"+Math.random().toString(36).slice(2);function lm(l){if(!l[Xf]){l[Xf]=!0,s.forEach(function(p){p!=="selectionchange"&&(dU.has(p)||Fy(p,!1,l),Fy(p,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[Xf]||(d[Xf]=!0,Fy("selectionchange",!1,d))}}function W2(l,d,p,_){switch(p2(d)){case 1:var A=NV;break;case 4:A=SV;break;default:A=jy}p=A.bind(null,d,p,l),A=void 0,!is||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(A=!0),_?A!==void 0?l.addEventListener(d,p,{capture:!0,passive:A}):l.addEventListener(d,p,!0):A!==void 0?l.addEventListener(d,p,{passive:A}):l.addEventListener(d,p,!1)}function Ly(l,d,p,_,A){var O=_;if((d&1)===0&&(d&2)===0&&_!==null)e:for(;;){if(_===null)return;var K=_.tag;if(K===3||K===4){var ue=_.stateNode.containerInfo;if(ue===A||ue.nodeType===8&&ue.parentNode===A)break;if(K===4)for(K=_.return;K!==null;){var he=K.tag;if((he===3||he===4)&&(he=K.stateNode.containerInfo,he===A||he.nodeType===8&&he.parentNode===A))return;K=K.return}for(;ue!==null;){if(K=Il(ue),K===null)return;if(he=K.tag,he===5||he===6){_=O=K;continue e}ue=ue.parentNode}}_=_.return}ys(function(){var De=O,tt=wi(p),rt=[];e:{var Ze=z2.get(l);if(Ze!==void 0){var xt=_y,wt=l;switch(l){case"keypress":if(Kf(p)===0)break e;case"keydown":case"keyup":xt=qV;break;case"focusin":wt="focus",xt=Cy;break;case"focusout":wt="blur",xt=Cy;break;case"beforeblur":case"afterblur":xt=Cy;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xt=v2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xt=PV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xt=VV;break;case L2:case I2:case q2:xt=OV;break;case B2:xt=KV;break;case"scroll":xt=CV;break;case"wheel":xt=HV;break;case"copy":case"cut":case"paste":xt=MV;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xt=j2}var Ct=(d&4)!==0,ur=!Ct&&l==="scroll",ke=Ct?Ze!==null?Ze+"Capture":null:Ze;Ct=[];for(var pe=De,Oe;pe!==null;){Oe=pe;var at=Oe.stateNode;if(Oe.tag===5&&at!==null&&(Oe=at,ke!==null&&(at=Sr(pe,ke),at!=null&&Ct.push(cm(pe,at,Oe)))),ur)break;pe=pe.return}0<Ct.length&&(Ze=new xt(Ze,wt,null,p,tt),rt.push({event:Ze,listeners:Ct}))}}if((d&7)===0){e:{if(Ze=l==="mouseover"||l==="pointerover",xt=l==="mouseout"||l==="pointerout",Ze&&p!==Ls&&(wt=p.relatedTarget||p.fromElement)&&(Il(wt)||wt[Hi]))break e;if((xt||Ze)&&(Ze=tt.window===tt?tt:(Ze=tt.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,xt?(wt=p.relatedTarget||p.toElement,xt=De,wt=wt?Il(wt):null,wt!==null&&(ur=Yr(wt),wt!==ur||wt.tag!==5&&wt.tag!==6)&&(wt=null)):(xt=null,wt=De),xt!==wt)){if(Ct=v2,at="onMouseLeave",ke="onMouseEnter",pe="mouse",(l==="pointerout"||l==="pointerover")&&(Ct=j2,at="onPointerLeave",ke="onPointerEnter",pe="pointer"),ur=xt==null?Ze:Xc(xt),Oe=wt==null?Ze:Xc(wt),Ze=new Ct(at,pe+"leave",xt,p,tt),Ze.target=ur,Ze.relatedTarget=Oe,at=null,Il(tt)===De&&(Ct=new Ct(ke,pe+"enter",wt,p,tt),Ct.target=Oe,Ct.relatedTarget=ur,at=Ct),ur=at,xt&&wt)t:{for(Ct=xt,ke=wt,pe=0,Oe=Ct;Oe;Oe=Yc(Oe))pe++;for(Oe=0,at=ke;at;at=Yc(at))Oe++;for(;0<pe-Oe;)Ct=Yc(Ct),pe--;for(;0<Oe-pe;)ke=Yc(ke),Oe--;for(;pe--;){if(Ct===ke||ke!==null&&Ct===ke.alternate)break t;Ct=Yc(Ct),ke=Yc(ke)}Ct=null}else Ct=null;xt!==null&&H2(rt,Ze,xt,Ct,!1),wt!==null&&ur!==null&&H2(rt,ur,wt,Ct,!0)}}e:{if(Ze=De?Xc(De):window,xt=Ze.nodeName&&Ze.nodeName.toLowerCase(),xt==="select"||xt==="input"&&Ze.type==="file")var Et=eU;else if(C2(Ze))if(P2)Et=sU;else{Et=nU;var Ft=tU}else(xt=Ze.nodeName)&&xt.toLowerCase()==="input"&&(Ze.type==="checkbox"||Ze.type==="radio")&&(Et=rU);if(Et&&(Et=Et(l,De))){k2(rt,Et,p,tt);break e}Ft&&Ft(l,Ze,De),l==="focusout"&&(Ft=Ze._wrapperState)&&Ft.controlled&&Ze.type==="number"&&G(Ze,"number",Ze.value)}switch(Ft=De?Xc(De):window,l){case"focusin":(C2(Ft)||Ft.contentEditable==="true")&&(Hc=Ft,Ty=De,im=null);break;case"focusout":im=Ty=Hc=null;break;case"mousedown":My=!0;break;case"contextmenu":case"mouseup":case"dragend":My=!1,$2(rt,p,tt);break;case"selectionchange":if(oU)break;case"keydown":case"keyup":$2(rt,p,tt)}var Lt;if(Py)e:{switch(l){case"compositionstart":var Gt="onCompositionStart";break e;case"compositionend":Gt="onCompositionEnd";break e;case"compositionupdate":Gt="onCompositionUpdate";break e}Gt=void 0}else Wc?N2(l,p)&&(Gt="onCompositionEnd"):l==="keydown"&&p.keyCode===229&&(Gt="onCompositionStart");Gt&&(b2&&p.locale!=="ko"&&(Wc||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&Wc&&(Lt=x2()):(Bo=tt,wy="value"in Bo?Bo.value:Bo.textContent,Wc=!0)),Ft=Zf(De,Gt),0<Ft.length&&(Gt=new y2(Gt,l,null,p,tt),rt.push({event:Gt,listeners:Ft}),Lt?Gt.data=Lt:(Lt=S2(p),Lt!==null&&(Gt.data=Lt)))),(Lt=YV?QV(l,p):XV(l,p))&&(De=Zf(De,"onBeforeInput"),0<De.length&&(tt=new y2("onBeforeInput","beforeinput",null,p,tt),rt.push({event:tt,listeners:De}),tt.data=Lt))}K2(rt,d)})}function cm(l,d,p){return{instance:l,listener:d,currentTarget:p}}function Zf(l,d){for(var p=d+"Capture",_=[];l!==null;){var A=l,O=A.stateNode;A.tag===5&&O!==null&&(A=O,O=Sr(l,p),O!=null&&_.unshift(cm(l,O,A)),O=Sr(l,d),O!=null&&_.push(cm(l,O,A))),l=l.return}return _}function Yc(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function H2(l,d,p,_,A){for(var O=d._reactName,K=[];p!==null&&p!==_;){var ue=p,he=ue.alternate,De=ue.stateNode;if(he!==null&&he===_)break;ue.tag===5&&De!==null&&(ue=De,A?(he=Sr(p,O),he!=null&&K.unshift(cm(p,he,ue))):A||(he=Sr(p,O),he!=null&&K.push(cm(p,he,ue)))),p=p.return}K.length!==0&&l.push({event:d,listeners:K})}var uU=/\r\n?/g,mU=/\u0000|\uFFFD/g;function G2(l){return(typeof l=="string"?l:""+l).replace(uU,`
`).replace(mU,"")}function Jf(l,d,p){if(d=G2(d),G2(l)!==d&&p)throw Error(r(425))}function ep(){}var Iy=null,qy=null;function By(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var zy=typeof setTimeout=="function"?setTimeout:void 0,hU=typeof clearTimeout=="function"?clearTimeout:void 0,Y2=typeof Promise=="function"?Promise:void 0,fU=typeof queueMicrotask=="function"?queueMicrotask:typeof Y2<"u"?function(l){return Y2.resolve(null).then(l).catch(pU)}:zy;function pU(l){setTimeout(function(){throw l})}function Vy(l,d){var p=d,_=0;do{var A=p.nextSibling;if(l.removeChild(p),A&&A.nodeType===8)if(p=A.data,p==="/$"){if(_===0){l.removeChild(A),Ju(d);return}_--}else p!=="$"&&p!=="$?"&&p!=="$!"||_++;p=A}while(p);Ju(d)}function Vo(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return l}function Q2(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var p=l.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return l;d--}else p==="/$"&&d++}l=l.previousSibling}return null}var Qc=Math.random().toString(36).slice(2),Si="__reactFiber$"+Qc,dm="__reactProps$"+Qc,Hi="__reactContainer$"+Qc,Uy="__reactEvents$"+Qc,xU="__reactListeners$"+Qc,gU="__reactHandles$"+Qc;function Il(l){var d=l[Si];if(d)return d;for(var p=l.parentNode;p;){if(d=p[Hi]||p[Si]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(l=Q2(l);l!==null;){if(p=l[Si])return p;l=Q2(l)}return d}l=p,p=l.parentNode}return null}function um(l){return l=l[Si]||l[Hi],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Xc(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(r(33))}function tp(l){return l[dm]||null}var Ky=[],Zc=-1;function Uo(l){return{current:l}}function Wn(l){0>Zc||(l.current=Ky[Zc],Ky[Zc]=null,Zc--)}function qn(l,d){Zc++,Ky[Zc]=l.current,l.current=d}var Ko={},os=Uo(Ko),zs=Uo(!1),ql=Ko;function Jc(l,d){var p=l.type.contextTypes;if(!p)return Ko;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===d)return _.__reactInternalMemoizedMaskedChildContext;var A={},O;for(O in p)A[O]=d[O];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=d,l.__reactInternalMemoizedMaskedChildContext=A),A}function Vs(l){return l=l.childContextTypes,l!=null}function np(){Wn(zs),Wn(os)}function X2(l,d,p){if(os.current!==Ko)throw Error(r(168));qn(os,d),qn(zs,p)}function Z2(l,d,p){var _=l.stateNode;if(d=d.childContextTypes,typeof _.getChildContext!="function")return p;_=_.getChildContext();for(var A in _)if(!(A in d))throw Error(r(108,Ce(l)||"Unknown",A));return ne({},p,_)}function rp(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Ko,ql=os.current,qn(os,l),qn(zs,zs.current),!0}function J2(l,d,p){var _=l.stateNode;if(!_)throw Error(r(169));p?(l=Z2(l,d,ql),_.__reactInternalMemoizedMergedChildContext=l,Wn(zs),Wn(os),qn(os,l)):Wn(zs),qn(zs,p)}var Gi=null,sp=!1,Wy=!1;function eP(l){Gi===null?Gi=[l]:Gi.push(l)}function vU(l){sp=!0,eP(l)}function Wo(){if(!Wy&&Gi!==null){Wy=!0;var l=0,d=vn;try{var p=Gi;for(vn=1;l<p.length;l++){var _=p[l];do _=_(!0);while(_!==null)}Gi=null,sp=!1}catch(A){throw Gi!==null&&(Gi=Gi.slice(l+1)),$t(En,Wo),A}finally{vn=d,Wy=!1}}return null}var ed=[],td=0,ap=null,ip=0,Sa=[],Ca=0,Bl=null,Yi=1,Qi="";function zl(l,d){ed[td++]=ip,ed[td++]=ap,ap=l,ip=d}function tP(l,d,p){Sa[Ca++]=Yi,Sa[Ca++]=Qi,Sa[Ca++]=Bl,Bl=l;var _=Yi;l=Qi;var A=32-or(_)-1;_&=~(1<<A),p+=1;var O=32-or(d)+A;if(30<O){var K=A-A%5;O=(_&(1<<K)-1).toString(32),_>>=K,A-=K,Yi=1<<32-or(d)+A|p<<A|_,Qi=O+l}else Yi=1<<O|p<<A|_,Qi=l}function Hy(l){l.return!==null&&(zl(l,1),tP(l,1,0))}function Gy(l){for(;l===ap;)ap=ed[--td],ed[td]=null,ip=ed[--td],ed[td]=null;for(;l===Bl;)Bl=Sa[--Ca],Sa[Ca]=null,Qi=Sa[--Ca],Sa[Ca]=null,Yi=Sa[--Ca],Sa[Ca]=null}var ia=null,oa=null,Jn=!1,Qa=null;function nP(l,d){var p=Ea(5,null,null,0);p.elementType="DELETED",p.stateNode=d,p.return=l,d=l.deletions,d===null?(l.deletions=[p],l.flags|=16):d.push(p)}function rP(l,d){switch(l.tag){case 5:var p=l.type;return d=d.nodeType!==1||p.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(l.stateNode=d,ia=l,oa=Vo(d.firstChild),!0):!1;case 6:return d=l.pendingProps===""||d.nodeType!==3?null:d,d!==null?(l.stateNode=d,ia=l,oa=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(p=Bl!==null?{id:Yi,overflow:Qi}:null,l.memoizedState={dehydrated:d,treeContext:p,retryLane:1073741824},p=Ea(18,null,null,0),p.stateNode=d,p.return=l,l.child=p,ia=l,oa=null,!0):!1;default:return!1}}function Yy(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Qy(l){if(Jn){var d=oa;if(d){var p=d;if(!rP(l,d)){if(Yy(l))throw Error(r(418));d=Vo(p.nextSibling);var _=ia;d&&rP(l,d)?nP(_,p):(l.flags=l.flags&-4097|2,Jn=!1,ia=l)}}else{if(Yy(l))throw Error(r(418));l.flags=l.flags&-4097|2,Jn=!1,ia=l}}}function sP(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;ia=l}function op(l){if(l!==ia)return!1;if(!Jn)return sP(l),Jn=!0,!1;var d;if((d=l.tag!==3)&&!(d=l.tag!==5)&&(d=l.type,d=d!=="head"&&d!=="body"&&!By(l.type,l.memoizedProps)),d&&(d=oa)){if(Yy(l))throw aP(),Error(r(418));for(;d;)nP(l,d),d=Vo(d.nextSibling)}if(sP(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));e:{for(l=l.nextSibling,d=0;l;){if(l.nodeType===8){var p=l.data;if(p==="/$"){if(d===0){oa=Vo(l.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++}l=l.nextSibling}oa=null}}else oa=ia?Vo(l.stateNode.nextSibling):null;return!0}function aP(){for(var l=oa;l;)l=Vo(l.nextSibling)}function nd(){oa=ia=null,Jn=!1}function Xy(l){Qa===null?Qa=[l]:Qa.push(l)}var yU=P.ReactCurrentBatchConfig;function mm(l,d,p){if(l=p.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var _=p.stateNode}if(!_)throw Error(r(147,l));var A=_,O=""+l;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===O?d.ref:(d=function(K){var ue=A.refs;K===null?delete ue[O]:ue[O]=K},d._stringRef=O,d)}if(typeof l!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,l))}return l}function lp(l,d){throw l=Object.prototype.toString.call(d),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l))}function iP(l){var d=l._init;return d(l._payload)}function oP(l){function d(ke,pe){if(l){var Oe=ke.deletions;Oe===null?(ke.deletions=[pe],ke.flags|=16):Oe.push(pe)}}function p(ke,pe){if(!l)return null;for(;pe!==null;)d(ke,pe),pe=pe.sibling;return null}function _(ke,pe){for(ke=new Map;pe!==null;)pe.key!==null?ke.set(pe.key,pe):ke.set(pe.index,pe),pe=pe.sibling;return ke}function A(ke,pe){return ke=el(ke,pe),ke.index=0,ke.sibling=null,ke}function O(ke,pe,Oe){return ke.index=Oe,l?(Oe=ke.alternate,Oe!==null?(Oe=Oe.index,Oe<pe?(ke.flags|=2,pe):Oe):(ke.flags|=2,pe)):(ke.flags|=1048576,pe)}function K(ke){return l&&ke.alternate===null&&(ke.flags|=2),ke}function ue(ke,pe,Oe,at){return pe===null||pe.tag!==6?(pe=zj(Oe,ke.mode,at),pe.return=ke,pe):(pe=A(pe,Oe),pe.return=ke,pe)}function he(ke,pe,Oe,at){var Et=Oe.type;return Et===E?tt(ke,pe,Oe.props.children,at,Oe.key):pe!==null&&(pe.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===z&&iP(Et)===pe.type)?(at=A(pe,Oe.props),at.ref=mm(ke,pe,Oe),at.return=ke,at):(at=Tp(Oe.type,Oe.key,Oe.props,null,ke.mode,at),at.ref=mm(ke,pe,Oe),at.return=ke,at)}function De(ke,pe,Oe,at){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Oe.containerInfo||pe.stateNode.implementation!==Oe.implementation?(pe=Vj(Oe,ke.mode,at),pe.return=ke,pe):(pe=A(pe,Oe.children||[]),pe.return=ke,pe)}function tt(ke,pe,Oe,at,Et){return pe===null||pe.tag!==7?(pe=Ql(Oe,ke.mode,at,Et),pe.return=ke,pe):(pe=A(pe,Oe),pe.return=ke,pe)}function rt(ke,pe,Oe){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return pe=zj(""+pe,ke.mode,Oe),pe.return=ke,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case w:return Oe=Tp(pe.type,pe.key,pe.props,null,ke.mode,Oe),Oe.ref=mm(ke,null,pe),Oe.return=ke,Oe;case S:return pe=Vj(pe,ke.mode,Oe),pe.return=ke,pe;case z:var at=pe._init;return rt(ke,at(pe._payload),Oe)}if(F(pe)||X(pe))return pe=Ql(pe,ke.mode,Oe,null),pe.return=ke,pe;lp(ke,pe)}return null}function Ze(ke,pe,Oe,at){var Et=pe!==null?pe.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return Et!==null?null:ue(ke,pe,""+Oe,at);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case w:return Oe.key===Et?he(ke,pe,Oe,at):null;case S:return Oe.key===Et?De(ke,pe,Oe,at):null;case z:return Et=Oe._init,Ze(ke,pe,Et(Oe._payload),at)}if(F(Oe)||X(Oe))return Et!==null?null:tt(ke,pe,Oe,at,null);lp(ke,Oe)}return null}function xt(ke,pe,Oe,at,Et){if(typeof at=="string"&&at!==""||typeof at=="number")return ke=ke.get(Oe)||null,ue(pe,ke,""+at,Et);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case w:return ke=ke.get(at.key===null?Oe:at.key)||null,he(pe,ke,at,Et);case S:return ke=ke.get(at.key===null?Oe:at.key)||null,De(pe,ke,at,Et);case z:var Ft=at._init;return xt(ke,pe,Oe,Ft(at._payload),Et)}if(F(at)||X(at))return ke=ke.get(Oe)||null,tt(pe,ke,at,Et,null);lp(pe,at)}return null}function wt(ke,pe,Oe,at){for(var Et=null,Ft=null,Lt=pe,Gt=pe=0,Br=null;Lt!==null&&Gt<Oe.length;Gt++){Lt.index>Gt?(Br=Lt,Lt=null):Br=Lt.sibling;var jn=Ze(ke,Lt,Oe[Gt],at);if(jn===null){Lt===null&&(Lt=Br);break}l&&Lt&&jn.alternate===null&&d(ke,Lt),pe=O(jn,pe,Gt),Ft===null?Et=jn:Ft.sibling=jn,Ft=jn,Lt=Br}if(Gt===Oe.length)return p(ke,Lt),Jn&&zl(ke,Gt),Et;if(Lt===null){for(;Gt<Oe.length;Gt++)Lt=rt(ke,Oe[Gt],at),Lt!==null&&(pe=O(Lt,pe,Gt),Ft===null?Et=Lt:Ft.sibling=Lt,Ft=Lt);return Jn&&zl(ke,Gt),Et}for(Lt=_(ke,Lt);Gt<Oe.length;Gt++)Br=xt(Lt,ke,Gt,Oe[Gt],at),Br!==null&&(l&&Br.alternate!==null&&Lt.delete(Br.key===null?Gt:Br.key),pe=O(Br,pe,Gt),Ft===null?Et=Br:Ft.sibling=Br,Ft=Br);return l&&Lt.forEach(function(tl){return d(ke,tl)}),Jn&&zl(ke,Gt),Et}function Ct(ke,pe,Oe,at){var Et=X(Oe);if(typeof Et!="function")throw Error(r(150));if(Oe=Et.call(Oe),Oe==null)throw Error(r(151));for(var Ft=Et=null,Lt=pe,Gt=pe=0,Br=null,jn=Oe.next();Lt!==null&&!jn.done;Gt++,jn=Oe.next()){Lt.index>Gt?(Br=Lt,Lt=null):Br=Lt.sibling;var tl=Ze(ke,Lt,jn.value,at);if(tl===null){Lt===null&&(Lt=Br);break}l&&Lt&&tl.alternate===null&&d(ke,Lt),pe=O(tl,pe,Gt),Ft===null?Et=tl:Ft.sibling=tl,Ft=tl,Lt=Br}if(jn.done)return p(ke,Lt),Jn&&zl(ke,Gt),Et;if(Lt===null){for(;!jn.done;Gt++,jn=Oe.next())jn=rt(ke,jn.value,at),jn!==null&&(pe=O(jn,pe,Gt),Ft===null?Et=jn:Ft.sibling=jn,Ft=jn);return Jn&&zl(ke,Gt),Et}for(Lt=_(ke,Lt);!jn.done;Gt++,jn=Oe.next())jn=xt(Lt,ke,Gt,jn.value,at),jn!==null&&(l&&jn.alternate!==null&&Lt.delete(jn.key===null?Gt:jn.key),pe=O(jn,pe,Gt),Ft===null?Et=jn:Ft.sibling=jn,Ft=jn);return l&&Lt.forEach(function(ZU){return d(ke,ZU)}),Jn&&zl(ke,Gt),Et}function ur(ke,pe,Oe,at){if(typeof Oe=="object"&&Oe!==null&&Oe.type===E&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case w:e:{for(var Et=Oe.key,Ft=pe;Ft!==null;){if(Ft.key===Et){if(Et=Oe.type,Et===E){if(Ft.tag===7){p(ke,Ft.sibling),pe=A(Ft,Oe.props.children),pe.return=ke,ke=pe;break e}}else if(Ft.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===z&&iP(Et)===Ft.type){p(ke,Ft.sibling),pe=A(Ft,Oe.props),pe.ref=mm(ke,Ft,Oe),pe.return=ke,ke=pe;break e}p(ke,Ft);break}else d(ke,Ft);Ft=Ft.sibling}Oe.type===E?(pe=Ql(Oe.props.children,ke.mode,at,Oe.key),pe.return=ke,ke=pe):(at=Tp(Oe.type,Oe.key,Oe.props,null,ke.mode,at),at.ref=mm(ke,pe,Oe),at.return=ke,ke=at)}return K(ke);case S:e:{for(Ft=Oe.key;pe!==null;){if(pe.key===Ft)if(pe.tag===4&&pe.stateNode.containerInfo===Oe.containerInfo&&pe.stateNode.implementation===Oe.implementation){p(ke,pe.sibling),pe=A(pe,Oe.children||[]),pe.return=ke,ke=pe;break e}else{p(ke,pe);break}else d(ke,pe);pe=pe.sibling}pe=Vj(Oe,ke.mode,at),pe.return=ke,ke=pe}return K(ke);case z:return Ft=Oe._init,ur(ke,pe,Ft(Oe._payload),at)}if(F(Oe))return wt(ke,pe,Oe,at);if(X(Oe))return Ct(ke,pe,Oe,at);lp(ke,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"?(Oe=""+Oe,pe!==null&&pe.tag===6?(p(ke,pe.sibling),pe=A(pe,Oe),pe.return=ke,ke=pe):(p(ke,pe),pe=zj(Oe,ke.mode,at),pe.return=ke,ke=pe),K(ke)):p(ke,pe)}return ur}var rd=oP(!0),lP=oP(!1),cp=Uo(null),dp=null,sd=null,Zy=null;function Jy(){Zy=sd=dp=null}function ej(l){var d=cp.current;Wn(cp),l._currentValue=d}function tj(l,d,p){for(;l!==null;){var _=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,_!==null&&(_.childLanes|=d)):_!==null&&(_.childLanes&d)!==d&&(_.childLanes|=d),l===p)break;l=l.return}}function ad(l,d){dp=l,Zy=sd=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&d)!==0&&(Us=!0),l.firstContext=null)}function ka(l){var d=l._currentValue;if(Zy!==l)if(l={context:l,memoizedValue:d,next:null},sd===null){if(dp===null)throw Error(r(308));sd=l,dp.dependencies={lanes:0,firstContext:l}}else sd=sd.next=l;return d}var Vl=null;function nj(l){Vl===null?Vl=[l]:Vl.push(l)}function cP(l,d,p,_){var A=d.interleaved;return A===null?(p.next=p,nj(d)):(p.next=A.next,A.next=p),d.interleaved=p,Xi(l,_)}function Xi(l,d){l.lanes|=d;var p=l.alternate;for(p!==null&&(p.lanes|=d),p=l,l=l.return;l!==null;)l.childLanes|=d,p=l.alternate,p!==null&&(p.childLanes|=d),p=l,l=l.return;return p.tag===3?p.stateNode:null}var Ho=!1;function rj(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dP(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Zi(l,d){return{eventTime:l,lane:d,tag:0,payload:null,callback:null,next:null}}function Go(l,d,p){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,(yn&2)!==0){var A=_.pending;return A===null?d.next=d:(d.next=A.next,A.next=d),_.pending=d,Xi(l,p)}return A=_.interleaved,A===null?(d.next=d,nj(_)):(d.next=A.next,A.next=d),_.interleaved=d,Xi(l,p)}function up(l,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194240)!==0)){var _=d.lanes;_&=l.pendingLanes,p|=_,d.lanes=p,pr(l,p)}}function uP(l,d){var p=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,p===_)){var A=null,O=null;if(p=p.firstBaseUpdate,p!==null){do{var K={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};O===null?A=O=K:O=O.next=K,p=p.next}while(p!==null);O===null?A=O=d:O=O.next=d}else A=O=d;p={baseState:_.baseState,firstBaseUpdate:A,lastBaseUpdate:O,shared:_.shared,effects:_.effects},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=d:l.next=d,p.lastBaseUpdate=d}function mp(l,d,p,_){var A=l.updateQueue;Ho=!1;var O=A.firstBaseUpdate,K=A.lastBaseUpdate,ue=A.shared.pending;if(ue!==null){A.shared.pending=null;var he=ue,De=he.next;he.next=null,K===null?O=De:K.next=De,K=he;var tt=l.alternate;tt!==null&&(tt=tt.updateQueue,ue=tt.lastBaseUpdate,ue!==K&&(ue===null?tt.firstBaseUpdate=De:ue.next=De,tt.lastBaseUpdate=he))}if(O!==null){var rt=A.baseState;K=0,tt=De=he=null,ue=O;do{var Ze=ue.lane,xt=ue.eventTime;if((_&Ze)===Ze){tt!==null&&(tt=tt.next={eventTime:xt,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var wt=l,Ct=ue;switch(Ze=d,xt=p,Ct.tag){case 1:if(wt=Ct.payload,typeof wt=="function"){rt=wt.call(xt,rt,Ze);break e}rt=wt;break e;case 3:wt.flags=wt.flags&-65537|128;case 0:if(wt=Ct.payload,Ze=typeof wt=="function"?wt.call(xt,rt,Ze):wt,Ze==null)break e;rt=ne({},rt,Ze);break e;case 2:Ho=!0}}ue.callback!==null&&ue.lane!==0&&(l.flags|=64,Ze=A.effects,Ze===null?A.effects=[ue]:Ze.push(ue))}else xt={eventTime:xt,lane:Ze,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},tt===null?(De=tt=xt,he=rt):tt=tt.next=xt,K|=Ze;if(ue=ue.next,ue===null){if(ue=A.shared.pending,ue===null)break;Ze=ue,ue=Ze.next,Ze.next=null,A.lastBaseUpdate=Ze,A.shared.pending=null}}while(!0);if(tt===null&&(he=rt),A.baseState=he,A.firstBaseUpdate=De,A.lastBaseUpdate=tt,d=A.shared.interleaved,d!==null){A=d;do K|=A.lane,A=A.next;while(A!==d)}else O===null&&(A.shared.lanes=0);Wl|=K,l.lanes=K,l.memoizedState=rt}}function mP(l,d,p){if(l=d.effects,d.effects=null,l!==null)for(d=0;d<l.length;d++){var _=l[d],A=_.callback;if(A!==null){if(_.callback=null,_=p,typeof A!="function")throw Error(r(191,A));A.call(_)}}}var hm={},Ci=Uo(hm),fm=Uo(hm),pm=Uo(hm);function Ul(l){if(l===hm)throw Error(r(174));return l}function sj(l,d){switch(qn(pm,d),qn(fm,l),qn(Ci,hm),l=d.nodeType,l){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Me(null,"");break;default:l=l===8?d.parentNode:d,d=l.namespaceURI||null,l=l.tagName,d=Me(d,l)}Wn(Ci),qn(Ci,d)}function id(){Wn(Ci),Wn(fm),Wn(pm)}function hP(l){Ul(pm.current);var d=Ul(Ci.current),p=Me(d,l.type);d!==p&&(qn(fm,l),qn(Ci,p))}function aj(l){fm.current===l&&(Wn(Ci),Wn(fm))}var rr=Uo(0);function hp(l){for(var d=l;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var ij=[];function oj(){for(var l=0;l<ij.length;l++)ij[l]._workInProgressVersionPrimary=null;ij.length=0}var fp=P.ReactCurrentDispatcher,lj=P.ReactCurrentBatchConfig,Kl=0,sr=null,Ar=null,Ir=null,pp=!1,xm=!1,gm=0,jU=0;function ls(){throw Error(r(321))}function cj(l,d){if(d===null)return!1;for(var p=0;p<d.length&&p<l.length;p++)if(!Ya(l[p],d[p]))return!1;return!0}function dj(l,d,p,_,A,O){if(Kl=O,sr=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,fp.current=l===null||l.memoizedState===null?NU:SU,l=p(_,A),xm){O=0;do{if(xm=!1,gm=0,25<=O)throw Error(r(301));O+=1,Ir=Ar=null,d.updateQueue=null,fp.current=CU,l=p(_,A)}while(xm)}if(fp.current=vp,d=Ar!==null&&Ar.next!==null,Kl=0,Ir=Ar=sr=null,pp=!1,d)throw Error(r(300));return l}function uj(){var l=gm!==0;return gm=0,l}function ki(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ir===null?sr.memoizedState=Ir=l:Ir=Ir.next=l,Ir}function Pa(){if(Ar===null){var l=sr.alternate;l=l!==null?l.memoizedState:null}else l=Ar.next;var d=Ir===null?sr.memoizedState:Ir.next;if(d!==null)Ir=d,Ar=l;else{if(l===null)throw Error(r(310));Ar=l,l={memoizedState:Ar.memoizedState,baseState:Ar.baseState,baseQueue:Ar.baseQueue,queue:Ar.queue,next:null},Ir===null?sr.memoizedState=Ir=l:Ir=Ir.next=l}return Ir}function vm(l,d){return typeof d=="function"?d(l):d}function mj(l){var d=Pa(),p=d.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=l;var _=Ar,A=_.baseQueue,O=p.pending;if(O!==null){if(A!==null){var K=A.next;A.next=O.next,O.next=K}_.baseQueue=A=O,p.pending=null}if(A!==null){O=A.next,_=_.baseState;var ue=K=null,he=null,De=O;do{var tt=De.lane;if((Kl&tt)===tt)he!==null&&(he=he.next={lane:0,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null}),_=De.hasEagerState?De.eagerState:l(_,De.action);else{var rt={lane:tt,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null};he===null?(ue=he=rt,K=_):he=he.next=rt,sr.lanes|=tt,Wl|=tt}De=De.next}while(De!==null&&De!==O);he===null?K=_:he.next=ue,Ya(_,d.memoizedState)||(Us=!0),d.memoizedState=_,d.baseState=K,d.baseQueue=he,p.lastRenderedState=_}if(l=p.interleaved,l!==null){A=l;do O=A.lane,sr.lanes|=O,Wl|=O,A=A.next;while(A!==l)}else A===null&&(p.lanes=0);return[d.memoizedState,p.dispatch]}function hj(l){var d=Pa(),p=d.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=l;var _=p.dispatch,A=p.pending,O=d.memoizedState;if(A!==null){p.pending=null;var K=A=A.next;do O=l(O,K.action),K=K.next;while(K!==A);Ya(O,d.memoizedState)||(Us=!0),d.memoizedState=O,d.baseQueue===null&&(d.baseState=O),p.lastRenderedState=O}return[O,_]}function fP(){}function pP(l,d){var p=sr,_=Pa(),A=d(),O=!Ya(_.memoizedState,A);if(O&&(_.memoizedState=A,Us=!0),_=_.queue,fj(vP.bind(null,p,_,l),[l]),_.getSnapshot!==d||O||Ir!==null&&Ir.memoizedState.tag&1){if(p.flags|=2048,ym(9,gP.bind(null,p,_,A,d),void 0,null),qr===null)throw Error(r(349));(Kl&30)!==0||xP(p,d,A)}return A}function xP(l,d,p){l.flags|=16384,l={getSnapshot:d,value:p},d=sr.updateQueue,d===null?(d={lastEffect:null,stores:null},sr.updateQueue=d,d.stores=[l]):(p=d.stores,p===null?d.stores=[l]:p.push(l))}function gP(l,d,p,_){d.value=p,d.getSnapshot=_,yP(d)&&jP(l)}function vP(l,d,p){return p(function(){yP(d)&&jP(l)})}function yP(l){var d=l.getSnapshot;l=l.value;try{var p=d();return!Ya(l,p)}catch{return!0}}function jP(l){var d=Xi(l,1);d!==null&&ei(d,l,1,-1)}function bP(l){var d=ki();return typeof l=="function"&&(l=l()),d.memoizedState=d.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vm,lastRenderedState:l},d.queue=l,l=l.dispatch=_U.bind(null,sr,l),[d.memoizedState,l]}function ym(l,d,p,_){return l={tag:l,create:d,destroy:p,deps:_,next:null},d=sr.updateQueue,d===null?(d={lastEffect:null,stores:null},sr.updateQueue=d,d.lastEffect=l.next=l):(p=d.lastEffect,p===null?d.lastEffect=l.next=l:(_=p.next,p.next=l,l.next=_,d.lastEffect=l)),l}function wP(){return Pa().memoizedState}function xp(l,d,p,_){var A=ki();sr.flags|=l,A.memoizedState=ym(1|d,p,void 0,_===void 0?null:_)}function gp(l,d,p,_){var A=Pa();_=_===void 0?null:_;var O=void 0;if(Ar!==null){var K=Ar.memoizedState;if(O=K.destroy,_!==null&&cj(_,K.deps)){A.memoizedState=ym(d,p,O,_);return}}sr.flags|=l,A.memoizedState=ym(1|d,p,O,_)}function _P(l,d){return xp(8390656,8,l,d)}function fj(l,d){return gp(2048,8,l,d)}function NP(l,d){return gp(4,2,l,d)}function SP(l,d){return gp(4,4,l,d)}function CP(l,d){if(typeof d=="function")return l=l(),d(l),function(){d(null)};if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function kP(l,d,p){return p=p!=null?p.concat([l]):null,gp(4,4,CP.bind(null,d,l),p)}function pj(){}function PP(l,d){var p=Pa();d=d===void 0?null:d;var _=p.memoizedState;return _!==null&&d!==null&&cj(d,_[1])?_[0]:(p.memoizedState=[l,d],l)}function AP(l,d){var p=Pa();d=d===void 0?null:d;var _=p.memoizedState;return _!==null&&d!==null&&cj(d,_[1])?_[0]:(l=l(),p.memoizedState=[l,d],l)}function EP(l,d,p){return(Kl&21)===0?(l.baseState&&(l.baseState=!1,Us=!0),l.memoizedState=p):(Ya(p,d)||(p=Wi(),sr.lanes|=p,Wl|=p,l.baseState=!0),d)}function bU(l,d){var p=vn;vn=p!==0&&4>p?p:4,l(!0);var _=lj.transition;lj.transition={};try{l(!1),d()}finally{vn=p,lj.transition=_}}function OP(){return Pa().memoizedState}function wU(l,d,p){var _=Zo(l);if(p={lane:_,action:p,hasEagerState:!1,eagerState:null,next:null},TP(l))MP(d,p);else if(p=cP(l,d,p,_),p!==null){var A=bs();ei(p,l,_,A),RP(p,d,_)}}function _U(l,d,p){var _=Zo(l),A={lane:_,action:p,hasEagerState:!1,eagerState:null,next:null};if(TP(l))MP(d,A);else{var O=l.alternate;if(l.lanes===0&&(O===null||O.lanes===0)&&(O=d.lastRenderedReducer,O!==null))try{var K=d.lastRenderedState,ue=O(K,p);if(A.hasEagerState=!0,A.eagerState=ue,Ya(ue,K)){var he=d.interleaved;he===null?(A.next=A,nj(d)):(A.next=he.next,he.next=A),d.interleaved=A;return}}catch{}p=cP(l,d,A,_),p!==null&&(A=bs(),ei(p,l,_,A),RP(p,d,_))}}function TP(l){var d=l.alternate;return l===sr||d!==null&&d===sr}function MP(l,d){xm=pp=!0;var p=l.pending;p===null?d.next=d:(d.next=p.next,p.next=d),l.pending=d}function RP(l,d,p){if((p&4194240)!==0){var _=d.lanes;_&=l.pendingLanes,p|=_,d.lanes=p,pr(l,p)}}var vp={readContext:ka,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useInsertionEffect:ls,useLayoutEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useMutableSource:ls,useSyncExternalStore:ls,useId:ls,unstable_isNewReconciler:!1},NU={readContext:ka,useCallback:function(l,d){return ki().memoizedState=[l,d===void 0?null:d],l},useContext:ka,useEffect:_P,useImperativeHandle:function(l,d,p){return p=p!=null?p.concat([l]):null,xp(4194308,4,CP.bind(null,d,l),p)},useLayoutEffect:function(l,d){return xp(4194308,4,l,d)},useInsertionEffect:function(l,d){return xp(4,2,l,d)},useMemo:function(l,d){var p=ki();return d=d===void 0?null:d,l=l(),p.memoizedState=[l,d],l},useReducer:function(l,d,p){var _=ki();return d=p!==void 0?p(d):d,_.memoizedState=_.baseState=d,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:d},_.queue=l,l=l.dispatch=wU.bind(null,sr,l),[_.memoizedState,l]},useRef:function(l){var d=ki();return l={current:l},d.memoizedState=l},useState:bP,useDebugValue:pj,useDeferredValue:function(l){return ki().memoizedState=l},useTransition:function(){var l=bP(!1),d=l[0];return l=bU.bind(null,l[1]),ki().memoizedState=l,[d,l]},useMutableSource:function(){},useSyncExternalStore:function(l,d,p){var _=sr,A=ki();if(Jn){if(p===void 0)throw Error(r(407));p=p()}else{if(p=d(),qr===null)throw Error(r(349));(Kl&30)!==0||xP(_,d,p)}A.memoizedState=p;var O={value:p,getSnapshot:d};return A.queue=O,_P(vP.bind(null,_,O,l),[l]),_.flags|=2048,ym(9,gP.bind(null,_,O,p,d),void 0,null),p},useId:function(){var l=ki(),d=qr.identifierPrefix;if(Jn){var p=Qi,_=Yi;p=(_&~(1<<32-or(_)-1)).toString(32)+p,d=":"+d+"R"+p,p=gm++,0<p&&(d+="H"+p.toString(32)),d+=":"}else p=jU++,d=":"+d+"r"+p.toString(32)+":";return l.memoizedState=d},unstable_isNewReconciler:!1},SU={readContext:ka,useCallback:PP,useContext:ka,useEffect:fj,useImperativeHandle:kP,useInsertionEffect:NP,useLayoutEffect:SP,useMemo:AP,useReducer:mj,useRef:wP,useState:function(){return mj(vm)},useDebugValue:pj,useDeferredValue:function(l){var d=Pa();return EP(d,Ar.memoizedState,l)},useTransition:function(){var l=mj(vm)[0],d=Pa().memoizedState;return[l,d]},useMutableSource:fP,useSyncExternalStore:pP,useId:OP,unstable_isNewReconciler:!1},CU={readContext:ka,useCallback:PP,useContext:ka,useEffect:fj,useImperativeHandle:kP,useInsertionEffect:NP,useLayoutEffect:SP,useMemo:AP,useReducer:hj,useRef:wP,useState:function(){return hj(vm)},useDebugValue:pj,useDeferredValue:function(l){var d=Pa();return Ar===null?d.memoizedState=l:EP(d,Ar.memoizedState,l)},useTransition:function(){var l=hj(vm)[0],d=Pa().memoizedState;return[l,d]},useMutableSource:fP,useSyncExternalStore:pP,useId:OP,unstable_isNewReconciler:!1};function Xa(l,d){if(l&&l.defaultProps){d=ne({},d),l=l.defaultProps;for(var p in l)d[p]===void 0&&(d[p]=l[p]);return d}return d}function xj(l,d,p,_){d=l.memoizedState,p=p(_,d),p=p==null?d:ne({},d,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var yp={isMounted:function(l){return(l=l._reactInternals)?Yr(l)===l:!1},enqueueSetState:function(l,d,p){l=l._reactInternals;var _=bs(),A=Zo(l),O=Zi(_,A);O.payload=d,p!=null&&(O.callback=p),d=Go(l,O,A),d!==null&&(ei(d,l,A,_),up(d,l,A))},enqueueReplaceState:function(l,d,p){l=l._reactInternals;var _=bs(),A=Zo(l),O=Zi(_,A);O.tag=1,O.payload=d,p!=null&&(O.callback=p),d=Go(l,O,A),d!==null&&(ei(d,l,A,_),up(d,l,A))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var p=bs(),_=Zo(l),A=Zi(p,_);A.tag=2,d!=null&&(A.callback=d),d=Go(l,A,_),d!==null&&(ei(d,l,_,p),up(d,l,_))}};function DP(l,d,p,_,A,O,K){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,O,K):d.prototype&&d.prototype.isPureReactComponent?!am(p,_)||!am(A,O):!0}function $P(l,d,p){var _=!1,A=Ko,O=d.contextType;return typeof O=="object"&&O!==null?O=ka(O):(A=Vs(d)?ql:os.current,_=d.contextTypes,O=(_=_!=null)?Jc(l,A):Ko),d=new d(p,O),l.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=yp,l.stateNode=d,d._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=A,l.__reactInternalMemoizedMaskedChildContext=O),d}function FP(l,d,p,_){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,_),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,_),d.state!==l&&yp.enqueueReplaceState(d,d.state,null)}function gj(l,d,p,_){var A=l.stateNode;A.props=p,A.state=l.memoizedState,A.refs={},rj(l);var O=d.contextType;typeof O=="object"&&O!==null?A.context=ka(O):(O=Vs(d)?ql:os.current,A.context=Jc(l,O)),A.state=l.memoizedState,O=d.getDerivedStateFromProps,typeof O=="function"&&(xj(l,d,O,p),A.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(d=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),d!==A.state&&yp.enqueueReplaceState(A,A.state,null),mp(l,p,A,_),A.state=l.memoizedState),typeof A.componentDidMount=="function"&&(l.flags|=4194308)}function od(l,d){try{var p="",_=d;do p+=Re(_),_=_.return;while(_);var A=p}catch(O){A=`
Error generating stack: `+O.message+`
`+O.stack}return{value:l,source:d,stack:A,digest:null}}function vj(l,d,p){return{value:l,source:null,stack:p??null,digest:d??null}}function yj(l,d){try{console.error(d.value)}catch(p){setTimeout(function(){throw p})}}var kU=typeof WeakMap=="function"?WeakMap:Map;function LP(l,d,p){p=Zi(-1,p),p.tag=3,p.payload={element:null};var _=d.value;return p.callback=function(){Cp||(Cp=!0,Rj=_),yj(l,d)},p}function IP(l,d,p){p=Zi(-1,p),p.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var A=d.value;p.payload=function(){return _(A)},p.callback=function(){yj(l,d)}}var O=l.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(p.callback=function(){yj(l,d),typeof _!="function"&&(Qo===null?Qo=new Set([this]):Qo.add(this));var K=d.stack;this.componentDidCatch(d.value,{componentStack:K!==null?K:""})}),p}function qP(l,d,p){var _=l.pingCache;if(_===null){_=l.pingCache=new kU;var A=new Set;_.set(d,A)}else A=_.get(d),A===void 0&&(A=new Set,_.set(d,A));A.has(p)||(A.add(p),l=BU.bind(null,l,d,p),d.then(l,l))}function BP(l){do{var d;if((d=l.tag===13)&&(d=l.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return l;l=l.return}while(l!==null);return null}function zP(l,d,p,_,A){return(l.mode&1)===0?(l===d?l.flags|=65536:(l.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(d=Zi(-1,1),d.tag=2,Go(p,d,1))),p.lanes|=1),l):(l.flags|=65536,l.lanes=A,l)}var PU=P.ReactCurrentOwner,Us=!1;function js(l,d,p,_){d.child=l===null?lP(d,null,p,_):rd(d,l.child,p,_)}function VP(l,d,p,_,A){p=p.render;var O=d.ref;return ad(d,A),_=dj(l,d,p,_,O,A),p=uj(),l!==null&&!Us?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~A,Ji(l,d,A)):(Jn&&p&&Hy(d),d.flags|=1,js(l,d,_,A),d.child)}function UP(l,d,p,_,A){if(l===null){var O=p.type;return typeof O=="function"&&!Bj(O)&&O.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(d.tag=15,d.type=O,KP(l,d,O,_,A)):(l=Tp(p.type,null,_,d,d.mode,A),l.ref=d.ref,l.return=d,d.child=l)}if(O=l.child,(l.lanes&A)===0){var K=O.memoizedProps;if(p=p.compare,p=p!==null?p:am,p(K,_)&&l.ref===d.ref)return Ji(l,d,A)}return d.flags|=1,l=el(O,_),l.ref=d.ref,l.return=d,d.child=l}function KP(l,d,p,_,A){if(l!==null){var O=l.memoizedProps;if(am(O,_)&&l.ref===d.ref)if(Us=!1,d.pendingProps=_=O,(l.lanes&A)!==0)(l.flags&131072)!==0&&(Us=!0);else return d.lanes=l.lanes,Ji(l,d,A)}return jj(l,d,p,_,A)}function WP(l,d,p){var _=d.pendingProps,A=_.children,O=l!==null?l.memoizedState:null;if(_.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},qn(cd,la),la|=p;else{if((p&1073741824)===0)return l=O!==null?O.baseLanes|p:p,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:l,cachePool:null,transitions:null},d.updateQueue=null,qn(cd,la),la|=l,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=O!==null?O.baseLanes:p,qn(cd,la),la|=_}else O!==null?(_=O.baseLanes|p,d.memoizedState=null):_=p,qn(cd,la),la|=_;return js(l,d,A,p),d.child}function HP(l,d){var p=d.ref;(l===null&&p!==null||l!==null&&l.ref!==p)&&(d.flags|=512,d.flags|=2097152)}function jj(l,d,p,_,A){var O=Vs(p)?ql:os.current;return O=Jc(d,O),ad(d,A),p=dj(l,d,p,_,O,A),_=uj(),l!==null&&!Us?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~A,Ji(l,d,A)):(Jn&&_&&Hy(d),d.flags|=1,js(l,d,p,A),d.child)}function GP(l,d,p,_,A){if(Vs(p)){var O=!0;rp(d)}else O=!1;if(ad(d,A),d.stateNode===null)bp(l,d),$P(d,p,_),gj(d,p,_,A),_=!0;else if(l===null){var K=d.stateNode,ue=d.memoizedProps;K.props=ue;var he=K.context,De=p.contextType;typeof De=="object"&&De!==null?De=ka(De):(De=Vs(p)?ql:os.current,De=Jc(d,De));var tt=p.getDerivedStateFromProps,rt=typeof tt=="function"||typeof K.getSnapshotBeforeUpdate=="function";rt||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ue!==_||he!==De)&&FP(d,K,_,De),Ho=!1;var Ze=d.memoizedState;K.state=Ze,mp(d,_,K,A),he=d.memoizedState,ue!==_||Ze!==he||zs.current||Ho?(typeof tt=="function"&&(xj(d,p,tt,_),he=d.memoizedState),(ue=Ho||DP(d,p,ue,_,Ze,he,De))?(rt||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(d.flags|=4194308)):(typeof K.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=_,d.memoizedState=he),K.props=_,K.state=he,K.context=De,_=ue):(typeof K.componentDidMount=="function"&&(d.flags|=4194308),_=!1)}else{K=d.stateNode,dP(l,d),ue=d.memoizedProps,De=d.type===d.elementType?ue:Xa(d.type,ue),K.props=De,rt=d.pendingProps,Ze=K.context,he=p.contextType,typeof he=="object"&&he!==null?he=ka(he):(he=Vs(p)?ql:os.current,he=Jc(d,he));var xt=p.getDerivedStateFromProps;(tt=typeof xt=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ue!==rt||Ze!==he)&&FP(d,K,_,he),Ho=!1,Ze=d.memoizedState,K.state=Ze,mp(d,_,K,A);var wt=d.memoizedState;ue!==rt||Ze!==wt||zs.current||Ho?(typeof xt=="function"&&(xj(d,p,xt,_),wt=d.memoizedState),(De=Ho||DP(d,p,De,_,Ze,wt,he)||!1)?(tt||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(_,wt,he),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(_,wt,he)),typeof K.componentDidUpdate=="function"&&(d.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof K.componentDidUpdate!="function"||ue===l.memoizedProps&&Ze===l.memoizedState||(d.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ue===l.memoizedProps&&Ze===l.memoizedState||(d.flags|=1024),d.memoizedProps=_,d.memoizedState=wt),K.props=_,K.state=wt,K.context=he,_=De):(typeof K.componentDidUpdate!="function"||ue===l.memoizedProps&&Ze===l.memoizedState||(d.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ue===l.memoizedProps&&Ze===l.memoizedState||(d.flags|=1024),_=!1)}return bj(l,d,p,_,O,A)}function bj(l,d,p,_,A,O){HP(l,d);var K=(d.flags&128)!==0;if(!_&&!K)return A&&J2(d,p,!1),Ji(l,d,O);_=d.stateNode,PU.current=d;var ue=K&&typeof p.getDerivedStateFromError!="function"?null:_.render();return d.flags|=1,l!==null&&K?(d.child=rd(d,l.child,null,O),d.child=rd(d,null,ue,O)):js(l,d,ue,O),d.memoizedState=_.state,A&&J2(d,p,!0),d.child}function YP(l){var d=l.stateNode;d.pendingContext?X2(l,d.pendingContext,d.pendingContext!==d.context):d.context&&X2(l,d.context,!1),sj(l,d.containerInfo)}function QP(l,d,p,_,A){return nd(),Xy(A),d.flags|=256,js(l,d,p,_),d.child}var wj={dehydrated:null,treeContext:null,retryLane:0};function _j(l){return{baseLanes:l,cachePool:null,transitions:null}}function XP(l,d,p){var _=d.pendingProps,A=rr.current,O=!1,K=(d.flags&128)!==0,ue;if((ue=K)||(ue=l!==null&&l.memoizedState===null?!1:(A&2)!==0),ue?(O=!0,d.flags&=-129):(l===null||l.memoizedState!==null)&&(A|=1),qn(rr,A&1),l===null)return Qy(d),l=d.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((d.mode&1)===0?d.lanes=1:l.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(K=_.children,l=_.fallback,O?(_=d.mode,O=d.child,K={mode:"hidden",children:K},(_&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=K):O=Mp(K,_,0,null),l=Ql(l,_,p,null),O.return=d,l.return=d,O.sibling=l,d.child=O,d.child.memoizedState=_j(p),d.memoizedState=wj,l):Nj(d,K));if(A=l.memoizedState,A!==null&&(ue=A.dehydrated,ue!==null))return AU(l,d,K,_,ue,A,p);if(O){O=_.fallback,K=d.mode,A=l.child,ue=A.sibling;var he={mode:"hidden",children:_.children};return(K&1)===0&&d.child!==A?(_=d.child,_.childLanes=0,_.pendingProps=he,d.deletions=null):(_=el(A,he),_.subtreeFlags=A.subtreeFlags&14680064),ue!==null?O=el(ue,O):(O=Ql(O,K,p,null),O.flags|=2),O.return=d,_.return=d,_.sibling=O,d.child=_,_=O,O=d.child,K=l.child.memoizedState,K=K===null?_j(p):{baseLanes:K.baseLanes|p,cachePool:null,transitions:K.transitions},O.memoizedState=K,O.childLanes=l.childLanes&~p,d.memoizedState=wj,_}return O=l.child,l=O.sibling,_=el(O,{mode:"visible",children:_.children}),(d.mode&1)===0&&(_.lanes=p),_.return=d,_.sibling=null,l!==null&&(p=d.deletions,p===null?(d.deletions=[l],d.flags|=16):p.push(l)),d.child=_,d.memoizedState=null,_}function Nj(l,d){return d=Mp({mode:"visible",children:d},l.mode,0,null),d.return=l,l.child=d}function jp(l,d,p,_){return _!==null&&Xy(_),rd(d,l.child,null,p),l=Nj(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function AU(l,d,p,_,A,O,K){if(p)return d.flags&256?(d.flags&=-257,_=vj(Error(r(422))),jp(l,d,K,_)):d.memoizedState!==null?(d.child=l.child,d.flags|=128,null):(O=_.fallback,A=d.mode,_=Mp({mode:"visible",children:_.children},A,0,null),O=Ql(O,A,K,null),O.flags|=2,_.return=d,O.return=d,_.sibling=O,d.child=_,(d.mode&1)!==0&&rd(d,l.child,null,K),d.child.memoizedState=_j(K),d.memoizedState=wj,O);if((d.mode&1)===0)return jp(l,d,K,null);if(A.data==="$!"){if(_=A.nextSibling&&A.nextSibling.dataset,_)var ue=_.dgst;return _=ue,O=Error(r(419)),_=vj(O,_,void 0),jp(l,d,K,_)}if(ue=(K&l.childLanes)!==0,Us||ue){if(_=qr,_!==null){switch(K&-K){case 4:A=2;break;case 16:A=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:A=32;break;case 536870912:A=268435456;break;default:A=0}A=(A&(_.suspendedLanes|K))!==0?0:A,A!==0&&A!==O.retryLane&&(O.retryLane=A,Xi(l,A),ei(_,l,A,-1))}return qj(),_=vj(Error(r(421))),jp(l,d,K,_)}return A.data==="$?"?(d.flags|=128,d.child=l.child,d=zU.bind(null,l),A._reactRetry=d,null):(l=O.treeContext,oa=Vo(A.nextSibling),ia=d,Jn=!0,Qa=null,l!==null&&(Sa[Ca++]=Yi,Sa[Ca++]=Qi,Sa[Ca++]=Bl,Yi=l.id,Qi=l.overflow,Bl=d),d=Nj(d,_.children),d.flags|=4096,d)}function ZP(l,d,p){l.lanes|=d;var _=l.alternate;_!==null&&(_.lanes|=d),tj(l.return,d,p)}function Sj(l,d,p,_,A){var O=l.memoizedState;O===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:_,tail:p,tailMode:A}:(O.isBackwards=d,O.rendering=null,O.renderingStartTime=0,O.last=_,O.tail=p,O.tailMode=A)}function JP(l,d,p){var _=d.pendingProps,A=_.revealOrder,O=_.tail;if(js(l,d,_.children,p),_=rr.current,(_&2)!==0)_=_&1|2,d.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&ZP(l,p,d);else if(l.tag===19)ZP(l,p,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(qn(rr,_),(d.mode&1)===0)d.memoizedState=null;else switch(A){case"forwards":for(p=d.child,A=null;p!==null;)l=p.alternate,l!==null&&hp(l)===null&&(A=p),p=p.sibling;p=A,p===null?(A=d.child,d.child=null):(A=p.sibling,p.sibling=null),Sj(d,!1,A,p,O);break;case"backwards":for(p=null,A=d.child,d.child=null;A!==null;){if(l=A.alternate,l!==null&&hp(l)===null){d.child=A;break}l=A.sibling,A.sibling=p,p=A,A=l}Sj(d,!0,p,null,O);break;case"together":Sj(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function bp(l,d){(d.mode&1)===0&&l!==null&&(l.alternate=null,d.alternate=null,d.flags|=2)}function Ji(l,d,p){if(l!==null&&(d.dependencies=l.dependencies),Wl|=d.lanes,(p&d.childLanes)===0)return null;if(l!==null&&d.child!==l.child)throw Error(r(153));if(d.child!==null){for(l=d.child,p=el(l,l.pendingProps),d.child=p,p.return=d;l.sibling!==null;)l=l.sibling,p=p.sibling=el(l,l.pendingProps),p.return=d;p.sibling=null}return d.child}function EU(l,d,p){switch(d.tag){case 3:YP(d),nd();break;case 5:hP(d);break;case 1:Vs(d.type)&&rp(d);break;case 4:sj(d,d.stateNode.containerInfo);break;case 10:var _=d.type._context,A=d.memoizedProps.value;qn(cp,_._currentValue),_._currentValue=A;break;case 13:if(_=d.memoizedState,_!==null)return _.dehydrated!==null?(qn(rr,rr.current&1),d.flags|=128,null):(p&d.child.childLanes)!==0?XP(l,d,p):(qn(rr,rr.current&1),l=Ji(l,d,p),l!==null?l.sibling:null);qn(rr,rr.current&1);break;case 19:if(_=(p&d.childLanes)!==0,(l.flags&128)!==0){if(_)return JP(l,d,p);d.flags|=128}if(A=d.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),qn(rr,rr.current),_)break;return null;case 22:case 23:return d.lanes=0,WP(l,d,p)}return Ji(l,d,p)}var eA,Cj,tA,nA;eA=function(l,d){for(var p=d.child;p!==null;){if(p.tag===5||p.tag===6)l.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Cj=function(){},tA=function(l,d,p,_){var A=l.memoizedProps;if(A!==_){l=d.stateNode,Ul(Ci.current);var O=null;switch(p){case"input":A=ut(l,A),_=ut(l,_),O=[];break;case"select":A=ne({},A,{value:void 0}),_=ne({},_,{value:void 0}),O=[];break;case"textarea":A=Z(l,A),_=Z(l,_),O=[];break;default:typeof A.onClick!="function"&&typeof _.onClick=="function"&&(l.onclick=ep)}ta(p,_);var K;p=null;for(De in A)if(!_.hasOwnProperty(De)&&A.hasOwnProperty(De)&&A[De]!=null)if(De==="style"){var ue=A[De];for(K in ue)ue.hasOwnProperty(K)&&(p||(p={}),p[K]="")}else De!=="dangerouslySetInnerHTML"&&De!=="children"&&De!=="suppressContentEditableWarning"&&De!=="suppressHydrationWarning"&&De!=="autoFocus"&&(a.hasOwnProperty(De)?O||(O=[]):(O=O||[]).push(De,null));for(De in _){var he=_[De];if(ue=A?.[De],_.hasOwnProperty(De)&&he!==ue&&(he!=null||ue!=null))if(De==="style")if(ue){for(K in ue)!ue.hasOwnProperty(K)||he&&he.hasOwnProperty(K)||(p||(p={}),p[K]="");for(K in he)he.hasOwnProperty(K)&&ue[K]!==he[K]&&(p||(p={}),p[K]=he[K])}else p||(O||(O=[]),O.push(De,p)),p=he;else De==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,ue=ue?ue.__html:void 0,he!=null&&ue!==he&&(O=O||[]).push(De,he)):De==="children"?typeof he!="string"&&typeof he!="number"||(O=O||[]).push(De,""+he):De!=="suppressContentEditableWarning"&&De!=="suppressHydrationWarning"&&(a.hasOwnProperty(De)?(he!=null&&De==="onScroll"&&Kn("scroll",l),O||ue===he||(O=[])):(O=O||[]).push(De,he))}p&&(O=O||[]).push("style",p);var De=O;(d.updateQueue=De)&&(d.flags|=4)}},nA=function(l,d,p,_){p!==_&&(d.flags|=4)};function jm(l,d){if(!Jn)switch(l.tailMode){case"hidden":d=l.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var _=null;p!==null;)p.alternate!==null&&(_=p),p=p.sibling;_===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function cs(l){var d=l.alternate!==null&&l.alternate.child===l.child,p=0,_=0;if(d)for(var A=l.child;A!==null;)p|=A.lanes|A.childLanes,_|=A.subtreeFlags&14680064,_|=A.flags&14680064,A.return=l,A=A.sibling;else for(A=l.child;A!==null;)p|=A.lanes|A.childLanes,_|=A.subtreeFlags,_|=A.flags,A.return=l,A=A.sibling;return l.subtreeFlags|=_,l.childLanes=p,d}function OU(l,d,p){var _=d.pendingProps;switch(Gy(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cs(d),null;case 1:return Vs(d.type)&&np(),cs(d),null;case 3:return _=d.stateNode,id(),Wn(zs),Wn(os),oj(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(op(d)?d.flags|=4:l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Qa!==null&&(Fj(Qa),Qa=null))),Cj(l,d),cs(d),null;case 5:aj(d);var A=Ul(pm.current);if(p=d.type,l!==null&&d.stateNode!=null)tA(l,d,p,_,A),l.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!_){if(d.stateNode===null)throw Error(r(166));return cs(d),null}if(l=Ul(Ci.current),op(d)){_=d.stateNode,p=d.type;var O=d.memoizedProps;switch(_[Si]=d,_[dm]=O,l=(d.mode&1)!==0,p){case"dialog":Kn("cancel",_),Kn("close",_);break;case"iframe":case"object":case"embed":Kn("load",_);break;case"video":case"audio":for(A=0;A<om.length;A++)Kn(om[A],_);break;case"source":Kn("error",_);break;case"img":case"image":case"link":Kn("error",_),Kn("load",_);break;case"details":Kn("toggle",_);break;case"input":Dt(_,O),Kn("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!O.multiple},Kn("invalid",_);break;case"textarea":xe(_,O),Kn("invalid",_)}ta(p,O),A=null;for(var K in O)if(O.hasOwnProperty(K)){var ue=O[K];K==="children"?typeof ue=="string"?_.textContent!==ue&&(O.suppressHydrationWarning!==!0&&Jf(_.textContent,ue,l),A=["children",ue]):typeof ue=="number"&&_.textContent!==""+ue&&(O.suppressHydrationWarning!==!0&&Jf(_.textContent,ue,l),A=["children",""+ue]):a.hasOwnProperty(K)&&ue!=null&&K==="onScroll"&&Kn("scroll",_)}switch(p){case"input":Ke(_),te(_,O,!0);break;case"textarea":Ke(_),Je(_);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(_.onclick=ep)}_=A,d.updateQueue=_,_!==null&&(d.flags|=4)}else{K=A.nodeType===9?A:A.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=ae(p)),l==="http://www.w3.org/1999/xhtml"?p==="script"?(l=K.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof _.is=="string"?l=K.createElement(p,{is:_.is}):(l=K.createElement(p),p==="select"&&(K=l,_.multiple?K.multiple=!0:_.size&&(K.size=_.size))):l=K.createElementNS(l,p),l[Si]=d,l[dm]=_,eA(l,d,!1,!1),d.stateNode=l;e:{switch(K=Hr(p,_),p){case"dialog":Kn("cancel",l),Kn("close",l),A=_;break;case"iframe":case"object":case"embed":Kn("load",l),A=_;break;case"video":case"audio":for(A=0;A<om.length;A++)Kn(om[A],l);A=_;break;case"source":Kn("error",l),A=_;break;case"img":case"image":case"link":Kn("error",l),Kn("load",l),A=_;break;case"details":Kn("toggle",l),A=_;break;case"input":Dt(l,_),A=ut(l,_),Kn("invalid",l);break;case"option":A=_;break;case"select":l._wrapperState={wasMultiple:!!_.multiple},A=ne({},_,{value:void 0}),Kn("invalid",l);break;case"textarea":xe(l,_),A=Z(l,_),Kn("invalid",l);break;default:A=_}ta(p,A),ue=A;for(O in ue)if(ue.hasOwnProperty(O)){var he=ue[O];O==="style"?Fs(l,he):O==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&Zt(l,he)):O==="children"?typeof he=="string"?(p!=="textarea"||he!=="")&&sn(l,he):typeof he=="number"&&sn(l,""+he):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(a.hasOwnProperty(O)?he!=null&&O==="onScroll"&&Kn("scroll",l):he!=null&&N(l,O,he,K))}switch(p){case"input":Ke(l),te(l,_,!1);break;case"textarea":Ke(l),Je(l);break;case"option":_.value!=null&&l.setAttribute("value",""+Y(_.value));break;case"select":l.multiple=!!_.multiple,O=_.value,O!=null?Ue(l,!!_.multiple,O,!1):_.defaultValue!=null&&Ue(l,!!_.multiple,_.defaultValue,!0);break;default:typeof A.onClick=="function"&&(l.onclick=ep)}switch(p){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return cs(d),null;case 6:if(l&&d.stateNode!=null)nA(l,d,l.memoizedProps,_);else{if(typeof _!="string"&&d.stateNode===null)throw Error(r(166));if(p=Ul(pm.current),Ul(Ci.current),op(d)){if(_=d.stateNode,p=d.memoizedProps,_[Si]=d,(O=_.nodeValue!==p)&&(l=ia,l!==null))switch(l.tag){case 3:Jf(_.nodeValue,p,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&Jf(_.nodeValue,p,(l.mode&1)!==0)}O&&(d.flags|=4)}else _=(p.nodeType===9?p:p.ownerDocument).createTextNode(_),_[Si]=d,d.stateNode=_}return cs(d),null;case 13:if(Wn(rr),_=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Jn&&oa!==null&&(d.mode&1)!==0&&(d.flags&128)===0)aP(),nd(),d.flags|=98560,O=!1;else if(O=op(d),_!==null&&_.dehydrated!==null){if(l===null){if(!O)throw Error(r(318));if(O=d.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(r(317));O[Si]=d}else nd(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;cs(d),O=!1}else Qa!==null&&(Fj(Qa),Qa=null),O=!0;if(!O)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=p,d):(_=_!==null,_!==(l!==null&&l.memoizedState!==null)&&_&&(d.child.flags|=8192,(d.mode&1)!==0&&(l===null||(rr.current&1)!==0?Er===0&&(Er=3):qj())),d.updateQueue!==null&&(d.flags|=4),cs(d),null);case 4:return id(),Cj(l,d),l===null&&lm(d.stateNode.containerInfo),cs(d),null;case 10:return ej(d.type._context),cs(d),null;case 17:return Vs(d.type)&&np(),cs(d),null;case 19:if(Wn(rr),O=d.memoizedState,O===null)return cs(d),null;if(_=(d.flags&128)!==0,K=O.rendering,K===null)if(_)jm(O,!1);else{if(Er!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(K=hp(l),K!==null){for(d.flags|=128,jm(O,!1),_=K.updateQueue,_!==null&&(d.updateQueue=_,d.flags|=4),d.subtreeFlags=0,_=p,p=d.child;p!==null;)O=p,l=_,O.flags&=14680066,K=O.alternate,K===null?(O.childLanes=0,O.lanes=l,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=K.childLanes,O.lanes=K.lanes,O.child=K.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=K.memoizedProps,O.memoizedState=K.memoizedState,O.updateQueue=K.updateQueue,O.type=K.type,l=K.dependencies,O.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),p=p.sibling;return qn(rr,rr.current&1|2),d.child}l=l.sibling}O.tail!==null&&nt()>dd&&(d.flags|=128,_=!0,jm(O,!1),d.lanes=4194304)}else{if(!_)if(l=hp(K),l!==null){if(d.flags|=128,_=!0,p=l.updateQueue,p!==null&&(d.updateQueue=p,d.flags|=4),jm(O,!0),O.tail===null&&O.tailMode==="hidden"&&!K.alternate&&!Jn)return cs(d),null}else 2*nt()-O.renderingStartTime>dd&&p!==1073741824&&(d.flags|=128,_=!0,jm(O,!1),d.lanes=4194304);O.isBackwards?(K.sibling=d.child,d.child=K):(p=O.last,p!==null?p.sibling=K:d.child=K,O.last=K)}return O.tail!==null?(d=O.tail,O.rendering=d,O.tail=d.sibling,O.renderingStartTime=nt(),d.sibling=null,p=rr.current,qn(rr,_?p&1|2:p&1),d):(cs(d),null);case 22:case 23:return Ij(),_=d.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(d.flags|=8192),_&&(d.mode&1)!==0?(la&1073741824)!==0&&(cs(d),d.subtreeFlags&6&&(d.flags|=8192)):cs(d),null;case 24:return null;case 25:return null}throw Error(r(156,d.tag))}function TU(l,d){switch(Gy(d),d.tag){case 1:return Vs(d.type)&&np(),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return id(),Wn(zs),Wn(os),oj(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 5:return aj(d),null;case 13:if(Wn(rr),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(r(340));nd()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return Wn(rr),null;case 4:return id(),null;case 10:return ej(d.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var wp=!1,ds=!1,MU=typeof WeakSet=="function"?WeakSet:Set,yt=null;function ld(l,d){var p=l.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(_){lr(l,d,_)}else p.current=null}function kj(l,d,p){try{p()}catch(_){lr(l,d,_)}}var rA=!1;function RU(l,d){if(Iy=zf,l=D2(),Oy(l)){if("selectionStart"in l)var p={start:l.selectionStart,end:l.selectionEnd};else e:{p=(p=l.ownerDocument)&&p.defaultView||window;var _=p.getSelection&&p.getSelection();if(_&&_.rangeCount!==0){p=_.anchorNode;var A=_.anchorOffset,O=_.focusNode;_=_.focusOffset;try{p.nodeType,O.nodeType}catch{p=null;break e}var K=0,ue=-1,he=-1,De=0,tt=0,rt=l,Ze=null;t:for(;;){for(var xt;rt!==p||A!==0&&rt.nodeType!==3||(ue=K+A),rt!==O||_!==0&&rt.nodeType!==3||(he=K+_),rt.nodeType===3&&(K+=rt.nodeValue.length),(xt=rt.firstChild)!==null;)Ze=rt,rt=xt;for(;;){if(rt===l)break t;if(Ze===p&&++De===A&&(ue=K),Ze===O&&++tt===_&&(he=K),(xt=rt.nextSibling)!==null)break;rt=Ze,Ze=rt.parentNode}rt=xt}p=ue===-1||he===-1?null:{start:ue,end:he}}else p=null}p=p||{start:0,end:0}}else p=null;for(qy={focusedElem:l,selectionRange:p},zf=!1,yt=d;yt!==null;)if(d=yt,l=d.child,(d.subtreeFlags&1028)!==0&&l!==null)l.return=d,yt=l;else for(;yt!==null;){d=yt;try{var wt=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(wt!==null){var Ct=wt.memoizedProps,ur=wt.memoizedState,ke=d.stateNode,pe=ke.getSnapshotBeforeUpdate(d.elementType===d.type?Ct:Xa(d.type,Ct),ur);ke.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var Oe=d.stateNode.containerInfo;Oe.nodeType===1?Oe.textContent="":Oe.nodeType===9&&Oe.documentElement&&Oe.removeChild(Oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(at){lr(d,d.return,at)}if(l=d.sibling,l!==null){l.return=d.return,yt=l;break}yt=d.return}return wt=rA,rA=!1,wt}function bm(l,d,p){var _=d.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var A=_=_.next;do{if((A.tag&l)===l){var O=A.destroy;A.destroy=void 0,O!==void 0&&kj(d,p,O)}A=A.next}while(A!==_)}}function _p(l,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&l)===l){var _=p.create;p.destroy=_()}p=p.next}while(p!==d)}}function Pj(l){var d=l.ref;if(d!==null){var p=l.stateNode;l.tag,l=p,typeof d=="function"?d(l):d.current=l}}function sA(l){var d=l.alternate;d!==null&&(l.alternate=null,sA(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&(delete d[Si],delete d[dm],delete d[Uy],delete d[xU],delete d[gU])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function aA(l){return l.tag===5||l.tag===3||l.tag===4}function iA(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||aA(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Aj(l,d,p){var _=l.tag;if(_===5||_===6)l=l.stateNode,d?p.nodeType===8?p.parentNode.insertBefore(l,d):p.insertBefore(l,d):(p.nodeType===8?(d=p.parentNode,d.insertBefore(l,p)):(d=p,d.appendChild(l)),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=ep));else if(_!==4&&(l=l.child,l!==null))for(Aj(l,d,p),l=l.sibling;l!==null;)Aj(l,d,p),l=l.sibling}function Ej(l,d,p){var _=l.tag;if(_===5||_===6)l=l.stateNode,d?p.insertBefore(l,d):p.appendChild(l);else if(_!==4&&(l=l.child,l!==null))for(Ej(l,d,p),l=l.sibling;l!==null;)Ej(l,d,p),l=l.sibling}var Xr=null,Za=!1;function Yo(l,d,p){for(p=p.child;p!==null;)oA(l,d,p),p=p.sibling}function oA(l,d,p){if(Mn&&typeof Mn.onCommitFiberUnmount=="function")try{Mn.onCommitFiberUnmount(kr,p)}catch{}switch(p.tag){case 5:ds||ld(p,d);case 6:var _=Xr,A=Za;Xr=null,Yo(l,d,p),Xr=_,Za=A,Xr!==null&&(Za?(l=Xr,p=p.stateNode,l.nodeType===8?l.parentNode.removeChild(p):l.removeChild(p)):Xr.removeChild(p.stateNode));break;case 18:Xr!==null&&(Za?(l=Xr,p=p.stateNode,l.nodeType===8?Vy(l.parentNode,p):l.nodeType===1&&Vy(l,p),Ju(l)):Vy(Xr,p.stateNode));break;case 4:_=Xr,A=Za,Xr=p.stateNode.containerInfo,Za=!0,Yo(l,d,p),Xr=_,Za=A;break;case 0:case 11:case 14:case 15:if(!ds&&(_=p.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){A=_=_.next;do{var O=A,K=O.destroy;O=O.tag,K!==void 0&&((O&2)!==0||(O&4)!==0)&&kj(p,d,K),A=A.next}while(A!==_)}Yo(l,d,p);break;case 1:if(!ds&&(ld(p,d),_=p.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=p.memoizedProps,_.state=p.memoizedState,_.componentWillUnmount()}catch(ue){lr(p,d,ue)}Yo(l,d,p);break;case 21:Yo(l,d,p);break;case 22:p.mode&1?(ds=(_=ds)||p.memoizedState!==null,Yo(l,d,p),ds=_):Yo(l,d,p);break;default:Yo(l,d,p)}}function lA(l){var d=l.updateQueue;if(d!==null){l.updateQueue=null;var p=l.stateNode;p===null&&(p=l.stateNode=new MU),d.forEach(function(_){var A=VU.bind(null,l,_);p.has(_)||(p.add(_),_.then(A,A))})}}function Ja(l,d){var p=d.deletions;if(p!==null)for(var _=0;_<p.length;_++){var A=p[_];try{var O=l,K=d,ue=K;e:for(;ue!==null;){switch(ue.tag){case 5:Xr=ue.stateNode,Za=!1;break e;case 3:Xr=ue.stateNode.containerInfo,Za=!0;break e;case 4:Xr=ue.stateNode.containerInfo,Za=!0;break e}ue=ue.return}if(Xr===null)throw Error(r(160));oA(O,K,A),Xr=null,Za=!1;var he=A.alternate;he!==null&&(he.return=null),A.return=null}catch(De){lr(A,d,De)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)cA(d,l),d=d.sibling}function cA(l,d){var p=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ja(d,l),Pi(l),_&4){try{bm(3,l,l.return),_p(3,l)}catch(Ct){lr(l,l.return,Ct)}try{bm(5,l,l.return)}catch(Ct){lr(l,l.return,Ct)}}break;case 1:Ja(d,l),Pi(l),_&512&&p!==null&&ld(p,p.return);break;case 5:if(Ja(d,l),Pi(l),_&512&&p!==null&&ld(p,p.return),l.flags&32){var A=l.stateNode;try{sn(A,"")}catch(Ct){lr(l,l.return,Ct)}}if(_&4&&(A=l.stateNode,A!=null)){var O=l.memoizedProps,K=p!==null?p.memoizedProps:O,ue=l.type,he=l.updateQueue;if(l.updateQueue=null,he!==null)try{ue==="input"&&O.type==="radio"&&O.name!=null&&be(A,O),Hr(ue,K);var De=Hr(ue,O);for(K=0;K<he.length;K+=2){var tt=he[K],rt=he[K+1];tt==="style"?Fs(A,rt):tt==="dangerouslySetInnerHTML"?Zt(A,rt):tt==="children"?sn(A,rt):N(A,tt,rt,De)}switch(ue){case"input":pt(A,O);break;case"textarea":Ae(A,O);break;case"select":var Ze=A._wrapperState.wasMultiple;A._wrapperState.wasMultiple=!!O.multiple;var xt=O.value;xt!=null?Ue(A,!!O.multiple,xt,!1):Ze!==!!O.multiple&&(O.defaultValue!=null?Ue(A,!!O.multiple,O.defaultValue,!0):Ue(A,!!O.multiple,O.multiple?[]:"",!1))}A[dm]=O}catch(Ct){lr(l,l.return,Ct)}}break;case 6:if(Ja(d,l),Pi(l),_&4){if(l.stateNode===null)throw Error(r(162));A=l.stateNode,O=l.memoizedProps;try{A.nodeValue=O}catch(Ct){lr(l,l.return,Ct)}}break;case 3:if(Ja(d,l),Pi(l),_&4&&p!==null&&p.memoizedState.isDehydrated)try{Ju(d.containerInfo)}catch(Ct){lr(l,l.return,Ct)}break;case 4:Ja(d,l),Pi(l);break;case 13:Ja(d,l),Pi(l),A=l.child,A.flags&8192&&(O=A.memoizedState!==null,A.stateNode.isHidden=O,!O||A.alternate!==null&&A.alternate.memoizedState!==null||(Mj=nt())),_&4&&lA(l);break;case 22:if(tt=p!==null&&p.memoizedState!==null,l.mode&1?(ds=(De=ds)||tt,Ja(d,l),ds=De):Ja(d,l),Pi(l),_&8192){if(De=l.memoizedState!==null,(l.stateNode.isHidden=De)&&!tt&&(l.mode&1)!==0)for(yt=l,tt=l.child;tt!==null;){for(rt=yt=tt;yt!==null;){switch(Ze=yt,xt=Ze.child,Ze.tag){case 0:case 11:case 14:case 15:bm(4,Ze,Ze.return);break;case 1:ld(Ze,Ze.return);var wt=Ze.stateNode;if(typeof wt.componentWillUnmount=="function"){_=Ze,p=Ze.return;try{d=_,wt.props=d.memoizedProps,wt.state=d.memoizedState,wt.componentWillUnmount()}catch(Ct){lr(_,p,Ct)}}break;case 5:ld(Ze,Ze.return);break;case 22:if(Ze.memoizedState!==null){mA(rt);continue}}xt!==null?(xt.return=Ze,yt=xt):mA(rt)}tt=tt.sibling}e:for(tt=null,rt=l;;){if(rt.tag===5){if(tt===null){tt=rt;try{A=rt.stateNode,De?(O=A.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(ue=rt.stateNode,he=rt.memoizedProps.style,K=he!=null&&he.hasOwnProperty("display")?he.display:null,ue.style.display=Wa("display",K))}catch(Ct){lr(l,l.return,Ct)}}}else if(rt.tag===6){if(tt===null)try{rt.stateNode.nodeValue=De?"":rt.memoizedProps}catch(Ct){lr(l,l.return,Ct)}}else if((rt.tag!==22&&rt.tag!==23||rt.memoizedState===null||rt===l)&&rt.child!==null){rt.child.return=rt,rt=rt.child;continue}if(rt===l)break e;for(;rt.sibling===null;){if(rt.return===null||rt.return===l)break e;tt===rt&&(tt=null),rt=rt.return}tt===rt&&(tt=null),rt.sibling.return=rt.return,rt=rt.sibling}}break;case 19:Ja(d,l),Pi(l),_&4&&lA(l);break;case 21:break;default:Ja(d,l),Pi(l)}}function Pi(l){var d=l.flags;if(d&2){try{e:{for(var p=l.return;p!==null;){if(aA(p)){var _=p;break e}p=p.return}throw Error(r(160))}switch(_.tag){case 5:var A=_.stateNode;_.flags&32&&(sn(A,""),_.flags&=-33);var O=iA(l);Ej(l,O,A);break;case 3:case 4:var K=_.stateNode.containerInfo,ue=iA(l);Aj(l,ue,K);break;default:throw Error(r(161))}}catch(he){lr(l,l.return,he)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function DU(l,d,p){yt=l,dA(l)}function dA(l,d,p){for(var _=(l.mode&1)!==0;yt!==null;){var A=yt,O=A.child;if(A.tag===22&&_){var K=A.memoizedState!==null||wp;if(!K){var ue=A.alternate,he=ue!==null&&ue.memoizedState!==null||ds;ue=wp;var De=ds;if(wp=K,(ds=he)&&!De)for(yt=A;yt!==null;)K=yt,he=K.child,K.tag===22&&K.memoizedState!==null?hA(A):he!==null?(he.return=K,yt=he):hA(A);for(;O!==null;)yt=O,dA(O),O=O.sibling;yt=A,wp=ue,ds=De}uA(l)}else(A.subtreeFlags&8772)!==0&&O!==null?(O.return=A,yt=O):uA(l)}}function uA(l){for(;yt!==null;){var d=yt;if((d.flags&8772)!==0){var p=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:ds||_p(5,d);break;case 1:var _=d.stateNode;if(d.flags&4&&!ds)if(p===null)_.componentDidMount();else{var A=d.elementType===d.type?p.memoizedProps:Xa(d.type,p.memoizedProps);_.componentDidUpdate(A,p.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var O=d.updateQueue;O!==null&&mP(d,O,_);break;case 3:var K=d.updateQueue;if(K!==null){if(p=null,d.child!==null)switch(d.child.tag){case 5:p=d.child.stateNode;break;case 1:p=d.child.stateNode}mP(d,K,p)}break;case 5:var ue=d.stateNode;if(p===null&&d.flags&4){p=ue;var he=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&p.focus();break;case"img":he.src&&(p.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var De=d.alternate;if(De!==null){var tt=De.memoizedState;if(tt!==null){var rt=tt.dehydrated;rt!==null&&Ju(rt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}ds||d.flags&512&&Pj(d)}catch(Ze){lr(d,d.return,Ze)}}if(d===l){yt=null;break}if(p=d.sibling,p!==null){p.return=d.return,yt=p;break}yt=d.return}}function mA(l){for(;yt!==null;){var d=yt;if(d===l){yt=null;break}var p=d.sibling;if(p!==null){p.return=d.return,yt=p;break}yt=d.return}}function hA(l){for(;yt!==null;){var d=yt;try{switch(d.tag){case 0:case 11:case 15:var p=d.return;try{_p(4,d)}catch(he){lr(d,p,he)}break;case 1:var _=d.stateNode;if(typeof _.componentDidMount=="function"){var A=d.return;try{_.componentDidMount()}catch(he){lr(d,A,he)}}var O=d.return;try{Pj(d)}catch(he){lr(d,O,he)}break;case 5:var K=d.return;try{Pj(d)}catch(he){lr(d,K,he)}}}catch(he){lr(d,d.return,he)}if(d===l){yt=null;break}var ue=d.sibling;if(ue!==null){ue.return=d.return,yt=ue;break}yt=d.return}}var $U=Math.ceil,Np=P.ReactCurrentDispatcher,Oj=P.ReactCurrentOwner,Aa=P.ReactCurrentBatchConfig,yn=0,qr=null,xr=null,Zr=0,la=0,cd=Uo(0),Er=0,wm=null,Wl=0,Sp=0,Tj=0,_m=null,Ks=null,Mj=0,dd=1/0,eo=null,Cp=!1,Rj=null,Qo=null,kp=!1,Xo=null,Pp=0,Nm=0,Dj=null,Ap=-1,Ep=0;function bs(){return(yn&6)!==0?nt():Ap!==-1?Ap:Ap=nt()}function Zo(l){return(l.mode&1)===0?1:(yn&2)!==0&&Zr!==0?Zr&-Zr:yU.transition!==null?(Ep===0&&(Ep=Wi()),Ep):(l=vn,l!==0||(l=window.event,l=l===void 0?16:p2(l.type)),l)}function ei(l,d,p,_){if(50<Nm)throw Nm=0,Dj=null,Error(r(185));mt(l,p,_),((yn&2)===0||l!==qr)&&(l===qr&&((yn&2)===0&&(Sp|=p),Er===4&&Jo(l,Zr)),Ws(l,_),p===1&&yn===0&&(d.mode&1)===0&&(dd=nt()+500,sp&&Wo()))}function Ws(l,d){var p=l.callbackNode;Pr(l,d);var _=Zn(l,l===qr?Zr:0);if(_===0)p!==null&&Tn(p),l.callbackNode=null,l.callbackPriority=0;else if(d=_&-_,l.callbackPriority!==d){if(p!=null&&Tn(p),d===1)l.tag===0?vU(pA.bind(null,l)):eP(pA.bind(null,l)),fU(function(){(yn&6)===0&&Wo()}),p=null;else{switch(Gu(_)){case 1:p=En;break;case 4:p=Xn;break;case 16:p=ir;break;case 536870912:p=Lr;break;default:p=ir}p=_A(p,fA.bind(null,l))}l.callbackPriority=d,l.callbackNode=p}}function fA(l,d){if(Ap=-1,Ep=0,(yn&6)!==0)throw Error(r(327));var p=l.callbackNode;if(ud()&&l.callbackNode!==p)return null;var _=Zn(l,l===qr?Zr:0);if(_===0)return null;if((_&30)!==0||(_&l.expiredLanes)!==0||d)d=Op(l,_);else{d=_;var A=yn;yn|=2;var O=gA();(qr!==l||Zr!==d)&&(eo=null,dd=nt()+500,Gl(l,d));do try{IU();break}catch(ue){xA(l,ue)}while(!0);Jy(),Np.current=O,yn=A,xr!==null?d=0:(qr=null,Zr=0,d=Er)}if(d!==0){if(d===2&&(A=Na(l),A!==0&&(_=A,d=$j(l,A))),d===1)throw p=wm,Gl(l,0),Jo(l,_),Ws(l,nt()),p;if(d===6)Jo(l,_);else{if(A=l.current.alternate,(_&30)===0&&!FU(A)&&(d=Op(l,_),d===2&&(O=Na(l),O!==0&&(_=O,d=$j(l,O))),d===1))throw p=wm,Gl(l,0),Jo(l,_),Ws(l,nt()),p;switch(l.finishedWork=A,l.finishedLanes=_,d){case 0:case 1:throw Error(r(345));case 2:Yl(l,Ks,eo);break;case 3:if(Jo(l,_),(_&130023424)===_&&(d=Mj+500-nt(),10<d)){if(Zn(l,0)!==0)break;if(A=l.suspendedLanes,(A&_)!==_){bs(),l.pingedLanes|=l.suspendedLanes&A;break}l.timeoutHandle=zy(Yl.bind(null,l,Ks,eo),d);break}Yl(l,Ks,eo);break;case 4:if(Jo(l,_),(_&4194240)===_)break;for(d=l.eventTimes,A=-1;0<_;){var K=31-or(_);O=1<<K,K=d[K],K>A&&(A=K),_&=~O}if(_=A,_=nt()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*$U(_/1960))-_,10<_){l.timeoutHandle=zy(Yl.bind(null,l,Ks,eo),_);break}Yl(l,Ks,eo);break;case 5:Yl(l,Ks,eo);break;default:throw Error(r(329))}}}return Ws(l,nt()),l.callbackNode===p?fA.bind(null,l):null}function $j(l,d){var p=_m;return l.current.memoizedState.isDehydrated&&(Gl(l,d).flags|=256),l=Op(l,d),l!==2&&(d=Ks,Ks=p,d!==null&&Fj(d)),l}function Fj(l){Ks===null?Ks=l:Ks.push.apply(Ks,l)}function FU(l){for(var d=l;;){if(d.flags&16384){var p=d.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var _=0;_<p.length;_++){var A=p[_],O=A.getSnapshot;A=A.value;try{if(!Ya(O(),A))return!1}catch{return!1}}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Jo(l,d){for(d&=~Tj,d&=~Sp,l.suspendedLanes|=d,l.pingedLanes&=~d,l=l.expirationTimes;0<d;){var p=31-or(d),_=1<<p;l[p]=-1,d&=~_}}function pA(l){if((yn&6)!==0)throw Error(r(327));ud();var d=Zn(l,0);if((d&1)===0)return Ws(l,nt()),null;var p=Op(l,d);if(l.tag!==0&&p===2){var _=Na(l);_!==0&&(d=_,p=$j(l,_))}if(p===1)throw p=wm,Gl(l,0),Jo(l,d),Ws(l,nt()),p;if(p===6)throw Error(r(345));return l.finishedWork=l.current.alternate,l.finishedLanes=d,Yl(l,Ks,eo),Ws(l,nt()),null}function Lj(l,d){var p=yn;yn|=1;try{return l(d)}finally{yn=p,yn===0&&(dd=nt()+500,sp&&Wo())}}function Hl(l){Xo!==null&&Xo.tag===0&&(yn&6)===0&&ud();var d=yn;yn|=1;var p=Aa.transition,_=vn;try{if(Aa.transition=null,vn=1,l)return l()}finally{vn=_,Aa.transition=p,yn=d,(yn&6)===0&&Wo()}}function Ij(){la=cd.current,Wn(cd)}function Gl(l,d){l.finishedWork=null,l.finishedLanes=0;var p=l.timeoutHandle;if(p!==-1&&(l.timeoutHandle=-1,hU(p)),xr!==null)for(p=xr.return;p!==null;){var _=p;switch(Gy(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&np();break;case 3:id(),Wn(zs),Wn(os),oj();break;case 5:aj(_);break;case 4:id();break;case 13:Wn(rr);break;case 19:Wn(rr);break;case 10:ej(_.type._context);break;case 22:case 23:Ij()}p=p.return}if(qr=l,xr=l=el(l.current,null),Zr=la=d,Er=0,wm=null,Tj=Sp=Wl=0,Ks=_m=null,Vl!==null){for(d=0;d<Vl.length;d++)if(p=Vl[d],_=p.interleaved,_!==null){p.interleaved=null;var A=_.next,O=p.pending;if(O!==null){var K=O.next;O.next=A,_.next=K}p.pending=_}Vl=null}return l}function xA(l,d){do{var p=xr;try{if(Jy(),fp.current=vp,pp){for(var _=sr.memoizedState;_!==null;){var A=_.queue;A!==null&&(A.pending=null),_=_.next}pp=!1}if(Kl=0,Ir=Ar=sr=null,xm=!1,gm=0,Oj.current=null,p===null||p.return===null){Er=1,wm=d,xr=null;break}e:{var O=l,K=p.return,ue=p,he=d;if(d=Zr,ue.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var De=he,tt=ue,rt=tt.tag;if((tt.mode&1)===0&&(rt===0||rt===11||rt===15)){var Ze=tt.alternate;Ze?(tt.updateQueue=Ze.updateQueue,tt.memoizedState=Ze.memoizedState,tt.lanes=Ze.lanes):(tt.updateQueue=null,tt.memoizedState=null)}var xt=BP(K);if(xt!==null){xt.flags&=-257,zP(xt,K,ue,O,d),xt.mode&1&&qP(O,De,d),d=xt,he=De;var wt=d.updateQueue;if(wt===null){var Ct=new Set;Ct.add(he),d.updateQueue=Ct}else wt.add(he);break e}else{if((d&1)===0){qP(O,De,d),qj();break e}he=Error(r(426))}}else if(Jn&&ue.mode&1){var ur=BP(K);if(ur!==null){(ur.flags&65536)===0&&(ur.flags|=256),zP(ur,K,ue,O,d),Xy(od(he,ue));break e}}O=he=od(he,ue),Er!==4&&(Er=2),_m===null?_m=[O]:_m.push(O),O=K;do{switch(O.tag){case 3:O.flags|=65536,d&=-d,O.lanes|=d;var ke=LP(O,he,d);uP(O,ke);break e;case 1:ue=he;var pe=O.type,Oe=O.stateNode;if((O.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||Oe!==null&&typeof Oe.componentDidCatch=="function"&&(Qo===null||!Qo.has(Oe)))){O.flags|=65536,d&=-d,O.lanes|=d;var at=IP(O,ue,d);uP(O,at);break e}}O=O.return}while(O!==null)}yA(p)}catch(Et){d=Et,xr===p&&p!==null&&(xr=p=p.return);continue}break}while(!0)}function gA(){var l=Np.current;return Np.current=vp,l===null?vp:l}function qj(){(Er===0||Er===3||Er===2)&&(Er=4),qr===null||(Wl&268435455)===0&&(Sp&268435455)===0||Jo(qr,Zr)}function Op(l,d){var p=yn;yn|=2;var _=gA();(qr!==l||Zr!==d)&&(eo=null,Gl(l,d));do try{LU();break}catch(A){xA(l,A)}while(!0);if(Jy(),yn=p,Np.current=_,xr!==null)throw Error(r(261));return qr=null,Zr=0,Er}function LU(){for(;xr!==null;)vA(xr)}function IU(){for(;xr!==null&&!St();)vA(xr)}function vA(l){var d=wA(l.alternate,l,la);l.memoizedProps=l.pendingProps,d===null?yA(l):xr=d,Oj.current=null}function yA(l){var d=l;do{var p=d.alternate;if(l=d.return,(d.flags&32768)===0){if(p=OU(p,d,la),p!==null){xr=p;return}}else{if(p=TU(p,d),p!==null){p.flags&=32767,xr=p;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Er=6,xr=null;return}}if(d=d.sibling,d!==null){xr=d;return}xr=d=l}while(d!==null);Er===0&&(Er=5)}function Yl(l,d,p){var _=vn,A=Aa.transition;try{Aa.transition=null,vn=1,qU(l,d,p,_)}finally{Aa.transition=A,vn=_}return null}function qU(l,d,p,_){do ud();while(Xo!==null);if((yn&6)!==0)throw Error(r(327));p=l.finishedWork;var A=l.finishedLanes;if(p===null)return null;if(l.finishedWork=null,l.finishedLanes=0,p===l.current)throw Error(r(177));l.callbackNode=null,l.callbackPriority=0;var O=p.lanes|p.childLanes;if(dr(l,O),l===qr&&(xr=qr=null,Zr=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||kp||(kp=!0,_A(ir,function(){return ud(),null})),O=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||O){O=Aa.transition,Aa.transition=null;var K=vn;vn=1;var ue=yn;yn|=4,Oj.current=null,RU(l,p),cA(p,l),iU(qy),zf=!!Iy,qy=Iy=null,l.current=p,DU(p),dn(),yn=ue,vn=K,Aa.transition=O}else l.current=p;if(kp&&(kp=!1,Xo=l,Pp=A),O=l.pendingLanes,O===0&&(Qo=null),In(p.stateNode),Ws(l,nt()),d!==null)for(_=l.onRecoverableError,p=0;p<d.length;p++)A=d[p],_(A.value,{componentStack:A.stack,digest:A.digest});if(Cp)throw Cp=!1,l=Rj,Rj=null,l;return(Pp&1)!==0&&l.tag!==0&&ud(),O=l.pendingLanes,(O&1)!==0?l===Dj?Nm++:(Nm=0,Dj=l):Nm=0,Wo(),null}function ud(){if(Xo!==null){var l=Gu(Pp),d=Aa.transition,p=vn;try{if(Aa.transition=null,vn=16>l?16:l,Xo===null)var _=!1;else{if(l=Xo,Xo=null,Pp=0,(yn&6)!==0)throw Error(r(331));var A=yn;for(yn|=4,yt=l.current;yt!==null;){var O=yt,K=O.child;if((yt.flags&16)!==0){var ue=O.deletions;if(ue!==null){for(var he=0;he<ue.length;he++){var De=ue[he];for(yt=De;yt!==null;){var tt=yt;switch(tt.tag){case 0:case 11:case 15:bm(8,tt,O)}var rt=tt.child;if(rt!==null)rt.return=tt,yt=rt;else for(;yt!==null;){tt=yt;var Ze=tt.sibling,xt=tt.return;if(sA(tt),tt===De){yt=null;break}if(Ze!==null){Ze.return=xt,yt=Ze;break}yt=xt}}}var wt=O.alternate;if(wt!==null){var Ct=wt.child;if(Ct!==null){wt.child=null;do{var ur=Ct.sibling;Ct.sibling=null,Ct=ur}while(Ct!==null)}}yt=O}}if((O.subtreeFlags&2064)!==0&&K!==null)K.return=O,yt=K;else e:for(;yt!==null;){if(O=yt,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:bm(9,O,O.return)}var ke=O.sibling;if(ke!==null){ke.return=O.return,yt=ke;break e}yt=O.return}}var pe=l.current;for(yt=pe;yt!==null;){K=yt;var Oe=K.child;if((K.subtreeFlags&2064)!==0&&Oe!==null)Oe.return=K,yt=Oe;else e:for(K=pe;yt!==null;){if(ue=yt,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:_p(9,ue)}}catch(Et){lr(ue,ue.return,Et)}if(ue===K){yt=null;break e}var at=ue.sibling;if(at!==null){at.return=ue.return,yt=at;break e}yt=ue.return}}if(yn=A,Wo(),Mn&&typeof Mn.onPostCommitFiberRoot=="function")try{Mn.onPostCommitFiberRoot(kr,l)}catch{}_=!0}return _}finally{vn=p,Aa.transition=d}}return!1}function jA(l,d,p){d=od(p,d),d=LP(l,d,1),l=Go(l,d,1),d=bs(),l!==null&&(mt(l,1,d),Ws(l,d))}function lr(l,d,p){if(l.tag===3)jA(l,l,p);else for(;d!==null;){if(d.tag===3){jA(d,l,p);break}else if(d.tag===1){var _=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Qo===null||!Qo.has(_))){l=od(p,l),l=IP(d,l,1),d=Go(d,l,1),l=bs(),d!==null&&(mt(d,1,l),Ws(d,l));break}}d=d.return}}function BU(l,d,p){var _=l.pingCache;_!==null&&_.delete(d),d=bs(),l.pingedLanes|=l.suspendedLanes&p,qr===l&&(Zr&p)===p&&(Er===4||Er===3&&(Zr&130023424)===Zr&&500>nt()-Mj?Gl(l,0):Tj|=p),Ws(l,d)}function bA(l,d){d===0&&((l.mode&1)===0?d=1:(d=Ht,Ht<<=1,(Ht&130023424)===0&&(Ht=4194304)));var p=bs();l=Xi(l,d),l!==null&&(mt(l,d,p),Ws(l,p))}function zU(l){var d=l.memoizedState,p=0;d!==null&&(p=d.retryLane),bA(l,p)}function VU(l,d){var p=0;switch(l.tag){case 13:var _=l.stateNode,A=l.memoizedState;A!==null&&(p=A.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(r(314))}_!==null&&_.delete(d),bA(l,p)}var wA;wA=function(l,d,p){if(l!==null)if(l.memoizedProps!==d.pendingProps||zs.current)Us=!0;else{if((l.lanes&p)===0&&(d.flags&128)===0)return Us=!1,EU(l,d,p);Us=(l.flags&131072)!==0}else Us=!1,Jn&&(d.flags&1048576)!==0&&tP(d,ip,d.index);switch(d.lanes=0,d.tag){case 2:var _=d.type;bp(l,d),l=d.pendingProps;var A=Jc(d,os.current);ad(d,p),A=dj(null,d,_,l,A,p);var O=uj();return d.flags|=1,typeof A=="object"&&A!==null&&typeof A.render=="function"&&A.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,Vs(_)?(O=!0,rp(d)):O=!1,d.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,rj(d),A.updater=yp,d.stateNode=A,A._reactInternals=d,gj(d,_,l,p),d=bj(null,d,_,!0,O,p)):(d.tag=0,Jn&&O&&Hy(d),js(null,d,A,p),d=d.child),d;case 16:_=d.elementType;e:{switch(bp(l,d),l=d.pendingProps,A=_._init,_=A(_._payload),d.type=_,A=d.tag=KU(_),l=Xa(_,l),A){case 0:d=jj(null,d,_,l,p);break e;case 1:d=GP(null,d,_,l,p);break e;case 11:d=VP(null,d,_,l,p);break e;case 14:d=UP(null,d,_,Xa(_.type,l),p);break e}throw Error(r(306,_,""))}return d;case 0:return _=d.type,A=d.pendingProps,A=d.elementType===_?A:Xa(_,A),jj(l,d,_,A,p);case 1:return _=d.type,A=d.pendingProps,A=d.elementType===_?A:Xa(_,A),GP(l,d,_,A,p);case 3:e:{if(YP(d),l===null)throw Error(r(387));_=d.pendingProps,O=d.memoizedState,A=O.element,dP(l,d),mp(d,_,null,p);var K=d.memoizedState;if(_=K.element,O.isDehydrated)if(O={element:_,isDehydrated:!1,cache:K.cache,pendingSuspenseBoundaries:K.pendingSuspenseBoundaries,transitions:K.transitions},d.updateQueue.baseState=O,d.memoizedState=O,d.flags&256){A=od(Error(r(423)),d),d=QP(l,d,_,p,A);break e}else if(_!==A){A=od(Error(r(424)),d),d=QP(l,d,_,p,A);break e}else for(oa=Vo(d.stateNode.containerInfo.firstChild),ia=d,Jn=!0,Qa=null,p=lP(d,null,_,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(nd(),_===A){d=Ji(l,d,p);break e}js(l,d,_,p)}d=d.child}return d;case 5:return hP(d),l===null&&Qy(d),_=d.type,A=d.pendingProps,O=l!==null?l.memoizedProps:null,K=A.children,By(_,A)?K=null:O!==null&&By(_,O)&&(d.flags|=32),HP(l,d),js(l,d,K,p),d.child;case 6:return l===null&&Qy(d),null;case 13:return XP(l,d,p);case 4:return sj(d,d.stateNode.containerInfo),_=d.pendingProps,l===null?d.child=rd(d,null,_,p):js(l,d,_,p),d.child;case 11:return _=d.type,A=d.pendingProps,A=d.elementType===_?A:Xa(_,A),VP(l,d,_,A,p);case 7:return js(l,d,d.pendingProps,p),d.child;case 8:return js(l,d,d.pendingProps.children,p),d.child;case 12:return js(l,d,d.pendingProps.children,p),d.child;case 10:e:{if(_=d.type._context,A=d.pendingProps,O=d.memoizedProps,K=A.value,qn(cp,_._currentValue),_._currentValue=K,O!==null)if(Ya(O.value,K)){if(O.children===A.children&&!zs.current){d=Ji(l,d,p);break e}}else for(O=d.child,O!==null&&(O.return=d);O!==null;){var ue=O.dependencies;if(ue!==null){K=O.child;for(var he=ue.firstContext;he!==null;){if(he.context===_){if(O.tag===1){he=Zi(-1,p&-p),he.tag=2;var De=O.updateQueue;if(De!==null){De=De.shared;var tt=De.pending;tt===null?he.next=he:(he.next=tt.next,tt.next=he),De.pending=he}}O.lanes|=p,he=O.alternate,he!==null&&(he.lanes|=p),tj(O.return,p,d),ue.lanes|=p;break}he=he.next}}else if(O.tag===10)K=O.type===d.type?null:O.child;else if(O.tag===18){if(K=O.return,K===null)throw Error(r(341));K.lanes|=p,ue=K.alternate,ue!==null&&(ue.lanes|=p),tj(K,p,d),K=O.sibling}else K=O.child;if(K!==null)K.return=O;else for(K=O;K!==null;){if(K===d){K=null;break}if(O=K.sibling,O!==null){O.return=K.return,K=O;break}K=K.return}O=K}js(l,d,A.children,p),d=d.child}return d;case 9:return A=d.type,_=d.pendingProps.children,ad(d,p),A=ka(A),_=_(A),d.flags|=1,js(l,d,_,p),d.child;case 14:return _=d.type,A=Xa(_,d.pendingProps),A=Xa(_.type,A),UP(l,d,_,A,p);case 15:return KP(l,d,d.type,d.pendingProps,p);case 17:return _=d.type,A=d.pendingProps,A=d.elementType===_?A:Xa(_,A),bp(l,d),d.tag=1,Vs(_)?(l=!0,rp(d)):l=!1,ad(d,p),$P(d,_,A),gj(d,_,A,p),bj(null,d,_,!0,l,p);case 19:return JP(l,d,p);case 22:return WP(l,d,p)}throw Error(r(156,d.tag))};function _A(l,d){return $t(l,d)}function UU(l,d,p,_){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ea(l,d,p,_){return new UU(l,d,p,_)}function Bj(l){return l=l.prototype,!(!l||!l.isReactComponent)}function KU(l){if(typeof l=="function")return Bj(l)?1:0;if(l!=null){if(l=l.$$typeof,l===L)return 11;if(l===D)return 14}return 2}function el(l,d){var p=l.alternate;return p===null?(p=Ea(l.tag,d,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=d,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&14680064,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,d=l.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p}function Tp(l,d,p,_,A,O){var K=2;if(_=l,typeof l=="function")Bj(l)&&(K=1);else if(typeof l=="string")K=5;else e:switch(l){case E:return Ql(p.children,A,O,d);case R:K=8,A|=8;break;case T:return l=Ea(12,p,d,A|2),l.elementType=T,l.lanes=O,l;case q:return l=Ea(13,p,d,A),l.elementType=q,l.lanes=O,l;case $:return l=Ea(19,p,d,A),l.elementType=$,l.lanes=O,l;case J:return Mp(p,A,O,d);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case U:K=10;break e;case M:K=9;break e;case L:K=11;break e;case D:K=14;break e;case z:K=16,_=null;break e}throw Error(r(130,l==null?l:typeof l,""))}return d=Ea(K,p,d,A),d.elementType=l,d.type=_,d.lanes=O,d}function Ql(l,d,p,_){return l=Ea(7,l,_,d),l.lanes=p,l}function Mp(l,d,p,_){return l=Ea(22,l,_,d),l.elementType=J,l.lanes=p,l.stateNode={isHidden:!1},l}function zj(l,d,p){return l=Ea(6,l,null,d),l.lanes=p,l}function Vj(l,d,p){return d=Ea(4,l.children!==null?l.children:[],l.key,d),d.lanes=p,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}function WU(l,d,p,_,A){this.tag=d,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tt(0),this.expirationTimes=Tt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tt(0),this.identifierPrefix=_,this.onRecoverableError=A,this.mutableSourceEagerHydrationData=null}function Uj(l,d,p,_,A,O,K,ue,he){return l=new WU(l,d,p,ue,he),d===1?(d=1,O===!0&&(d|=8)):d=0,O=Ea(3,null,null,d),l.current=O,O.stateNode=l,O.memoizedState={element:_,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},rj(O),l}function HU(l,d,p){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:S,key:_==null?null:""+_,children:l,containerInfo:d,implementation:p}}function NA(l){if(!l)return Ko;l=l._reactInternals;e:{if(Yr(l)!==l||l.tag!==1)throw Error(r(170));var d=l;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(Vs(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(r(171))}if(l.tag===1){var p=l.type;if(Vs(p))return Z2(l,p,d)}return d}function SA(l,d,p,_,A,O,K,ue,he){return l=Uj(p,_,!0,l,A,O,K,ue,he),l.context=NA(null),p=l.current,_=bs(),A=Zo(p),O=Zi(_,A),O.callback=d??null,Go(p,O,A),l.current.lanes=A,mt(l,A,_),Ws(l,_),l}function Rp(l,d,p,_){var A=d.current,O=bs(),K=Zo(A);return p=NA(p),d.context===null?d.context=p:d.pendingContext=p,d=Zi(O,K),d.payload={element:l},_=_===void 0?null:_,_!==null&&(d.callback=_),l=Go(A,d,K),l!==null&&(ei(l,A,K,O),up(l,A,K)),K}function Dp(l){return l=l.current,l.child?(l.child.tag===5,l.child.stateNode):null}function CA(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<d?p:d}}function Kj(l,d){CA(l,d),(l=l.alternate)&&CA(l,d)}function GU(){return null}var kA=typeof reportError=="function"?reportError:function(l){console.error(l)};function Wj(l){this._internalRoot=l}$p.prototype.render=Wj.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(r(409));Rp(l,d,null,null)},$p.prototype.unmount=Wj.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;Hl(function(){Rp(null,l,null,null)}),d[Hi]=null}};function $p(l){this._internalRoot=l}$p.prototype.unstable_scheduleHydration=function(l){if(l){var d=d2();l={blockedOn:null,target:l,priority:d};for(var p=0;p<qo.length&&d!==0&&d<qo[p].priority;p++);qo.splice(p,0,l),p===0&&h2(l)}};function Hj(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Fp(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function PA(){}function YU(l,d,p,_,A){if(A){if(typeof _=="function"){var O=_;_=function(){var De=Dp(K);O.call(De)}}var K=SA(d,_,l,0,null,!1,!1,"",PA);return l._reactRootContainer=K,l[Hi]=K.current,lm(l.nodeType===8?l.parentNode:l),Hl(),K}for(;A=l.lastChild;)l.removeChild(A);if(typeof _=="function"){var ue=_;_=function(){var De=Dp(he);ue.call(De)}}var he=Uj(l,0,!1,null,null,!1,!1,"",PA);return l._reactRootContainer=he,l[Hi]=he.current,lm(l.nodeType===8?l.parentNode:l),Hl(function(){Rp(d,he,p,_)}),he}function Lp(l,d,p,_,A){var O=p._reactRootContainer;if(O){var K=O;if(typeof A=="function"){var ue=A;A=function(){var he=Dp(K);ue.call(he)}}Rp(d,K,l,A)}else K=YU(p,d,l,A,_);return Dp(K)}l2=function(l){switch(l.tag){case 3:var d=l.stateNode;if(d.current.memoizedState.isDehydrated){var p=on(d.pendingLanes);p!==0&&(pr(d,p|1),Ws(d,nt()),(yn&6)===0&&(dd=nt()+500,Wo()))}break;case 13:Hl(function(){var _=Xi(l,1);if(_!==null){var A=bs();ei(_,l,1,A)}}),Kj(l,1)}},vy=function(l){if(l.tag===13){var d=Xi(l,134217728);if(d!==null){var p=bs();ei(d,l,134217728,p)}Kj(l,134217728)}},c2=function(l){if(l.tag===13){var d=Zo(l),p=Xi(l,d);if(p!==null){var _=bs();ei(p,l,d,_)}Kj(l,d)}},d2=function(){return vn},u2=function(l,d){var p=vn;try{return vn=l,d()}finally{vn=p}},Is=function(l,d,p){switch(d){case"input":if(pt(l,p),d=p.name,p.type==="radio"&&d!=null){for(p=l;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<p.length;d++){var _=p[d];if(_!==l&&_.form===l.form){var A=tp(_);if(!A)throw Error(r(90));Te(_),pt(_,A)}}}break;case"textarea":Ae(l,p);break;case"select":d=p.value,d!=null&&Ue(l,!!p.multiple,d,!1)}},na=Lj,nr=Hl;var QU={usingClientEntryPoint:!1,Events:[um,Xc,tp,Mo,Vc,Lj]},Sm={findFiberByHostInstance:Il,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},XU={bundleType:Sm.bundleType,version:Sm.version,rendererPackageName:Sm.rendererPackageName,rendererConfig:Sm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=ce(l),l===null?null:l.stateNode},findFiberByHostInstance:Sm.findFiberByHostInstance||GU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ip=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ip.isDisabled&&Ip.supportsFiber)try{kr=Ip.inject(XU),Mn=Ip}catch{}}return Hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QU,Hs.createPortal=function(l,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hj(d))throw Error(r(200));return HU(l,d,null,p)},Hs.createRoot=function(l,d){if(!Hj(l))throw Error(r(299));var p=!1,_="",A=kA;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),d=Uj(l,1,!1,null,null,p,!1,_,A),l[Hi]=d.current,lm(l.nodeType===8?l.parentNode:l),new Wj(d)},Hs.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=ce(d),l=l===null?null:l.stateNode,l},Hs.flushSync=function(l){return Hl(l)},Hs.hydrate=function(l,d,p){if(!Fp(d))throw Error(r(200));return Lp(null,l,d,!0,p)},Hs.hydrateRoot=function(l,d,p){if(!Hj(l))throw Error(r(405));var _=p!=null&&p.hydratedSources||null,A=!1,O="",K=kA;if(p!=null&&(p.unstable_strictMode===!0&&(A=!0),p.identifierPrefix!==void 0&&(O=p.identifierPrefix),p.onRecoverableError!==void 0&&(K=p.onRecoverableError)),d=SA(d,null,l,1,p??null,A,!1,O,K),l[Hi]=d.current,lm(l),_)for(l=0;l<_.length;l++)p=_[l],A=p._getVersion,A=A(p._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[p,A]:d.mutableSourceEagerHydrationData.push(p,A);return new $p(d)},Hs.render=function(l,d,p){if(!Fp(d))throw Error(r(200));return Lp(null,l,d,!1,p)},Hs.unmountComponentAtNode=function(l){if(!Fp(l))throw Error(r(40));return l._reactRootContainer?(Hl(function(){Lp(null,null,l,!1,function(){l._reactRootContainer=null,l[Hi]=null})}),!0):!1},Hs.unstable_batchedUpdates=Lj,Hs.unstable_renderSubtreeIntoContainer=function(l,d,p,_){if(!Fp(p))throw Error(r(200));if(l==null||l._reactInternals===void 0)throw Error(r(38));return Lp(l,d,p,!1,_)},Hs.version="18.3.1-next-f1338f8080-20240426",Hs}var $A;function NF(){if($A)return Qj.exports;$A=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),Qj.exports=a9(),Qj.exports}var FA;function i9(){if(FA)return Bp;FA=1;var t=NF();return Bp.createRoot=t.createRoot,Bp.hydrateRoot=t.hydrateRoot,Bp}var o9=i9();function l9(t,n){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,a,i,o=[],c="",u=t.split("/");for(u[0]||u.shift();a=u.shift();)r=a[0],r==="*"?(o.push(r),c+=a[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=a.indexOf("?",1),i=a.indexOf(".",1),o.push(a.substring(1,~s?s:~i?i:a.length)),c+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(c+=(~s?"?":"")+"\\"+a.substring(i))):c+="/"+a;return{keys:o,pattern:new RegExp("^"+c+(n?"(?=$|/)":"/?$"),"i")}}var v=Wg();const le=kn(v),SF=JU({__proto__:null,default:le},[v]);var Jj={exports:{}},eb={};var LA;function c9(){if(LA)return eb;LA=1;var t=Wg();function n(f,x){return f===x&&(f!==0||1/f===1/x)||f!==f&&x!==x}var r=typeof Object.is=="function"?Object.is:n,s=t.useState,a=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function c(f,x){var j=x(),b=s({inst:{value:j,getSnapshot:x}}),g=b[0].inst,y=b[1];return i(function(){g.value=j,g.getSnapshot=x,u(g)&&y({inst:g})},[f,j,x]),a(function(){return u(g)&&y({inst:g}),f(function(){u(g)&&y({inst:g})})},[f]),o(j),j}function u(f){var x=f.getSnapshot;f=f.value;try{var j=x();return!r(f,j)}catch{return!0}}function m(f,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m:c;return eb.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,eb}var IA;function d9(){return IA||(IA=1,Jj.exports=c9()),Jj.exports}var u9=d9();const m9=SF.useInsertionEffect,h9=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",f9=h9?v.useLayoutEffect:v.useEffect,p9=m9||f9,CF=t=>{const n=v.useRef([t,(...r)=>n[0](...r)]).current;return p9(()=>{n[0]=t}),n[1]},x9="popstate",US="pushState",KS="replaceState",g9="hashchange",qA=[x9,US,KS,g9],v9=t=>{for(const n of qA)addEventListener(n,t);return()=>{for(const n of qA)removeEventListener(n,t)}},kF=(t,n)=>u9.useSyncExternalStore(v9,t,n),y9=()=>location.search,j9=({ssrSearch:t=""}={})=>kF(y9,()=>t),BA=()=>location.pathname,b9=({ssrPath:t}={})=>kF(BA,t?()=>t:BA),w9=(t,{replace:n=!1,state:r=null}={})=>history[n?KS:US](r,"",t),_9=(t={})=>[b9(t),w9],zA=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[zA]>"u"){for(const t of[US,KS]){const n=history[t];history[t]=function(){const r=n.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,zA,{value:!0})}const N9=(t,n)=>n.toLowerCase().indexOf(t.toLowerCase())?"~"+n:n.slice(t.length)||"/",PF=(t="")=>t==="/"?"":t,S9=(t,n)=>t[0]==="~"?t.slice(1):PF(n)+t,C9=(t="",n)=>N9(TN(PF(t)),TN(n)),k9=t=>t[0]==="?"?t.slice(1):t,TN=t=>{try{return decodeURI(t)}catch{return t}},P9=t=>TN(k9(t)),AF={hook:_9,searchHook:j9,parser:l9,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:t=>t},EF=v.createContext(AF),Au=()=>v.useContext(EF),OF={},TF=v.createContext(OF),A9=()=>v.useContext(TF),Hg=t=>{const[n,r]=t.hook(t);return[C9(t.base,n),CF((s,a)=>r(S9(s,t.base),a))]},WS=()=>Hg(Au()),E9=()=>{const t=Au();return P9(t.searchHook(t))},MF=(t,n,r,s)=>{const{pattern:a,keys:i}=n instanceof RegExp?{keys:!1,pattern:n}:t(n||"*",s),o=a.exec(r)||[],[c,...u]=o;return c!==void 0?[!0,(()=>{const m=i!==!1?Object.fromEntries(i.map((f,x)=>[f,u[x]])):o.groups;let h={...u};return m&&Object.assign(h,m),h})(),...s?[c]:[]]:[!1,null]},O9=({children:t,...n})=>{const r=Au(),s=n.hook?AF:r;let a=s;const[i,o]=n.ssrPath?.split("?")??[];o&&(n.ssrSearch=o,n.ssrPath=i),n.hrefs=n.hrefs??n.hook?.hrefs;let c=v.useRef({}),u=c.current,m=u;for(let h in s){const f=h==="base"?s[h]+(n[h]||""):n[h]||s[h];u===m&&f!==m[h]&&(c.current=m={...m}),m[h]=f,f!==s[h]&&(a=m)}return v.createElement(EF.Provider,{value:a,children:t})},VA=({children:t,component:n},r)=>n?v.createElement(n,{params:r}):typeof t=="function"?t(r):t,T9=t=>{let n=v.useRef(OF),r=n.current;for(const s in t)t[s]!==r[s]&&(r=t);return Object.keys(t).length===0&&(r=t),n.current=r},Gs=({path:t,nest:n,match:r,...s})=>{const a=Au(),[i]=Hg(a),[o,c,u]=r??MF(a.parser,t,i,n),m=T9({...A9(),...c});if(!o)return null;const h=u?v.createElement(O9,{base:u},VA(s,m)):VA(s,m);return v.createElement(TF.Provider,{value:m,children:h})},Xs=v.forwardRef((t,n)=>{const r=Au(),[s,a]=Hg(r),{to:i="",href:o=i,onClick:c,asChild:u,children:m,className:h,replace:f,state:x,...j}=t,b=CF(y=>{y.ctrlKey||y.metaKey||y.altKey||y.shiftKey||y.button!==0||(c?.(y),y.defaultPrevented||(y.preventDefault(),a(o,t)))}),g=r.hrefs(o[0]==="~"?o.slice(1):r.base+o,r);return u&&v.isValidElement(m)?v.cloneElement(m,{onClick:b,href:g}):v.createElement("a",{...j,onClick:b,href:g,className:h?.call?h(s===o):h,children:m,ref:n})}),RF=t=>Array.isArray(t)?t.flatMap(n=>RF(n&&n.type===v.Fragment?n.props.children:n)):[t],UA=({children:t,location:n})=>{const r=Au(),[s]=Hg(r);for(const a of RF(t)){let i=0;if(v.isValidElement(a)&&(i=MF(r.parser,a.props.path,n||s,a.props.nest))[0])return v.cloneElement(a,{match:i})}return null};var Eu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},yc=typeof window>"u"||"Deno"in globalThis;function Ra(){}function M9(t,n){return typeof t=="function"?t(n):t}function MN(t){return typeof t=="number"&&t>=0&&t!==1/0}function DF(t,n){return Math.max(t+(n||0)-Date.now(),0)}function Md(t,n){return typeof t=="function"?t(n):t}function ai(t,n){return typeof t=="function"?t(n):t}function KA(t,n){const{type:r="all",exact:s,fetchStatus:a,predicate:i,queryKey:o,stale:c}=t;if(o){if(s){if(n.queryHash!==HS(o,n.options))return!1}else if(!dh(n.queryKey,o))return!1}if(r!=="all"){const u=n.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof c=="boolean"&&n.isStale()!==c||a&&a!==n.state.fetchStatus||i&&!i(n))}function WA(t,n){const{exact:r,status:s,predicate:a,mutationKey:i}=t;if(i){if(!n.options.mutationKey)return!1;if(r){if(jc(n.options.mutationKey)!==jc(i))return!1}else if(!dh(n.options.mutationKey,i))return!1}return!(s&&n.state.status!==s||a&&!a(n))}function HS(t,n){return(n?.queryKeyHashFn||jc)(t)}function jc(t){return JSON.stringify(t,(n,r)=>RN(r)?Object.keys(r).sort().reduce((s,a)=>(s[a]=r[a],s),{}):r)}function dh(t,n){return t===n?!0:typeof t!=typeof n?!1:t&&n&&typeof t=="object"&&typeof n=="object"?!Object.keys(n).some(r=>!dh(t[r],n[r])):!1}function $F(t,n){if(t===n)return t;const r=HA(t)&&HA(n);if(r||RN(t)&&RN(n)){const s=r?t:Object.keys(t),a=s.length,i=r?n:Object.keys(n),o=i.length,c=r?[]:{};let u=0;for(let m=0;m<o;m++){const h=r?m:i[m];(!r&&s.includes(h)||r)&&t[h]===void 0&&n[h]===void 0?(c[h]=void 0,u++):(c[h]=$F(t[h],n[h]),c[h]===t[h]&&t[h]!==void 0&&u++)}return a===o&&u===a?t:c}return n}function wx(t,n){if(!n||Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}function HA(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function RN(t){if(!GA(t))return!1;const n=t.constructor;if(n===void 0)return!0;const r=n.prototype;return!(!GA(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function GA(t){return Object.prototype.toString.call(t)==="[object Object]"}function R9(t){return new Promise(n=>{setTimeout(n,t)})}function DN(t,n,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,n):r.structuralSharing!==!1?$F(t,n):n}function D9(t,n,r=0){const s=[...t,n];return r&&s.length>r?s.slice(1):s}function $9(t,n,r=0){const s=[n,...t];return r&&s.length>r?s.slice(0,-1):s}var GS=Symbol();function FF(t,n){return!t.queryFn&&n?.initialPromise?()=>n.initialPromise:!t.queryFn||t.queryFn===GS?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var F9=class extends Eu{#e;#t;#r;constructor(){super(),this.#r=t=>{if(!yc&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},YS=new F9,L9=class extends Eu{#e=!0;#t;#r;constructor(){super(),this.#r=t=>{if(!yc&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},_x=new L9;function $N(){let t,n;const r=new Promise((a,i)=>{t=a,n=i});r.status="pending",r.catch(()=>{});function s(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{s({status:"fulfilled",value:a}),t(a)},r.reject=a=>{s({status:"rejected",reason:a}),n(a)},r}function I9(t){return Math.min(1e3*2**t,3e4)}function LF(t){return(t??"online")==="online"?_x.isOnline():!0}var IF=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function tb(t){return t instanceof IF}function qF(t){let n=!1,r=0,s=!1,a;const i=$N(),o=g=>{s||(x(new IF(g)),t.abort?.())},c=()=>{n=!0},u=()=>{n=!1},m=()=>YS.isFocused()&&(t.networkMode==="always"||_x.isOnline())&&t.canRun(),h=()=>LF(t.networkMode)&&t.canRun(),f=g=>{s||(s=!0,t.onSuccess?.(g),a?.(),i.resolve(g))},x=g=>{s||(s=!0,t.onError?.(g),a?.(),i.reject(g))},j=()=>new Promise(g=>{a=y=>{(s||m())&&g(y)},t.onPause?.()}).then(()=>{a=void 0,s||t.onContinue?.()}),b=()=>{if(s)return;let g;const y=r===0?t.initialPromise:void 0;try{g=y??t.fn()}catch(C){g=Promise.reject(C)}Promise.resolve(g).then(f).catch(C=>{if(s)return;const k=t.retry??(yc?0:3),N=t.retryDelay??I9,P=typeof N=="function"?N(r,C):N,w=k===!0||typeof k=="number"&&r<k||typeof k=="function"&&k(r,C);if(n||!w){x(C);return}r++,t.onFail?.(r,C),R9(P).then(()=>m()?void 0:j()).then(()=>{n?x(C):b()})})};return{promise:i,cancel:o,continue:()=>(a?.(),i),cancelRetry:c,continueRetry:u,canStart:h,start:()=>(h()?b():j().then(b),i)}}function q9(){let t=[],n=0,r=c=>{c()},s=c=>{c()},a=c=>setTimeout(c,0);const i=c=>{n?t.push(c):a(()=>{r(c)})},o=()=>{const c=t;t=[],c.length&&a(()=>{s(()=>{c.forEach(u=>{r(u)})})})};return{batch:c=>{let u;n++;try{u=c()}finally{n--,n||o()}return u},batchCalls:c=>(...u)=>{i(()=>{c(...u)})},schedule:i,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{s=c},setScheduler:c=>{a=c}}}var Rr=q9(),BF=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),MN(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(yc?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},B9=class extends BF{#e;#t;#r;#n;#i;#a;constructor(t){super(),this.#a=!1,this.#i=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#r=t.cache,this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=z9(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(t){this.options={...this.#i,...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(t,n){const r=DN(this.state.data,t,this.options);return this.#s({data:r,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),r}setState(t,n){this.#s({type:"setState",state:t,setStateOptions:n})}cancel(t){const n=this.#n?.promise;return this.#n?.cancel(t),n?n.then(Ra).catch(Ra):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>ai(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===GS||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!DF(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(this.#n&&(this.#a?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}fetch(t,n){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(t&&this.setOptions(t),!this.options.queryFn){const c=this.observers.find(u=>u.options.queryFn);c&&this.setOptions(c.options)}const r=new AbortController,s=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(this.#a=!0,r.signal)})},a=()=>{const c=FF(this.options,n),u={queryKey:this.queryKey,meta:this.meta};return s(u),this.#a=!1,this.options.persister?this.options.persister(c,u,this):c(u)},i={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:a};s(i),this.options.behavior?.onFetch(i,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==i.fetchOptions?.meta)&&this.#s({type:"fetch",meta:i.fetchOptions?.meta});const o=c=>{tb(c)&&c.silent||this.#s({type:"error",error:c}),tb(c)||(this.#r.config.onError?.(c,this),this.#r.config.onSettled?.(this.state.data,c,this)),this.scheduleGc()};return this.#n=qF({initialPromise:n?.initialPromise,fn:i.fetchFn,abort:r.abort.bind(r),onSuccess:c=>{if(c===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(c)}catch(u){o(u);return}this.#r.config.onSuccess?.(c,this),this.#r.config.onSettled?.(c,this.state.error,this),this.scheduleGc()},onError:o,onFail:(c,u)=>{this.#s({type:"failed",failureCount:c,error:u})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0}),this.#n.start()}#s(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...zF(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return tb(s)&&s.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Rr.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:t})})}};function zF(t,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:LF(n.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function z9(t){const n=typeof t.initialData=="function"?t.initialData():t.initialData,r=n!==void 0,s=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var V9=class extends Eu{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,n,r){const s=n.queryKey,a=n.queryHash??HS(s,n);let i=this.get(a);return i||(i=new B9({cache:this,queryKey:s,queryHash:a,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(i)),i}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=this.#e.get(t.queryHash);n&&(t.destroy(),n===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Rr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>KA(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>KA(t,r)):n}notify(t){Rr.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Rr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Rr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},U9=class extends BF{#e;#t;#r;constructor(t){super(),this.mutationId=t.mutationId,this.#t=t.mutationCache,this.#e=[],this.state=t.state||VF(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#e.includes(t)||(this.#e.push(t),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#e=this.#e.filter(n=>n!==t),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(t){this.#r=qF({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(s,a)=>{this.#n({type:"failed",failureCount:s,error:a})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const n=this.state.status==="pending",r=!this.#r.canStart();try{if(!n){this.#n({type:"pending",variables:t,isPaused:r}),await this.#t.config.onMutate?.(t,this);const a=await this.options.onMutate?.(t);a!==this.state.context&&this.#n({type:"pending",context:a,variables:t,isPaused:r})}const s=await this.#r.start();return await this.#t.config.onSuccess?.(s,t,this.state.context,this),await this.options.onSuccess?.(s,t,this.state.context),await this.#t.config.onSettled?.(s,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(s,null,t,this.state.context),this.#n({type:"success",data:s}),s}catch(s){try{throw await this.#t.config.onError?.(s,t,this.state.context,this),await this.options.onError?.(s,t,this.state.context),await this.#t.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,s,t,this.state.context),s}finally{this.#n({type:"error",error:s})}}finally{this.#t.runNext(this)}}#n(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Rr.batch(()=>{this.#e.forEach(r=>{r.onMutationUpdate(t)}),this.#t.notify({mutation:this,type:"updated",action:t})})}};function VF(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var K9=class extends Eu{constructor(t={}){super(),this.config=t,this.#e=new Map,this.#t=Date.now()}#e;#t;build(t,n,r){const s=new U9({mutationCache:this,mutationId:++this.#t,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){const n=zp(t),r=this.#e.get(n)??[];r.push(t),this.#e.set(n,r),this.notify({type:"added",mutation:t})}remove(t){const n=zp(t);if(this.#e.has(n)){const r=this.#e.get(n)?.filter(s=>s!==t);r&&(r.length===0?this.#e.delete(n):this.#e.set(n,r))}this.notify({type:"removed",mutation:t})}canRun(t){const n=this.#e.get(zp(t))?.find(r=>r.state.status==="pending");return!n||n===t}runNext(t){return this.#e.get(zp(t))?.find(r=>r!==t&&r.state.isPaused)?.continue()??Promise.resolve()}clear(){Rr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...this.#e.values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(r=>WA(n,r))}findAll(t={}){return this.getAll().filter(n=>WA(t,n))}notify(t){Rr.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Rr.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ra))))}};function zp(t){return t.options.scope?.id??String(t.mutationId)}function YA(t){return{onFetch:(n,r)=>{const s=n.options,a=n.fetchOptions?.meta?.fetchMore?.direction,i=n.state.data?.pages||[],o=n.state.data?.pageParams||[];let c={pages:[],pageParams:[]},u=0;const m=async()=>{let h=!1;const f=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(n.signal.aborted?h=!0:n.signal.addEventListener("abort",()=>{h=!0}),n.signal)})},x=FF(n.options,n.fetchOptions),j=async(b,g,y)=>{if(h)return Promise.reject();if(g==null&&b.pages.length)return Promise.resolve(b);const C={queryKey:n.queryKey,pageParam:g,direction:y?"backward":"forward",meta:n.options.meta};f(C);const k=await x(C),{maxPages:N}=n.options,P=y?$9:D9;return{pages:P(b.pages,k,N),pageParams:P(b.pageParams,g,N)}};if(a&&i.length){const b=a==="backward",g=b?W9:QA,y={pages:i,pageParams:o},C=g(s,y);c=await j(y,C,b)}else{const b=t??i.length;do{const g=u===0?o[0]??s.initialPageParam:QA(s,c);if(u>0&&g==null)break;c=await j(c,g),u++}while(u<b)}return c};n.options.persister?n.fetchFn=()=>n.options.persister?.(m,{queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},r):n.fetchFn=m}}}function QA(t,{pages:n,pageParams:r}){const s=n.length-1;return n.length>0?t.getNextPageParam(n[s],n,r[s],r):void 0}function W9(t,{pages:n,pageParams:r}){return n.length>0?t.getPreviousPageParam?.(n[0],n,r[0],r):void 0}var H9=class{#e;#t;#r;#n;#i;#a;#s;#o;constructor(t={}){this.#e=t.queryCache||new V9,this.#t=t.mutationCache||new K9,this.#r=t.defaultOptions||{},this.#n=new Map,this.#i=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#s=YS.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#o=_x.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#s?.(),this.#s=void 0,this.#o?.(),this.#o=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const n=this.defaultQueryOptions({queryKey:t});return this.#e.get(n.queryHash)?.state.data}ensureQueryData(t){const n=this.getQueryData(t.queryKey);if(n===void 0)return this.fetchQuery(t);{const r=this.defaultQueryOptions(t),s=this.#e.build(this,r);return t.revalidateIfStale&&s.isStaleByTime(Md(r.staleTime,s))&&this.prefetchQuery(r),Promise.resolve(n)}}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:n,state:r})=>{const s=r.data;return[n,s]})}setQueryData(t,n,r){const s=this.defaultQueryOptions({queryKey:t}),i=this.#e.get(s.queryHash)?.state.data,o=M9(n,i);if(o!==void 0)return this.#e.build(this,s).setData(o,{...r,manual:!0})}setQueriesData(t,n,r){return Rr.batch(()=>this.#e.findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,n,r)]))}getQueryState(t){const n=this.defaultQueryOptions({queryKey:t});return this.#e.get(n.queryHash)?.state}removeQueries(t){const n=this.#e;Rr.batch(()=>{n.findAll(t).forEach(r=>{n.remove(r)})})}resetQueries(t,n){const r=this.#e,s={type:"active",...t};return Rr.batch(()=>(r.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(s,n)))}cancelQueries(t={},n={}){const r={revert:!0,...n},s=Rr.batch(()=>this.#e.findAll(t).map(a=>a.cancel(r)));return Promise.all(s).then(Ra).catch(Ra)}invalidateQueries(t={},n={}){return Rr.batch(()=>{if(this.#e.findAll(t).forEach(s=>{s.invalidate()}),t.refetchType==="none")return Promise.resolve();const r={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(r,n)})}refetchQueries(t={},n){const r={...n,cancelRefetch:n?.cancelRefetch??!0},s=Rr.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(Ra)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Ra)}fetchQuery(t){const n=this.defaultQueryOptions(t);n.retry===void 0&&(n.retry=!1);const r=this.#e.build(this,n);return r.isStaleByTime(Md(n.staleTime,r))?r.fetch(n):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ra).catch(Ra)}fetchInfiniteQuery(t){return t.behavior=YA(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ra).catch(Ra)}ensureInfiniteQueryData(t){return t.behavior=YA(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return _x.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(t){this.#r=t}setQueryDefaults(t,n){this.#n.set(jc(t),{queryKey:t,defaultOptions:n})}getQueryDefaults(t){const n=[...this.#n.values()];let r={};return n.forEach(s=>{dh(t,s.queryKey)&&(r={...r,...s.defaultOptions})}),r}setMutationDefaults(t,n){this.#i.set(jc(t),{mutationKey:t,defaultOptions:n})}getMutationDefaults(t){const n=[...this.#i.values()];let r={};return n.forEach(s=>{dh(t,s.mutationKey)&&(r={...r,...s.defaultOptions})}),r}defaultQueryOptions(t){if(t._defaulted)return t;const n={...this.#r.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return n.queryHash||(n.queryHash=HS(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.enabled!==!0&&n.queryFn===GS&&(n.enabled=!1),n}defaultMutationOptions(t){return t?._defaulted?t:{...this.#r.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},G9=class extends Eu{constructor(t,n){super(),this.options=n,this.#e=t,this.#o=null,this.#s=$N(),this.options.experimental_prefetchInRender||this.#s.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}#e;#t=void 0;#r=void 0;#n=void 0;#i;#a;#s;#o;#p;#m;#h;#c;#d;#l;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),XA(this.#t,this.options)?this.#u():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return FN(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return FN(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#j(),this.#b(),this.#t.removeObserver(this)}setOptions(t,n){const r=this.options,s=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ai(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#t.setOptions(this.options),r._defaulted&&!wx(this.options,r)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const a=this.hasListeners();a&&ZA(this.#t,s,this.options,r)&&this.#u(),this.updateResult(n),a&&(this.#t!==s||ai(this.options.enabled,this.#t)!==ai(r.enabled,this.#t)||Md(this.options.staleTime,this.#t)!==Md(r.staleTime,this.#t))&&this.#x();const i=this.#g();a&&(this.#t!==s||ai(this.options.enabled,this.#t)!==ai(r.enabled,this.#t)||i!==this.#l)&&this.#v(i)}getOptimisticResult(t){const n=this.#e.getQueryCache().build(this.#e,t),r=this.createResult(n,t);return Q9(this,r)&&(this.#n=r,this.#a=this.options,this.#i=this.#t.state),r}getCurrentResult(){return this.#n}trackResult(t,n){const r={};return Object.keys(t).forEach(s=>{Object.defineProperty(r,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),n?.(s),t[s])})}),r}trackProp(t){this.#f.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=this.#e.defaultQueryOptions(t),r=this.#e.getQueryCache().build(this.#e,n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return this.#u({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#u(t){this.#w();let n=this.#t.fetch(this.options,t);return t?.throwOnError||(n=n.catch(Ra)),n}#x(){this.#j();const t=Md(this.options.staleTime,this.#t);if(yc||this.#n.isStale||!MN(t))return;const r=DF(this.#n.dataUpdatedAt,t)+1;this.#c=setTimeout(()=>{this.#n.isStale||this.updateResult()},r)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(t){this.#b(),this.#l=t,!(yc||ai(this.options.enabled,this.#t)===!1||!MN(this.#l)||this.#l===0)&&(this.#d=setInterval(()=>{(this.options.refetchIntervalInBackground||YS.isFocused())&&this.#u()},this.#l))}#y(){this.#x(),this.#v(this.#g())}#j(){this.#c&&(clearTimeout(this.#c),this.#c=void 0)}#b(){this.#d&&(clearInterval(this.#d),this.#d=void 0)}createResult(t,n){const r=this.#t,s=this.options,a=this.#n,i=this.#i,o=this.#a,u=t!==r?t.state:this.#r,{state:m}=t;let h={...m},f=!1,x;if(n._optimisticResults){const E=this.hasListeners(),R=!E&&XA(t,n),T=E&&ZA(t,r,n,s);(R||T)&&(h={...h,...zF(m.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:j,errorUpdatedAt:b,status:g}=h;if(n.select&&h.data!==void 0)if(a&&h.data===i?.data&&n.select===this.#p)x=this.#m;else try{this.#p=n.select,x=n.select(h.data),x=DN(a?.data,x,n),this.#m=x,this.#o=null}catch(E){this.#o=E}else x=h.data;if(n.placeholderData!==void 0&&x===void 0&&g==="pending"){let E;if(a?.isPlaceholderData&&n.placeholderData===o?.placeholderData)E=a.data;else if(E=typeof n.placeholderData=="function"?n.placeholderData(this.#h?.state.data,this.#h):n.placeholderData,n.select&&E!==void 0)try{E=n.select(E),this.#o=null}catch(R){this.#o=R}E!==void 0&&(g="success",x=DN(a?.data,E,n),f=!0)}this.#o&&(j=this.#o,x=this.#m,b=Date.now(),g="error");const y=h.fetchStatus==="fetching",C=g==="pending",k=g==="error",N=C&&y,P=x!==void 0,S={status:g,fetchStatus:h.fetchStatus,isPending:C,isSuccess:g==="success",isError:k,isInitialLoading:N,isLoading:N,data:x,dataUpdatedAt:h.dataUpdatedAt,error:j,errorUpdatedAt:b,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:y,isRefetching:y&&!C,isLoadingError:k&&!P,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:k&&P,isStale:QS(t,n),refetch:this.refetch,promise:this.#s};if(this.options.experimental_prefetchInRender){const E=U=>{S.status==="error"?U.reject(S.error):S.data!==void 0&&U.resolve(S.data)},R=()=>{const U=this.#s=S.promise=$N();E(U)},T=this.#s;switch(T.status){case"pending":t.queryHash===r.queryHash&&E(T);break;case"fulfilled":(S.status==="error"||S.data!==T.value)&&R();break;case"rejected":(S.status!=="error"||S.error!==T.reason)&&R();break}}return S}updateResult(t){const n=this.#n,r=this.createResult(this.#t,this.options);if(this.#i=this.#t.state,this.#a=this.options,this.#i.data!==void 0&&(this.#h=this.#t),wx(r,n))return;this.#n=r;const s={},a=()=>{if(!n)return!0;const{notifyOnChangeProps:i}=this.options,o=typeof i=="function"?i():i;if(o==="all"||!o&&!this.#f.size)return!0;const c=new Set(o??this.#f);return this.options.throwOnError&&c.add("error"),Object.keys(this.#n).some(u=>{const m=u;return this.#n[m]!==n[m]&&c.has(m)})};t?.listeners!==!1&&a()&&(s.listeners=!0),this.#_({...s,...t})}#w(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const n=this.#t;this.#t=t,this.#r=t.state,this.hasListeners()&&(n?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#_(t){Rr.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(this.#n)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function Y9(t,n){return ai(n.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&n.retryOnMount===!1)}function XA(t,n){return Y9(t,n)||t.state.data!==void 0&&FN(t,n,n.refetchOnMount)}function FN(t,n,r){if(ai(n.enabled,t)!==!1){const s=typeof r=="function"?r(t):r;return s==="always"||s!==!1&&QS(t,n)}return!1}function ZA(t,n,r,s){return(t!==n||ai(s.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&QS(t,r)}function QS(t,n){return ai(n.enabled,t)!==!1&&t.isStaleByTime(Md(n.staleTime,t))}function Q9(t,n){return!wx(t.getCurrentResult(),n)}var X9=class extends Eu{#e;#t=void 0;#r;#n;constructor(n,r){super(),this.#e=n,this.setOptions(r),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){const r=this.options;this.options=this.#e.defaultMutationOptions(n),wx(this.options,r)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),r?.mutationKey&&this.options.mutationKey&&jc(r.mutationKey)!==jc(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(n){this.#i(),this.#a(n)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#i(),this.#a()}mutate(n,r){return this.#n=r,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(n)}#i(){const n=this.#r?.state??VF();this.#t={...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset}}#a(n){Rr.batch(()=>{if(this.#n&&this.hasListeners()){const r=this.#t.variables,s=this.#t.context;n?.type==="success"?(this.#n.onSuccess?.(n.data,r,s),this.#n.onSettled?.(n.data,null,r,s)):n?.type==="error"&&(this.#n.onError?.(n.error,r,s),this.#n.onSettled?.(void 0,n.error,r,s))}this.listeners.forEach(r=>{r(this.#t)})})}},UF=v.createContext(void 0),gs=t=>{const n=v.useContext(UF);if(!n)throw new Error("No QueryClient set, use QueryClientProvider to set one");return n},Z9=({client:t,children:n})=>(v.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(UF.Provider,{value:t,children:n})),KF=v.createContext(!1),J9=()=>v.useContext(KF);KF.Provider;function eK(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var tK=v.createContext(eK()),nK=()=>v.useContext(tK);function WF(t,n){return typeof t=="function"?t(...n):!!t}function LN(){}var rK=(t,n)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(n.isReset()||(t.retryOnMount=!1))},sK=t=>{v.useEffect(()=>{t.clearReset()},[t])},aK=({result:t,errorResetBoundary:n,throwOnError:r,query:s})=>t.isError&&!n.isReset()&&!t.isFetching&&s&&WF(r,[t.error,s]),iK=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},oK=(t,n)=>t.isLoading&&t.isFetching&&!n,lK=(t,n)=>t?.suspense&&n.isPending,JA=(t,n,r)=>n.fetchOptimistic(t).catch(()=>{r.clearReset()});function cK(t,n,r){const s=gs(),a=J9(),i=nK(),o=s.defaultQueryOptions(t);s.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=a?"isRestoring":"optimistic",iK(o),rK(o,i),sK(i);const c=!s.getQueryCache().get(o.queryHash),[u]=v.useState(()=>new n(s,o)),m=u.getOptimisticResult(o);if(v.useSyncExternalStore(v.useCallback(h=>{const f=a?LN:u.subscribe(Rr.batchCalls(h));return u.updateResult(),f},[u,a]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),v.useEffect(()=>{u.setOptions(o,{listeners:!1})},[o,u]),lK(o,m))throw JA(o,u,i);if(aK({result:m,errorResetBoundary:i,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash)}))throw m.error;return s.getDefaultOptions().queries?._experimental_afterQuery?.(o,m),o.experimental_prefetchInRender&&!yc&&oK(m,a)&&(c?JA(o,u,i):s.getQueryCache().get(o.queryHash)?.promise)?.catch(LN).finally(()=>{u.updateResult()}),o.notifyOnChangeProps?m:u.trackResult(m)}function $e(t,n){return cK(t,G9)}function Le(t,n){const r=gs(),[s]=v.useState(()=>new X9(r,t));v.useEffect(()=>{s.setOptions(t)},[s,t]);const a=v.useSyncExternalStore(v.useCallback(o=>s.subscribe(Rr.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((o,c)=>{s.mutate(o,c).catch(LN)},[s]);if(a.error&&WF(s.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}function Vn(t,n="Something went wrong. Please try again."){if(!t)return n;if(typeof t=="string")return Xl(t);if(t instanceof Error)return Xl(t.message);if(typeof t=="object"){const r=t;if(typeof r.detail=="string")return Xl(r.detail);if(typeof r.message=="string")return Xl(r.message);if(typeof r.error=="string")return Xl(r.error);if(r.response&&typeof r.response=="object"){const s=r.response;if(s.data&&typeof s.data=="object"){const a=s.data;if(typeof a.message=="string")return Xl(a.message);if(typeof a.detail=="string")return Xl(a.detail)}}}return n}function Xl(t){if(!t)return"Something went wrong. Please try again.";const n=t.replace(/^\d{3}:\s*/,"");try{const r=JSON.parse(n);if(typeof r.detail=="string")return r.detail;if(typeof r.message=="string")return r.message;if(typeof r.error=="string")return r.error}catch{}return n||"Something went wrong. Please try again."}const dK={400:"Invalid request. Please check your input and try again.",401:"You are not authorized. Please log in again.",403:"You don't have permission to perform this action.",404:"The requested resource was not found.",409:"This action conflicts with existing data.",422:"Please check your input - some fields may be invalid.",500:"Something went wrong on our end. Please try again later.",502:"Server is temporarily unavailable. Please try again.",503:"Service is temporarily unavailable. Please try again later.",504:"Request timed out. Please try again."};function eE(t){return dK[t]||"An error occurred. Please try again."}async function HF(t){if(!t.ok){const n=await t.text()||t.statusText;try{const r=JSON.parse(n),s=Vn(r,eE(t.status));throw new Error(s)}catch(r){if(r instanceof Error&&r.message!==n)throw r}throw new Error(eE(t.status))}}async function Be(t,n,r){const s=await fetch(n,{method:t,headers:r?{"Content-Type":"application/json"}:{},body:r?JSON.stringify(r):void 0,credentials:"include"});return await HF(s),s}const uK=({on401:t})=>async({queryKey:n})=>{const r=await fetch(n.join("/"),{credentials:"include"});return await HF(r),await r.json()},Fe=new H9({defaultOptions:{queries:{queryFn:uK({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!0,refetchOnMount:"always",staleTime:5e3,gcTime:300*1e3,retry:2,retryDelay:t=>Math.min(1e3*2**t,8e3)},mutations:{retry:!1}}}),mK=1,hK=1e6;let nb=0;function fK(){return nb=(nb+1)%Number.MAX_SAFE_INTEGER,nb.toString()}const rb=new Map,tE=t=>{if(rb.has(t))return;const n=setTimeout(()=>{rb.delete(t),Zm({type:"REMOVE_TOAST",toastId:t})},hK);rb.set(t,n)},pK=(t,n)=>{switch(n.type){case"ADD_TOAST":return{...t,toasts:[n.toast,...t.toasts].slice(0,mK)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===n.toast.id?{...r,...n.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=n;return r?tE(r):t.toasts.forEach(s=>{tE(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===r||r===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return n.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==n.toastId)}}},px=[];let xx={toasts:[]};function Zm(t){xx=pK(xx,t),px.forEach(n=>{n(xx)})}function xK({...t}){const n=fK(),r=a=>Zm({type:"UPDATE_TOAST",toast:{...a,id:n}}),s=()=>Zm({type:"DISMISS_TOAST",toastId:n});return Zm({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:a=>{a||s()}}}),{id:n,dismiss:s,update:r}}function Xt(){const[t,n]=v.useState(xx);return v.useEffect(()=>(px.push(n),()=>{const r=px.indexOf(n);r>-1&&px.splice(r,1)}),[t]),{...t,toast:xK,dismiss:r=>Zm({type:"DISMISS_TOAST",toastId:r})}}var Ou=NF();const gK=kn(Ou);function ot(t,n,{checkForDefaultPrevented:r=!0}={}){return function(a){if(t?.(a),r===!1||!a.defaultPrevented)return n?.(a)}}function nE(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function xo(...t){return n=>{let r=!1;const s=t.map(a=>{const i=nE(a,n);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<s.length;a++){const i=s[a];typeof i=="function"?i():nE(t[a],null)}}}}function cn(...t){return v.useCallback(xo(...t),t)}function vK(t,n){const r=v.createContext(n),s=i=>{const{children:o,...c}=i,u=v.useMemo(()=>c,Object.values(c));return e.jsx(r.Provider,{value:u,children:o})};s.displayName=t+"Provider";function a(i){const o=v.useContext(r);if(o)return o;if(n!==void 0)return n;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[s,a]}function Kr(t,n=[]){let r=[];function s(i,o){const c=v.createContext(o),u=r.length;r=[...r,o];const m=f=>{const{scope:x,children:j,...b}=f,g=x?.[t]?.[u]||c,y=v.useMemo(()=>b,Object.values(b));return e.jsx(g.Provider,{value:y,children:j})};m.displayName=i+"Provider";function h(f,x){const j=x?.[t]?.[u]||c,b=v.useContext(j);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[m,h]}const a=()=>{const i=r.map(o=>v.createContext(o));return function(c){const u=c?.[t]||i;return v.useMemo(()=>({[`__scope${t}`]:{...c,[t]:u}}),[c,u])}};return a.scopeName=t,[s,yK(a,...n)]}function yK(...t){const n=t[0];if(t.length===1)return n;const r=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((c,{useScope:u,scopeName:m})=>{const f=u(i)[`__scope${m}`];return{...c,...f}},{});return v.useMemo(()=>({[`__scope${n.scopeName}`]:o}),[o])}};return r.scopeName=n.scopeName,r}function yl(t){const n=jK(t),r=v.forwardRef((s,a)=>{const{children:i,...o}=s,c=v.Children.toArray(i),u=c.find(bK);if(u){const m=u.props.children,h=c.map(f=>f===u?v.Children.count(m)>1?v.Children.only(null):v.isValidElement(m)?m.props.children:null:f);return e.jsx(n,{...o,ref:a,children:v.isValidElement(m)?v.cloneElement(m,void 0,h):null})}return e.jsx(n,{...o,ref:a,children:i})});return r.displayName=`${t}.Slot`,r}var Gg=yl("Slot");function jK(t){const n=v.forwardRef((r,s)=>{const{children:a,...i}=r;if(v.isValidElement(a)){const o=_K(a),c=wK(i,a.props);return a.type!==v.Fragment&&(c.ref=s?xo(s,o):o),v.cloneElement(a,c)}return v.Children.count(a)>1?v.Children.only(null):null});return n.displayName=`${t}.SlotClone`,n}var GF=Symbol("radix.slottable");function YF(t){const n=({children:r})=>e.jsx(e.Fragment,{children:r});return n.displayName=`${t}.Slottable`,n.__radixId=GF,n}function bK(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===GF}function wK(t,n){const r={...n};for(const s in n){const a=t[s],i=n[s];/^on[A-Z]/.test(s)?a&&i?r[s]=(...c)=>{i(...c),a(...c)}:a&&(r[s]=a):s==="style"?r[s]={...a,...i}:s==="className"&&(r[s]=[a,i].filter(Boolean).join(" "))}return{...t,...r}}function _K(t){let n=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function pf(t){const n=t+"CollectionProvider",[r,s]=Kr(n),[a,i]=r(n,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:y,children:C}=g,k=le.useRef(null),N=le.useRef(new Map).current;return e.jsx(a,{scope:y,itemMap:N,collectionRef:k,children:C})};o.displayName=n;const c=t+"CollectionSlot",u=yl(c),m=le.forwardRef((g,y)=>{const{scope:C,children:k}=g,N=i(c,C),P=cn(y,N.collectionRef);return e.jsx(u,{ref:P,children:k})});m.displayName=c;const h=t+"CollectionItemSlot",f="data-radix-collection-item",x=yl(h),j=le.forwardRef((g,y)=>{const{scope:C,children:k,...N}=g,P=le.useRef(null),w=cn(y,P),S=i(h,C);return le.useEffect(()=>(S.itemMap.set(P,{ref:P,...N}),()=>{S.itemMap.delete(P)})),e.jsx(x,{[f]:"",ref:w,children:k})});j.displayName=h;function b(g){const y=i(t+"CollectionConsumer",g);return le.useCallback(()=>{const k=y.collectionRef.current;if(!k)return[];const N=Array.from(k.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((S,E)=>N.indexOf(S.ref.current)-N.indexOf(E.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:m,ItemSlot:j},b,s]}var NK=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],gt=NK.reduce((t,n)=>{const r=yl(`Primitive.${n}`),s=v.forwardRef((a,i)=>{const{asChild:o,...c}=a,u=o?r:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(u,{...c,ref:i})});return s.displayName=`Primitive.${n}`,{...t,[n]:s}},{});function XS(t,n){t&&Ou.flushSync(()=>t.dispatchEvent(n))}function ss(t){const n=v.useRef(t);return v.useEffect(()=>{n.current=t}),v.useMemo(()=>(...r)=>n.current?.(...r),[])}function SK(t,n=globalThis?.document){const r=ss(t);v.useEffect(()=>{const s=a=>{a.key==="Escape"&&r(a)};return n.addEventListener("keydown",s,{capture:!0}),()=>n.removeEventListener("keydown",s,{capture:!0})},[r,n])}var CK="DismissableLayer",IN="dismissableLayer.update",kK="dismissableLayer.pointerDownOutside",PK="dismissableLayer.focusOutside",rE,QF=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Dc=v.forwardRef((t,n)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:c,...u}=t,m=v.useContext(QF),[h,f]=v.useState(null),x=h?.ownerDocument??globalThis?.document,[,j]=v.useState({}),b=cn(n,E=>f(E)),g=Array.from(m.layers),[y]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),C=g.indexOf(y),k=h?g.indexOf(h):-1,N=m.layersWithOutsidePointerEventsDisabled.size>0,P=k>=C,w=EK(E=>{const R=E.target,T=[...m.branches].some(U=>U.contains(R));!P||T||(a?.(E),o?.(E),E.defaultPrevented||c?.())},x),S=OK(E=>{const R=E.target;[...m.branches].some(U=>U.contains(R))||(i?.(E),o?.(E),E.defaultPrevented||c?.())},x);return SK(E=>{k===m.layers.size-1&&(s?.(E),!E.defaultPrevented&&c&&(E.preventDefault(),c()))},x),v.useEffect(()=>{if(h)return r&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(rE=x.body.style.pointerEvents,x.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(h)),m.layers.add(h),sE(),()=>{r&&m.layersWithOutsidePointerEventsDisabled.size===1&&(x.body.style.pointerEvents=rE)}},[h,x,r,m]),v.useEffect(()=>()=>{h&&(m.layers.delete(h),m.layersWithOutsidePointerEventsDisabled.delete(h),sE())},[h,m]),v.useEffect(()=>{const E=()=>j({});return document.addEventListener(IN,E),()=>document.removeEventListener(IN,E)},[]),e.jsx(gt.div,{...u,ref:b,style:{pointerEvents:N?P?"auto":"none":void 0,...t.style},onFocusCapture:ot(t.onFocusCapture,S.onFocusCapture),onBlurCapture:ot(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:ot(t.onPointerDownCapture,w.onPointerDownCapture)})});Dc.displayName=CK;var AK="DismissableLayerBranch",XF=v.forwardRef((t,n)=>{const r=v.useContext(QF),s=v.useRef(null),a=cn(n,s);return v.useEffect(()=>{const i=s.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),e.jsx(gt.div,{...t,ref:a})});XF.displayName=AK;function EK(t,n=globalThis?.document){const r=ss(t),s=v.useRef(!1),a=v.useRef(()=>{});return v.useEffect(()=>{const i=c=>{if(c.target&&!s.current){let u=function(){ZF(kK,r,m,{discrete:!0})};const m={originalEvent:c};c.pointerType==="touch"?(n.removeEventListener("click",a.current),a.current=u,n.addEventListener("click",a.current,{once:!0})):u()}else n.removeEventListener("click",a.current);s.current=!1},o=window.setTimeout(()=>{n.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),n.removeEventListener("pointerdown",i),n.removeEventListener("click",a.current)}},[n,r]),{onPointerDownCapture:()=>s.current=!0}}function OK(t,n=globalThis?.document){const r=ss(t),s=v.useRef(!1);return v.useEffect(()=>{const a=i=>{i.target&&!s.current&&ZF(PK,r,{originalEvent:i},{discrete:!1})};return n.addEventListener("focusin",a),()=>n.removeEventListener("focusin",a)},[n,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function sE(){const t=new CustomEvent(IN);document.dispatchEvent(t)}function ZF(t,n,r,{discrete:s}){const a=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});n&&a.addEventListener(t,n,{once:!0}),s?XS(a,i):a.dispatchEvent(i)}var TK=Dc,MK=XF,wr=globalThis?.document?v.useLayoutEffect:()=>{},RK="Portal",Tu=v.forwardRef((t,n)=>{const{container:r,...s}=t,[a,i]=v.useState(!1);wr(()=>i(!0),[]);const o=r||a&&globalThis?.document?.body;return o?gK.createPortal(e.jsx(gt.div,{...s,ref:n}),o):null});Tu.displayName=RK;function DK(t,n){return v.useReducer((r,s)=>n[r][s]??r,t)}var Rs=t=>{const{present:n,children:r}=t,s=$K(n),a=typeof r=="function"?r({present:s.isPresent}):v.Children.only(r),i=cn(s.ref,FK(a));return typeof r=="function"||s.isPresent?v.cloneElement(a,{ref:i}):null};Rs.displayName="Presence";function $K(t){const[n,r]=v.useState(),s=v.useRef({}),a=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[c,u]=DK(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const m=Vp(s.current);i.current=c==="mounted"?m:"none"},[c]),wr(()=>{const m=s.current,h=a.current;if(h!==t){const x=i.current,j=Vp(m);t?u("MOUNT"):j==="none"||m?.display==="none"?u("UNMOUNT"):u(h&&x!==j?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,u]),wr(()=>{if(n){let m;const h=n.ownerDocument.defaultView??window,f=j=>{const g=Vp(s.current).includes(j.animationName);if(j.target===n&&g&&(u("ANIMATION_END"),!a.current)){const y=n.style.animationFillMode;n.style.animationFillMode="forwards",m=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=y)})}},x=j=>{j.target===n&&(i.current=Vp(s.current))};return n.addEventListener("animationstart",x),n.addEventListener("animationcancel",f),n.addEventListener("animationend",f),()=>{h.clearTimeout(m),n.removeEventListener("animationstart",x),n.removeEventListener("animationcancel",f),n.removeEventListener("animationend",f)}}else u("ANIMATION_END")},[n,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:v.useCallback(m=>{m&&(s.current=getComputedStyle(m)),r(m)},[])}}function Vp(t){return t?.animationName||"none"}function FK(t){let n=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function Zs({prop:t,defaultProp:n,onChange:r=()=>{}}){const[s,a]=LK({defaultProp:n,onChange:r}),i=t!==void 0,o=i?t:s,c=ss(r),u=v.useCallback(m=>{if(i){const f=typeof m=="function"?m(t):m;f!==t&&c(f)}else a(m)},[i,t,a,c]);return[o,u]}function LK({defaultProp:t,onChange:n}){const r=v.useState(t),[s]=r,a=v.useRef(s),i=ss(n);return v.useEffect(()=>{a.current!==s&&(i(s),a.current=s)},[s,a,i]),r}var IK="VisuallyHidden",xf=v.forwardRef((t,n)=>e.jsx(gt.span,{...t,ref:n,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));xf.displayName=IK;var qK=xf,ZS="ToastProvider",[JS,BK,zK]=pf("Toast"),[JF]=Kr("Toast",[zK]),[VK,Yg]=JF(ZS),eL=t=>{const{__scopeToast:n,label:r="Notification",duration:s=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=t,[c,u]=v.useState(null),[m,h]=v.useState(0),f=v.useRef(!1),x=v.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${ZS}\`. Expected non-empty \`string\`.`),e.jsx(JS.Provider,{scope:n,children:e.jsx(VK,{scope:n,label:r,duration:s,swipeDirection:a,swipeThreshold:i,toastCount:m,viewport:c,onViewportChange:u,onToastAdd:v.useCallback(()=>h(j=>j+1),[]),onToastRemove:v.useCallback(()=>h(j=>j-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:x,children:o})})};eL.displayName=ZS;var tL="ToastViewport",UK=["F8"],qN="toast.viewportPause",BN="toast.viewportResume",nL=v.forwardRef((t,n)=>{const{__scopeToast:r,hotkey:s=UK,label:a="Notifications ({hotkey})",...i}=t,o=Yg(tL,r),c=BK(r),u=v.useRef(null),m=v.useRef(null),h=v.useRef(null),f=v.useRef(null),x=cn(n,f,o.onViewportChange),j=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),b=o.toastCount>0;v.useEffect(()=>{const y=C=>{s.length!==0&&s.every(N=>C[N]||C.code===N)&&f.current?.focus()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[s]),v.useEffect(()=>{const y=u.current,C=f.current;if(b&&y&&C){const k=()=>{if(!o.isClosePausedRef.current){const S=new CustomEvent(qN);C.dispatchEvent(S),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const S=new CustomEvent(BN);C.dispatchEvent(S),o.isClosePausedRef.current=!1}},P=S=>{!y.contains(S.relatedTarget)&&N()},w=()=>{y.contains(document.activeElement)||N()};return y.addEventListener("focusin",k),y.addEventListener("focusout",P),y.addEventListener("pointermove",k),y.addEventListener("pointerleave",w),window.addEventListener("blur",k),window.addEventListener("focus",N),()=>{y.removeEventListener("focusin",k),y.removeEventListener("focusout",P),y.removeEventListener("pointermove",k),y.removeEventListener("pointerleave",w),window.removeEventListener("blur",k),window.removeEventListener("focus",N)}}},[b,o.isClosePausedRef]);const g=v.useCallback(({tabbingDirection:y})=>{const k=c().map(N=>{const P=N.ref.current,w=[P,...rW(P)];return y==="forwards"?w:w.reverse()});return(y==="forwards"?k.reverse():k).flat()},[c]);return v.useEffect(()=>{const y=f.current;if(y){const C=k=>{const N=k.altKey||k.ctrlKey||k.metaKey;if(k.key==="Tab"&&!N){const w=document.activeElement,S=k.shiftKey;if(k.target===y&&S){m.current?.focus();return}const T=g({tabbingDirection:S?"backwards":"forwards"}),U=T.findIndex(M=>M===w);sb(T.slice(U+1))?k.preventDefault():S?m.current?.focus():h.current?.focus()}};return y.addEventListener("keydown",C),()=>y.removeEventListener("keydown",C)}},[c,g]),e.jsxs(MK,{ref:u,role:"region","aria-label":a.replace("{hotkey}",j),tabIndex:-1,style:{pointerEvents:b?void 0:"none"},children:[b&&e.jsx(zN,{ref:m,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});sb(y)}}),e.jsx(JS.Slot,{scope:r,children:e.jsx(gt.ol,{tabIndex:-1,...i,ref:x})}),b&&e.jsx(zN,{ref:h,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});sb(y)}})]})});nL.displayName=tL;var rL="ToastFocusProxy",zN=v.forwardRef((t,n)=>{const{__scopeToast:r,onFocusFromOutsideViewport:s,...a}=t,i=Yg(rL,r);return e.jsx(xf,{"aria-hidden":!0,tabIndex:0,...a,ref:n,style:{position:"fixed"},onFocus:o=>{const c=o.relatedTarget;!i.viewport?.contains(c)&&s()}})});zN.displayName=rL;var Qg="Toast",KK="toast.swipeStart",WK="toast.swipeMove",HK="toast.swipeCancel",GK="toast.swipeEnd",sL=v.forwardRef((t,n)=>{const{forceMount:r,open:s,defaultOpen:a,onOpenChange:i,...o}=t,[c=!0,u]=Zs({prop:s,defaultProp:a,onChange:i});return e.jsx(Rs,{present:r||c,children:e.jsx(XK,{open:c,...o,ref:n,onClose:()=>u(!1),onPause:ss(t.onPause),onResume:ss(t.onResume),onSwipeStart:ot(t.onSwipeStart,m=>{m.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ot(t.onSwipeMove,m=>{const{x:h,y:f}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","move"),m.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:ot(t.onSwipeCancel,m=>{m.currentTarget.setAttribute("data-swipe","cancel"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ot(t.onSwipeEnd,m=>{const{x:h,y:f}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","end"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),u(!1)})})})});sL.displayName=Qg;var[YK,QK]=JF(Qg,{onClose(){}}),XK=v.forwardRef((t,n)=>{const{__scopeToast:r,type:s="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:c,onPause:u,onResume:m,onSwipeStart:h,onSwipeMove:f,onSwipeCancel:x,onSwipeEnd:j,...b}=t,g=Yg(Qg,r),[y,C]=v.useState(null),k=cn(n,$=>C($)),N=v.useRef(null),P=v.useRef(null),w=a||g.duration,S=v.useRef(0),E=v.useRef(w),R=v.useRef(0),{onToastAdd:T,onToastRemove:U}=g,M=ss(()=>{y?.contains(document.activeElement)&&g.viewport?.focus(),o()}),L=v.useCallback($=>{!$||$===1/0||(window.clearTimeout(R.current),S.current=new Date().getTime(),R.current=window.setTimeout(M,$))},[M]);v.useEffect(()=>{const $=g.viewport;if($){const D=()=>{L(E.current),m?.()},z=()=>{const J=new Date().getTime()-S.current;E.current=E.current-J,window.clearTimeout(R.current),u?.()};return $.addEventListener(qN,z),$.addEventListener(BN,D),()=>{$.removeEventListener(qN,z),$.removeEventListener(BN,D)}}},[g.viewport,w,u,m,L]),v.useEffect(()=>{i&&!g.isClosePausedRef.current&&L(w)},[i,w,g.isClosePausedRef,L]),v.useEffect(()=>(T(),()=>U()),[T,U]);const q=v.useMemo(()=>y?uL(y):null,[y]);return g.viewport?e.jsxs(e.Fragment,{children:[q&&e.jsx(ZK,{__scopeToast:r,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:q}),e.jsx(YK,{scope:r,onClose:M,children:Ou.createPortal(e.jsx(JS.ItemSlot,{scope:r,children:e.jsx(TK,{asChild:!0,onEscapeKeyDown:ot(c,()=>{g.isFocusedToastEscapeKeyDownRef.current||M(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(gt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...b,ref:k,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ot(t.onKeyDown,$=>{$.key==="Escape"&&(c?.($.nativeEvent),$.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,M()))}),onPointerDown:ot(t.onPointerDown,$=>{$.button===0&&(N.current={x:$.clientX,y:$.clientY})}),onPointerMove:ot(t.onPointerMove,$=>{if(!N.current)return;const D=$.clientX-N.current.x,z=$.clientY-N.current.y,J=!!P.current,I=["left","right"].includes(g.swipeDirection),X=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,ne=I?X(0,D):0,W=I?0:X(0,z),H=$.pointerType==="touch"?10:2,fe={x:ne,y:W},Pe={originalEvent:$,delta:fe};J?(P.current=fe,Up(WK,f,Pe,{discrete:!1})):aE(fe,g.swipeDirection,H)?(P.current=fe,Up(KK,h,Pe,{discrete:!1}),$.target.setPointerCapture($.pointerId)):(Math.abs(D)>H||Math.abs(z)>H)&&(N.current=null)}),onPointerUp:ot(t.onPointerUp,$=>{const D=P.current,z=$.target;if(z.hasPointerCapture($.pointerId)&&z.releasePointerCapture($.pointerId),P.current=null,N.current=null,D){const J=$.currentTarget,I={originalEvent:$,delta:D};aE(D,g.swipeDirection,g.swipeThreshold)?Up(GK,j,I,{discrete:!0}):Up(HK,x,I,{discrete:!0}),J.addEventListener("click",X=>X.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),ZK=t=>{const{__scopeToast:n,children:r,...s}=t,a=Yg(Qg,n),[i,o]=v.useState(!1),[c,u]=v.useState(!1);return tW(()=>o(!0)),v.useEffect(()=>{const m=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(m)},[]),c?null:e.jsx(Tu,{asChild:!0,children:e.jsx(xf,{...s,children:i&&e.jsxs(e.Fragment,{children:[a.label," ",r]})})})},JK="ToastTitle",aL=v.forwardRef((t,n)=>{const{__scopeToast:r,...s}=t;return e.jsx(gt.div,{...s,ref:n})});aL.displayName=JK;var eW="ToastDescription",iL=v.forwardRef((t,n)=>{const{__scopeToast:r,...s}=t;return e.jsx(gt.div,{...s,ref:n})});iL.displayName=eW;var oL="ToastAction",lL=v.forwardRef((t,n)=>{const{altText:r,...s}=t;return r.trim()?e.jsx(dL,{altText:r,asChild:!0,children:e.jsx(eC,{...s,ref:n})}):(console.error(`Invalid prop \`altText\` supplied to \`${oL}\`. Expected non-empty \`string\`.`),null)});lL.displayName=oL;var cL="ToastClose",eC=v.forwardRef((t,n)=>{const{__scopeToast:r,...s}=t,a=QK(cL,r);return e.jsx(dL,{asChild:!0,children:e.jsx(gt.button,{type:"button",...s,ref:n,onClick:ot(t.onClick,a.onClose)})})});eC.displayName=cL;var dL=v.forwardRef((t,n)=>{const{__scopeToast:r,altText:s,...a}=t;return e.jsx(gt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...a,ref:n})});function uL(t){const n=[];return Array.from(t.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&n.push(s.textContent),nW(s)){const a=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&n.push(o)}else n.push(...uL(s))}}),n}function Up(t,n,r,{discrete:s}){const a=r.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});n&&a.addEventListener(t,n,{once:!0}),s?XS(a,i):a.dispatchEvent(i)}var aE=(t,n,r=0)=>{const s=Math.abs(t.x),a=Math.abs(t.y),i=s>a;return n==="left"||n==="right"?i&&s>r:!i&&a>r};function tW(t=()=>{}){const n=ss(t);wr(()=>{let r=0,s=0;return r=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(s)}},[n])}function nW(t){return t.nodeType===t.ELEMENT_NODE}function rW(t){const n=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)n.push(r.currentNode);return n}function sb(t){const n=document.activeElement;return t.some(r=>r===n?!0:(r.focus(),document.activeElement!==n))}var sW=eL,mL=nL,hL=sL,fL=aL,pL=iL,xL=lL,gL=eC;function vL(t){var n,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(n=0;n<a;n++)t[n]&&(r=vL(t[n]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function rn(){for(var t,n,r=0,s="",a=arguments.length;r<a;r++)(t=arguments[r])&&(n=vL(t))&&(s&&(s+=" "),s+=n);return s}const iE=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,oE=rn,$c=(t,n)=>r=>{var s;if(n?.variants==null)return oE(t,r?.class,r?.className);const{variants:a,defaultVariants:i}=n,o=Object.keys(a).map(m=>{const h=r?.[m],f=i?.[m];if(h===null)return null;const x=iE(h)||iE(f);return a[m][x]}),c=r&&Object.entries(r).reduce((m,h)=>{let[f,x]=h;return x===void 0||(m[f]=x),m},{}),u=n==null||(s=n.compoundVariants)===null||s===void 0?void 0:s.reduce((m,h)=>{let{class:f,className:x,...j}=h;return Object.entries(j).every(b=>{let[g,y]=b;return Array.isArray(y)?y.includes({...i,...c}[g]):{...i,...c}[g]===y})?[...m,f,x]:m},[]);return oE(t,o,u,r?.class,r?.className)};const aW=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),yL=(...t)=>t.filter((n,r,s)=>!!n&&s.indexOf(n)===r).join(" ");var iW={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const oW=v.forwardRef(({color:t="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:a="",children:i,iconNode:o,...c},u)=>v.createElement("svg",{ref:u,...iW,width:n,height:n,stroke:t,strokeWidth:s?Number(r)*24/Number(n):r,className:yL("lucide",a),...c},[...o.map(([m,h])=>v.createElement(m,h)),...Array.isArray(i)?i:[i]]));const Ye=(t,n)=>{const r=v.forwardRef(({className:s,...a},i)=>v.createElement(oW,{ref:i,iconNode:n,className:yL(`lucide-${aW(t)}`,s),...a}));return r.displayName=`${t}`,r};const lW=Ye("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const jL=Ye("ArrowDownLeft",[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]]);const bL=Ye("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);const $r=Ye("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const ml=Ye("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);const ab=Ye("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const Mu=Ye("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);const xa=Ye("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);const lE=Ye("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const cW=Ye("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);const dW=Ye("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const ib=Ye("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const Yn=Ye("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const wL=Ye("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const uW=Ye("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const cE=Ye("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const oo=Ye("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const mW=Ye("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const Ri=Ye("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const hW=Ye("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);const fs=Ye("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Xg=Ye("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const vi=Ye("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Os=Ye("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const fW=Ye("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const pW=Ye("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);const xW=Ye("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);const uh=Ye("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);const La=Ye("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const yr=Ye("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const ps=Ye("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const gW=Ye("CircleDollarSign",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 18V6",key:"zqpxq5"}]]);const vW=Ye("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const yW=Ye("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);const Cs=Ye("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const jW=Ye("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const bW=Ye("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const bn=Ye("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const wW=Ye("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);const ns=Ye("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const _W=Ye("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);const _L=Ye("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);const ho=Ye("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const $a=Ye("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const NW=Ye("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);const mh=Ye("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const Ts=Ye("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const tn=Ye("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const SW=Ye("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);const CW=Ye("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const VN=Ye("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);const dE=Ye("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);const kW=Ye("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const uE=Ye("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);const ob=Ye("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const md=Ye("HandCoins",[["path",{d:"M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17",key:"geh8rc"}],["path",{d:"m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"1fto5m"}],["path",{d:"m2 16 6 6",key:"1pfhp9"}],["circle",{cx:"16",cy:"9",r:"2.9",key:"1n0dlu"}],["circle",{cx:"6",cy:"5",r:"3",key:"151irh"}]]);const Kp=Ye("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);const NL=Ye("IdCard",[["path",{d:"M16 10h2",key:"8sgtl7"}],["path",{d:"M16 14h2",key:"epxaof"}],["path",{d:"M6.17 15a3 3 0 0 1 5.66 0",key:"n6f512"}],["circle",{cx:"9",cy:"11",r:"2",key:"yxgjnd"}],["rect",{x:"2",y:"5",width:"20",height:"14",rx:"2",key:"qneu4z"}]]);const PW=Ye("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const Zg=Ye("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const hh=Ye("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);const mE=Ye("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);const vr=Ye("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);const AW=Ye("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const ln=Ye("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const SL=Ye("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);const hl=Ye("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const EW=Ye("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const Rd=Ye("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const ja=Ye("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Jm=Ye("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const cl=Ye("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const OW=Ye("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);const Ba=Ye("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);const TW=Ye("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);const ic=Ye("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const Nx=Ye("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2V5z",key:"1ivx2i"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h.01",key:"xkw8gn"}]]);const MW=Ye("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);const mn=Ye("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const tC=Ye("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);const Ei=Ye("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);const mi=Ye("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Jg=Ye("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const Um=Ye("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const RW=Ye("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);const eh=Ye("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);const za=Ye("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const Cd=Ye("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const Kd=Ye("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Dd=Ye("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const Es=Ye("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const hE=Ye("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);const Wd=Ye("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const DW=Ye("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);const Sx=Ye("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);const $W=Ye("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);const ba=Ye("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const ev=Ye("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const Ur=Ye("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const CL=Ye("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const kL=Ye("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const fh=Ye("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);const Cx=Ye("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const FW=Ye("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);const $d=Ye("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const pn=Ye("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const LW=Ye("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);const Ys=Ye("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);const fE=Ye("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);const rs=Ye("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),nC="-",IW=t=>{const n=BW(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const c=o.split(nC);return c[0]===""&&c.length!==1&&c.shift(),PL(c,n)||qW(o)},getConflictingClassGroupIds:(o,c)=>{const u=r[o]||[];return c&&s[o]?[...u,...s[o]]:u}}},PL=(t,n)=>{if(t.length===0)return n.classGroupId;const r=t[0],s=n.nextPart.get(r),a=s?PL(t.slice(1),s):void 0;if(a)return a;if(n.validators.length===0)return;const i=t.join(nC);return n.validators.find(({validator:o})=>o(i))?.classGroupId},pE=/^\[(.+)\]$/,qW=t=>{if(pE.test(t)){const n=pE.exec(t)[1],r=n?.substring(0,n.indexOf(":"));if(r)return"arbitrary.."+r}},BW=t=>{const{theme:n,prefix:r}=t,s={nextPart:new Map,validators:[]};return VW(Object.entries(t.classGroups),r).forEach(([i,o])=>{UN(o,s,i,n)}),s},UN=(t,n,r,s)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?n:xE(n,a);i.classGroupId=r;return}if(typeof a=="function"){if(zW(a)){UN(a(s),n,r,s);return}n.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{UN(o,xE(n,i),r,s)})})},xE=(t,n)=>{let r=t;return n.split(nC).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},zW=t=>t.isThemeGetter,VW=(t,n)=>n?t.map(([r,s])=>{const a=s.map(i=>typeof i=="string"?n+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[n+o,c])):i);return[r,a]}):t,UW=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,r=new Map,s=new Map;const a=(i,o)=>{r.set(i,o),n++,n>t&&(n=0,s=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},AL="!",KW=t=>{const{separator:n,experimentalParseClassName:r}=t,s=n.length===1,a=n[0],i=n.length,o=c=>{const u=[];let m=0,h=0,f;for(let y=0;y<c.length;y++){let C=c[y];if(m===0){if(C===a&&(s||c.slice(y,y+i)===n)){u.push(c.slice(h,y)),h=y+i;continue}if(C==="/"){f=y;continue}}C==="["?m++:C==="]"&&m--}const x=u.length===0?c:c.substring(h),j=x.startsWith(AL),b=j?x.substring(1):x,g=f&&f>h?f-h:void 0;return{modifiers:u,hasImportantModifier:j,baseClassName:b,maybePostfixModifierPosition:g}};return r?c=>r({className:c,parseClassName:o}):o},WW=t=>{if(t.length<=1)return t;const n=[];let r=[];return t.forEach(s=>{s[0]==="["?(n.push(...r.sort(),s),r=[]):r.push(s)}),n.push(...r.sort()),n},HW=t=>({cache:UW(t.cacheSize),parseClassName:KW(t),...IW(t)}),GW=/\s+/,YW=(t,n)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:a}=n,i=[],o=t.trim().split(GW);let c="";for(let u=o.length-1;u>=0;u-=1){const m=o[u],{modifiers:h,hasImportantModifier:f,baseClassName:x,maybePostfixModifierPosition:j}=r(m);let b=!!j,g=s(b?x.substring(0,j):x);if(!g){if(!b){c=m+(c.length>0?" "+c:c);continue}if(g=s(x),!g){c=m+(c.length>0?" "+c:c);continue}b=!1}const y=WW(h).join(":"),C=f?y+AL:y,k=C+g;if(i.includes(k))continue;i.push(k);const N=a(g,b);for(let P=0;P<N.length;++P){const w=N[P];i.push(C+w)}c=m+(c.length>0?" "+c:c)}return c};function QW(){let t=0,n,r,s="";for(;t<arguments.length;)(n=arguments[t++])&&(r=EL(n))&&(s&&(s+=" "),s+=r);return s}const EL=t=>{if(typeof t=="string")return t;let n,r="";for(let s=0;s<t.length;s++)t[s]&&(n=EL(t[s]))&&(r&&(r+=" "),r+=n);return r};function XW(t,...n){let r,s,a,i=o;function o(u){const m=n.reduce((h,f)=>f(h),t());return r=HW(m),s=r.cache.get,a=r.cache.set,i=c,c(u)}function c(u){const m=s(u);if(m)return m;const h=YW(u,r);return a(u,h),h}return function(){return i(QW.apply(null,arguments))}}const Hn=t=>{const n=r=>r[t]||[];return n.isThemeGetter=!0,n},OL=/^\[(?:([a-z-]+):)?(.+)\]$/i,ZW=/^\d+\/\d+$/,JW=new Set(["px","full","screen"]),e7=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,t7=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,n7=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,r7=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,s7=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,to=t=>Fd(t)||JW.has(t)||ZW.test(t),nl=t=>Ru(t,"length",m7),Fd=t=>!!t&&!Number.isNaN(Number(t)),lb=t=>Ru(t,"number",Fd),km=t=>!!t&&Number.isInteger(Number(t)),a7=t=>t.endsWith("%")&&Fd(t.slice(0,-1)),en=t=>OL.test(t),rl=t=>e7.test(t),i7=new Set(["length","size","percentage"]),o7=t=>Ru(t,i7,TL),l7=t=>Ru(t,"position",TL),c7=new Set(["image","url"]),d7=t=>Ru(t,c7,f7),u7=t=>Ru(t,"",h7),Pm=()=>!0,Ru=(t,n,r)=>{const s=OL.exec(t);return s?s[1]?typeof n=="string"?s[1]===n:n.has(s[1]):r(s[2]):!1},m7=t=>t7.test(t)&&!n7.test(t),TL=()=>!1,h7=t=>r7.test(t),f7=t=>s7.test(t),p7=()=>{const t=Hn("colors"),n=Hn("spacing"),r=Hn("blur"),s=Hn("brightness"),a=Hn("borderColor"),i=Hn("borderRadius"),o=Hn("borderSpacing"),c=Hn("borderWidth"),u=Hn("contrast"),m=Hn("grayscale"),h=Hn("hueRotate"),f=Hn("invert"),x=Hn("gap"),j=Hn("gradientColorStops"),b=Hn("gradientColorStopPositions"),g=Hn("inset"),y=Hn("margin"),C=Hn("opacity"),k=Hn("padding"),N=Hn("saturate"),P=Hn("scale"),w=Hn("sepia"),S=Hn("skew"),E=Hn("space"),R=Hn("translate"),T=()=>["auto","contain","none"],U=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto",en,n],L=()=>[en,n],q=()=>["",to,nl],$=()=>["auto",Fd,en],D=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],J=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],I=()=>["start","end","center","between","around","evenly","stretch"],X=()=>["","0",en],ne=()=>["auto","avoid","all","avoid-page","page","left","right","column"],W=()=>[Fd,en];return{cacheSize:500,separator:":",theme:{colors:[Pm],spacing:[to,nl],blur:["none","",rl,en],brightness:W(),borderColor:[t],borderRadius:["none","","full",rl,en],borderSpacing:L(),borderWidth:q(),contrast:W(),grayscale:X(),hueRotate:W(),invert:X(),gap:L(),gradientColorStops:[t],gradientColorStopPositions:[a7,nl],inset:M(),margin:M(),opacity:W(),padding:L(),saturate:W(),scale:W(),sepia:X(),skew:W(),space:L(),translate:L()},classGroups:{aspect:[{aspect:["auto","square","video",en]}],container:["container"],columns:[{columns:[rl]}],"break-after":[{"break-after":ne()}],"break-before":[{"break-before":ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...D(),en]}],overflow:[{overflow:U()}],"overflow-x":[{"overflow-x":U()}],"overflow-y":[{"overflow-y":U()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",km,en]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",en]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",km,en]}],"grid-cols":[{"grid-cols":[Pm]}],"col-start-end":[{col:["auto",{span:["full",km,en]},en]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[Pm]}],"row-start-end":[{row:["auto",{span:[km,en]},en]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",en]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",en]}],gap:[{gap:[x]}],"gap-x":[{"gap-x":[x]}],"gap-y":[{"gap-y":[x]}],"justify-content":[{justify:["normal",...I()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...I(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...I(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",en,n]}],"min-w":[{"min-w":[en,n,"min","max","fit"]}],"max-w":[{"max-w":[en,n,"none","full","min","max","fit","prose",{screen:[rl]},rl]}],h:[{h:[en,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[en,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[en,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[en,n,"auto","min","max","fit"]}],"font-size":[{text:["base",rl,nl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",lb]}],"font-family":[{font:[Pm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",en]}],"line-clamp":[{"line-clamp":["none",Fd,lb]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",to,en]}],"list-image":[{"list-image":["none",en]}],"list-style-type":[{list:["none","disc","decimal",en]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[C]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[C]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",to,nl]}],"underline-offset":[{"underline-offset":["auto",to,en]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",en]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",en]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[C]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...D(),l7]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",o7]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},d7]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[j]}],"gradient-via":[{via:[j]}],"gradient-to":[{to:[j]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[C]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[C]}],"divide-style":[{divide:z()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[to,en]}],"outline-w":[{outline:[to,nl]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[C]}],"ring-offset-w":[{"ring-offset":[to,nl]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",rl,u7]}],"shadow-color":[{shadow:[Pm]}],opacity:[{opacity:[C]}],"mix-blend":[{"mix-blend":[...J(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":J()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[s]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",rl,en]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[f]}],saturate:[{saturate:[N]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[C]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",en]}],duration:[{duration:W()}],ease:[{ease:["linear","in","out","in-out",en]}],delay:[{delay:W()}],animate:[{animate:["none","spin","ping","pulse","bounce",en]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[km,en]}],"translate-x":[{"translate-x":[R]}],"translate-y":[{"translate-y":[R]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",en]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",en]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",en]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[to,nl,lb]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},x7=XW(p7);function We(...t){return x7(rn(t))}const g7=sW,ML=v.forwardRef(({className:t,...n},r)=>e.jsx(mL,{ref:r,className:We("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...n}));ML.displayName=mL.displayName;const v7=$c("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),RL=v.forwardRef(({className:t,variant:n,...r},s)=>e.jsx(hL,{ref:s,className:We(v7({variant:n}),t),...r}));RL.displayName=hL.displayName;const y7=v.forwardRef(({className:t,...n},r)=>e.jsx(xL,{ref:r,className:We("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...n}));y7.displayName=xL.displayName;const DL=v.forwardRef(({className:t,...n},r)=>e.jsx(gL,{ref:r,className:We("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...n,children:e.jsx(rs,{className:"h-4 w-4"})}));DL.displayName=gL.displayName;const $L=v.forwardRef(({className:t,...n},r)=>e.jsx(fL,{ref:r,className:We("text-sm font-semibold",t),...n}));$L.displayName=fL.displayName;const FL=v.forwardRef(({className:t,...n},r)=>e.jsx(pL,{ref:r,className:We("text-sm opacity-90",t),...n}));FL.displayName=pL.displayName;function j7(){const{toasts:t}=Xt();return e.jsxs(g7,{children:[t.map(function({id:n,title:r,description:s,action:a,...i}){return e.jsxs(RL,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx($L,{children:r}),s&&e.jsx(FL,{children:s})]}),a,e.jsx(DL,{})]},n)}),e.jsx(ML,{})]})}var b7=SF[" useId ".trim().toString()]||(()=>{}),w7=0;function jr(t){const[n,r]=v.useState(b7());return wr(()=>{r(s=>s??String(w7++))},[t]),n?`radix-${n}`:""}const _7=["top","right","bottom","left"],jl=Math.min,fa=Math.max,kx=Math.round,Wp=Math.floor,Di=t=>({x:t,y:t}),N7={left:"right",right:"left",bottom:"top",top:"bottom"},S7={start:"end",end:"start"};function KN(t,n,r){return fa(t,jl(n,r))}function go(t,n){return typeof t=="function"?t(n):t}function vo(t){return t.split("-")[0]}function Du(t){return t.split("-")[1]}function rC(t){return t==="x"?"y":"x"}function sC(t){return t==="y"?"height":"width"}function bl(t){return["top","bottom"].includes(vo(t))?"y":"x"}function aC(t){return rC(bl(t))}function C7(t,n,r){r===void 0&&(r=!1);const s=Du(t),a=aC(t),i=sC(a);let o=a==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return n.reference[i]>n.floating[i]&&(o=Px(o)),[o,Px(o)]}function k7(t){const n=Px(t);return[WN(t),n,WN(n)]}function WN(t){return t.replace(/start|end/g,n=>S7[n])}function P7(t,n,r){const s=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?n?a:s:n?s:a;case"left":case"right":return n?i:o;default:return[]}}function A7(t,n,r,s){const a=Du(t);let i=P7(vo(t),r==="start",s);return a&&(i=i.map(o=>o+"-"+a),n&&(i=i.concat(i.map(WN)))),i}function Px(t){return t.replace(/left|right|bottom|top/g,n=>N7[n])}function E7(t){return{top:0,right:0,bottom:0,left:0,...t}}function LL(t){return typeof t!="number"?E7(t):{top:t,right:t,bottom:t,left:t}}function Ax(t){const{x:n,y:r,width:s,height:a}=t;return{width:s,height:a,top:r,left:n,right:n+s,bottom:r+a,x:n,y:r}}function gE(t,n,r){let{reference:s,floating:a}=t;const i=bl(n),o=aC(n),c=sC(o),u=vo(n),m=i==="y",h=s.x+s.width/2-a.width/2,f=s.y+s.height/2-a.height/2,x=s[c]/2-a[c]/2;let j;switch(u){case"top":j={x:h,y:s.y-a.height};break;case"bottom":j={x:h,y:s.y+s.height};break;case"right":j={x:s.x+s.width,y:f};break;case"left":j={x:s.x-a.width,y:f};break;default:j={x:s.x,y:s.y}}switch(Du(n)){case"start":j[o]-=x*(r&&m?-1:1);break;case"end":j[o]+=x*(r&&m?-1:1);break}return j}const O7=async(t,n,r)=>{const{placement:s="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,c=i.filter(Boolean),u=await(o.isRTL==null?void 0:o.isRTL(n));let m=await o.getElementRects({reference:t,floating:n,strategy:a}),{x:h,y:f}=gE(m,s,u),x=s,j={},b=0;for(let g=0;g<c.length;g++){const{name:y,fn:C}=c[g],{x:k,y:N,data:P,reset:w}=await C({x:h,y:f,initialPlacement:s,placement:x,strategy:a,middlewareData:j,rects:m,platform:o,elements:{reference:t,floating:n}});h=k??h,f=N??f,j={...j,[y]:{...j[y],...P}},w&&b<=50&&(b++,typeof w=="object"&&(w.placement&&(x=w.placement),w.rects&&(m=w.rects===!0?await o.getElementRects({reference:t,floating:n,strategy:a}):w.rects),{x:h,y:f}=gE(m,x,u)),g=-1)}return{x:h,y:f,placement:x,strategy:a,middlewareData:j}};async function ph(t,n){var r;n===void 0&&(n={});const{x:s,y:a,platform:i,rects:o,elements:c,strategy:u}=t,{boundary:m="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:x=!1,padding:j=0}=go(n,t),b=LL(j),y=c[x?f==="floating"?"reference":"floating":f],C=Ax(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(y)))==null||r?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(c.floating)),boundary:m,rootBoundary:h,strategy:u})),k=f==="floating"?{x:s,y:a,width:o.floating.width,height:o.floating.height}:o.reference,N=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c.floating)),P=await(i.isElement==null?void 0:i.isElement(N))?await(i.getScale==null?void 0:i.getScale(N))||{x:1,y:1}:{x:1,y:1},w=Ax(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:k,offsetParent:N,strategy:u}):k);return{top:(C.top-w.top+b.top)/P.y,bottom:(w.bottom-C.bottom+b.bottom)/P.y,left:(C.left-w.left+b.left)/P.x,right:(w.right-C.right+b.right)/P.x}}const T7=t=>({name:"arrow",options:t,async fn(n){const{x:r,y:s,placement:a,rects:i,platform:o,elements:c,middlewareData:u}=n,{element:m,padding:h=0}=go(t,n)||{};if(m==null)return{};const f=LL(h),x={x:r,y:s},j=aC(a),b=sC(j),g=await o.getDimensions(m),y=j==="y",C=y?"top":"left",k=y?"bottom":"right",N=y?"clientHeight":"clientWidth",P=i.reference[b]+i.reference[j]-x[j]-i.floating[b],w=x[j]-i.reference[j],S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(m));let E=S?S[N]:0;(!E||!await(o.isElement==null?void 0:o.isElement(S)))&&(E=c.floating[N]||i.floating[b]);const R=P/2-w/2,T=E/2-g[b]/2-1,U=jl(f[C],T),M=jl(f[k],T),L=U,q=E-g[b]-M,$=E/2-g[b]/2+R,D=KN(L,$,q),z=!u.arrow&&Du(a)!=null&&$!==D&&i.reference[b]/2-($<L?U:M)-g[b]/2<0,J=z?$<L?$-L:$-q:0;return{[j]:x[j]+J,data:{[j]:D,centerOffset:$-D-J,...z&&{alignmentOffset:J}},reset:z}}}),M7=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(n){var r,s;const{placement:a,middlewareData:i,rects:o,initialPlacement:c,platform:u,elements:m}=n,{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:x,fallbackStrategy:j="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:g=!0,...y}=go(t,n);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const C=vo(a),k=bl(c),N=vo(c)===c,P=await(u.isRTL==null?void 0:u.isRTL(m.floating)),w=x||(N||!g?[Px(c)]:k7(c)),S=b!=="none";!x&&S&&w.push(...A7(c,g,b,P));const E=[c,...w],R=await ph(n,y),T=[];let U=((s=i.flip)==null?void 0:s.overflows)||[];if(h&&T.push(R[C]),f){const $=C7(a,o,P);T.push(R[$[0]],R[$[1]])}if(U=[...U,{placement:a,overflows:T}],!T.every($=>$<=0)){var M,L;const $=(((M=i.flip)==null?void 0:M.index)||0)+1,D=E[$];if(D)return{data:{index:$,overflows:U},reset:{placement:D}};let z=(L=U.filter(J=>J.overflows[0]<=0).sort((J,I)=>J.overflows[1]-I.overflows[1])[0])==null?void 0:L.placement;if(!z)switch(j){case"bestFit":{var q;const J=(q=U.filter(I=>{if(S){const X=bl(I.placement);return X===k||X==="y"}return!0}).map(I=>[I.placement,I.overflows.filter(X=>X>0).reduce((X,ne)=>X+ne,0)]).sort((I,X)=>I[1]-X[1])[0])==null?void 0:q[0];J&&(z=J);break}case"initialPlacement":z=c;break}if(a!==z)return{reset:{placement:z}}}return{}}}};function vE(t,n){return{top:t.top-n.height,right:t.right-n.width,bottom:t.bottom-n.height,left:t.left-n.width}}function yE(t){return _7.some(n=>t[n]>=0)}const R7=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(n){const{rects:r}=n,{strategy:s="referenceHidden",...a}=go(t,n);switch(s){case"referenceHidden":{const i=await ph(n,{...a,elementContext:"reference"}),o=vE(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:yE(o)}}}case"escaped":{const i=await ph(n,{...a,altBoundary:!0}),o=vE(i,r.floating);return{data:{escapedOffsets:o,escaped:yE(o)}}}default:return{}}}}};async function D7(t,n){const{placement:r,platform:s,elements:a}=t,i=await(s.isRTL==null?void 0:s.isRTL(a.floating)),o=vo(r),c=Du(r),u=bl(r)==="y",m=["left","top"].includes(o)?-1:1,h=i&&u?-1:1,f=go(n,t);let{mainAxis:x,crossAxis:j,alignmentAxis:b}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return c&&typeof b=="number"&&(j=c==="end"?b*-1:b),u?{x:j*h,y:x*m}:{x:x*m,y:j*h}}const $7=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(n){var r,s;const{x:a,y:i,placement:o,middlewareData:c}=n,u=await D7(n,t);return o===((r=c.offset)==null?void 0:r.placement)&&(s=c.arrow)!=null&&s.alignmentOffset?{}:{x:a+u.x,y:i+u.y,data:{...u,placement:o}}}}},F7=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(n){const{x:r,y:s,placement:a}=n,{mainAxis:i=!0,crossAxis:o=!1,limiter:c={fn:y=>{let{x:C,y:k}=y;return{x:C,y:k}}},...u}=go(t,n),m={x:r,y:s},h=await ph(n,u),f=bl(vo(a)),x=rC(f);let j=m[x],b=m[f];if(i){const y=x==="y"?"top":"left",C=x==="y"?"bottom":"right",k=j+h[y],N=j-h[C];j=KN(k,j,N)}if(o){const y=f==="y"?"top":"left",C=f==="y"?"bottom":"right",k=b+h[y],N=b-h[C];b=KN(k,b,N)}const g=c.fn({...n,[x]:j,[f]:b});return{...g,data:{x:g.x-r,y:g.y-s,enabled:{[x]:i,[f]:o}}}}}},L7=function(t){return t===void 0&&(t={}),{options:t,fn(n){const{x:r,y:s,placement:a,rects:i,middlewareData:o}=n,{offset:c=0,mainAxis:u=!0,crossAxis:m=!0}=go(t,n),h={x:r,y:s},f=bl(a),x=rC(f);let j=h[x],b=h[f];const g=go(c,n),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(u){const N=x==="y"?"height":"width",P=i.reference[x]-i.floating[N]+y.mainAxis,w=i.reference[x]+i.reference[N]-y.mainAxis;j<P?j=P:j>w&&(j=w)}if(m){var C,k;const N=x==="y"?"width":"height",P=["top","left"].includes(vo(a)),w=i.reference[f]-i.floating[N]+(P&&((C=o.offset)==null?void 0:C[f])||0)+(P?0:y.crossAxis),S=i.reference[f]+i.reference[N]+(P?0:((k=o.offset)==null?void 0:k[f])||0)-(P?y.crossAxis:0);b<w?b=w:b>S&&(b=S)}return{[x]:j,[f]:b}}}},I7=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(n){var r,s;const{placement:a,rects:i,platform:o,elements:c}=n,{apply:u=()=>{},...m}=go(t,n),h=await ph(n,m),f=vo(a),x=Du(a),j=bl(a)==="y",{width:b,height:g}=i.floating;let y,C;f==="top"||f==="bottom"?(y=f,C=x===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(C=f,y=x==="end"?"top":"bottom");const k=g-h.top-h.bottom,N=b-h.left-h.right,P=jl(g-h[y],k),w=jl(b-h[C],N),S=!n.middlewareData.shift;let E=P,R=w;if((r=n.middlewareData.shift)!=null&&r.enabled.x&&(R=N),(s=n.middlewareData.shift)!=null&&s.enabled.y&&(E=k),S&&!x){const U=fa(h.left,0),M=fa(h.right,0),L=fa(h.top,0),q=fa(h.bottom,0);j?R=b-2*(U!==0||M!==0?U+M:fa(h.left,h.right)):E=g-2*(L!==0||q!==0?L+q:fa(h.top,h.bottom))}await u({...n,availableWidth:R,availableHeight:E});const T=await o.getDimensions(c.floating);return b!==T.width||g!==T.height?{reset:{rects:!0}}:{}}}};function tv(){return typeof window<"u"}function $u(t){return IL(t)?(t.nodeName||"").toLowerCase():"#document"}function ga(t){var n;return(t==null||(n=t.ownerDocument)==null?void 0:n.defaultView)||window}function Vi(t){var n;return(n=(IL(t)?t.ownerDocument:t.document)||window.document)==null?void 0:n.documentElement}function IL(t){return tv()?t instanceof Node||t instanceof ga(t).Node:!1}function pi(t){return tv()?t instanceof Element||t instanceof ga(t).Element:!1}function Ii(t){return tv()?t instanceof HTMLElement||t instanceof ga(t).HTMLElement:!1}function jE(t){return!tv()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof ga(t).ShadowRoot}function gf(t){const{overflow:n,overflowX:r,overflowY:s,display:a}=xi(t);return/auto|scroll|overlay|hidden|clip/.test(n+s+r)&&!["inline","contents"].includes(a)}function q7(t){return["table","td","th"].includes($u(t))}function nv(t){return[":popover-open",":modal"].some(n=>{try{return t.matches(n)}catch{return!1}})}function iC(t){const n=oC(),r=pi(t)?xi(t):t;return["transform","translate","scale","rotate","perspective"].some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!n&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!n&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(r.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(r.contain||"").includes(s))}function B7(t){let n=wl(t);for(;Ii(n)&&!Hd(n);){if(iC(n))return n;if(nv(n))return null;n=wl(n)}return null}function oC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Hd(t){return["html","body","#document"].includes($u(t))}function xi(t){return ga(t).getComputedStyle(t)}function rv(t){return pi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function wl(t){if($u(t)==="html")return t;const n=t.assignedSlot||t.parentNode||jE(t)&&t.host||Vi(t);return jE(n)?n.host:n}function qL(t){const n=wl(t);return Hd(n)?t.ownerDocument?t.ownerDocument.body:t.body:Ii(n)&&gf(n)?n:qL(n)}function xh(t,n,r){var s;n===void 0&&(n=[]),r===void 0&&(r=!0);const a=qL(t),i=a===((s=t.ownerDocument)==null?void 0:s.body),o=ga(a);if(i){const c=HN(o);return n.concat(o,o.visualViewport||[],gf(a)?a:[],c&&r?xh(c):[])}return n.concat(a,xh(a,[],r))}function HN(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function BL(t){const n=xi(t);let r=parseFloat(n.width)||0,s=parseFloat(n.height)||0;const a=Ii(t),i=a?t.offsetWidth:r,o=a?t.offsetHeight:s,c=kx(r)!==i||kx(s)!==o;return c&&(r=i,s=o),{width:r,height:s,$:c}}function lC(t){return pi(t)?t:t.contextElement}function Ld(t){const n=lC(t);if(!Ii(n))return Di(1);const r=n.getBoundingClientRect(),{width:s,height:a,$:i}=BL(n);let o=(i?kx(r.width):r.width)/s,c=(i?kx(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const z7=Di(0);function zL(t){const n=ga(t);return!oC()||!n.visualViewport?z7:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function V7(t,n,r){return n===void 0&&(n=!1),!r||n&&r!==ga(t)?!1:n}function bc(t,n,r,s){n===void 0&&(n=!1),r===void 0&&(r=!1);const a=t.getBoundingClientRect(),i=lC(t);let o=Di(1);n&&(s?pi(s)&&(o=Ld(s)):o=Ld(t));const c=V7(i,r,s)?zL(i):Di(0);let u=(a.left+c.x)/o.x,m=(a.top+c.y)/o.y,h=a.width/o.x,f=a.height/o.y;if(i){const x=ga(i),j=s&&pi(s)?ga(s):s;let b=x,g=HN(b);for(;g&&s&&j!==b;){const y=Ld(g),C=g.getBoundingClientRect(),k=xi(g),N=C.left+(g.clientLeft+parseFloat(k.paddingLeft))*y.x,P=C.top+(g.clientTop+parseFloat(k.paddingTop))*y.y;u*=y.x,m*=y.y,h*=y.x,f*=y.y,u+=N,m+=P,b=ga(g),g=HN(b)}}return Ax({width:h,height:f,x:u,y:m})}function cC(t,n){const r=rv(t).scrollLeft;return n?n.left+r:bc(Vi(t)).left+r}function VL(t,n,r){r===void 0&&(r=!1);const s=t.getBoundingClientRect(),a=s.left+n.scrollLeft-(r?0:cC(t,s)),i=s.top+n.scrollTop;return{x:a,y:i}}function U7(t){let{elements:n,rect:r,offsetParent:s,strategy:a}=t;const i=a==="fixed",o=Vi(s),c=n?nv(n.floating):!1;if(s===o||c&&i)return r;let u={scrollLeft:0,scrollTop:0},m=Di(1);const h=Di(0),f=Ii(s);if((f||!f&&!i)&&(($u(s)!=="body"||gf(o))&&(u=rv(s)),Ii(s))){const j=bc(s);m=Ld(s),h.x=j.x+s.clientLeft,h.y=j.y+s.clientTop}const x=o&&!f&&!i?VL(o,u,!0):Di(0);return{width:r.width*m.x,height:r.height*m.y,x:r.x*m.x-u.scrollLeft*m.x+h.x+x.x,y:r.y*m.y-u.scrollTop*m.y+h.y+x.y}}function K7(t){return Array.from(t.getClientRects())}function W7(t){const n=Vi(t),r=rv(t),s=t.ownerDocument.body,a=fa(n.scrollWidth,n.clientWidth,s.scrollWidth,s.clientWidth),i=fa(n.scrollHeight,n.clientHeight,s.scrollHeight,s.clientHeight);let o=-r.scrollLeft+cC(t);const c=-r.scrollTop;return xi(s).direction==="rtl"&&(o+=fa(n.clientWidth,s.clientWidth)-a),{width:a,height:i,x:o,y:c}}function H7(t,n){const r=ga(t),s=Vi(t),a=r.visualViewport;let i=s.clientWidth,o=s.clientHeight,c=0,u=0;if(a){i=a.width,o=a.height;const m=oC();(!m||m&&n==="fixed")&&(c=a.offsetLeft,u=a.offsetTop)}return{width:i,height:o,x:c,y:u}}function G7(t,n){const r=bc(t,!0,n==="fixed"),s=r.top+t.clientTop,a=r.left+t.clientLeft,i=Ii(t)?Ld(t):Di(1),o=t.clientWidth*i.x,c=t.clientHeight*i.y,u=a*i.x,m=s*i.y;return{width:o,height:c,x:u,y:m}}function bE(t,n,r){let s;if(n==="viewport")s=H7(t,r);else if(n==="document")s=W7(Vi(t));else if(pi(n))s=G7(n,r);else{const a=zL(t);s={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Ax(s)}function UL(t,n){const r=wl(t);return r===n||!pi(r)||Hd(r)?!1:xi(r).position==="fixed"||UL(r,n)}function Y7(t,n){const r=n.get(t);if(r)return r;let s=xh(t,[],!1).filter(c=>pi(c)&&$u(c)!=="body"),a=null;const i=xi(t).position==="fixed";let o=i?wl(t):t;for(;pi(o)&&!Hd(o);){const c=xi(o),u=iC(o);!u&&c.position==="fixed"&&(a=null),(i?!u&&!a:!u&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||gf(o)&&!u&&UL(t,o))?s=s.filter(h=>h!==o):a=c,o=wl(o)}return n.set(t,s),s}function Q7(t){let{element:n,boundary:r,rootBoundary:s,strategy:a}=t;const o=[...r==="clippingAncestors"?nv(n)?[]:Y7(n,this._c):[].concat(r),s],c=o[0],u=o.reduce((m,h)=>{const f=bE(n,h,a);return m.top=fa(f.top,m.top),m.right=jl(f.right,m.right),m.bottom=jl(f.bottom,m.bottom),m.left=fa(f.left,m.left),m},bE(n,c,a));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function X7(t){const{width:n,height:r}=BL(t);return{width:n,height:r}}function Z7(t,n,r){const s=Ii(n),a=Vi(n),i=r==="fixed",o=bc(t,!0,i,n);let c={scrollLeft:0,scrollTop:0};const u=Di(0);if(s||!s&&!i)if(($u(n)!=="body"||gf(a))&&(c=rv(n)),s){const x=bc(n,!0,i,n);u.x=x.x+n.clientLeft,u.y=x.y+n.clientTop}else a&&(u.x=cC(a));const m=a&&!s&&!i?VL(a,c):Di(0),h=o.left+c.scrollLeft-u.x-m.x,f=o.top+c.scrollTop-u.y-m.y;return{x:h,y:f,width:o.width,height:o.height}}function cb(t){return xi(t).position==="static"}function wE(t,n){if(!Ii(t)||xi(t).position==="fixed")return null;if(n)return n(t);let r=t.offsetParent;return Vi(t)===r&&(r=r.ownerDocument.body),r}function KL(t,n){const r=ga(t);if(nv(t))return r;if(!Ii(t)){let a=wl(t);for(;a&&!Hd(a);){if(pi(a)&&!cb(a))return a;a=wl(a)}return r}let s=wE(t,n);for(;s&&q7(s)&&cb(s);)s=wE(s,n);return s&&Hd(s)&&cb(s)&&!iC(s)?r:s||B7(t)||r}const J7=async function(t){const n=this.getOffsetParent||KL,r=this.getDimensions,s=await r(t.floating);return{reference:Z7(t.reference,await n(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function eH(t){return xi(t).direction==="rtl"}const tH={convertOffsetParentRelativeRectToViewportRelativeRect:U7,getDocumentElement:Vi,getClippingRect:Q7,getOffsetParent:KL,getElementRects:J7,getClientRects:K7,getDimensions:X7,getScale:Ld,isElement:pi,isRTL:eH};function WL(t,n){return t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height}function nH(t,n){let r=null,s;const a=Vi(t);function i(){var c;clearTimeout(s),(c=r)==null||c.disconnect(),r=null}function o(c,u){c===void 0&&(c=!1),u===void 0&&(u=1),i();const m=t.getBoundingClientRect(),{left:h,top:f,width:x,height:j}=m;if(c||n(),!x||!j)return;const b=Wp(f),g=Wp(a.clientWidth-(h+x)),y=Wp(a.clientHeight-(f+j)),C=Wp(h),N={rootMargin:-b+"px "+-g+"px "+-y+"px "+-C+"px",threshold:fa(0,jl(1,u))||1};let P=!0;function w(S){const E=S[0].intersectionRatio;if(E!==u){if(!P)return o();E?o(!1,E):s=setTimeout(()=>{o(!1,1e-7)},1e3)}E===1&&!WL(m,t.getBoundingClientRect())&&o(),P=!1}try{r=new IntersectionObserver(w,{...N,root:a.ownerDocument})}catch{r=new IntersectionObserver(w,N)}r.observe(t)}return o(!0),i}function rH(t,n,r,s){s===void 0&&(s={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:u=!1}=s,m=lC(t),h=a||i?[...m?xh(m):[],...xh(n)]:[];h.forEach(C=>{a&&C.addEventListener("scroll",r,{passive:!0}),i&&C.addEventListener("resize",r)});const f=m&&c?nH(m,r):null;let x=-1,j=null;o&&(j=new ResizeObserver(C=>{let[k]=C;k&&k.target===m&&j&&(j.unobserve(n),cancelAnimationFrame(x),x=requestAnimationFrame(()=>{var N;(N=j)==null||N.observe(n)})),r()}),m&&!u&&j.observe(m),j.observe(n));let b,g=u?bc(t):null;u&&y();function y(){const C=bc(t);g&&!WL(g,C)&&r(),g=C,b=requestAnimationFrame(y)}return r(),()=>{var C;h.forEach(k=>{a&&k.removeEventListener("scroll",r),i&&k.removeEventListener("resize",r)}),f?.(),(C=j)==null||C.disconnect(),j=null,u&&cancelAnimationFrame(b)}}const sH=$7,aH=F7,iH=M7,oH=I7,lH=R7,_E=T7,cH=L7,dH=(t,n,r)=>{const s=new Map,a={platform:tH,...r},i={...a.platform,_c:s};return O7(t,n,{...a,platform:i})};var gx=typeof document<"u"?v.useLayoutEffect:v.useEffect;function Ex(t,n){if(t===n)return!0;if(typeof t!=typeof n)return!1;if(typeof t=="function"&&t.toString()===n.toString())return!0;let r,s,a;if(t&&n&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==n.length)return!1;for(s=r;s--!==0;)if(!Ex(t[s],n[s]))return!1;return!0}if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(n,a[s]))return!1;for(s=r;s--!==0;){const i=a[s];if(!(i==="_owner"&&t.$$typeof)&&!Ex(t[i],n[i]))return!1}return!0}return t!==t&&n!==n}function HL(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function NE(t,n){const r=HL(t);return Math.round(n*r)/r}function db(t){const n=v.useRef(t);return gx(()=>{n.current=t}),n}function uH(t){t===void 0&&(t={});const{placement:n="bottom",strategy:r="absolute",middleware:s=[],platform:a,elements:{reference:i,floating:o}={},transform:c=!0,whileElementsMounted:u,open:m}=t,[h,f]=v.useState({x:0,y:0,strategy:r,placement:n,middlewareData:{},isPositioned:!1}),[x,j]=v.useState(s);Ex(x,s)||j(s);const[b,g]=v.useState(null),[y,C]=v.useState(null),k=v.useCallback(I=>{I!==S.current&&(S.current=I,g(I))},[]),N=v.useCallback(I=>{I!==E.current&&(E.current=I,C(I))},[]),P=i||b,w=o||y,S=v.useRef(null),E=v.useRef(null),R=v.useRef(h),T=u!=null,U=db(u),M=db(a),L=db(m),q=v.useCallback(()=>{if(!S.current||!E.current)return;const I={placement:n,strategy:r,middleware:x};M.current&&(I.platform=M.current),dH(S.current,E.current,I).then(X=>{const ne={...X,isPositioned:L.current!==!1};$.current&&!Ex(R.current,ne)&&(R.current=ne,Ou.flushSync(()=>{f(ne)}))})},[x,n,r,M,L]);gx(()=>{m===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,f(I=>({...I,isPositioned:!1})))},[m]);const $=v.useRef(!1);gx(()=>($.current=!0,()=>{$.current=!1}),[]),gx(()=>{if(P&&(S.current=P),w&&(E.current=w),P&&w){if(U.current)return U.current(P,w,q);q()}},[P,w,q,U,T]);const D=v.useMemo(()=>({reference:S,floating:E,setReference:k,setFloating:N}),[k,N]),z=v.useMemo(()=>({reference:P,floating:w}),[P,w]),J=v.useMemo(()=>{const I={position:r,left:0,top:0};if(!z.floating)return I;const X=NE(z.floating,h.x),ne=NE(z.floating,h.y);return c?{...I,transform:"translate("+X+"px, "+ne+"px)",...HL(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:X,top:ne}},[r,c,z.floating,h.x,h.y]);return v.useMemo(()=>({...h,update:q,refs:D,elements:z,floatingStyles:J}),[h,q,D,z,J])}const mH=t=>{function n(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:s,padding:a}=typeof t=="function"?t(r):t;return s&&n(s)?s.current!=null?_E({element:s.current,padding:a}).fn(r):{}:s?_E({element:s,padding:a}).fn(r):{}}}},hH=(t,n)=>({...sH(t),options:[t,n]}),fH=(t,n)=>({...aH(t),options:[t,n]}),pH=(t,n)=>({...cH(t),options:[t,n]}),xH=(t,n)=>({...iH(t),options:[t,n]}),gH=(t,n)=>({...oH(t),options:[t,n]}),vH=(t,n)=>({...lH(t),options:[t,n]}),yH=(t,n)=>({...mH(t),options:[t,n]});var jH="Arrow",GL=v.forwardRef((t,n)=>{const{children:r,width:s=10,height:a=5,...i}=t;return e.jsx(gt.svg,{...i,ref:n,width:s,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});GL.displayName=jH;var bH=GL;function dC(t){const[n,r]=v.useState(void 0);return wr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,c;if("borderBoxSize"in i){const u=i.borderBoxSize,m=Array.isArray(u)?u[0]:u;o=m.inlineSize,c=m.blockSize}else o=t.offsetWidth,c=t.offsetHeight;r({width:o,height:c})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else r(void 0)},[t]),n}var uC="Popper",[YL,Al]=Kr(uC),[wH,QL]=YL(uC),XL=t=>{const{__scopePopper:n,children:r}=t,[s,a]=v.useState(null);return e.jsx(wH,{scope:n,anchor:s,onAnchorChange:a,children:r})};XL.displayName=uC;var ZL="PopperAnchor",JL=v.forwardRef((t,n)=>{const{__scopePopper:r,virtualRef:s,...a}=t,i=QL(ZL,r),o=v.useRef(null),c=cn(n,o);return v.useEffect(()=>{i.onAnchorChange(s?.current||o.current)}),s?null:e.jsx(gt.div,{...a,ref:c})});JL.displayName=ZL;var mC="PopperContent",[_H,NH]=YL(mC),eI=v.forwardRef((t,n)=>{const{__scopePopper:r,side:s="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:u=!0,collisionBoundary:m=[],collisionPadding:h=0,sticky:f="partial",hideWhenDetached:x=!1,updatePositionStrategy:j="optimized",onPlaced:b,...g}=t,y=QL(mC,r),[C,k]=v.useState(null),N=cn(n,Ce=>k(Ce)),[P,w]=v.useState(null),S=dC(P),E=S?.width??0,R=S?.height??0,T=s+(i!=="center"?"-"+i:""),U=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},M=Array.isArray(m)?m:[m],L=M.length>0,q={padding:U,boundary:M.filter(CH),altBoundary:L},{refs:$,floatingStyles:D,placement:z,isPositioned:J,middlewareData:I}=uH({strategy:"fixed",placement:T,whileElementsMounted:(...Ce)=>rH(...Ce,{animationFrame:j==="always"}),elements:{reference:y.anchor},middleware:[hH({mainAxis:a+R,alignmentAxis:o}),u&&fH({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?pH():void 0,...q}),u&&xH({...q}),gH({...q,apply:({elements:Ce,rects:Y,availableWidth:ie,availableHeight:Ee})=>{const{width:Ke,height:Te}=Y.reference,ct=Ce.floating.style;ct.setProperty("--radix-popper-available-width",`${ie}px`),ct.setProperty("--radix-popper-available-height",`${Ee}px`),ct.setProperty("--radix-popper-anchor-width",`${Ke}px`),ct.setProperty("--radix-popper-anchor-height",`${Te}px`)}}),P&&yH({element:P,padding:c}),kH({arrowWidth:E,arrowHeight:R}),x&&vH({strategy:"referenceHidden",...q})]}),[X,ne]=rI(z),W=ss(b);wr(()=>{J&&W?.()},[J,W]);const H=I.arrow?.x,fe=I.arrow?.y,Pe=I.arrow?.centerOffset!==0,[Re,Ie]=v.useState();return wr(()=>{C&&Ie(window.getComputedStyle(C).zIndex)},[C]),e.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...D,transform:J?D.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Re,"--radix-popper-transform-origin":[I.transformOrigin?.x,I.transformOrigin?.y].join(" "),...I.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(_H,{scope:r,placedSide:X,onArrowChange:w,arrowX:H,arrowY:fe,shouldHideArrow:Pe,children:e.jsx(gt.div,{"data-side":X,"data-align":ne,...g,ref:N,style:{...g.style,animation:J?void 0:"none"}})})})});eI.displayName=mC;var tI="PopperArrow",SH={top:"bottom",right:"left",bottom:"top",left:"right"},nI=v.forwardRef(function(n,r){const{__scopePopper:s,...a}=n,i=NH(tI,s),o=SH[i.placedSide];return e.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:e.jsx(bH,{...a,ref:r,style:{...a.style,display:"block"}})})});nI.displayName=tI;function CH(t){return t!==null}var kH=t=>({name:"transformOrigin",options:t,fn(n){const{placement:r,rects:s,middlewareData:a}=n,o=a.arrow?.centerOffset!==0,c=o?0:t.arrowWidth,u=o?0:t.arrowHeight,[m,h]=rI(r),f={start:"0%",center:"50%",end:"100%"}[h],x=(a.arrow?.x??0)+c/2,j=(a.arrow?.y??0)+u/2;let b="",g="";return m==="bottom"?(b=o?f:`${x}px`,g=`${-u}px`):m==="top"?(b=o?f:`${x}px`,g=`${s.floating.height+u}px`):m==="right"?(b=`${-u}px`,g=o?f:`${j}px`):m==="left"&&(b=`${s.floating.width+u}px`,g=o?f:`${j}px`),{data:{x:b,y:g}}}});function rI(t){const[n,r="center"]=t.split("-");return[n,r]}var sv=XL,vf=JL,av=eI,iv=nI,[ov]=Kr("Tooltip",[Al]),lv=Al(),sI="TooltipProvider",PH=700,GN="tooltip.open",[AH,hC]=ov(sI),aI=t=>{const{__scopeTooltip:n,delayDuration:r=PH,skipDelayDuration:s=300,disableHoverableContent:a=!1,children:i}=t,o=v.useRef(!0),c=v.useRef(!1),u=v.useRef(0);return v.useEffect(()=>{const m=u.current;return()=>window.clearTimeout(m)},[]),e.jsx(AH,{scope:n,isOpenDelayedRef:o,delayDuration:r,onOpen:v.useCallback(()=>{window.clearTimeout(u.current),o.current=!1},[]),onClose:v.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>o.current=!0,s)},[s]),isPointerInTransitRef:c,onPointerInTransitChange:v.useCallback(m=>{c.current=m},[]),disableHoverableContent:a,children:i})};aI.displayName=sI;var cv="Tooltip",[EH,dv]=ov(cv),iI=t=>{const{__scopeTooltip:n,children:r,open:s,defaultOpen:a=!1,onOpenChange:i,disableHoverableContent:o,delayDuration:c}=t,u=hC(cv,t.__scopeTooltip),m=lv(n),[h,f]=v.useState(null),x=jr(),j=v.useRef(0),b=o??u.disableHoverableContent,g=c??u.delayDuration,y=v.useRef(!1),[C=!1,k]=Zs({prop:s,defaultProp:a,onChange:E=>{E?(u.onOpen(),document.dispatchEvent(new CustomEvent(GN))):u.onClose(),i?.(E)}}),N=v.useMemo(()=>C?y.current?"delayed-open":"instant-open":"closed",[C]),P=v.useCallback(()=>{window.clearTimeout(j.current),j.current=0,y.current=!1,k(!0)},[k]),w=v.useCallback(()=>{window.clearTimeout(j.current),j.current=0,k(!1)},[k]),S=v.useCallback(()=>{window.clearTimeout(j.current),j.current=window.setTimeout(()=>{y.current=!0,k(!0),j.current=0},g)},[g,k]);return v.useEffect(()=>()=>{j.current&&(window.clearTimeout(j.current),j.current=0)},[]),e.jsx(sv,{...m,children:e.jsx(EH,{scope:n,contentId:x,open:C,stateAttribute:N,trigger:h,onTriggerChange:f,onTriggerEnter:v.useCallback(()=>{u.isOpenDelayedRef.current?S():P()},[u.isOpenDelayedRef,S,P]),onTriggerLeave:v.useCallback(()=>{b?w():(window.clearTimeout(j.current),j.current=0)},[w,b]),onOpen:P,onClose:w,disableHoverableContent:b,children:r})})};iI.displayName=cv;var YN="TooltipTrigger",oI=v.forwardRef((t,n)=>{const{__scopeTooltip:r,...s}=t,a=dv(YN,r),i=hC(YN,r),o=lv(r),c=v.useRef(null),u=cn(n,c,a.onTriggerChange),m=v.useRef(!1),h=v.useRef(!1),f=v.useCallback(()=>m.current=!1,[]);return v.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),e.jsx(vf,{asChild:!0,...o,children:e.jsx(gt.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...s,ref:u,onPointerMove:ot(t.onPointerMove,x=>{x.pointerType!=="touch"&&!h.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),h.current=!0)}),onPointerLeave:ot(t.onPointerLeave,()=>{a.onTriggerLeave(),h.current=!1}),onPointerDown:ot(t.onPointerDown,()=>{a.open&&a.onClose(),m.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:ot(t.onFocus,()=>{m.current||a.onOpen()}),onBlur:ot(t.onBlur,a.onClose),onClick:ot(t.onClick,a.onClose)})})});oI.displayName=YN;var OH="TooltipPortal",[Ibe,TH]=ov(OH,{forceMount:void 0}),Gd="TooltipContent",lI=v.forwardRef((t,n)=>{const r=TH(Gd,t.__scopeTooltip),{forceMount:s=r.forceMount,side:a="top",...i}=t,o=dv(Gd,t.__scopeTooltip);return e.jsx(Rs,{present:s||o.open,children:o.disableHoverableContent?e.jsx(cI,{side:a,...i,ref:n}):e.jsx(MH,{side:a,...i,ref:n})})}),MH=v.forwardRef((t,n)=>{const r=dv(Gd,t.__scopeTooltip),s=hC(Gd,t.__scopeTooltip),a=v.useRef(null),i=cn(n,a),[o,c]=v.useState(null),{trigger:u,onClose:m}=r,h=a.current,{onPointerInTransitChange:f}=s,x=v.useCallback(()=>{c(null),f(!1)},[f]),j=v.useCallback((b,g)=>{const y=b.currentTarget,C={x:b.clientX,y:b.clientY},k=LH(C,y.getBoundingClientRect()),N=IH(C,k),P=qH(g.getBoundingClientRect()),w=zH([...N,...P]);c(w),f(!0)},[f]);return v.useEffect(()=>()=>x(),[x]),v.useEffect(()=>{if(u&&h){const b=y=>j(y,h),g=y=>j(y,u);return u.addEventListener("pointerleave",b),h.addEventListener("pointerleave",g),()=>{u.removeEventListener("pointerleave",b),h.removeEventListener("pointerleave",g)}}},[u,h,j,x]),v.useEffect(()=>{if(o){const b=g=>{const y=g.target,C={x:g.clientX,y:g.clientY},k=u?.contains(y)||h?.contains(y),N=!BH(C,o);k?x():N&&(x(),m())};return document.addEventListener("pointermove",b),()=>document.removeEventListener("pointermove",b)}},[u,h,o,m,x]),e.jsx(cI,{...t,ref:i})}),[RH,DH]=ov(cv,{isInside:!1}),$H=YF("TooltipContent"),cI=v.forwardRef((t,n)=>{const{__scopeTooltip:r,children:s,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=t,u=dv(Gd,r),m=lv(r),{onClose:h}=u;return v.useEffect(()=>(document.addEventListener(GN,h),()=>document.removeEventListener(GN,h)),[h]),v.useEffect(()=>{if(u.trigger){const f=x=>{x.target?.contains(u.trigger)&&h()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[u.trigger,h]),e.jsx(Dc,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:h,children:e.jsxs(av,{"data-state":u.stateAttribute,...m,...c,ref:n,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx($H,{children:s}),e.jsx(RH,{scope:r,isInside:!0,children:e.jsx(qK,{id:u.contentId,role:"tooltip",children:a||s})})]})})});lI.displayName=Gd;var dI="TooltipArrow",FH=v.forwardRef((t,n)=>{const{__scopeTooltip:r,...s}=t,a=lv(r);return DH(dI,r).isInside?null:e.jsx(iv,{...a,...s,ref:n})});FH.displayName=dI;function LH(t,n){const r=Math.abs(n.top-t.y),s=Math.abs(n.bottom-t.y),a=Math.abs(n.right-t.x),i=Math.abs(n.left-t.x);switch(Math.min(r,s,a,i)){case i:return"left";case a:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function IH(t,n,r=5){const s=[];switch(n){case"top":s.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":s.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":s.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":s.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return s}function qH(t){const{top:n,right:r,bottom:s,left:a}=t;return[{x:a,y:n},{x:r,y:n},{x:r,y:s},{x:a,y:s}]}function BH(t,n){const{x:r,y:s}=t;let a=!1;for(let i=0,o=n.length-1;i<n.length;o=i++){const c=n[i].x,u=n[i].y,m=n[o].x,h=n[o].y;u>s!=h>s&&r<(m-c)*(s-u)/(h-u)+c&&(a=!a)}return a}function zH(t){const n=t.slice();return n.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),VH(n)}function VH(t){if(t.length<=1)return t.slice();const n=[];for(let s=0;s<t.length;s++){const a=t[s];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))n.pop();else break}n.push(a)}n.pop();const r=[];for(let s=t.length-1;s>=0;s--){const a=t[s];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),n.length===1&&r.length===1&&n[0].x===r[0].x&&n[0].y===r[0].y?n:n.concat(r)}var UH=aI,KH=iI,WH=oI,uI=lI;const mI=UH,HH=KH,GH=WH,hI=v.forwardRef(({className:t,sideOffset:n=4,...r},s)=>e.jsx(uI,{ref:s,sideOffset:n,className:We("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...r}));hI.displayName=uI.displayName;async function YH(){const t=await fetch("/api/auth/user",{credentials:"include"});if(t.status===401)return null;if(!t.ok)throw new Error(`${t.status}: ${t.statusText}`);const n=await t.json();return n?.user||n}function No(){const t=gs(),{data:n,isLoading:r}=$e({queryKey:["/api/auth/user"],queryFn:YH,retry:(a,i)=>i instanceof Error&&i.message.includes("401")?!1:a<3,retryDelay:a=>Math.min(1e3*2**a,1e4),staleTime:1e3*60*5,gcTime:1e3*60*10}),s=Le({mutationFn:async()=>{await Be("POST","/api/auth/logout")},onSuccess:()=>{t.setQueryData(["/api/auth/user"],null),t.removeQueries({predicate:a=>{const i=a.queryKey;return!(Array.isArray(i)&&i[0]==="/api/auth/user")}})}});return{user:n,isLoading:r,isAuthenticated:!!n,logout:s.mutate,isLoggingOut:s.isPending}}const Ox={platform_name:"BANKY",support_email:"",theme_primary_color:"#2563eb",theme_secondary_color:"#64748b",theme_accent_color:"#10b981",theme_sidebar_color:"#1e293b"},fI=v.createContext(Ox);async function QH(){const t=await fetch("/api/public/branding");if(!t.ok)return Ox;const n=await t.json();return{...Ox,...n}}function XH({children:t}){const{data:n}=$e({queryKey:["branding"],queryFn:QH,staleTime:3e5});return e.jsx(fI.Provider,{value:n||Ox,children:t})}function El(){return v.useContext(fI)}const oe=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:We("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",t),...n}));oe.displayName="Card";const we=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:We("flex flex-col space-y-1.5 p-6",t),...n}));we.displayName="CardHeader";const _e=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:We("text-2xl font-semibold leading-none tracking-tight",t),...n}));_e.displayName="CardTitle";const dt=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:We("text-sm text-muted-foreground",t),...n}));dt.displayName="CardDescription";const de=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:We("p-6 pt-0",t),...n}));de.displayName="CardContent";const ZH=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:We("flex items-center p-6 pt-0",t),...n}));ZH.displayName="CardFooter";function SE(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(oe,{className:"w-full max-w-md mx-4",children:e.jsxs(de,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(La,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}var yf=t=>t.type==="checkbox",oc=t=>t instanceof Date,_s=t=>t==null;const pI=t=>typeof t=="object";var hr=t=>!_s(t)&&!Array.isArray(t)&&pI(t)&&!oc(t),xI=t=>hr(t)&&t.target?yf(t.target)?t.target.checked:t.target.value:t,JH=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,gI=(t,n)=>t.has(JH(n)),eG=t=>{const n=t.constructor&&t.constructor.prototype;return hr(n)&&n.hasOwnProperty("isPrototypeOf")},fC=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Jr(t){let n;const r=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)n=new Date(t);else if(t instanceof Set)n=new Set(t);else if(!(fC&&(t instanceof Blob||s))&&(r||hr(t)))if(n=r?[]:{},!r&&!eG(t))n=t;else for(const a in t)t.hasOwnProperty(a)&&(n[a]=Jr(t[a]));else return t;return n}var uv=t=>Array.isArray(t)?t.filter(Boolean):[],mr=t=>t===void 0,ht=(t,n,r)=>{if(!n||!hr(t))return r;const s=uv(n.split(/[,[\].]+?/)).reduce((a,i)=>_s(a)?a:a[i],t);return mr(s)||s===t?mr(t[n])?r:t[n]:s},ha=t=>typeof t=="boolean",pC=t=>/^\w*$/.test(t),vI=t=>uv(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Cn=(t,n,r)=>{let s=-1;const a=pC(n)?[n]:vI(n),i=a.length,o=i-1;for(;++s<i;){const c=a[s];let u=r;if(s!==o){const m=t[c];u=hr(m)||Array.isArray(m)?m:isNaN(+a[s+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=u,t=t[c]}};const Tx={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ii={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},no={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},yI=le.createContext(null),mv=()=>le.useContext(yI),tG=t=>{const{children:n,...r}=t;return le.createElement(yI.Provider,{value:r},n)};var jI=(t,n,r,s=!0)=>{const a={defaultValues:n._defaultValues};for(const i in t)Object.defineProperty(a,i,{get:()=>{const o=i;return n._proxyFormState[o]!==ii.all&&(n._proxyFormState[o]=!s||ii.all),r&&(r[o]=!0),t[o]}});return a};function nG(t){const n=mv(),{control:r=n.control,disabled:s,name:a,exact:i}=t||{},[o,c]=le.useState(r._formState),u=le.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),m=le.useRef(a);return m.current=a,le.useEffect(()=>r._subscribe({name:m.current,formState:u.current,exact:i,callback:h=>{!s&&c({...r._formState,...h})}}),[r,s,i]),le.useEffect(()=>{u.current.isValid&&r._setValid(!0)},[r]),le.useMemo(()=>jI(o,r,u.current,!1),[o,r])}var Ti=t=>typeof t=="string",bI=(t,n,r,s,a)=>Ti(t)?(s&&n.watch.add(t),ht(r,t,a)):Array.isArray(t)?t.map(i=>(s&&n.watch.add(i),ht(r,i))):(s&&(n.watchAll=!0),r);function rG(t){const n=mv(),{control:r=n.control,name:s,defaultValue:a,disabled:i,exact:o}=t||{},c=le.useRef(s),u=le.useRef(a);c.current=s,le.useEffect(()=>r._subscribe({name:c.current,formState:{values:!0},exact:o,callback:f=>!i&&h(bI(c.current,r._names,f.values||r._formValues,!1,u.current))}),[r,i,o]);const[m,h]=le.useState(r._getWatch(s,a));return le.useEffect(()=>r._removeUnmounted()),m}function sG(t){const n=mv(),{name:r,disabled:s,control:a=n.control,shouldUnregister:i}=t,o=gI(a._names.array,r),c=rG({control:a,name:r,defaultValue:ht(a._formValues,r,ht(a._defaultValues,r,t.defaultValue)),exact:!0}),u=nG({control:a,name:r,exact:!0}),m=le.useRef(t),h=le.useRef(a.register(r,{...t.rules,value:c,...ha(t.disabled)?{disabled:t.disabled}:{}})),f=le.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ht(u.errors,r)},isDirty:{enumerable:!0,get:()=>!!ht(u.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!ht(u.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!ht(u.validatingFields,r)},error:{enumerable:!0,get:()=>ht(u.errors,r)}}),[u,r]),x=le.useCallback(y=>h.current.onChange({target:{value:xI(y),name:r},type:Tx.CHANGE}),[r]),j=le.useCallback(()=>h.current.onBlur({target:{value:ht(a._formValues,r),name:r},type:Tx.BLUR}),[r,a._formValues]),b=le.useCallback(y=>{const C=ht(a._fields,r);C&&y&&(C._f.ref={focus:()=>y.focus(),select:()=>y.select(),setCustomValidity:k=>y.setCustomValidity(k),reportValidity:()=>y.reportValidity()})},[a._fields,r]),g=le.useMemo(()=>({name:r,value:c,...ha(s)||u.disabled?{disabled:u.disabled||s}:{},onChange:x,onBlur:j,ref:b}),[r,s,u.disabled,x,j,b,c]);return le.useEffect(()=>{const y=a._options.shouldUnregister||i;a.register(r,{...m.current.rules,...ha(m.current.disabled)?{disabled:m.current.disabled}:{}});const C=(k,N)=>{const P=ht(a._fields,k);P&&P._f&&(P._f.mount=N)};if(C(r,!0),y){const k=Jr(ht(a._options.defaultValues,r));Cn(a._defaultValues,r,k),mr(ht(a._formValues,r))&&Cn(a._formValues,r,k)}return!o&&a.register(r),()=>{(o?y&&!a._state.action:y)?a.unregister(r):C(r,!1)}},[r,a,o,i]),le.useEffect(()=>{a._setDisabledField({disabled:s,name:r})},[s,r,a]),le.useMemo(()=>({field:g,formState:u,fieldState:f}),[g,u,f])}const aG=t=>t.render(sG(t));var wI=(t,n,r,s,a)=>n?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[s]:a||!0}}:{},th=t=>Array.isArray(t)?t:[t],CE=()=>{let t=[];return{get observers(){return t},next:a=>{for(const i of t)i.next&&i.next(a)},subscribe:a=>(t.push(a),{unsubscribe:()=>{t=t.filter(i=>i!==a)}}),unsubscribe:()=>{t=[]}}},QN=t=>_s(t)||!pI(t);function dl(t,n){if(QN(t)||QN(n))return t===n;if(oc(t)&&oc(n))return t.getTime()===n.getTime();const r=Object.keys(t),s=Object.keys(n);if(r.length!==s.length)return!1;for(const a of r){const i=t[a];if(!s.includes(a))return!1;if(a!=="ref"){const o=n[a];if(oc(i)&&oc(o)||hr(i)&&hr(o)||Array.isArray(i)&&Array.isArray(o)?!dl(i,o):i!==o)return!1}}return!0}var ws=t=>hr(t)&&!Object.keys(t).length,xC=t=>t.type==="file",oi=t=>typeof t=="function",Mx=t=>{if(!fC)return!1;const n=t?t.ownerDocument:0;return t instanceof(n&&n.defaultView?n.defaultView.HTMLElement:HTMLElement)},_I=t=>t.type==="select-multiple",gC=t=>t.type==="radio",iG=t=>gC(t)||yf(t),ub=t=>Mx(t)&&t.isConnected;function oG(t,n){const r=n.slice(0,-1).length;let s=0;for(;s<r;)t=mr(t)?s++:t[n[s++]];return t}function lG(t){for(const n in t)if(t.hasOwnProperty(n)&&!mr(t[n]))return!1;return!0}function Mr(t,n){const r=Array.isArray(n)?n:pC(n)?[n]:vI(n),s=r.length===1?t:oG(t,r),a=r.length-1,i=r[a];return s&&delete s[i],a!==0&&(hr(s)&&ws(s)||Array.isArray(s)&&lG(s))&&Mr(t,r.slice(0,-1)),t}var NI=t=>{for(const n in t)if(oi(t[n]))return!0;return!1};function Rx(t,n={}){const r=Array.isArray(t);if(hr(t)||r)for(const s in t)Array.isArray(t[s])||hr(t[s])&&!NI(t[s])?(n[s]=Array.isArray(t[s])?[]:{},Rx(t[s],n[s])):_s(t[s])||(n[s]=!0);return n}function SI(t,n,r){const s=Array.isArray(t);if(hr(t)||s)for(const a in t)Array.isArray(t[a])||hr(t[a])&&!NI(t[a])?mr(n)||QN(r[a])?r[a]=Array.isArray(t[a])?Rx(t[a],[]):{...Rx(t[a])}:SI(t[a],_s(n)?{}:n[a],r[a]):r[a]=!dl(t[a],n[a]);return r}var Am=(t,n)=>SI(t,n,Rx(n));const kE={value:!1,isValid:!1},PE={value:!0,isValid:!0};var CI=t=>{if(Array.isArray(t)){if(t.length>1){const n=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:n,isValid:!!n.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!mr(t[0].attributes.value)?mr(t[0].value)||t[0].value===""?PE:{value:t[0].value,isValid:!0}:PE:kE}return kE},kI=(t,{valueAsNumber:n,valueAsDate:r,setValueAs:s})=>mr(t)?t:n?t===""?NaN:t&&+t:r&&Ti(t)?new Date(t):s?s(t):t;const AE={isValid:!1,value:null};var PI=t=>Array.isArray(t)?t.reduce((n,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:n,AE):AE;function EE(t){const n=t.ref;return xC(n)?n.files:gC(n)?PI(t.refs).value:_I(n)?[...n.selectedOptions].map(({value:r})=>r):yf(n)?CI(t.refs).value:kI(mr(n.value)?t.ref.value:n.value,t)}var cG=(t,n,r,s)=>{const a={};for(const i of t){const o=ht(n,i);o&&Cn(a,i,o._f)}return{criteriaMode:r,names:[...t],fields:a,shouldUseNativeValidation:s}},Dx=t=>t instanceof RegExp,Em=t=>mr(t)?t:Dx(t)?t.source:hr(t)?Dx(t.value)?t.value.source:t.value:t,OE=t=>({isOnSubmit:!t||t===ii.onSubmit,isOnBlur:t===ii.onBlur,isOnChange:t===ii.onChange,isOnAll:t===ii.all,isOnTouch:t===ii.onTouched});const TE="AsyncFunction";var dG=t=>!!t&&!!t.validate&&!!(oi(t.validate)&&t.validate.constructor.name===TE||hr(t.validate)&&Object.values(t.validate).find(n=>n.constructor.name===TE)),uG=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),ME=(t,n,r)=>!r&&(n.watchAll||n.watch.has(t)||[...n.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const nh=(t,n,r,s)=>{for(const a of r||Object.keys(t)){const i=ht(t,a);if(i){const{_f:o,...c}=i;if(o){if(o.refs&&o.refs[0]&&n(o.refs[0],a)&&!s)return!0;if(o.ref&&n(o.ref,o.name)&&!s)return!0;if(nh(c,n))break}else if(hr(c)&&nh(c,n))break}}};function RE(t,n,r){const s=ht(t,r);if(s||pC(r))return{error:s,name:r};const a=r.split(".");for(;a.length;){const i=a.join("."),o=ht(n,i),c=ht(t,i);if(o&&!Array.isArray(o)&&r!==i)return{name:r};if(c&&c.type)return{name:i,error:c};a.pop()}return{name:r}}var mG=(t,n,r,s)=>{r(t);const{name:a,...i}=t;return ws(i)||Object.keys(i).length>=Object.keys(n).length||Object.keys(i).find(o=>n[o]===(!s||ii.all))},hG=(t,n,r)=>!t||!n||t===n||th(t).some(s=>s&&(r?s===n:s.startsWith(n)||n.startsWith(s))),fG=(t,n,r,s,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(n||t):(r?s.isOnBlur:a.isOnBlur)?!t:(r?s.isOnChange:a.isOnChange)?t:!0,pG=(t,n)=>!uv(ht(t,n)).length&&Mr(t,n),xG=(t,n,r)=>{const s=th(ht(t,r));return Cn(s,"root",n[r]),Cn(t,r,s),t},vx=t=>Ti(t);function DE(t,n,r="validate"){if(vx(t)||Array.isArray(t)&&t.every(vx)||ha(t)&&!t)return{type:r,message:vx(t)?t:"",ref:n}}var hd=t=>hr(t)&&!Dx(t)?t:{value:t,message:""},$E=async(t,n,r,s,a,i)=>{const{ref:o,refs:c,required:u,maxLength:m,minLength:h,min:f,max:x,pattern:j,validate:b,name:g,valueAsNumber:y,mount:C}=t._f,k=ht(r,g);if(!C||n.has(g))return{};const N=c?c[0]:o,P=L=>{a&&N.reportValidity&&(N.setCustomValidity(ha(L)?"":L||""),N.reportValidity())},w={},S=gC(o),E=yf(o),R=S||E,T=(y||xC(o))&&mr(o.value)&&mr(k)||Mx(o)&&o.value===""||k===""||Array.isArray(k)&&!k.length,U=wI.bind(null,g,s,w),M=(L,q,$,D=no.maxLength,z=no.minLength)=>{const J=L?q:$;w[g]={type:L?D:z,message:J,ref:o,...U(L?D:z,J)}};if(i?!Array.isArray(k)||!k.length:u&&(!R&&(T||_s(k))||ha(k)&&!k||E&&!CI(c).isValid||S&&!PI(c).isValid)){const{value:L,message:q}=vx(u)?{value:!!u,message:u}:hd(u);if(L&&(w[g]={type:no.required,message:q,ref:N,...U(no.required,q)},!s))return P(q),w}if(!T&&(!_s(f)||!_s(x))){let L,q;const $=hd(x),D=hd(f);if(!_s(k)&&!isNaN(k)){const z=o.valueAsNumber||k&&+k;_s($.value)||(L=z>$.value),_s(D.value)||(q=z<D.value)}else{const z=o.valueAsDate||new Date(k),J=ne=>new Date(new Date().toDateString()+" "+ne),I=o.type=="time",X=o.type=="week";Ti($.value)&&k&&(L=I?J(k)>J($.value):X?k>$.value:z>new Date($.value)),Ti(D.value)&&k&&(q=I?J(k)<J(D.value):X?k<D.value:z<new Date(D.value))}if((L||q)&&(M(!!L,$.message,D.message,no.max,no.min),!s))return P(w[g].message),w}if((m||h)&&!T&&(Ti(k)||i&&Array.isArray(k))){const L=hd(m),q=hd(h),$=!_s(L.value)&&k.length>+L.value,D=!_s(q.value)&&k.length<+q.value;if(($||D)&&(M($,L.message,q.message),!s))return P(w[g].message),w}if(j&&!T&&Ti(k)){const{value:L,message:q}=hd(j);if(Dx(L)&&!k.match(L)&&(w[g]={type:no.pattern,message:q,ref:o,...U(no.pattern,q)},!s))return P(q),w}if(b){if(oi(b)){const L=await b(k,r),q=DE(L,N);if(q&&(w[g]={...q,...U(no.validate,q.message)},!s))return P(q.message),w}else if(hr(b)){let L={};for(const q in b){if(!ws(L)&&!s)break;const $=DE(await b[q](k,r),N,q);$&&(L={...$,...U(q,$.message)},P($.message),s&&(w[g]=L))}if(!ws(L)&&(w[g]={ref:N,...L},!s))return w}}return P(!0),w};const gG={mode:ii.onSubmit,reValidateMode:ii.onChange,shouldFocusError:!0};function vG(t={}){let n={...gG,...t},r={submitCount:0,isDirty:!1,isLoading:oi(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1};const s={};let a=hr(n.defaultValues)||hr(n.values)?Jr(n.values||n.defaultValues)||{}:{},i=n.shouldUnregister?{}:Jr(a),o={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...h};const x={array:CE(),state:CE()},j=OE(n.mode),b=OE(n.reValidateMode),g=n.criteriaMode===ii.all,y=Z=>xe=>{clearTimeout(m),m=setTimeout(Z,xe)},C=async Z=>{if(!n.disabled&&(h.isValid||f.isValid||Z)){const xe=n.resolver?ws((await T()).errors):await M(s,!0);xe!==r.isValid&&x.state.next({isValid:xe})}},k=(Z,xe)=>{!n.disabled&&(h.isValidating||h.validatingFields||f.isValidating||f.validatingFields)&&((Z||Array.from(c.mount)).forEach(Ae=>{Ae&&(xe?Cn(r.validatingFields,Ae,xe):Mr(r.validatingFields,Ae))}),x.state.next({validatingFields:r.validatingFields,isValidating:!ws(r.validatingFields)}))},N=(Z,xe=[],Ae,Je,ae=!0,Me=!0)=>{if(Je&&Ae&&!n.disabled){if(o.action=!0,Me&&Array.isArray(ht(s,Z))){const lt=Ae(ht(s,Z),Je.argA,Je.argB);ae&&Cn(s,Z,lt)}if(Me&&Array.isArray(ht(r.errors,Z))){const lt=Ae(ht(r.errors,Z),Je.argA,Je.argB);ae&&Cn(r.errors,Z,lt),pG(r.errors,Z)}if((h.touchedFields||f.touchedFields)&&Me&&Array.isArray(ht(r.touchedFields,Z))){const lt=Ae(ht(r.touchedFields,Z),Je.argA,Je.argB);ae&&Cn(r.touchedFields,Z,lt)}(h.dirtyFields||f.dirtyFields)&&(r.dirtyFields=Am(a,i)),x.state.next({name:Z,isDirty:q(Z,xe),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Cn(i,Z,xe)},P=(Z,xe)=>{Cn(r.errors,Z,xe),x.state.next({errors:r.errors})},w=Z=>{r.errors=Z,x.state.next({errors:r.errors,isValid:!1})},S=(Z,xe,Ae,Je)=>{const ae=ht(s,Z);if(ae){const Me=ht(i,Z,mr(Ae)?ht(a,Z):Ae);mr(Me)||Je&&Je.defaultChecked||xe?Cn(i,Z,xe?Me:EE(ae._f)):z(Z,Me),o.mount&&C()}},E=(Z,xe,Ae,Je,ae)=>{let Me=!1,lt=!1;const Zt={name:Z};if(!n.disabled){if(!Ae||Je){(h.isDirty||f.isDirty)&&(lt=r.isDirty,r.isDirty=Zt.isDirty=q(),Me=lt!==Zt.isDirty);const sn=dl(ht(a,Z),xe);lt=!!ht(r.dirtyFields,Z),sn?Mr(r.dirtyFields,Z):Cn(r.dirtyFields,Z,!0),Zt.dirtyFields=r.dirtyFields,Me=Me||(h.dirtyFields||f.dirtyFields)&&lt!==!sn}if(Ae){const sn=ht(r.touchedFields,Z);sn||(Cn(r.touchedFields,Z,Ae),Zt.touchedFields=r.touchedFields,Me=Me||(h.touchedFields||f.touchedFields)&&sn!==Ae)}Me&&ae&&x.state.next(Zt)}return Me?Zt:{}},R=(Z,xe,Ae,Je)=>{const ae=ht(r.errors,Z),Me=(h.isValid||f.isValid)&&ha(xe)&&r.isValid!==xe;if(n.delayError&&Ae?(u=y(()=>P(Z,Ae)),u(n.delayError)):(clearTimeout(m),u=null,Ae?Cn(r.errors,Z,Ae):Mr(r.errors,Z)),(Ae?!dl(ae,Ae):ae)||!ws(Je)||Me){const lt={...Je,...Me&&ha(xe)?{isValid:xe}:{},errors:r.errors,name:Z};r={...r,...lt},x.state.next(lt)}},T=async Z=>{k(Z,!0);const xe=await n.resolver(i,n.context,cG(Z||c.mount,s,n.criteriaMode,n.shouldUseNativeValidation));return k(Z),xe},U=async Z=>{const{errors:xe}=await T(Z);if(Z)for(const Ae of Z){const Je=ht(xe,Ae);Je?Cn(r.errors,Ae,Je):Mr(r.errors,Ae)}else r.errors=xe;return xe},M=async(Z,xe,Ae={valid:!0})=>{for(const Je in Z){const ae=Z[Je];if(ae){const{_f:Me,...lt}=ae;if(Me){const Zt=c.array.has(Me.name),sn=ae._f&&dG(ae._f);sn&&h.validatingFields&&k([Je],!0);const _n=await $E(ae,c.disabled,i,g,n.shouldUseNativeValidation&&!xe,Zt);if(sn&&h.validatingFields&&k([Je]),_n[Me.name]&&(Ae.valid=!1,xe))break;!xe&&(ht(_n,Me.name)?Zt?xG(r.errors,_n,Me.name):Cn(r.errors,Me.name,_n[Me.name]):Mr(r.errors,Me.name))}!ws(lt)&&await M(lt,xe,Ae)}}return Ae.valid},L=()=>{for(const Z of c.unMount){const xe=ht(s,Z);xe&&(xe._f.refs?xe._f.refs.every(Ae=>!ub(Ae)):!ub(xe._f.ref))&&ie(Z)}c.unMount=new Set},q=(Z,xe)=>!n.disabled&&(Z&&xe&&Cn(i,Z,xe),!dl(H(),a)),$=(Z,xe,Ae)=>bI(Z,c,{...o.mount?i:mr(xe)?a:Ti(Z)?{[Z]:xe}:xe},Ae,xe),D=Z=>uv(ht(o.mount?i:a,Z,n.shouldUnregister?ht(a,Z,[]):[])),z=(Z,xe,Ae={})=>{const Je=ht(s,Z);let ae=xe;if(Je){const Me=Je._f;Me&&(!Me.disabled&&Cn(i,Z,kI(xe,Me)),ae=Mx(Me.ref)&&_s(xe)?"":xe,_I(Me.ref)?[...Me.ref.options].forEach(lt=>lt.selected=ae.includes(lt.value)):Me.refs?yf(Me.ref)?Me.refs.length>1?Me.refs.forEach(lt=>(!lt.defaultChecked||!lt.disabled)&&(lt.checked=Array.isArray(ae)?!!ae.find(Zt=>Zt===lt.value):ae===lt.value)):Me.refs[0]&&(Me.refs[0].checked=!!ae):Me.refs.forEach(lt=>lt.checked=lt.value===ae):xC(Me.ref)?Me.ref.value="":(Me.ref.value=ae,Me.ref.type||x.state.next({name:Z,values:Jr(i)})))}(Ae.shouldDirty||Ae.shouldTouch)&&E(Z,ae,Ae.shouldTouch,Ae.shouldDirty,!0),Ae.shouldValidate&&W(Z)},J=(Z,xe,Ae)=>{for(const Je in xe){const ae=xe[Je],Me=`${Z}.${Je}`,lt=ht(s,Me);(c.array.has(Z)||hr(ae)||lt&&!lt._f)&&!oc(ae)?J(Me,ae,Ae):z(Me,ae,Ae)}},I=(Z,xe,Ae={})=>{const Je=ht(s,Z),ae=c.array.has(Z),Me=Jr(xe);Cn(i,Z,Me),ae?(x.array.next({name:Z,values:Jr(i)}),(h.isDirty||h.dirtyFields||f.isDirty||f.dirtyFields)&&Ae.shouldDirty&&x.state.next({name:Z,dirtyFields:Am(a,i),isDirty:q(Z,Me)})):Je&&!Je._f&&!_s(Me)?J(Z,Me,Ae):z(Z,Me,Ae),ME(Z,c)&&x.state.next({...r}),x.state.next({name:o.mount?Z:void 0,values:Jr(i)})},X=async Z=>{o.mount=!0;const xe=Z.target;let Ae=xe.name,Je=!0;const ae=ht(s,Ae),Me=lt=>{Je=Number.isNaN(lt)||oc(lt)&&isNaN(lt.getTime())||dl(lt,ht(i,Ae,lt))};if(ae){let lt,Zt;const sn=xe.type?EE(ae._f):xI(Z),_n=Z.type===Tx.BLUR||Z.type===Tx.FOCUS_OUT,Ka=!uG(ae._f)&&!n.resolver&&!ht(r.errors,Ae)&&!ae._f.deps||fG(_n,ht(r.touchedFields,Ae),r.isSubmitted,b,j),Wa=ME(Ae,c,_n);Cn(i,Ae,sn),_n?(ae._f.onBlur&&ae._f.onBlur(Z),u&&u(0)):ae._f.onChange&&ae._f.onChange(Z);const Fs=E(Ae,sn,_n),Oo=!ws(Fs)||Wa;if(!_n&&x.state.next({name:Ae,type:Z.type,values:Jr(i)}),Ka)return(h.isValid||f.isValid)&&(n.mode==="onBlur"?_n&&C():_n||C()),Oo&&x.state.next({name:Ae,...Wa?{}:Fs});if(!_n&&Wa&&x.state.next({...r}),n.resolver){const{errors:ta}=await T([Ae]);if(Me(sn),Je){const Hr=RE(r.errors,s,Ae),Ls=RE(ta,s,Hr.name||Ae);lt=Ls.error,Ae=Ls.name,Zt=ws(ta)}}else k([Ae],!0),lt=(await $E(ae,c.disabled,i,g,n.shouldUseNativeValidation))[Ae],k([Ae]),Me(sn),Je&&(lt?Zt=!1:(h.isValid||f.isValid)&&(Zt=await M(s,!0)));Je&&(ae._f.deps&&W(ae._f.deps),R(Ae,Zt,lt,Fs))}},ne=(Z,xe)=>{if(ht(r.errors,xe)&&Z.focus)return Z.focus(),1},W=async(Z,xe={})=>{let Ae,Je;const ae=th(Z);if(n.resolver){const Me=await U(mr(Z)?Z:ae);Ae=ws(Me),Je=Z?!ae.some(lt=>ht(Me,lt)):Ae}else Z?(Je=(await Promise.all(ae.map(async Me=>{const lt=ht(s,Me);return await M(lt&&lt._f?{[Me]:lt}:lt)}))).every(Boolean),!(!Je&&!r.isValid)&&C()):Je=Ae=await M(s);return x.state.next({...!Ti(Z)||(h.isValid||f.isValid)&&Ae!==r.isValid?{}:{name:Z},...n.resolver||!Z?{isValid:Ae}:{},errors:r.errors}),xe.shouldFocus&&!Je&&nh(s,ne,Z?ae:c.mount),Je},H=Z=>{const xe={...o.mount?i:a};return mr(Z)?xe:Ti(Z)?ht(xe,Z):Z.map(Ae=>ht(xe,Ae))},fe=(Z,xe)=>({invalid:!!ht((xe||r).errors,Z),isDirty:!!ht((xe||r).dirtyFields,Z),error:ht((xe||r).errors,Z),isValidating:!!ht(r.validatingFields,Z),isTouched:!!ht((xe||r).touchedFields,Z)}),Pe=Z=>{Z&&th(Z).forEach(xe=>Mr(r.errors,xe)),x.state.next({errors:Z?r.errors:{}})},Re=(Z,xe,Ae)=>{const Je=(ht(s,Z,{_f:{}})._f||{}).ref,ae=ht(r.errors,Z)||{},{ref:Me,message:lt,type:Zt,...sn}=ae;Cn(r.errors,Z,{...sn,...xe,ref:Je}),x.state.next({name:Z,errors:r.errors,isValid:!1}),Ae&&Ae.shouldFocus&&Je&&Je.focus&&Je.focus()},Ie=(Z,xe)=>oi(Z)?x.state.subscribe({next:Ae=>Z($(void 0,xe),Ae)}):$(Z,xe,!0),Ce=Z=>x.state.subscribe({next:xe=>{hG(Z.name,xe.name,Z.exact)&&mG(xe,Z.formState||h,G,Z.reRenderRoot)&&Z.callback({values:{...i},...r,...xe})}}).unsubscribe,Y=Z=>(o.mount=!0,f={...f,...Z.formState},Ce({...Z,formState:f})),ie=(Z,xe={})=>{for(const Ae of Z?th(Z):c.mount)c.mount.delete(Ae),c.array.delete(Ae),xe.keepValue||(Mr(s,Ae),Mr(i,Ae)),!xe.keepError&&Mr(r.errors,Ae),!xe.keepDirty&&Mr(r.dirtyFields,Ae),!xe.keepTouched&&Mr(r.touchedFields,Ae),!xe.keepIsValidating&&Mr(r.validatingFields,Ae),!n.shouldUnregister&&!xe.keepDefaultValue&&Mr(a,Ae);x.state.next({values:Jr(i)}),x.state.next({...r,...xe.keepDirty?{isDirty:q()}:{}}),!xe.keepIsValid&&C()},Ee=({disabled:Z,name:xe})=>{(ha(Z)&&o.mount||Z||c.disabled.has(xe))&&(Z?c.disabled.add(xe):c.disabled.delete(xe))},Ke=(Z,xe={})=>{let Ae=ht(s,Z);const Je=ha(xe.disabled)||ha(n.disabled);return Cn(s,Z,{...Ae||{},_f:{...Ae&&Ae._f?Ae._f:{ref:{name:Z}},name:Z,mount:!0,...xe}}),c.mount.add(Z),Ae?Ee({disabled:ha(xe.disabled)?xe.disabled:n.disabled,name:Z}):S(Z,!0,xe.value),{...Je?{disabled:xe.disabled||n.disabled}:{},...n.progressive?{required:!!xe.required,min:Em(xe.min),max:Em(xe.max),minLength:Em(xe.minLength),maxLength:Em(xe.maxLength),pattern:Em(xe.pattern)}:{},name:Z,onChange:X,onBlur:X,ref:ae=>{if(ae){Ke(Z,xe),Ae=ht(s,Z);const Me=mr(ae.value)&&ae.querySelectorAll&&ae.querySelectorAll("input,select,textarea")[0]||ae,lt=iG(Me),Zt=Ae._f.refs||[];if(lt?Zt.find(sn=>sn===Me):Me===Ae._f.ref)return;Cn(s,Z,{_f:{...Ae._f,...lt?{refs:[...Zt.filter(ub),Me,...Array.isArray(ht(a,Z))?[{}]:[]],ref:{type:Me.type,name:Z}}:{ref:Me}}}),S(Z,!1,void 0,Me)}else Ae=ht(s,Z,{}),Ae._f&&(Ae._f.mount=!1),(n.shouldUnregister||xe.shouldUnregister)&&!(gI(c.array,Z)&&o.action)&&c.unMount.add(Z)}}},Te=()=>n.shouldFocusError&&nh(s,ne,c.mount),ct=Z=>{ha(Z)&&(x.state.next({disabled:Z}),nh(s,(xe,Ae)=>{const Je=ht(s,Ae);Je&&(xe.disabled=Je._f.disabled||Z,Array.isArray(Je._f.refs)&&Je._f.refs.forEach(ae=>{ae.disabled=Je._f.disabled||Z}))},0,!1))},ut=(Z,xe)=>async Ae=>{let Je;Ae&&(Ae.preventDefault&&Ae.preventDefault(),Ae.persist&&Ae.persist());let ae=Jr(i);if(x.state.next({isSubmitting:!0}),n.resolver){const{errors:Me,values:lt}=await T();r.errors=Me,ae=lt}else await M(s);if(c.disabled.size)for(const Me of c.disabled)Cn(ae,Me,void 0);if(Mr(r.errors,"root"),ws(r.errors)){x.state.next({errors:{}});try{await Z(ae,Ae)}catch(Me){Je=Me}}else xe&&await xe({...r.errors},Ae),Te(),setTimeout(Te);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ws(r.errors)&&!Je,submitCount:r.submitCount+1,errors:r.errors}),Je)throw Je},Dt=(Z,xe={})=>{ht(s,Z)&&(mr(xe.defaultValue)?I(Z,Jr(ht(a,Z))):(I(Z,xe.defaultValue),Cn(a,Z,Jr(xe.defaultValue))),xe.keepTouched||Mr(r.touchedFields,Z),xe.keepDirty||(Mr(r.dirtyFields,Z),r.isDirty=xe.defaultValue?q(Z,Jr(ht(a,Z))):q()),xe.keepError||(Mr(r.errors,Z),h.isValid&&C()),x.state.next({...r}))},be=(Z,xe={})=>{const Ae=Z?Jr(Z):a,Je=Jr(Ae),ae=ws(Z),Me=ae?a:Je;if(xe.keepDefaultValues||(a=Ae),!xe.keepValues){if(xe.keepDirtyValues){const lt=new Set([...c.mount,...Object.keys(Am(a,i))]);for(const Zt of Array.from(lt))ht(r.dirtyFields,Zt)?Cn(Me,Zt,ht(i,Zt)):I(Zt,ht(Me,Zt))}else{if(fC&&mr(Z))for(const lt of c.mount){const Zt=ht(s,lt);if(Zt&&Zt._f){const sn=Array.isArray(Zt._f.refs)?Zt._f.refs[0]:Zt._f.ref;if(Mx(sn)){const _n=sn.closest("form");if(_n){_n.reset();break}}}}for(const lt of c.mount)I(lt,ht(Me,lt))}i=Jr(Me),x.array.next({values:{...Me}}),x.state.next({values:{...Me}})}c={mount:xe.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!h.isValid||!!xe.keepIsValid||!!xe.keepDirtyValues,o.watch=!!n.shouldUnregister,x.state.next({submitCount:xe.keepSubmitCount?r.submitCount:0,isDirty:ae?!1:xe.keepDirty?r.isDirty:!!(xe.keepDefaultValues&&!dl(Z,a)),isSubmitted:xe.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:ae?{}:xe.keepDirtyValues?xe.keepDefaultValues&&i?Am(a,i):r.dirtyFields:xe.keepDefaultValues&&Z?Am(a,Z):xe.keepDirty?r.dirtyFields:{},touchedFields:xe.keepTouched?r.touchedFields:{},errors:xe.keepErrors?r.errors:{},isSubmitSuccessful:xe.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},pt=(Z,xe)=>be(oi(Z)?Z(i):Z,xe),te=(Z,xe={})=>{const Ae=ht(s,Z),Je=Ae&&Ae._f;if(Je){const ae=Je.refs?Je.refs[0]:Je.ref;ae.focus&&(ae.focus(),xe.shouldSelect&&oi(ae.select)&&ae.select())}},G=Z=>{r={...r,...Z}},Ue={control:{register:Ke,unregister:ie,getFieldState:fe,handleSubmit:ut,setError:Re,_subscribe:Ce,_runSchema:T,_getWatch:$,_getDirty:q,_setValid:C,_setFieldArray:N,_setDisabledField:Ee,_setErrors:w,_getFieldArray:D,_reset:be,_resetDefaultValues:()=>oi(n.defaultValues)&&n.defaultValues().then(Z=>{pt(Z,n.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:L,_disableForm:ct,_subjects:x,_proxyFormState:h,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(Z){o=Z},get _defaultValues(){return a},get _names(){return c},set _names(Z){c=Z},get _formState(){return r},get _options(){return n},set _options(Z){n={...n,...Z}}},subscribe:Y,trigger:W,register:Ke,handleSubmit:ut,watch:Ie,setValue:I,getValues:H,reset:pt,resetField:Dt,clearErrors:Pe,unregister:ie,setError:Re,setFocus:te,getFieldState:fe};return{...Ue,formControl:Ue}}function $n(t={}){const n=le.useRef(void 0),r=le.useRef(void 0),[s,a]=le.useState({isDirty:!1,isValidating:!1,isLoading:oi(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,defaultValues:oi(t.defaultValues)?void 0:t.defaultValues});n.current||(n.current={...t.formControl?t.formControl:vG(t),formState:s},t.formControl&&t.defaultValues&&!oi(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const i=n.current.control;return i._options=t,le.useLayoutEffect(()=>i._subscribe({formState:i._proxyFormState,callback:()=>a({...i._formState}),reRenderRoot:!0}),[i]),le.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),le.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),le.useEffect(()=>{t.values&&!dl(t.values,r.current)?(i._reset(t.values,i._options.resetOptions),r.current=t.values,a(o=>({...o}))):i._resetDefaultValues()},[t.values,i]),le.useEffect(()=>{t.errors&&!ws(t.errors)&&i._setErrors(t.errors)},[t.errors,i]),le.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),le.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[t.shouldUnregister,i]),n.current.formState=jI(s,i),n.current}const FE=(t,n,r)=>{if(t&&"reportValidity"in t){const s=ht(r,n);t.setCustomValidity(s&&s.message||""),t.reportValidity()}},AI=(t,n)=>{for(const r in n.fields){const s=n.fields[r];s&&s.ref&&"reportValidity"in s.ref?FE(s.ref,r,t):s.refs&&s.refs.forEach(a=>FE(a,r,t))}},yG=(t,n)=>{n.shouldUseNativeValidation&&AI(t,n);const r={};for(const s in t){const a=ht(n.fields,s),i=Object.assign(t[s]||{},{ref:a&&a.ref});if(jG(n.names||Object.keys(t),s)){const o=Object.assign({},ht(r,s));Cn(o,"root",i),Cn(r,s,o)}else Cn(r,s,i)}return r},jG=(t,n)=>t.some(r=>r.startsWith(n+"."));var bG=function(t,n){for(var r={};t.length;){var s=t[0],a=s.code,i=s.message,o=s.path.join(".");if(!r[o])if("unionErrors"in s){var c=s.unionErrors[0].errors[0];r[o]={message:c.message,type:c.code}}else r[o]={message:i,type:a};if("unionErrors"in s&&s.unionErrors.forEach(function(h){return h.errors.forEach(function(f){return t.push(f)})}),n){var u=r[o].types,m=u&&u[s.code];r[o]=wI(o,n,r,a,m?[].concat(m,s.message):s.message)}t.shift()}return r},Fn=function(t,n,r){return r===void 0&&(r={}),function(s,a,i){try{return Promise.resolve((function(o,c){try{var u=Promise.resolve(t[r.mode==="sync"?"parse":"parseAsync"](s,n)).then(function(m){return i.shouldUseNativeValidation&&AI({},i),{errors:{},values:r.raw?s:m}})}catch(m){return c(m)}return u&&u.then?u.then(void 0,c):u})(0,function(o){if((function(c){return Array.isArray(c?.errors)})(o))return{values:{},errors:yG(bG(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},gn;(function(t){t.assertEqual=a=>a;function n(a){}t.assertIs=n;function r(a){throw new Error}t.assertNever=r,t.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),o={};for(const c of i)o[c]=a[c];return t.objectValues(o)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},t.find=(a,i)=>{for(const o of a)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function s(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(gn||(gn={}));var XN;(function(t){t.mergeShapes=(n,r)=>({...n,...r})})(XN||(XN={}));const vt=gn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),io=t=>{switch(typeof t){case"undefined":return vt.undefined;case"string":return vt.string;case"number":return isNaN(t)?vt.nan:vt.number;case"boolean":return vt.boolean;case"function":return vt.function;case"bigint":return vt.bigint;case"symbol":return vt.symbol;case"object":return Array.isArray(t)?vt.array:t===null?vt.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?vt.promise:typeof Map<"u"&&t instanceof Map?vt.map:typeof Set<"u"&&t instanceof Set?vt.set:typeof Date<"u"&&t instanceof Date?vt.date:vt.object;default:return vt.unknown}},st=gn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),wG=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class va extends Error{get errors(){return this.issues}constructor(n){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=n}format(n){const r=n||function(i){return i.message},s={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)s._errors.push(r(o));else{let c=s,u=0;for(;u<o.path.length;){const m=o.path[u];u===o.path.length-1?(c[m]=c[m]||{_errors:[]},c[m]._errors.push(r(o))):c[m]=c[m]||{_errors:[]},c=c[m],u++}}};return a(this),s}static assert(n){if(!(n instanceof va))throw new Error(`Not a ZodError: ${n}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,gn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(n=r=>r.message){const r={},s=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(n(a))):s.push(n(a));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}}va.create=t=>new va(t);const Yd=(t,n)=>{let r;switch(t.code){case st.invalid_type:t.received===vt.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case st.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,gn.jsonStringifyReplacer)}`;break;case st.unrecognized_keys:r=`Unrecognized key(s) in object: ${gn.joinValues(t.keys,", ")}`;break;case st.invalid_union:r="Invalid input";break;case st.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${gn.joinValues(t.options)}`;break;case st.invalid_enum_value:r=`Invalid enum value. Expected ${gn.joinValues(t.options)}, received '${t.received}'`;break;case st.invalid_arguments:r="Invalid function arguments";break;case st.invalid_return_type:r="Invalid function return type";break;case st.invalid_date:r="Invalid date";break;case st.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:gn.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case st.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case st.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case st.custom:r="Invalid input";break;case st.invalid_intersection_types:r="Intersection results could not be merged";break;case st.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case st.not_finite:r="Number must be finite";break;default:r=n.defaultError,gn.assertNever(t)}return{message:r}};let EI=Yd;function _G(t){EI=t}function $x(){return EI}const Fx=t=>{const{data:n,path:r,errorMaps:s,issueData:a}=t,i=[...r,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const u=s.filter(m=>!!m).slice().reverse();for(const m of u)c=m(o,{data:n,defaultError:c}).message;return{...a,path:i,message:c}},NG=[];function ft(t,n){const r=$x(),s=Fx({issueData:n,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Yd?void 0:Yd].filter(a=>!!a)});t.common.issues.push(s)}class xs{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(n,r){const s=[];for(const a of r){if(a.status==="aborted")return Kt;a.status==="dirty"&&n.dirty(),s.push(a.value)}return{status:n.value,value:s}}static async mergeObjectAsync(n,r){const s=[];for(const a of r){const i=await a.key,o=await a.value;s.push({key:i,value:o})}return xs.mergeObjectSync(n,s)}static mergeObjectSync(n,r){const s={};for(const a of r){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return Kt;i.status==="dirty"&&n.dirty(),o.status==="dirty"&&n.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(s[i.value]=o.value)}return{status:n.value,value:s}}}const Kt=Object.freeze({status:"aborted"}),kd=t=>({status:"dirty",value:t}),Ms=t=>({status:"valid",value:t}),ZN=t=>t.status==="aborted",JN=t=>t.status==="dirty",wc=t=>t.status==="valid",gh=t=>typeof Promise<"u"&&t instanceof Promise;function Lx(t,n,r,s){if(typeof n=="function"?t!==n||!0:!n.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n.get(t)}function OI(t,n,r,s,a){if(typeof n=="function"?t!==n||!0:!n.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n.set(t,r),r}var Ot;(function(t){t.errToObj=n=>typeof n=="string"?{message:n}:n||{},t.toString=n=>typeof n=="string"?n:n?.message})(Ot||(Ot={}));var Km,Wm;class qi{constructor(n,r,s,a){this._cachedPath=[],this.parent=n,this.data=r,this._path=s,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const LE=(t,n)=>{if(wc(n))return{success:!0,data:n.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new va(t.common.issues);return this._error=r,this._error}}};function Jt(t){if(!t)return{};const{errorMap:n,invalid_type_error:r,required_error:s,description:a}=t;if(n&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return n?{errorMap:n,description:a}:{errorMap:(o,c)=>{var u,m;const{message:h}=t;return o.code==="invalid_enum_value"?{message:h??c.defaultError}:typeof c.data>"u"?{message:(u=h??s)!==null&&u!==void 0?u:c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:(m=h??r)!==null&&m!==void 0?m:c.defaultError}},description:a}}class an{get description(){return this._def.description}_getType(n){return io(n.data)}_getOrReturnCtx(n,r){return r||{common:n.parent.common,data:n.data,parsedType:io(n.data),schemaErrorMap:this._def.errorMap,path:n.path,parent:n.parent}}_processInputParams(n){return{status:new xs,ctx:{common:n.parent.common,data:n.data,parsedType:io(n.data),schemaErrorMap:this._def.errorMap,path:n.path,parent:n.parent}}}_parseSync(n){const r=this._parse(n);if(gh(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(n){const r=this._parse(n);return Promise.resolve(r)}parse(n,r){const s=this.safeParse(n,r);if(s.success)return s.data;throw s.error}safeParse(n,r){var s;const a={common:{issues:[],async:(s=r?.async)!==null&&s!==void 0?s:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:io(n)},i=this._parseSync({data:n,path:a.path,parent:a});return LE(a,i)}"~validate"(n){var r,s;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:io(n)};if(!this["~standard"].async)try{const i=this._parseSync({data:n,path:[],parent:a});return wc(i)?{value:i.value}:{issues:a.common.issues}}catch(i){!((s=(r=i?.message)===null||r===void 0?void 0:r.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:n,path:[],parent:a}).then(i=>wc(i)?{value:i.value}:{issues:a.common.issues})}async parseAsync(n,r){const s=await this.safeParseAsync(n,r);if(s.success)return s.data;throw s.error}async safeParseAsync(n,r){const s={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:io(n)},a=this._parse({data:n,path:s.path,parent:s}),i=await(gh(a)?a:Promise.resolve(a));return LE(s,i)}refine(n,r){const s=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{const o=n(a),c=()=>i.addIssue({code:st.custom,...s(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(n,r){return this._refinement((s,a)=>n(s)?!0:(a.addIssue(typeof r=="function"?r(s,a):r),!1))}_refinement(n){return new gi({schema:this,typeName:Ut.ZodEffects,effect:{type:"refinement",refinement:n}})}superRefine(n){return this._refinement(n)}constructor(n){this.spa=this.safeParseAsync,this._def=n,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return $i.create(this,this._def)}nullable(){return Cl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return hi.create(this)}promise(){return Xd.create(this,this._def)}or(n){return bh.create([this,n],this._def)}and(n){return wh.create(this,n,this._def)}transform(n){return new gi({...Jt(this._def),schema:this,typeName:Ut.ZodEffects,effect:{type:"transform",transform:n}})}default(n){const r=typeof n=="function"?n:()=>n;return new kh({...Jt(this._def),innerType:this,defaultValue:r,typeName:Ut.ZodDefault})}brand(){return new vC({typeName:Ut.ZodBranded,type:this,...Jt(this._def)})}catch(n){const r=typeof n=="function"?n:()=>n;return new Ph({...Jt(this._def),innerType:this,catchValue:r,typeName:Ut.ZodCatch})}describe(n){const r=this.constructor;return new r({...this._def,description:n})}pipe(n){return jf.create(this,n)}readonly(){return Ah.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const SG=/^c[^\s-]{8,}$/i,CG=/^[0-9a-z]+$/,kG=/^[0-9A-HJKMNP-TV-Z]{26}$/i,PG=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,AG=/^[a-z0-9_-]{21}$/i,EG=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,OG=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,TG=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,MG="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let mb;const RG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,DG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,$G=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,FG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,LG=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,IG=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,TI="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",qG=new RegExp(`^${TI}$`);function MI(t){let n="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?n=`${n}\\.\\d{${t.precision}}`:t.precision==null&&(n=`${n}(\\.\\d+)?`),n}function BG(t){return new RegExp(`^${MI(t)}$`)}function RI(t){let n=`${TI}T${MI(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),n=`${n}(${r.join("|")})`,new RegExp(`^${n}$`)}function zG(t,n){return!!((n==="v4"||!n)&&RG.test(t)||(n==="v6"||!n)&&$G.test(t))}function VG(t,n){if(!EG.test(t))return!1;try{const[r]=t.split("."),s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(s));return!(typeof a!="object"||a===null||!a.typ||!a.alg||n&&a.alg!==n)}catch{return!1}}function UG(t,n){return!!((n==="v4"||!n)&&DG.test(t)||(n==="v6"||!n)&&FG.test(t))}class ci extends an{_parse(n){if(this._def.coerce&&(n.data=String(n.data)),this._getType(n)!==vt.string){const i=this._getOrReturnCtx(n);return ft(i,{code:st.invalid_type,expected:vt.string,received:i.parsedType}),Kt}const s=new xs;let a;for(const i of this._def.checks)if(i.kind==="min")n.data.length<i.value&&(a=this._getOrReturnCtx(n,a),ft(a,{code:st.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")n.data.length>i.value&&(a=this._getOrReturnCtx(n,a),ft(a,{code:st.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=n.data.length>i.value,c=n.data.length<i.value;(o||c)&&(a=this._getOrReturnCtx(n,a),o?ft(a,{code:st.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&ft(a,{code:st.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")TG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"email",code:st.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")mb||(mb=new RegExp(MG,"u")),mb.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"emoji",code:st.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")PG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"uuid",code:st.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")AG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"nanoid",code:st.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")SG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"cuid",code:st.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")CG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"cuid2",code:st.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")kG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"ulid",code:st.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(n.data)}catch{a=this._getOrReturnCtx(n,a),ft(a,{validation:"url",code:st.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"regex",code:st.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?n.data=n.data.trim():i.kind==="includes"?n.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(n,a),ft(a,{code:st.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?n.data=n.data.toLowerCase():i.kind==="toUpperCase"?n.data=n.data.toUpperCase():i.kind==="startsWith"?n.data.startsWith(i.value)||(a=this._getOrReturnCtx(n,a),ft(a,{code:st.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?n.data.endsWith(i.value)||(a=this._getOrReturnCtx(n,a),ft(a,{code:st.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?RI(i).test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{code:st.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?qG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{code:st.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?BG(i).test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{code:st.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?OG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"duration",code:st.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?zG(n.data,i.version)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"ip",code:st.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?VG(n.data,i.alg)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"jwt",code:st.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?UG(n.data,i.version)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"cidr",code:st.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?LG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"base64",code:st.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?IG.test(n.data)||(a=this._getOrReturnCtx(n,a),ft(a,{validation:"base64url",code:st.invalid_string,message:i.message}),s.dirty()):gn.assertNever(i);return{status:s.value,value:n.data}}_regex(n,r,s){return this.refinement(a=>n.test(a),{validation:r,code:st.invalid_string,...Ot.errToObj(s)})}_addCheck(n){return new ci({...this._def,checks:[...this._def.checks,n]})}email(n){return this._addCheck({kind:"email",...Ot.errToObj(n)})}url(n){return this._addCheck({kind:"url",...Ot.errToObj(n)})}emoji(n){return this._addCheck({kind:"emoji",...Ot.errToObj(n)})}uuid(n){return this._addCheck({kind:"uuid",...Ot.errToObj(n)})}nanoid(n){return this._addCheck({kind:"nanoid",...Ot.errToObj(n)})}cuid(n){return this._addCheck({kind:"cuid",...Ot.errToObj(n)})}cuid2(n){return this._addCheck({kind:"cuid2",...Ot.errToObj(n)})}ulid(n){return this._addCheck({kind:"ulid",...Ot.errToObj(n)})}base64(n){return this._addCheck({kind:"base64",...Ot.errToObj(n)})}base64url(n){return this._addCheck({kind:"base64url",...Ot.errToObj(n)})}jwt(n){return this._addCheck({kind:"jwt",...Ot.errToObj(n)})}ip(n){return this._addCheck({kind:"ip",...Ot.errToObj(n)})}cidr(n){return this._addCheck({kind:"cidr",...Ot.errToObj(n)})}datetime(n){var r,s;return typeof n=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:n}):this._addCheck({kind:"datetime",precision:typeof n?.precision>"u"?null:n?.precision,offset:(r=n?.offset)!==null&&r!==void 0?r:!1,local:(s=n?.local)!==null&&s!==void 0?s:!1,...Ot.errToObj(n?.message)})}date(n){return this._addCheck({kind:"date",message:n})}time(n){return typeof n=="string"?this._addCheck({kind:"time",precision:null,message:n}):this._addCheck({kind:"time",precision:typeof n?.precision>"u"?null:n?.precision,...Ot.errToObj(n?.message)})}duration(n){return this._addCheck({kind:"duration",...Ot.errToObj(n)})}regex(n,r){return this._addCheck({kind:"regex",regex:n,...Ot.errToObj(r)})}includes(n,r){return this._addCheck({kind:"includes",value:n,position:r?.position,...Ot.errToObj(r?.message)})}startsWith(n,r){return this._addCheck({kind:"startsWith",value:n,...Ot.errToObj(r)})}endsWith(n,r){return this._addCheck({kind:"endsWith",value:n,...Ot.errToObj(r)})}min(n,r){return this._addCheck({kind:"min",value:n,...Ot.errToObj(r)})}max(n,r){return this._addCheck({kind:"max",value:n,...Ot.errToObj(r)})}length(n,r){return this._addCheck({kind:"length",value:n,...Ot.errToObj(r)})}nonempty(n){return this.min(1,Ot.errToObj(n))}trim(){return new ci({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ci({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ci({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(n=>n.kind==="datetime")}get isDate(){return!!this._def.checks.find(n=>n.kind==="date")}get isTime(){return!!this._def.checks.find(n=>n.kind==="time")}get isDuration(){return!!this._def.checks.find(n=>n.kind==="duration")}get isEmail(){return!!this._def.checks.find(n=>n.kind==="email")}get isURL(){return!!this._def.checks.find(n=>n.kind==="url")}get isEmoji(){return!!this._def.checks.find(n=>n.kind==="emoji")}get isUUID(){return!!this._def.checks.find(n=>n.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(n=>n.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(n=>n.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(n=>n.kind==="cuid2")}get isULID(){return!!this._def.checks.find(n=>n.kind==="ulid")}get isIP(){return!!this._def.checks.find(n=>n.kind==="ip")}get isCIDR(){return!!this._def.checks.find(n=>n.kind==="cidr")}get isBase64(){return!!this._def.checks.find(n=>n.kind==="base64")}get isBase64url(){return!!this._def.checks.find(n=>n.kind==="base64url")}get minLength(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxLength(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}}ci.create=t=>{var n;return new ci({checks:[],typeName:Ut.ZodString,coerce:(n=t?.coerce)!==null&&n!==void 0?n:!1,...Jt(t)})};function KG(t,n){const r=(t.toString().split(".")[1]||"").length,s=(n.toString().split(".")[1]||"").length,a=r>s?r:s,i=parseInt(t.toFixed(a).replace(".","")),o=parseInt(n.toFixed(a).replace(".",""));return i%o/Math.pow(10,a)}class _l extends an{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(n){if(this._def.coerce&&(n.data=Number(n.data)),this._getType(n)!==vt.number){const i=this._getOrReturnCtx(n);return ft(i,{code:st.invalid_type,expected:vt.number,received:i.parsedType}),Kt}let s;const a=new xs;for(const i of this._def.checks)i.kind==="int"?gn.isInteger(n.data)||(s=this._getOrReturnCtx(n,s),ft(s,{code:st.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?n.data<i.value:n.data<=i.value)&&(s=this._getOrReturnCtx(n,s),ft(s,{code:st.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?n.data>i.value:n.data>=i.value)&&(s=this._getOrReturnCtx(n,s),ft(s,{code:st.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?KG(n.data,i.value)!==0&&(s=this._getOrReturnCtx(n,s),ft(s,{code:st.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(n.data)||(s=this._getOrReturnCtx(n,s),ft(s,{code:st.not_finite,message:i.message}),a.dirty()):gn.assertNever(i);return{status:a.value,value:n.data}}gte(n,r){return this.setLimit("min",n,!0,Ot.toString(r))}gt(n,r){return this.setLimit("min",n,!1,Ot.toString(r))}lte(n,r){return this.setLimit("max",n,!0,Ot.toString(r))}lt(n,r){return this.setLimit("max",n,!1,Ot.toString(r))}setLimit(n,r,s,a){return new _l({...this._def,checks:[...this._def.checks,{kind:n,value:r,inclusive:s,message:Ot.toString(a)}]})}_addCheck(n){return new _l({...this._def,checks:[...this._def.checks,n]})}int(n){return this._addCheck({kind:"int",message:Ot.toString(n)})}positive(n){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ot.toString(n)})}negative(n){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ot.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ot.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ot.toString(n)})}multipleOf(n,r){return this._addCheck({kind:"multipleOf",value:n,message:Ot.toString(r)})}finite(n){return this._addCheck({kind:"finite",message:Ot.toString(n)})}safe(n){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ot.toString(n)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ot.toString(n)})}get minValue(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxValue(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}get isInt(){return!!this._def.checks.find(n=>n.kind==="int"||n.kind==="multipleOf"&&gn.isInteger(n.value))}get isFinite(){let n=null,r=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(n===null||s.value<n)&&(n=s.value)}return Number.isFinite(r)&&Number.isFinite(n)}}_l.create=t=>new _l({checks:[],typeName:Ut.ZodNumber,coerce:t?.coerce||!1,...Jt(t)});class Nl extends an{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(n){if(this._def.coerce)try{n.data=BigInt(n.data)}catch{return this._getInvalidInput(n)}if(this._getType(n)!==vt.bigint)return this._getInvalidInput(n);let s;const a=new xs;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?n.data<i.value:n.data<=i.value)&&(s=this._getOrReturnCtx(n,s),ft(s,{code:st.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?n.data>i.value:n.data>=i.value)&&(s=this._getOrReturnCtx(n,s),ft(s,{code:st.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?n.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(n,s),ft(s,{code:st.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):gn.assertNever(i);return{status:a.value,value:n.data}}_getInvalidInput(n){const r=this._getOrReturnCtx(n);return ft(r,{code:st.invalid_type,expected:vt.bigint,received:r.parsedType}),Kt}gte(n,r){return this.setLimit("min",n,!0,Ot.toString(r))}gt(n,r){return this.setLimit("min",n,!1,Ot.toString(r))}lte(n,r){return this.setLimit("max",n,!0,Ot.toString(r))}lt(n,r){return this.setLimit("max",n,!1,Ot.toString(r))}setLimit(n,r,s,a){return new Nl({...this._def,checks:[...this._def.checks,{kind:n,value:r,inclusive:s,message:Ot.toString(a)}]})}_addCheck(n){return new Nl({...this._def,checks:[...this._def.checks,n]})}positive(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ot.toString(n)})}negative(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ot.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ot.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ot.toString(n)})}multipleOf(n,r){return this._addCheck({kind:"multipleOf",value:n,message:Ot.toString(r)})}get minValue(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxValue(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}}Nl.create=t=>{var n;return new Nl({checks:[],typeName:Ut.ZodBigInt,coerce:(n=t?.coerce)!==null&&n!==void 0?n:!1,...Jt(t)})};class vh extends an{_parse(n){if(this._def.coerce&&(n.data=!!n.data),this._getType(n)!==vt.boolean){const s=this._getOrReturnCtx(n);return ft(s,{code:st.invalid_type,expected:vt.boolean,received:s.parsedType}),Kt}return Ms(n.data)}}vh.create=t=>new vh({typeName:Ut.ZodBoolean,coerce:t?.coerce||!1,...Jt(t)});class _c extends an{_parse(n){if(this._def.coerce&&(n.data=new Date(n.data)),this._getType(n)!==vt.date){const i=this._getOrReturnCtx(n);return ft(i,{code:st.invalid_type,expected:vt.date,received:i.parsedType}),Kt}if(isNaN(n.data.getTime())){const i=this._getOrReturnCtx(n);return ft(i,{code:st.invalid_date}),Kt}const s=new xs;let a;for(const i of this._def.checks)i.kind==="min"?n.data.getTime()<i.value&&(a=this._getOrReturnCtx(n,a),ft(a,{code:st.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?n.data.getTime()>i.value&&(a=this._getOrReturnCtx(n,a),ft(a,{code:st.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):gn.assertNever(i);return{status:s.value,value:new Date(n.data.getTime())}}_addCheck(n){return new _c({...this._def,checks:[...this._def.checks,n]})}min(n,r){return this._addCheck({kind:"min",value:n.getTime(),message:Ot.toString(r)})}max(n,r){return this._addCheck({kind:"max",value:n.getTime(),message:Ot.toString(r)})}get minDate(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n!=null?new Date(n):null}get maxDate(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n!=null?new Date(n):null}}_c.create=t=>new _c({checks:[],coerce:t?.coerce||!1,typeName:Ut.ZodDate,...Jt(t)});class Ix extends an{_parse(n){if(this._getType(n)!==vt.symbol){const s=this._getOrReturnCtx(n);return ft(s,{code:st.invalid_type,expected:vt.symbol,received:s.parsedType}),Kt}return Ms(n.data)}}Ix.create=t=>new Ix({typeName:Ut.ZodSymbol,...Jt(t)});class yh extends an{_parse(n){if(this._getType(n)!==vt.undefined){const s=this._getOrReturnCtx(n);return ft(s,{code:st.invalid_type,expected:vt.undefined,received:s.parsedType}),Kt}return Ms(n.data)}}yh.create=t=>new yh({typeName:Ut.ZodUndefined,...Jt(t)});class jh extends an{_parse(n){if(this._getType(n)!==vt.null){const s=this._getOrReturnCtx(n);return ft(s,{code:st.invalid_type,expected:vt.null,received:s.parsedType}),Kt}return Ms(n.data)}}jh.create=t=>new jh({typeName:Ut.ZodNull,...Jt(t)});class Qd extends an{constructor(){super(...arguments),this._any=!0}_parse(n){return Ms(n.data)}}Qd.create=t=>new Qd({typeName:Ut.ZodAny,...Jt(t)});class mc extends an{constructor(){super(...arguments),this._unknown=!0}_parse(n){return Ms(n.data)}}mc.create=t=>new mc({typeName:Ut.ZodUnknown,...Jt(t)});class yo extends an{_parse(n){const r=this._getOrReturnCtx(n);return ft(r,{code:st.invalid_type,expected:vt.never,received:r.parsedType}),Kt}}yo.create=t=>new yo({typeName:Ut.ZodNever,...Jt(t)});class qx extends an{_parse(n){if(this._getType(n)!==vt.undefined){const s=this._getOrReturnCtx(n);return ft(s,{code:st.invalid_type,expected:vt.void,received:s.parsedType}),Kt}return Ms(n.data)}}qx.create=t=>new qx({typeName:Ut.ZodVoid,...Jt(t)});class hi extends an{_parse(n){const{ctx:r,status:s}=this._processInputParams(n),a=this._def;if(r.parsedType!==vt.array)return ft(r,{code:st.invalid_type,expected:vt.array,received:r.parsedType}),Kt;if(a.exactLength!==null){const o=r.data.length>a.exactLength.value,c=r.data.length<a.exactLength.value;(o||c)&&(ft(r,{code:o?st.too_big:st.too_small,minimum:c?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),s.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(ft(r,{code:st.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),s.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(ft(r,{code:st.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((o,c)=>a.type._parseAsync(new qi(r,o,r.path,c)))).then(o=>xs.mergeArray(s,o));const i=[...r.data].map((o,c)=>a.type._parseSync(new qi(r,o,r.path,c)));return xs.mergeArray(s,i)}get element(){return this._def.type}min(n,r){return new hi({...this._def,minLength:{value:n,message:Ot.toString(r)}})}max(n,r){return new hi({...this._def,maxLength:{value:n,message:Ot.toString(r)}})}length(n,r){return new hi({...this._def,exactLength:{value:n,message:Ot.toString(r)}})}nonempty(n){return this.min(1,n)}}hi.create=(t,n)=>new hi({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ut.ZodArray,...Jt(n)});function _d(t){if(t instanceof ar){const n={};for(const r in t.shape){const s=t.shape[r];n[r]=$i.create(_d(s))}return new ar({...t._def,shape:()=>n})}else return t instanceof hi?new hi({...t._def,type:_d(t.element)}):t instanceof $i?$i.create(_d(t.unwrap())):t instanceof Cl?Cl.create(_d(t.unwrap())):t instanceof Bi?Bi.create(t.items.map(n=>_d(n))):t}class ar extends an{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const n=this._def.shape(),r=gn.objectKeys(n);return this._cached={shape:n,keys:r}}_parse(n){if(this._getType(n)!==vt.object){const m=this._getOrReturnCtx(n);return ft(m,{code:st.invalid_type,expected:vt.object,received:m.parsedType}),Kt}const{status:s,ctx:a}=this._processInputParams(n),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof yo&&this._def.unknownKeys==="strip"))for(const m in a.data)o.includes(m)||c.push(m);const u=[];for(const m of o){const h=i[m],f=a.data[m];u.push({key:{status:"valid",value:m},value:h._parse(new qi(a,f,a.path,m)),alwaysSet:m in a.data})}if(this._def.catchall instanceof yo){const m=this._def.unknownKeys;if(m==="passthrough")for(const h of c)u.push({key:{status:"valid",value:h},value:{status:"valid",value:a.data[h]}});else if(m==="strict")c.length>0&&(ft(a,{code:st.unrecognized_keys,keys:c}),s.dirty());else if(m!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const m=this._def.catchall;for(const h of c){const f=a.data[h];u.push({key:{status:"valid",value:h},value:m._parse(new qi(a,f,a.path,h)),alwaysSet:h in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const m=[];for(const h of u){const f=await h.key,x=await h.value;m.push({key:f,value:x,alwaysSet:h.alwaysSet})}return m}).then(m=>xs.mergeObjectSync(s,m)):xs.mergeObjectSync(s,u)}get shape(){return this._def.shape()}strict(n){return Ot.errToObj,new ar({...this._def,unknownKeys:"strict",...n!==void 0?{errorMap:(r,s)=>{var a,i,o,c;const u=(o=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,r,s).message)!==null&&o!==void 0?o:s.defaultError;return r.code==="unrecognized_keys"?{message:(c=Ot.errToObj(n).message)!==null&&c!==void 0?c:u}:{message:u}}}:{}})}strip(){return new ar({...this._def,unknownKeys:"strip"})}passthrough(){return new ar({...this._def,unknownKeys:"passthrough"})}extend(n){return new ar({...this._def,shape:()=>({...this._def.shape(),...n})})}merge(n){return new ar({unknownKeys:n._def.unknownKeys,catchall:n._def.catchall,shape:()=>({...this._def.shape(),...n._def.shape()}),typeName:Ut.ZodObject})}setKey(n,r){return this.augment({[n]:r})}catchall(n){return new ar({...this._def,catchall:n})}pick(n){const r={};return gn.objectKeys(n).forEach(s=>{n[s]&&this.shape[s]&&(r[s]=this.shape[s])}),new ar({...this._def,shape:()=>r})}omit(n){const r={};return gn.objectKeys(this.shape).forEach(s=>{n[s]||(r[s]=this.shape[s])}),new ar({...this._def,shape:()=>r})}deepPartial(){return _d(this)}partial(n){const r={};return gn.objectKeys(this.shape).forEach(s=>{const a=this.shape[s];n&&!n[s]?r[s]=a:r[s]=a.optional()}),new ar({...this._def,shape:()=>r})}required(n){const r={};return gn.objectKeys(this.shape).forEach(s=>{if(n&&!n[s])r[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof $i;)i=i._def.innerType;r[s]=i}}),new ar({...this._def,shape:()=>r})}keyof(){return DI(gn.objectKeys(this.shape))}}ar.create=(t,n)=>new ar({shape:()=>t,unknownKeys:"strip",catchall:yo.create(),typeName:Ut.ZodObject,...Jt(n)});ar.strictCreate=(t,n)=>new ar({shape:()=>t,unknownKeys:"strict",catchall:yo.create(),typeName:Ut.ZodObject,...Jt(n)});ar.lazycreate=(t,n)=>new ar({shape:t,unknownKeys:"strip",catchall:yo.create(),typeName:Ut.ZodObject,...Jt(n)});class bh extends an{_parse(n){const{ctx:r}=this._processInputParams(n),s=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new va(c.ctx.common.issues));return ft(r,{code:st.invalid_union,unionErrors:o}),Kt}if(r.common.async)return Promise.all(s.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const u of s){const m={...r,common:{...r.common,issues:[]},parent:null},h=u._parseSync({data:r.data,path:r.path,parent:m});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:m}),m.common.issues.length&&o.push(m.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(u=>new va(u));return ft(r,{code:st.invalid_union,unionErrors:c}),Kt}}get options(){return this._def.options}}bh.create=(t,n)=>new bh({options:t,typeName:Ut.ZodUnion,...Jt(n)});const so=t=>t instanceof Nh?so(t.schema):t instanceof gi?so(t.innerType()):t instanceof Sh?[t.value]:t instanceof Sl?t.options:t instanceof Ch?gn.objectValues(t.enum):t instanceof kh?so(t._def.innerType):t instanceof yh?[void 0]:t instanceof jh?[null]:t instanceof $i?[void 0,...so(t.unwrap())]:t instanceof Cl?[null,...so(t.unwrap())]:t instanceof vC||t instanceof Ah?so(t.unwrap()):t instanceof Ph?so(t._def.innerType):[];class hv extends an{_parse(n){const{ctx:r}=this._processInputParams(n);if(r.parsedType!==vt.object)return ft(r,{code:st.invalid_type,expected:vt.object,received:r.parsedType}),Kt;const s=this.discriminator,a=r.data[s],i=this.optionsMap.get(a);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(ft(r,{code:st.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Kt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(n,r,s){const a=new Map;for(const i of r){const o=so(i.shape[n]);if(!o.length)throw new Error(`A discriminator value for key \`${n}\` could not be extracted from all schema options`);for(const c of o){if(a.has(c))throw new Error(`Discriminator property ${String(n)} has duplicate value ${String(c)}`);a.set(c,i)}}return new hv({typeName:Ut.ZodDiscriminatedUnion,discriminator:n,options:r,optionsMap:a,...Jt(s)})}}function e1(t,n){const r=io(t),s=io(n);if(t===n)return{valid:!0,data:t};if(r===vt.object&&s===vt.object){const a=gn.objectKeys(n),i=gn.objectKeys(t).filter(c=>a.indexOf(c)!==-1),o={...t,...n};for(const c of i){const u=e1(t[c],n[c]);if(!u.valid)return{valid:!1};o[c]=u.data}return{valid:!0,data:o}}else if(r===vt.array&&s===vt.array){if(t.length!==n.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const o=t[i],c=n[i],u=e1(o,c);if(!u.valid)return{valid:!1};a.push(u.data)}return{valid:!0,data:a}}else return r===vt.date&&s===vt.date&&+t==+n?{valid:!0,data:t}:{valid:!1}}class wh extends an{_parse(n){const{status:r,ctx:s}=this._processInputParams(n),a=(i,o)=>{if(ZN(i)||ZN(o))return Kt;const c=e1(i.value,o.value);return c.valid?((JN(i)||JN(o))&&r.dirty(),{status:r.value,value:c.data}):(ft(s,{code:st.invalid_intersection_types}),Kt)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}wh.create=(t,n,r)=>new wh({left:t,right:n,typeName:Ut.ZodIntersection,...Jt(r)});class Bi extends an{_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.parsedType!==vt.array)return ft(s,{code:st.invalid_type,expected:vt.array,received:s.parsedType}),Kt;if(s.data.length<this._def.items.length)return ft(s,{code:st.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Kt;!this._def.rest&&s.data.length>this._def.items.length&&(ft(s,{code:st.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...s.data].map((o,c)=>{const u=this._def.items[c]||this._def.rest;return u?u._parse(new qi(s,o,s.path,c)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>xs.mergeArray(r,o)):xs.mergeArray(r,i)}get items(){return this._def.items}rest(n){return new Bi({...this._def,rest:n})}}Bi.create=(t,n)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Bi({items:t,typeName:Ut.ZodTuple,rest:null,...Jt(n)})};class _h extends an{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.parsedType!==vt.object)return ft(s,{code:st.invalid_type,expected:vt.object,received:s.parsedType}),Kt;const a=[],i=this._def.keyType,o=this._def.valueType;for(const c in s.data)a.push({key:i._parse(new qi(s,c,s.path,c)),value:o._parse(new qi(s,s.data[c],s.path,c)),alwaysSet:c in s.data});return s.common.async?xs.mergeObjectAsync(r,a):xs.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(n,r,s){return r instanceof an?new _h({keyType:n,valueType:r,typeName:Ut.ZodRecord,...Jt(s)}):new _h({keyType:ci.create(),valueType:n,typeName:Ut.ZodRecord,...Jt(r)})}}class Bx extends an{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.parsedType!==vt.map)return ft(s,{code:st.invalid_type,expected:vt.map,received:s.parsedType}),Kt;const a=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([c,u],m)=>({key:a._parse(new qi(s,c,s.path,[m,"key"])),value:i._parse(new qi(s,u,s.path,[m,"value"]))}));if(s.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const u of o){const m=await u.key,h=await u.value;if(m.status==="aborted"||h.status==="aborted")return Kt;(m.status==="dirty"||h.status==="dirty")&&r.dirty(),c.set(m.value,h.value)}return{status:r.value,value:c}})}else{const c=new Map;for(const u of o){const m=u.key,h=u.value;if(m.status==="aborted"||h.status==="aborted")return Kt;(m.status==="dirty"||h.status==="dirty")&&r.dirty(),c.set(m.value,h.value)}return{status:r.value,value:c}}}}Bx.create=(t,n,r)=>new Bx({valueType:n,keyType:t,typeName:Ut.ZodMap,...Jt(r)});class Nc extends an{_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.parsedType!==vt.set)return ft(s,{code:st.invalid_type,expected:vt.set,received:s.parsedType}),Kt;const a=this._def;a.minSize!==null&&s.data.size<a.minSize.value&&(ft(s,{code:st.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&s.data.size>a.maxSize.value&&(ft(s,{code:st.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const i=this._def.valueType;function o(u){const m=new Set;for(const h of u){if(h.status==="aborted")return Kt;h.status==="dirty"&&r.dirty(),m.add(h.value)}return{status:r.value,value:m}}const c=[...s.data.values()].map((u,m)=>i._parse(new qi(s,u,s.path,m)));return s.common.async?Promise.all(c).then(u=>o(u)):o(c)}min(n,r){return new Nc({...this._def,minSize:{value:n,message:Ot.toString(r)}})}max(n,r){return new Nc({...this._def,maxSize:{value:n,message:Ot.toString(r)}})}size(n,r){return this.min(n,r).max(n,r)}nonempty(n){return this.min(1,n)}}Nc.create=(t,n)=>new Nc({valueType:t,minSize:null,maxSize:null,typeName:Ut.ZodSet,...Jt(n)});class Id extends an{constructor(){super(...arguments),this.validate=this.implement}_parse(n){const{ctx:r}=this._processInputParams(n);if(r.parsedType!==vt.function)return ft(r,{code:st.invalid_type,expected:vt.function,received:r.parsedType}),Kt;function s(c,u){return Fx({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,$x(),Yd].filter(m=>!!m),issueData:{code:st.invalid_arguments,argumentsError:u}})}function a(c,u){return Fx({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,$x(),Yd].filter(m=>!!m),issueData:{code:st.invalid_return_type,returnTypeError:u}})}const i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof Xd){const c=this;return Ms(async function(...u){const m=new va([]),h=await c._def.args.parseAsync(u,i).catch(j=>{throw m.addIssue(s(u,j)),m}),f=await Reflect.apply(o,this,h);return await c._def.returns._def.type.parseAsync(f,i).catch(j=>{throw m.addIssue(a(f,j)),m})})}else{const c=this;return Ms(function(...u){const m=c._def.args.safeParse(u,i);if(!m.success)throw new va([s(u,m.error)]);const h=Reflect.apply(o,this,m.data),f=c._def.returns.safeParse(h,i);if(!f.success)throw new va([a(h,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...n){return new Id({...this._def,args:Bi.create(n).rest(mc.create())})}returns(n){return new Id({...this._def,returns:n})}implement(n){return this.parse(n)}strictImplement(n){return this.parse(n)}static create(n,r,s){return new Id({args:n||Bi.create([]).rest(mc.create()),returns:r||mc.create(),typeName:Ut.ZodFunction,...Jt(s)})}}class Nh extends an{get schema(){return this._def.getter()}_parse(n){const{ctx:r}=this._processInputParams(n);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Nh.create=(t,n)=>new Nh({getter:t,typeName:Ut.ZodLazy,...Jt(n)});class Sh extends an{_parse(n){if(n.data!==this._def.value){const r=this._getOrReturnCtx(n);return ft(r,{received:r.data,code:st.invalid_literal,expected:this._def.value}),Kt}return{status:"valid",value:n.data}}get value(){return this._def.value}}Sh.create=(t,n)=>new Sh({value:t,typeName:Ut.ZodLiteral,...Jt(n)});function DI(t,n){return new Sl({values:t,typeName:Ut.ZodEnum,...Jt(n)})}class Sl extends an{constructor(){super(...arguments),Km.set(this,void 0)}_parse(n){if(typeof n.data!="string"){const r=this._getOrReturnCtx(n),s=this._def.values;return ft(r,{expected:gn.joinValues(s),received:r.parsedType,code:st.invalid_type}),Kt}if(Lx(this,Km)||OI(this,Km,new Set(this._def.values)),!Lx(this,Km).has(n.data)){const r=this._getOrReturnCtx(n),s=this._def.values;return ft(r,{received:r.data,code:st.invalid_enum_value,options:s}),Kt}return Ms(n.data)}get options(){return this._def.values}get enum(){const n={};for(const r of this._def.values)n[r]=r;return n}get Values(){const n={};for(const r of this._def.values)n[r]=r;return n}get Enum(){const n={};for(const r of this._def.values)n[r]=r;return n}extract(n,r=this._def){return Sl.create(n,{...this._def,...r})}exclude(n,r=this._def){return Sl.create(this.options.filter(s=>!n.includes(s)),{...this._def,...r})}}Km=new WeakMap;Sl.create=DI;class Ch extends an{constructor(){super(...arguments),Wm.set(this,void 0)}_parse(n){const r=gn.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(n);if(s.parsedType!==vt.string&&s.parsedType!==vt.number){const a=gn.objectValues(r);return ft(s,{expected:gn.joinValues(a),received:s.parsedType,code:st.invalid_type}),Kt}if(Lx(this,Wm)||OI(this,Wm,new Set(gn.getValidEnumValues(this._def.values))),!Lx(this,Wm).has(n.data)){const a=gn.objectValues(r);return ft(s,{received:s.data,code:st.invalid_enum_value,options:a}),Kt}return Ms(n.data)}get enum(){return this._def.values}}Wm=new WeakMap;Ch.create=(t,n)=>new Ch({values:t,typeName:Ut.ZodNativeEnum,...Jt(n)});class Xd extends an{unwrap(){return this._def.type}_parse(n){const{ctx:r}=this._processInputParams(n);if(r.parsedType!==vt.promise&&r.common.async===!1)return ft(r,{code:st.invalid_type,expected:vt.promise,received:r.parsedType}),Kt;const s=r.parsedType===vt.promise?r.data:Promise.resolve(r.data);return Ms(s.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Xd.create=(t,n)=>new Xd({type:t,typeName:Ut.ZodPromise,...Jt(n)});class gi extends an{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ut.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(n){const{status:r,ctx:s}=this._processInputParams(n),a=this._def.effect||null,i={addIssue:o=>{ft(s,o),o.fatal?r.abort():r.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async c=>{if(r.value==="aborted")return Kt;const u=await this._def.schema._parseAsync({data:c,path:s.path,parent:s});return u.status==="aborted"?Kt:u.status==="dirty"||r.value==="dirty"?kd(u.value):u});{if(r.value==="aborted")return Kt;const c=this._def.schema._parseSync({data:o,path:s.path,parent:s});return c.status==="aborted"?Kt:c.status==="dirty"||r.value==="dirty"?kd(c.value):c}}if(a.type==="refinement"){const o=c=>{const u=a.refinement(c,i);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(s.common.async===!1){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return c.status==="aborted"?Kt:(c.status==="dirty"&&r.dirty(),o(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>c.status==="aborted"?Kt:(c.status==="dirty"&&r.dirty(),o(c.value).then(()=>({status:r.value,value:c.value}))))}if(a.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!wc(o))return o;const c=a.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>wc(o)?Promise.resolve(a.transform(o.value,i)).then(c=>({status:r.value,value:c})):o);gn.assertNever(a)}}gi.create=(t,n,r)=>new gi({schema:t,typeName:Ut.ZodEffects,effect:n,...Jt(r)});gi.createWithPreprocess=(t,n,r)=>new gi({schema:n,effect:{type:"preprocess",transform:t},typeName:Ut.ZodEffects,...Jt(r)});class $i extends an{_parse(n){return this._getType(n)===vt.undefined?Ms(void 0):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}$i.create=(t,n)=>new $i({innerType:t,typeName:Ut.ZodOptional,...Jt(n)});class Cl extends an{_parse(n){return this._getType(n)===vt.null?Ms(null):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}Cl.create=(t,n)=>new Cl({innerType:t,typeName:Ut.ZodNullable,...Jt(n)});class kh extends an{_parse(n){const{ctx:r}=this._processInputParams(n);let s=r.data;return r.parsedType===vt.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}kh.create=(t,n)=>new kh({innerType:t,typeName:Ut.ZodDefault,defaultValue:typeof n.default=="function"?n.default:()=>n.default,...Jt(n)});class Ph extends an{_parse(n){const{ctx:r}=this._processInputParams(n),s={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return gh(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new va(s.common.issues)},input:s.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new va(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Ph.create=(t,n)=>new Ph({innerType:t,typeName:Ut.ZodCatch,catchValue:typeof n.catch=="function"?n.catch:()=>n.catch,...Jt(n)});class zx extends an{_parse(n){if(this._getType(n)!==vt.nan){const s=this._getOrReturnCtx(n);return ft(s,{code:st.invalid_type,expected:vt.nan,received:s.parsedType}),Kt}return{status:"valid",value:n.data}}}zx.create=t=>new zx({typeName:Ut.ZodNaN,...Jt(t)});const WG=Symbol("zod_brand");class vC extends an{_parse(n){const{ctx:r}=this._processInputParams(n),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}}class jf extends an{_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?Kt:i.status==="dirty"?(r.dirty(),kd(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const a=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?Kt:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:s.path,parent:s})}}static create(n,r){return new jf({in:n,out:r,typeName:Ut.ZodPipeline})}}class Ah extends an{_parse(n){const r=this._def.innerType._parse(n),s=a=>(wc(a)&&(a.value=Object.freeze(a.value)),a);return gh(r)?r.then(a=>s(a)):s(r)}unwrap(){return this._def.innerType}}Ah.create=(t,n)=>new Ah({innerType:t,typeName:Ut.ZodReadonly,...Jt(n)});function IE(t,n){const r=typeof t=="function"?t(n):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function $I(t,n={},r){return t?Qd.create().superRefine((s,a)=>{var i,o;const c=t(s);if(c instanceof Promise)return c.then(u=>{var m,h;if(!u){const f=IE(n,s),x=(h=(m=f.fatal)!==null&&m!==void 0?m:r)!==null&&h!==void 0?h:!0;a.addIssue({code:"custom",...f,fatal:x})}});if(!c){const u=IE(n,s),m=(o=(i=u.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0;a.addIssue({code:"custom",...u,fatal:m})}}):Qd.create()}const HG={object:ar.lazycreate};var Ut;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ut||(Ut={}));const GG=(t,n={message:`Input not instance of ${t.name}`})=>$I(r=>r instanceof t,n),FI=ci.create,LI=_l.create,YG=zx.create,QG=Nl.create,II=vh.create,XG=_c.create,ZG=Ix.create,JG=yh.create,eY=jh.create,tY=Qd.create,nY=mc.create,rY=yo.create,sY=qx.create,aY=hi.create,iY=ar.create,oY=ar.strictCreate,lY=bh.create,cY=hv.create,dY=wh.create,uY=Bi.create,mY=_h.create,hY=Bx.create,fY=Nc.create,pY=Id.create,xY=Nh.create,gY=Sh.create,vY=Sl.create,yY=Ch.create,jY=Xd.create,qE=gi.create,bY=$i.create,wY=Cl.create,_Y=gi.createWithPreprocess,NY=jf.create,SY=()=>FI().optional(),CY=()=>LI().optional(),kY=()=>II().optional(),PY={string:(t=>ci.create({...t,coerce:!0})),number:(t=>_l.create({...t,coerce:!0})),boolean:(t=>vh.create({...t,coerce:!0})),bigint:(t=>Nl.create({...t,coerce:!0})),date:(t=>_c.create({...t,coerce:!0}))},AY=Kt;var me=Object.freeze({__proto__:null,defaultErrorMap:Yd,setErrorMap:_G,getErrorMap:$x,makeIssue:Fx,EMPTY_PATH:NG,addIssueToContext:ft,ParseStatus:xs,INVALID:Kt,DIRTY:kd,OK:Ms,isAborted:ZN,isDirty:JN,isValid:wc,isAsync:gh,get util(){return gn},get objectUtil(){return XN},ZodParsedType:vt,getParsedType:io,ZodType:an,datetimeRegex:RI,ZodString:ci,ZodNumber:_l,ZodBigInt:Nl,ZodBoolean:vh,ZodDate:_c,ZodSymbol:Ix,ZodUndefined:yh,ZodNull:jh,ZodAny:Qd,ZodUnknown:mc,ZodNever:yo,ZodVoid:qx,ZodArray:hi,ZodObject:ar,ZodUnion:bh,ZodDiscriminatedUnion:hv,ZodIntersection:wh,ZodTuple:Bi,ZodRecord:_h,ZodMap:Bx,ZodSet:Nc,ZodFunction:Id,ZodLazy:Nh,ZodLiteral:Sh,ZodEnum:Sl,ZodNativeEnum:Ch,ZodPromise:Xd,ZodEffects:gi,ZodTransformer:gi,ZodOptional:$i,ZodNullable:Cl,ZodDefault:kh,ZodCatch:Ph,ZodNaN:zx,BRAND:WG,ZodBranded:vC,ZodPipeline:jf,ZodReadonly:Ah,custom:$I,Schema:an,ZodSchema:an,late:HG,get ZodFirstPartyTypeKind(){return Ut},coerce:PY,any:tY,array:aY,bigint:QG,boolean:II,date:XG,discriminatedUnion:cY,effect:qE,enum:vY,function:pY,instanceof:GG,intersection:dY,lazy:xY,literal:gY,map:hY,nan:YG,nativeEnum:yY,never:rY,null:eY,nullable:wY,number:LI,object:iY,oboolean:kY,onumber:CY,optional:bY,ostring:SY,pipeline:NY,preprocess:_Y,promise:jY,record:mY,set:fY,strictObject:oY,string:FI,symbol:ZG,transformer:qE,tuple:uY,undefined:JG,union:lY,unknown:nY,void:sY,NEVER:AY,ZodIssueCode:st,quotelessJson:wG,ZodError:va});const yC=$c("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),B=v.forwardRef(({className:t,variant:n,size:r,asChild:s=!1,...a},i)=>{const o=s?Gg:"button";return e.jsx(o,{className:We(yC({variant:n,size:r,className:t})),ref:i,...a})});B.displayName="Button";const re=v.forwardRef(({className:t,type:n,...r},s)=>e.jsx("input",{type:n,className:We("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r}));re.displayName="Input";var EY="Label",qI=v.forwardRef((t,n)=>e.jsx(gt.label,{...t,ref:n,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));qI.displayName=EY;var BI=qI;const OY=$c("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Se=v.forwardRef(({className:t,...n},r)=>e.jsx(BI,{ref:r,className:We(OY(),t),...n}));Se.displayName=BI.displayName;const Qn=tG,zI=v.createContext({}),je=({...t})=>e.jsx(zI.Provider,{value:{name:t.name},children:e.jsx(aG,{...t})}),fv=()=>{const t=v.useContext(zI),n=v.useContext(VI),{getFieldState:r,formState:s}=mv(),a=r(t.name,s);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:i}=n;return{id:i,name:t.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...a}},VI=v.createContext({}),ge=v.forwardRef(({className:t,...n},r)=>{const s=v.useId();return e.jsx(VI.Provider,{value:{id:s},children:e.jsx("div",{ref:r,className:We("space-y-2",t),...n})})});ge.displayName="FormItem";const ve=v.forwardRef(({className:t,...n},r)=>{const{error:s,formItemId:a}=fv();return e.jsx(Se,{ref:r,className:We(s&&"text-destructive",t),htmlFor:a,...n})});ve.displayName="FormLabel";const ye=v.forwardRef(({...t},n)=>{const{error:r,formItemId:s,formDescriptionId:a,formMessageId:i}=fv();return e.jsx(Gg,{ref:n,id:s,"aria-describedby":r?`${a} ${i}`:`${a}`,"aria-invalid":!!r,...t})});ye.displayName="FormControl";const Rn=v.forwardRef(({className:t,...n},r)=>{const{formDescriptionId:s}=fv();return e.jsx("p",{ref:r,id:s,className:We("text-sm text-muted-foreground",t),...n})});Rn.displayName="FormDescription";const Ne=v.forwardRef(({className:t,children:n,...r},s)=>{const{error:a,formMessageId:i}=fv(),o=a?String(a?.message??""):n;return o?e.jsx("p",{ref:s,id:i,className:We("text-sm font-medium text-destructive",t),...r,children:o}):null});Ne.displayName="FormMessage";var jC="Progress",bC=100,[TY]=Kr(jC),[MY,RY]=TY(jC),UI=v.forwardRef((t,n)=>{const{__scopeProgress:r,value:s=null,max:a,getValueLabel:i=DY,...o}=t;(a||a===0)&&!BE(a)&&console.error($Y(`${a}`,"Progress"));const c=BE(a)?a:bC;s!==null&&!zE(s,c)&&console.error(FY(`${s}`,"Progress"));const u=zE(s,c)?s:null,m=Vx(u)?i(u,c):void 0;return e.jsx(MY,{scope:r,value:u,max:c,children:e.jsx(gt.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Vx(u)?u:void 0,"aria-valuetext":m,role:"progressbar","data-state":HI(u,c),"data-value":u??void 0,"data-max":c,...o,ref:n})})});UI.displayName=jC;var KI="ProgressIndicator",WI=v.forwardRef((t,n)=>{const{__scopeProgress:r,...s}=t,a=RY(KI,r);return e.jsx(gt.div,{"data-state":HI(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...s,ref:n})});WI.displayName=KI;function DY(t,n){return`${Math.round(t/n*100)}%`}function HI(t,n){return t==null?"indeterminate":t===n?"complete":"loading"}function Vx(t){return typeof t=="number"}function BE(t){return Vx(t)&&!isNaN(t)&&t>0}function zE(t,n){return Vx(t)&&!isNaN(t)&&t<=n&&t>=0}function $Y(t,n){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${n}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${bC}\`.`}function FY(t,n){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${n}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${bC} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var GI=UI,LY=WI;const YI=v.forwardRef(({className:t,value:n,...r},s)=>e.jsx(GI,{ref:s,className:We("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:e.jsx(LY,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));YI.displayName=GI.displayName;const IY=me.object({email:me.string().email("Invalid email address"),password:me.string().min(1,"Password is required")});function VE(){const[,t]=WS(),{toast:n}=Xt(),{platform_name:r}=El(),[s,a]=v.useState(!1),[i,o]=v.useState(!1),[c,u]=v.useState(0),m=$n({resolver:Fn(IY),defaultValues:{email:"",password:""}}),h=Le({mutationFn:async f=>Be("POST","/api/auth/login",f),onSuccess:async()=>{o(!0),u(20),await Fe.refetchQueries({queryKey:["/api/auth/user"]}),u(50),await Fe.prefetchQuery({queryKey:["/api/organizations/my"]}),u(80),n({title:"Welcome back!",description:"You have successfully signed in."}),u(100),setTimeout(()=>t("/"),200)},onError:f=>{n({title:"Login failed",description:f.message||"Invalid email or password.",variant:"destructive"})}});return i?e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center",children:[e.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-lg bg-primary mb-6",children:e.jsx(vr,{className:"h-8 w-8 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:r}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Signing you in..."}),e.jsx("div",{className:"w-64",children:e.jsx(YI,{value:c,className:"h-2"})})]}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Welcome back"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:["Sign in to your ",r," account"]})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Sign In"}),e.jsx(dt,{children:"Enter your credentials to access your account"})]}),e.jsxs(de,{children:[e.jsx(Qn,{...m,children:e.jsxs("form",{onSubmit:m.handleSubmit(f=>h.mutate(f)),className:"space-y-4",children:[e.jsx(je,{control:m.control,name:"email",render:({field:f})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Email"}),e.jsx(ye,{children:e.jsx(re,{type:"email",placeholder:"john@example.com",...f,"data-testid":"input-email"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:m.control,name:"password",render:({field:f})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Password"}),e.jsx(ye,{children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{type:s?"text":"password",placeholder:"Enter password",...f,"data-testid":"input-password"}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>a(!s),children:s?e.jsx(mh,{className:"h-4 w-4"}):e.jsx(Ts,{className:"h-4 w-4"})})]})}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full",disabled:h.isPending,"data-testid":"button-login",children:h.isPending?"Signing in...":"Sign In"})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(Xs,{href:"/forgot-password",className:"text-primary hover:underline text-sm","data-testid":"link-forgot-password",children:"Forgot password?"})}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Don't have an account? "}),e.jsx(Xs,{href:"/register",className:"text-primary hover:underline","data-testid":"link-register",children:"Create one"})]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{href:"/",className:"text-sm text-muted-foreground hover:underline",children:"View Guide"})})]})})}const qY=me.object({email:me.string().email("Invalid email address"),password:me.string().min(8,"Password must be at least 8 characters"),confirmPassword:me.string(),firstName:me.string().min(1,"First name is required"),lastName:me.string().min(1,"Last name is required"),phone:me.string().optional(),acceptTerms:me.boolean().refine(t=>t===!0,{message:"You must accept the Terms of Service and Privacy Policy"})}).refine(t=>t.password===t.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function BY(){const[,t]=WS(),{toast:n}=Xt(),{platform_name:r}=El(),[s,a]=v.useState(!1),[i,o]=v.useState(!1),c=$n({resolver:Fn(qY),defaultValues:{email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phone:"",acceptTerms:!1}}),u=Le({mutationFn:async m=>Be("POST","/api/auth/register",m),onSuccess:async()=>{await Fe.refetchQueries({queryKey:["/api/auth/user"]}),n({title:"Account created",description:`Welcome to ${r}! Let's set up your organization.`}),t("/")},onError:m=>{n({title:"Registration failed",description:m.message||"Could not create account. Please try again.",variant:"destructive"})}});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-background to-blue-50/30 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-xl bg-primary mb-3",children:e.jsx(vr,{className:"h-6 w-6 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Create your account"}),e.jsxs("p",{className:"text-muted-foreground text-sm mt-1",children:["Get started with ",r," in minutes"]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl shadow-sm p-6 sm:p-8",children:[e.jsx(Qn,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(m=>u.mutate(m)),className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:c.control,name:"firstName",render:({field:m})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"First Name"}),e.jsx(ye,{children:e.jsx(re,{placeholder:"John",...m,"data-testid":"input-firstname"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:c.control,name:"lastName",render:({field:m})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Last Name"}),e.jsx(ye,{children:e.jsx(re,{placeholder:"Doe",...m,"data-testid":"input-lastname"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:c.control,name:"email",render:({field:m})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Email"}),e.jsx(ye,{children:e.jsx(re,{type:"email",placeholder:"you@example.com",...m,"data-testid":"input-email"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:c.control,name:"phone",render:({field:m})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Phone ",e.jsx("span",{className:"text-muted-foreground font-normal",children:"(optional)"})]}),e.jsx(ye,{children:e.jsx(re,{placeholder:"+254 700 000 000",...m,"data-testid":"input-phone"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:c.control,name:"password",render:({field:m})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Password"}),e.jsx(ye,{children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{type:s?"text":"password",placeholder:"Min. 8 characters",className:"pr-10",...m,"data-testid":"input-password"}),e.jsx("button",{type:"button",tabIndex:-1,className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:()=>a(!s),children:s?e.jsx(mh,{className:"h-4 w-4"}):e.jsx(Ts,{className:"h-4 w-4"})})]})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:c.control,name:"confirmPassword",render:({field:m})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Confirm Password"}),e.jsx(ye,{children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{type:i?"text":"password",placeholder:"Repeat password",className:"pr-10",...m,"data-testid":"input-confirm-password"}),e.jsx("button",{type:"button",tabIndex:-1,className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:()=>o(!i),children:i?e.jsx(mh,{className:"h-4 w-4"}):e.jsx(Ts,{className:"h-4 w-4"})})]})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:c.control,name:"acceptTerms",render:({field:m})=>e.jsxs(ge,{children:[e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsx(ye,{children:e.jsx("input",{type:"checkbox",checked:m.value,onChange:m.onChange,className:"h-4 w-4 rounded border-border accent-primary cursor-pointer shrink-0","data-testid":"checkbox-accept-terms"})}),e.jsxs(ve,{className:"text-sm font-normal leading-none cursor-pointer",children:["I agree to the"," ",e.jsx(Xs,{href:"/terms",className:"text-primary hover:underline font-medium","data-testid":"link-terms",children:"Terms of Service"})," ","and"," ",e.jsx(Xs,{href:"/privacy",className:"text-primary hover:underline font-medium","data-testid":"link-privacy",children:"Privacy Policy"})]})]}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full mt-2",disabled:u.isPending,"data-testid":"button-register",children:u.isPending?"Creating Account...":"Create Account"})]})}),e.jsxs("div",{className:"mt-5 pt-5 border-t border-border text-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Already have an account? "}),e.jsx(Xs,{href:"/login",className:"text-primary hover:underline font-medium","data-testid":"link-login",children:"Sign in"})]})]}),e.jsx("p",{className:"mt-4 text-center",children:e.jsx("a",{href:"/",className:"text-xs text-muted-foreground hover:underline",children:"View Guide"})})]})})}const zY=me.object({email:me.string().email("Invalid email address")});function VY(){const{toast:t}=Xt(),{platform_name:n}=El(),[r,s]=v.useState(!1),a=$n({resolver:Fn(zY),defaultValues:{email:""}}),i=Le({mutationFn:async o=>Be("POST","/api/auth/forgot-password",o),onSuccess:()=>{s(!0)},onError:o=>{t({title:"Error",description:o.message||"Something went wrong. Please try again.",variant:"destructive"})}});return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Reset your password"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"We'll send you a link to reset your password"})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Forgot Password"}),e.jsx(dt,{children:"Enter the email address associated with your account"})]}),e.jsx(de,{children:r?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground","data-testid":"text-success-message",children:"If an account exists with that email, we've sent a password reset link."}),e.jsx(Xs,{href:"/login",className:"text-primary hover:underline text-sm","data-testid":"link-back-to-login",children:"Back to Sign In"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qn,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(o=>i.mutate(o)),className:"space-y-4",children:[e.jsx(je,{control:a.control,name:"email",render:({field:o})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Email"}),e.jsx(ye,{children:e.jsx(re,{type:"email",placeholder:"john@example.com",...o,"data-testid":"input-email"})}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full",disabled:i.isPending,"data-testid":"button-submit",children:i.isPending?"Sending...":"Send Reset Link"})]})}),e.jsx("div",{className:"mt-6 text-center text-sm",children:e.jsx(Xs,{href:"/login",className:"text-primary hover:underline","data-testid":"link-login",children:"Back to Sign In"})})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{href:"/",className:"text-sm text-muted-foreground hover:underline",children:"View Guide"})})]})})}const UY=me.object({password:me.string().min(8,"Password must be at least 8 characters"),confirmPassword:me.string()}).refine(t=>t.password===t.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function KY(){const{toast:t}=Xt(),{platform_name:n}=El(),[r,s]=v.useState(!1),[a,i]=v.useState(!1),[o,c]=v.useState(null),[u,m]=v.useState(!1),f=new URLSearchParams(window.location.search).get("token")||"";v.useEffect(()=>{if(!f){c(!1);return}fetch(`/api/auth/verify-reset-token/${f}`,{credentials:"include"}).then(b=>{c(b.ok)}).catch(()=>{c(!1)})},[f]);const x=$n({resolver:Fn(UY),defaultValues:{password:"",confirmPassword:""}}),j=Le({mutationFn:async b=>Be("POST","/api/auth/reset-password",{token:f,password:b.password}),onSuccess:()=>{m(!0)},onError:b=>{t({title:"Reset failed",description:b.message||"Could not reset password. The link may have expired.",variant:"destructive"})}});return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Reset your password"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:["Set a new password for your ",n," account"]})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"New Password"}),e.jsx(dt,{children:"Enter your new password below"})]}),e.jsx(de,{children:o===null?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground","data-testid":"text-verifying",children:"Verifying link..."})]}):o===!1?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-sm text-destructive","data-testid":"text-invalid-token",children:"This reset link is invalid or has expired."}),e.jsx(Xs,{href:"/forgot-password",className:"text-primary hover:underline text-sm","data-testid":"link-forgot-password",children:"Request a new reset link"})]}):u?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground","data-testid":"text-reset-success",children:"Your password has been reset successfully."}),e.jsx(Xs,{href:"/login",className:"text-primary hover:underline text-sm","data-testid":"link-login",children:"Sign in with your new password"})]}):e.jsx(e.Fragment,{children:e.jsx(Qn,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(b=>j.mutate(b)),className:"space-y-4",children:[e.jsx(je,{control:x.control,name:"password",render:({field:b})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"New Password"}),e.jsx(ye,{children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{type:r?"text":"password",placeholder:"Enter new password",...b,"data-testid":"input-password"}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>s(!r),children:r?e.jsx(mh,{className:"h-4 w-4"}):e.jsx(Ts,{className:"h-4 w-4"})})]})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:x.control,name:"confirmPassword",render:({field:b})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Confirm Password"}),e.jsx(ye,{children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{type:a?"text":"password",placeholder:"Confirm new password",...b,"data-testid":"input-confirm-password"}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>i(!a),children:a?e.jsx(mh,{className:"h-4 w-4"}):e.jsx(Ts,{className:"h-4 w-4"})})]})}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full",disabled:j.isPending,"data-testid":"button-reset-password",children:j.isPending?"Resetting...":"Reset Password"})]})})})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("a",{href:"/",className:"text-sm text-muted-foreground hover:underline",children:"View Guide"})})]})})}function wC(t,n){const r=gs(),s=n?.deferToSession??!1,a=s?!!r.getQueryData(["/api/auth/permissions",t]):!0,{data:i,isLoading:o}=$e({queryKey:["/api/auth/permissions",t],queryFn:async()=>{if(!t)return{role:null,permissions:[],working_hours_allowed:!0,working_hours_message:""};const h=await fetch(`/api/auth/permissions/${t}`,{credentials:"include"});return h.ok?h.json():{role:null,permissions:[],working_hours_allowed:!0,working_hours_message:""}},enabled:!!t&&(!s||a),refetchInterval:s?void 0:6e4,refetchIntervalInBackground:!s,staleTime:s?1e3*60*5:0,gcTime:s?1e3*60*10:void 0}),c=h=>{if(!i)return!1;if(i.permissions.includes("*")||i.permissions.includes(h))return!0;const f=h.split(":")[0];return!!i.permissions.includes(`${f}:*`)},u=h=>h.some(f=>c(f)),m=h=>i?.role?h.includes(i.role):!1;return{role:i?.role||null,permissions:i?.permissions||[],isLoading:s?o&&!a:o,hasPermission:c,hasAnyPermission:u,hasRole:m,isAdmin:i?.role==="admin"||i?.role==="owner",workingHoursAllowed:i?.working_hours_allowed??!0,workingHoursMessage:i?.working_hours_message||""}}function Ol(t,n){const r=gs(),s=n?.deferToSession??!1,a=s?!!r.getQueryData(["/api/organizations",t,"features"]):!0,{data:i,isLoading:o,error:c}=$e({queryKey:["/api/organizations",t,"features"],queryFn:async()=>{if(!t)throw new Error("No organization ID");const h=await fetch(`/api/organizations/${t}/features`,{credentials:"include"});if(!h.ok)throw new Error("Failed to load features");return h.json()},enabled:!!t&&(!s||a),staleTime:300*1e3});return{featureAccess:i,isLoading:s?o&&!a:o,error:c,hasFeature:h=>i?i.features.includes(h):!1,checkLimit:(h,f)=>{if(!i)return!0;const x=i.limits[h];return x===null?!0:f<x},plan:i?.plan_or_edition||"starter",mode:i?.mode||"saas",subscriptionStatus:i?.subscription_status,isExpired:i?.subscription_status?.is_expired||!1,isTrial:i?.subscription_status?.is_trial||!1,trialDaysRemaining:i?.subscription_status?.trial_days_remaining||0,trialMessage:i?.subscription_status?.message||null}}function WY(t){const n=gs(),{data:r,isLoading:s}=$e({queryKey:["/api/auth/session",t],queryFn:async()=>{if(!t)throw new Error("No organization ID");const a=await fetch(`/api/auth/session/${t}`,{credentials:"include"});if(!a.ok)throw new Error("Failed to load session");const i=await a.json();return n.setQueryData(["/api/auth/permissions",t],i.permissions),n.setQueryData(["/api/organizations",t,"features"],i.features),i},enabled:!!t,staleTime:1e3*60*1,retry:3,retryDelay:a=>Math.min(1e3*2**a,1e4),refetchInterval:6e4,refetchIntervalInBackground:!0});return{session:r,isLoading:s,isReady:!s&&!!r}}const _C=[{code:"KES",name:"Kenya Shilling",symbol:"KSh"},{code:"UGX",name:"Uganda Shilling",symbol:"USh"},{code:"TZS",name:"Tanzania Shilling",symbol:"TSh"},{code:"RWF",name:"Rwanda Franc",symbol:"FRw"},{code:"ETB",name:"Ethiopian Birr",symbol:"Br"},{code:"NGN",name:"Nigerian Naira",symbol:""},{code:"GHS",name:"Ghanaian Cedi",symbol:"GH"},{code:"ZAR",name:"South African Rand",symbol:"R"},{code:"BWP",name:"Botswana Pula",symbol:"P"},{code:"MWK",name:"Malawian Kwacha",symbol:"MK"},{code:"ZMW",name:"Zambian Kwacha",symbol:"ZK"},{code:"MZN",name:"Mozambican Metical",symbol:"MT"},{code:"AOA",name:"Angolan Kwanza",symbol:"Kz"},{code:"CDF",name:"Congolese Franc",symbol:"FC"},{code:"XOF",name:"West African CFA Franc",symbol:"CFA"},{code:"XAF",name:"Central African CFA Franc",symbol:"FCFA"},{code:"EGP",name:"Egyptian Pound",symbol:"E"},{code:"MAD",name:"Moroccan Dirham",symbol:"MAD"},{code:"TND",name:"Tunisian Dinar",symbol:"DT"},{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:""},{code:"GBP",name:"British Pound",symbol:""},{code:"CAD",name:"Canadian Dollar",symbol:"CA$"},{code:"AUD",name:"Australian Dollar",symbol:"A$"},{code:"INR",name:"Indian Rupee",symbol:""},{code:"PKR",name:"Pakistani Rupee",symbol:"Rs"},{code:"BDT",name:"Bangladeshi Taka",symbol:""},{code:"LKR",name:"Sri Lankan Rupee",symbol:"Rs"},{code:"PHP",name:"Philippine Peso",symbol:""},{code:"MYR",name:"Malaysian Ringgit",symbol:"RM"},{code:"IDR",name:"Indonesian Rupiah",symbol:"Rp"},{code:"THB",name:"Thai Baht",symbol:""},{code:"VND",name:"Vietnamese Dong",symbol:""},{code:"JPY",name:"Japanese Yen",symbol:""},{code:"CNY",name:"Chinese Yuan",symbol:""},{code:"KRW",name:"South Korean Won",symbol:""},{code:"SGD",name:"Singapore Dollar",symbol:"S$"},{code:"HKD",name:"Hong Kong Dollar",symbol:"HK$"},{code:"TWD",name:"Taiwan Dollar",symbol:"NT$"},{code:"AED",name:"UAE Dirham",symbol:"AED"},{code:"SAR",name:"Saudi Riyal",symbol:"SAR"},{code:"QAR",name:"Qatari Riyal",symbol:"QAR"},{code:"BRL",name:"Brazilian Real",symbol:"R$"},{code:"MXN",name:"Mexican Peso",symbol:"MX$"},{code:"ARS",name:"Argentine Peso",symbol:"AR$"},{code:"CLP",name:"Chilean Peso",symbol:"CL$"},{code:"COP",name:"Colombian Peso",symbol:"CO$"},{code:"PEN",name:"Peruvian Sol",symbol:"S/"},{code:"CHF",name:"Swiss Franc",symbol:"CHF"},{code:"SEK",name:"Swedish Krona",symbol:"kr"},{code:"NOK",name:"Norwegian Krone",symbol:"kr"},{code:"DKK",name:"Danish Krone",symbol:"kr"},{code:"PLN",name:"Polish Zloty",symbol:"z"},{code:"CZK",name:"Czech Koruna",symbol:"K"},{code:"HUF",name:"Hungarian Forint",symbol:"Ft"},{code:"RON",name:"Romanian Leu",symbol:"lei"},{code:"TRY",name:"Turkish Lira",symbol:""},{code:"ILS",name:"Israeli Shekel",symbol:""},{code:"NZD",name:"New Zealand Dollar",symbol:"NZ$"},{code:"FJD",name:"Fijian Dollar",symbol:"FJ$"},{code:"PGK",name:"Papua New Guinean Kina",symbol:"K"},{code:"WST",name:"Samoan Tala",symbol:"WS$"},{code:"TOP",name:"Tongan Pa'anga",symbol:"T$"},{code:"SBD",name:"Solomon Islands Dollar",symbol:"SI$"},{code:"VUV",name:"Vanuatu Vatu",symbol:"VT"},{code:"SCR",name:"Seychellois Rupee",symbol:"SCR"},{code:"MUR",name:"Mauritian Rupee",symbol:"Rs"},{code:"GMD",name:"Gambian Dalasi",symbol:"D"},{code:"SLL",name:"Sierra Leonean Leone",symbol:"Le"},{code:"LRD",name:"Liberian Dollar",symbol:"L$"},{code:"SSP",name:"South Sudanese Pound",symbol:"SSP"},{code:"SOS",name:"Somali Shilling",symbol:"Sh"},{code:"DJF",name:"Djiboutian Franc",symbol:"Fdj"},{code:"ERN",name:"Eritrean Nakfa",symbol:"Nfk"},{code:"SDG",name:"Sudanese Pound",symbol:"SDG"},{code:"LSL",name:"Lesotho Loti",symbol:"L"},{code:"SZL",name:"Swazi Lilangeni",symbol:"E"},{code:"NAD",name:"Namibian Dollar",symbol:"N$"},{code:"BIF",name:"Burundian Franc",symbol:"FBu"},{code:"KMF",name:"Comorian Franc",symbol:"CF"},{code:"MGA",name:"Malagasy Ariary",symbol:"Ar"},{code:"CVE",name:"Cape Verdean Escudo",symbol:"Esc"},{code:"STN",name:"So Tom Dobra",symbol:"Db"},{code:"GNF",name:"Guinean Franc",symbol:"FG"}];function Ux(t){return _C.find(r=>r.code===t)?.symbol||t}function HY(t,n){const r=typeof t=="string"?parseFloat(t):t;return isNaN(r)?`${Ux(n)} 0`:`${Ux(n)} ${r.toLocaleString()}`}function UE(t,[n,r]){return Math.min(r,Math.max(n,t))}var GY=v.createContext(void 0);function bf(t){const n=v.useContext(GY);return t||n||"ltr"}var hb=0;function pv(){v.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??KE()),document.body.insertAdjacentElement("beforeend",t[1]??KE()),hb++,()=>{hb===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),hb--}},[])}function KE(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var fb="focusScope.autoFocusOnMount",pb="focusScope.autoFocusOnUnmount",WE={bubbles:!1,cancelable:!0},YY="FocusScope",wf=v.forwardRef((t,n)=>{const{loop:r=!1,trapped:s=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=t,[c,u]=v.useState(null),m=ss(a),h=ss(i),f=v.useRef(null),x=cn(n,g=>u(g)),j=v.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;v.useEffect(()=>{if(s){let g=function(N){if(j.paused||!c)return;const P=N.target;c.contains(P)?f.current=P:il(f.current,{select:!0})},y=function(N){if(j.paused||!c)return;const P=N.relatedTarget;P!==null&&(c.contains(P)||il(f.current,{select:!0}))},C=function(N){if(document.activeElement===document.body)for(const w of N)w.removedNodes.length>0&&il(c)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const k=new MutationObserver(C);return c&&k.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),k.disconnect()}}},[s,c,j.paused]),v.useEffect(()=>{if(c){GE.add(j);const g=document.activeElement;if(!c.contains(g)){const C=new CustomEvent(fb,WE);c.addEventListener(fb,m),c.dispatchEvent(C),C.defaultPrevented||(QY(tQ(QI(c)),{select:!0}),document.activeElement===g&&il(c))}return()=>{c.removeEventListener(fb,m),setTimeout(()=>{const C=new CustomEvent(pb,WE);c.addEventListener(pb,h),c.dispatchEvent(C),C.defaultPrevented||il(g??document.body,{select:!0}),c.removeEventListener(pb,h),GE.remove(j)},0)}}},[c,m,h,j]);const b=v.useCallback(g=>{if(!r&&!s||j.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,C=document.activeElement;if(y&&C){const k=g.currentTarget,[N,P]=XY(k);N&&P?!g.shiftKey&&C===P?(g.preventDefault(),r&&il(N,{select:!0})):g.shiftKey&&C===N&&(g.preventDefault(),r&&il(P,{select:!0})):C===k&&g.preventDefault()}},[r,s,j.paused]);return e.jsx(gt.div,{tabIndex:-1,...o,ref:x,onKeyDown:b})});wf.displayName=YY;function QY(t,{select:n=!1}={}){const r=document.activeElement;for(const s of t)if(il(s,{select:n}),document.activeElement!==r)return}function XY(t){const n=QI(t),r=HE(n,t),s=HE(n.reverse(),t);return[r,s]}function QI(t){const n=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)n.push(r.currentNode);return n}function HE(t,n){for(const r of t)if(!ZY(r,{upTo:n}))return r}function ZY(t,{upTo:n}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(n!==void 0&&t===n)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function JY(t){return t instanceof HTMLInputElement&&"select"in t}function il(t,{select:n=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&JY(t)&&n&&t.select()}}var GE=eQ();function eQ(){let t=[];return{add(n){const r=t[0];n!==r&&r?.pause(),t=YE(t,n),t.unshift(n)},remove(n){t=YE(t,n),t[0]?.resume()}}}function YE(t,n){const r=[...t],s=r.indexOf(n);return s!==-1&&r.splice(s,1),r}function tQ(t){return t.filter(n=>n.tagName!=="A")}function NC(t){const n=v.useRef({value:t,previous:t});return v.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var nQ=function(t){if(typeof document>"u")return null;var n=Array.isArray(t)?t[0]:t;return n.ownerDocument.body},fd=new WeakMap,Hp=new WeakMap,Gp={},xb=0,XI=function(t){return t&&(t.host||XI(t.parentNode))},rQ=function(t,n){return n.map(function(r){if(t.contains(r))return r;var s=XI(r);return s&&t.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},sQ=function(t,n,r,s){var a=rQ(n,Array.isArray(t)?t:[t]);Gp[r]||(Gp[r]=new WeakMap);var i=Gp[r],o=[],c=new Set,u=new Set(a),m=function(f){!f||c.has(f)||(c.add(f),m(f.parentNode))};a.forEach(m);var h=function(f){!f||u.has(f)||Array.prototype.forEach.call(f.children,function(x){if(c.has(x))h(x);else try{var j=x.getAttribute(s),b=j!==null&&j!=="false",g=(fd.get(x)||0)+1,y=(i.get(x)||0)+1;fd.set(x,g),i.set(x,y),o.push(x),g===1&&b&&Hp.set(x,!0),y===1&&x.setAttribute(r,"true"),b||x.setAttribute(s,"true")}catch(C){console.error("aria-hidden: cannot operate on ",x,C)}})};return h(n),c.clear(),xb++,function(){o.forEach(function(f){var x=fd.get(f)-1,j=i.get(f)-1;fd.set(f,x),i.set(f,j),x||(Hp.has(f)||f.removeAttribute(s),Hp.delete(f)),j||f.removeAttribute(r)}),xb--,xb||(fd=new WeakMap,fd=new WeakMap,Hp=new WeakMap,Gp={})}},xv=function(t,n,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),a=nQ(t);return a?(s.push.apply(s,Array.from(a.querySelectorAll("[aria-live]"))),sQ(s,a,r,"aria-hidden")):function(){return null}},Oi=function(){return Oi=Object.assign||function(n){for(var r,s=1,a=arguments.length;s<a;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}return n},Oi.apply(this,arguments)};function ZI(t,n){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&n.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)n.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(r[s[a]]=t[s[a]]);return r}function aQ(t,n,r){if(r||arguments.length===2)for(var s=0,a=n.length,i;s<a;s++)(i||!(s in n))&&(i||(i=Array.prototype.slice.call(n,0,s)),i[s]=n[s]);return t.concat(i||Array.prototype.slice.call(n))}var yx="right-scroll-bar-position",jx="width-before-scroll-bar",iQ="with-scroll-bars-hidden",oQ="--removed-body-scroll-bar-size";function gb(t,n){return typeof t=="function"?t(n):t&&(t.current=n),t}function lQ(t,n){var r=v.useState(function(){return{value:t,callback:n,facade:{get current(){return r.value},set current(s){var a=r.value;a!==s&&(r.value=s,r.callback(s,a))}}}})[0];return r.callback=n,r.facade}var cQ=typeof window<"u"?v.useLayoutEffect:v.useEffect,QE=new WeakMap;function dQ(t,n){var r=lQ(null,function(s){return t.forEach(function(a){return gb(a,s)})});return cQ(function(){var s=QE.get(r);if(s){var a=new Set(s),i=new Set(t),o=r.current;a.forEach(function(c){i.has(c)||gb(c,null)}),i.forEach(function(c){a.has(c)||gb(c,o)})}QE.set(r,t)},[t]),r}function uQ(t){return t}function mQ(t,n){n===void 0&&(n=uQ);var r=[],s=!1,a={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(i){var o=n(i,s);return r.push(o),function(){r=r.filter(function(c){return c!==o})}},assignSyncMedium:function(i){for(s=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(c){return i(c)},filter:function(){return r}}},assignMedium:function(i){s=!0;var o=[];if(r.length){var c=r;r=[],c.forEach(i),o=r}var u=function(){var h=o;o=[],h.forEach(i)},m=function(){return Promise.resolve().then(u)};m(),r={push:function(h){o.push(h),m()},filter:function(h){return o=o.filter(h),r}}}};return a}function hQ(t){t===void 0&&(t={});var n=mQ(null);return n.options=Oi({async:!0,ssr:!1},t),n}var JI=function(t){var n=t.sideCar,r=ZI(t,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=n.read();if(!s)throw new Error("Sidecar medium not found");return v.createElement(s,Oi({},r))};JI.isSideCarExport=!0;function fQ(t,n){return t.useMedium(n),JI}var e3=hQ(),vb=function(){},gv=v.forwardRef(function(t,n){var r=v.useRef(null),s=v.useState({onScrollCapture:vb,onWheelCapture:vb,onTouchMoveCapture:vb}),a=s[0],i=s[1],o=t.forwardProps,c=t.children,u=t.className,m=t.removeScrollBar,h=t.enabled,f=t.shards,x=t.sideCar,j=t.noIsolation,b=t.inert,g=t.allowPinchZoom,y=t.as,C=y===void 0?"div":y,k=t.gapMode,N=ZI(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=x,w=dQ([r,n]),S=Oi(Oi({},N),a);return v.createElement(v.Fragment,null,h&&v.createElement(P,{sideCar:e3,removeScrollBar:m,shards:f,noIsolation:j,inert:b,setCallbacks:i,allowPinchZoom:!!g,lockRef:r,gapMode:k}),o?v.cloneElement(v.Children.only(c),Oi(Oi({},S),{ref:w})):v.createElement(C,Oi({},S,{className:u,ref:w}),c))});gv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};gv.classNames={fullWidth:jx,zeroRight:yx};var pQ=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function xQ(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var n=pQ();return n&&t.setAttribute("nonce",n),t}function gQ(t,n){t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}function vQ(t){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(t)}var yQ=function(){var t=0,n=null;return{add:function(r){t==0&&(n=xQ())&&(gQ(n,r),vQ(n)),t++},remove:function(){t--,!t&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},jQ=function(){var t=yQ();return function(n,r){v.useEffect(function(){return t.add(n),function(){t.remove()}},[n&&r])}},t3=function(){var t=jQ(),n=function(r){var s=r.styles,a=r.dynamic;return t(s,a),null};return n},bQ={left:0,top:0,right:0,gap:0},yb=function(t){return parseInt(t||"",10)||0},wQ=function(t){var n=window.getComputedStyle(document.body),r=n[t==="padding"?"paddingLeft":"marginLeft"],s=n[t==="padding"?"paddingTop":"marginTop"],a=n[t==="padding"?"paddingRight":"marginRight"];return[yb(r),yb(s),yb(a)]},_Q=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return bQ;var n=wQ(t),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,s-r+n[2]-n[0])}},NQ=t3(),qd="data-scroll-locked",SQ=function(t,n,r,s){var a=t.left,i=t.top,o=t.right,c=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(iQ,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(c,"px ").concat(s,`;
  }
  body[`).concat(qd,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(s,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(s,`;
    `),r==="padding"&&"padding-right: ".concat(c,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(yx,` {
    right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(jx,` {
    margin-right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(yx," .").concat(yx,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(jx," .").concat(jx,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(qd,`] {
    `).concat(oQ,": ").concat(c,`px;
  }
`)},XE=function(){var t=parseInt(document.body.getAttribute(qd)||"0",10);return isFinite(t)?t:0},CQ=function(){v.useEffect(function(){return document.body.setAttribute(qd,(XE()+1).toString()),function(){var t=XE()-1;t<=0?document.body.removeAttribute(qd):document.body.setAttribute(qd,t.toString())}},[])},kQ=function(t){var n=t.noRelative,r=t.noImportant,s=t.gapMode,a=s===void 0?"margin":s;CQ();var i=v.useMemo(function(){return _Q(a)},[a]);return v.createElement(NQ,{styles:SQ(i,!n,a,r?"":"!important")})},t1=!1;if(typeof window<"u")try{var Yp=Object.defineProperty({},"passive",{get:function(){return t1=!0,!0}});window.addEventListener("test",Yp,Yp),window.removeEventListener("test",Yp,Yp)}catch{t1=!1}var pd=t1?{passive:!1}:!1,PQ=function(t){return t.tagName==="TEXTAREA"},n3=function(t,n){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[n]!=="hidden"&&!(r.overflowY===r.overflowX&&!PQ(t)&&r[n]==="visible")},AQ=function(t){return n3(t,"overflowY")},EQ=function(t){return n3(t,"overflowX")},ZE=function(t,n){var r=n.ownerDocument,s=n;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var a=r3(t,s);if(a){var i=s3(t,s),o=i[1],c=i[2];if(o>c)return!0}s=s.parentNode}while(s&&s!==r.body);return!1},OQ=function(t){var n=t.scrollTop,r=t.scrollHeight,s=t.clientHeight;return[n,r,s]},TQ=function(t){var n=t.scrollLeft,r=t.scrollWidth,s=t.clientWidth;return[n,r,s]},r3=function(t,n){return t==="v"?AQ(n):EQ(n)},s3=function(t,n){return t==="v"?OQ(n):TQ(n)},MQ=function(t,n){return t==="h"&&n==="rtl"?-1:1},RQ=function(t,n,r,s,a){var i=MQ(t,window.getComputedStyle(n).direction),o=i*s,c=r.target,u=n.contains(c),m=!1,h=o>0,f=0,x=0;do{var j=s3(t,c),b=j[0],g=j[1],y=j[2],C=g-y-i*b;(b||C)&&r3(t,c)&&(f+=C,x+=b),c instanceof ShadowRoot?c=c.host:c=c.parentNode}while(!u&&c!==document.body||u&&(n.contains(c)||n===c));return(h&&Math.abs(f)<1||!h&&Math.abs(x)<1)&&(m=!0),m},Qp=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},JE=function(t){return[t.deltaX,t.deltaY]},eO=function(t){return t&&"current"in t?t.current:t},DQ=function(t,n){return t[0]===n[0]&&t[1]===n[1]},$Q=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},FQ=0,xd=[];function LQ(t){var n=v.useRef([]),r=v.useRef([0,0]),s=v.useRef(),a=v.useState(FQ++)[0],i=v.useState(t3)[0],o=v.useRef(t);v.useEffect(function(){o.current=t},[t]),v.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var g=aQ([t.lockRef.current],(t.shards||[]).map(eO),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var c=v.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var C=Qp(g),k=r.current,N="deltaX"in g?g.deltaX:k[0]-C[0],P="deltaY"in g?g.deltaY:k[1]-C[1],w,S=g.target,E=Math.abs(N)>Math.abs(P)?"h":"v";if("touches"in g&&E==="h"&&S.type==="range")return!1;var R=ZE(E,S);if(!R)return!0;if(R?w=E:(w=E==="v"?"h":"v",R=ZE(E,S)),!R)return!1;if(!s.current&&"changedTouches"in g&&(N||P)&&(s.current=w),!w)return!0;var T=s.current||w;return RQ(T,y,g,T==="h"?N:P)},[]),u=v.useCallback(function(g){var y=g;if(!(!xd.length||xd[xd.length-1]!==i)){var C="deltaY"in y?JE(y):Qp(y),k=n.current.filter(function(w){return w.name===y.type&&(w.target===y.target||y.target===w.shadowParent)&&DQ(w.delta,C)})[0];if(k&&k.should){y.cancelable&&y.preventDefault();return}if(!k){var N=(o.current.shards||[]).map(eO).filter(Boolean).filter(function(w){return w.contains(y.target)}),P=N.length>0?c(y,N[0]):!o.current.noIsolation;P&&y.cancelable&&y.preventDefault()}}},[]),m=v.useCallback(function(g,y,C,k){var N={name:g,delta:y,target:C,should:k,shadowParent:IQ(C)};n.current.push(N),setTimeout(function(){n.current=n.current.filter(function(P){return P!==N})},1)},[]),h=v.useCallback(function(g){r.current=Qp(g),s.current=void 0},[]),f=v.useCallback(function(g){m(g.type,JE(g),g.target,c(g,t.lockRef.current))},[]),x=v.useCallback(function(g){m(g.type,Qp(g),g.target,c(g,t.lockRef.current))},[]);v.useEffect(function(){return xd.push(i),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:x}),document.addEventListener("wheel",u,pd),document.addEventListener("touchmove",u,pd),document.addEventListener("touchstart",h,pd),function(){xd=xd.filter(function(g){return g!==i}),document.removeEventListener("wheel",u,pd),document.removeEventListener("touchmove",u,pd),document.removeEventListener("touchstart",h,pd)}},[]);var j=t.removeScrollBar,b=t.inert;return v.createElement(v.Fragment,null,b?v.createElement(i,{styles:$Q(a)}):null,j?v.createElement(kQ,{gapMode:t.gapMode}):null)}function IQ(t){for(var n=null;t!==null;)t instanceof ShadowRoot&&(n=t.host,t=t.host),t=t.parentNode;return n}const qQ=fQ(e3,LQ);var _f=v.forwardRef(function(t,n){return v.createElement(gv,Oi({},t,{ref:n,sideCar:qQ}))});_f.classNames=gv.classNames;var BQ=[" ","Enter","ArrowUp","ArrowDown"],zQ=[" ","Enter"],Nf="Select",[vv,yv,VQ]=pf(Nf),[Fu]=Kr(Nf,[VQ,Al]),jv=Al(),[UQ,Tl]=Fu(Nf),[KQ,WQ]=Fu(Nf),a3=t=>{const{__scopeSelect:n,children:r,open:s,defaultOpen:a,onOpenChange:i,value:o,defaultValue:c,onValueChange:u,dir:m,name:h,autoComplete:f,disabled:x,required:j,form:b}=t,g=jv(n),[y,C]=v.useState(null),[k,N]=v.useState(null),[P,w]=v.useState(!1),S=bf(m),[E=!1,R]=Zs({prop:s,defaultProp:a,onChange:i}),[T,U]=Zs({prop:o,defaultProp:c,onChange:u}),M=v.useRef(null),L=y?b||!!y.closest("form"):!0,[q,$]=v.useState(new Set),D=Array.from(q).map(z=>z.props.value).join(";");return e.jsx(sv,{...g,children:e.jsxs(UQ,{required:j,scope:n,trigger:y,onTriggerChange:C,valueNode:k,onValueNodeChange:N,valueNodeHasChildren:P,onValueNodeHasChildrenChange:w,contentId:jr(),value:T,onValueChange:U,open:E,onOpenChange:R,dir:S,triggerPointerDownPosRef:M,disabled:x,children:[e.jsx(vv.Provider,{scope:n,children:e.jsx(KQ,{scope:t.__scopeSelect,onNativeOptionAdd:v.useCallback(z=>{$(J=>new Set(J).add(z))},[]),onNativeOptionRemove:v.useCallback(z=>{$(J=>{const I=new Set(J);return I.delete(z),I})},[]),children:r})}),L?e.jsxs(E3,{"aria-hidden":!0,required:j,tabIndex:-1,name:h,autoComplete:f,value:T,onChange:z=>U(z.target.value),disabled:x,form:b,children:[T===void 0?e.jsx("option",{value:""}):null,Array.from(q)]},D):null]})})};a3.displayName=Nf;var i3="SelectTrigger",o3=v.forwardRef((t,n)=>{const{__scopeSelect:r,disabled:s=!1,...a}=t,i=jv(r),o=Tl(i3,r),c=o.disabled||s,u=cn(n,o.onTriggerChange),m=yv(r),h=v.useRef("touch"),[f,x,j]=O3(g=>{const y=m().filter(N=>!N.disabled),C=y.find(N=>N.value===o.value),k=T3(y,g,C);k!==void 0&&o.onValueChange(k.value)}),b=g=>{c||(o.onOpenChange(!0),j()),g&&(o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return e.jsx(vf,{asChild:!0,...i,children:e.jsx(gt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":A3(o.value)?"":void 0,...a,ref:u,onClick:ot(a.onClick,g=>{g.currentTarget.focus(),h.current!=="mouse"&&b(g)}),onPointerDown:ot(a.onPointerDown,g=>{h.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(b(g),g.preventDefault())}),onKeyDown:ot(a.onKeyDown,g=>{const y=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&x(g.key),!(y&&g.key===" ")&&BQ.includes(g.key)&&(b(),g.preventDefault())})})})});o3.displayName=i3;var l3="SelectValue",c3=v.forwardRef((t,n)=>{const{__scopeSelect:r,className:s,style:a,children:i,placeholder:o="",...c}=t,u=Tl(l3,r),{onValueNodeHasChildrenChange:m}=u,h=i!==void 0,f=cn(n,u.onValueNodeChange);return wr(()=>{m(h)},[m,h]),e.jsx(gt.span,{...c,ref:f,style:{pointerEvents:"none"},children:A3(u.value)?e.jsx(e.Fragment,{children:o}):i})});c3.displayName=l3;var HQ="SelectIcon",d3=v.forwardRef((t,n)=>{const{__scopeSelect:r,children:s,...a}=t;return e.jsx(gt.span,{"aria-hidden":!0,...a,ref:n,children:s||""})});d3.displayName=HQ;var GQ="SelectPortal",u3=t=>e.jsx(Tu,{asChild:!0,...t});u3.displayName=GQ;var Sc="SelectContent",m3=v.forwardRef((t,n)=>{const r=Tl(Sc,t.__scopeSelect),[s,a]=v.useState();if(wr(()=>{a(new DocumentFragment)},[]),!r.open){const i=s;return i?Ou.createPortal(e.jsx(h3,{scope:t.__scopeSelect,children:e.jsx(vv.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),i):null}return e.jsx(f3,{...t,ref:n})});m3.displayName=Sc;var ni=10,[h3,Ml]=Fu(Sc),YQ="SelectContentImpl",QQ=yl("SelectContent.RemoveScroll"),f3=v.forwardRef((t,n)=>{const{__scopeSelect:r,position:s="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:c,sideOffset:u,align:m,alignOffset:h,arrowPadding:f,collisionBoundary:x,collisionPadding:j,sticky:b,hideWhenDetached:g,avoidCollisions:y,...C}=t,k=Tl(Sc,r),[N,P]=v.useState(null),[w,S]=v.useState(null),E=cn(n,Ce=>P(Ce)),[R,T]=v.useState(null),[U,M]=v.useState(null),L=yv(r),[q,$]=v.useState(!1),D=v.useRef(!1);v.useEffect(()=>{if(N)return xv(N)},[N]),pv();const z=v.useCallback(Ce=>{const[Y,...ie]=L().map(Te=>Te.ref.current),[Ee]=ie.slice(-1),Ke=document.activeElement;for(const Te of Ce)if(Te===Ke||(Te?.scrollIntoView({block:"nearest"}),Te===Y&&w&&(w.scrollTop=0),Te===Ee&&w&&(w.scrollTop=w.scrollHeight),Te?.focus(),document.activeElement!==Ke))return},[L,w]),J=v.useCallback(()=>z([R,N]),[z,R,N]);v.useEffect(()=>{q&&J()},[q,J]);const{onOpenChange:I,triggerPointerDownPosRef:X}=k;v.useEffect(()=>{if(N){let Ce={x:0,y:0};const Y=Ee=>{Ce={x:Math.abs(Math.round(Ee.pageX)-(X.current?.x??0)),y:Math.abs(Math.round(Ee.pageY)-(X.current?.y??0))}},ie=Ee=>{Ce.x<=10&&Ce.y<=10?Ee.preventDefault():N.contains(Ee.target)||I(!1),document.removeEventListener("pointermove",Y),X.current=null};return X.current!==null&&(document.addEventListener("pointermove",Y),document.addEventListener("pointerup",ie,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Y),document.removeEventListener("pointerup",ie,{capture:!0})}}},[N,I,X]),v.useEffect(()=>{const Ce=()=>I(!1);return window.addEventListener("blur",Ce),window.addEventListener("resize",Ce),()=>{window.removeEventListener("blur",Ce),window.removeEventListener("resize",Ce)}},[I]);const[ne,W]=O3(Ce=>{const Y=L().filter(Ke=>!Ke.disabled),ie=Y.find(Ke=>Ke.ref.current===document.activeElement),Ee=T3(Y,Ce,ie);Ee&&setTimeout(()=>Ee.ref.current.focus())}),H=v.useCallback((Ce,Y,ie)=>{const Ee=!D.current&&!ie;(k.value!==void 0&&k.value===Y||Ee)&&(T(Ce),Ee&&(D.current=!0))},[k.value]),fe=v.useCallback(()=>N?.focus(),[N]),Pe=v.useCallback((Ce,Y,ie)=>{const Ee=!D.current&&!ie;(k.value!==void 0&&k.value===Y||Ee)&&M(Ce)},[k.value]),Re=s==="popper"?n1:p3,Ie=Re===n1?{side:c,sideOffset:u,align:m,alignOffset:h,arrowPadding:f,collisionBoundary:x,collisionPadding:j,sticky:b,hideWhenDetached:g,avoidCollisions:y}:{};return e.jsx(h3,{scope:r,content:N,viewport:w,onViewportChange:S,itemRefCallback:H,selectedItem:R,onItemLeave:fe,itemTextRefCallback:Pe,focusSelectedItem:J,selectedItemText:U,position:s,isPositioned:q,searchRef:ne,children:e.jsx(_f,{as:QQ,allowPinchZoom:!0,children:e.jsx(wf,{asChild:!0,trapped:k.open,onMountAutoFocus:Ce=>{Ce.preventDefault()},onUnmountAutoFocus:ot(a,Ce=>{k.trigger?.focus({preventScroll:!0}),Ce.preventDefault()}),children:e.jsx(Dc,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:Ce=>Ce.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:e.jsx(Re,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:Ce=>Ce.preventDefault(),...C,...Ie,onPlaced:()=>$(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...C.style},onKeyDown:ot(C.onKeyDown,Ce=>{const Y=Ce.ctrlKey||Ce.altKey||Ce.metaKey;if(Ce.key==="Tab"&&Ce.preventDefault(),!Y&&Ce.key.length===1&&W(Ce.key),["ArrowUp","ArrowDown","Home","End"].includes(Ce.key)){let Ee=L().filter(Ke=>!Ke.disabled).map(Ke=>Ke.ref.current);if(["ArrowUp","End"].includes(Ce.key)&&(Ee=Ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ce.key)){const Ke=Ce.target,Te=Ee.indexOf(Ke);Ee=Ee.slice(Te+1)}setTimeout(()=>z(Ee)),Ce.preventDefault()}})})})})})})});f3.displayName=YQ;var XQ="SelectItemAlignedPosition",p3=v.forwardRef((t,n)=>{const{__scopeSelect:r,onPlaced:s,...a}=t,i=Tl(Sc,r),o=Ml(Sc,r),[c,u]=v.useState(null),[m,h]=v.useState(null),f=cn(n,E=>h(E)),x=yv(r),j=v.useRef(!1),b=v.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:C,focusSelectedItem:k}=o,N=v.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&m&&g&&y&&C){const E=i.trigger.getBoundingClientRect(),R=m.getBoundingClientRect(),T=i.valueNode.getBoundingClientRect(),U=C.getBoundingClientRect();if(i.dir!=="rtl"){const Ke=U.left-R.left,Te=T.left-Ke,ct=E.left-Te,ut=E.width+ct,Dt=Math.max(ut,R.width),be=window.innerWidth-ni,pt=UE(Te,[ni,Math.max(ni,be-Dt)]);c.style.minWidth=ut+"px",c.style.left=pt+"px"}else{const Ke=R.right-U.right,Te=window.innerWidth-T.right-Ke,ct=window.innerWidth-E.right-Te,ut=E.width+ct,Dt=Math.max(ut,R.width),be=window.innerWidth-ni,pt=UE(Te,[ni,Math.max(ni,be-Dt)]);c.style.minWidth=ut+"px",c.style.right=pt+"px"}const M=x(),L=window.innerHeight-ni*2,q=g.scrollHeight,$=window.getComputedStyle(m),D=parseInt($.borderTopWidth,10),z=parseInt($.paddingTop,10),J=parseInt($.borderBottomWidth,10),I=parseInt($.paddingBottom,10),X=D+z+q+I+J,ne=Math.min(y.offsetHeight*5,X),W=window.getComputedStyle(g),H=parseInt(W.paddingTop,10),fe=parseInt(W.paddingBottom,10),Pe=E.top+E.height/2-ni,Re=L-Pe,Ie=y.offsetHeight/2,Ce=y.offsetTop+Ie,Y=D+z+Ce,ie=X-Y;if(Y<=Pe){const Ke=M.length>0&&y===M[M.length-1].ref.current;c.style.bottom="0px";const Te=m.clientHeight-g.offsetTop-g.offsetHeight,ct=Math.max(Re,Ie+(Ke?fe:0)+Te+J),ut=Y+ct;c.style.height=ut+"px"}else{const Ke=M.length>0&&y===M[0].ref.current;c.style.top="0px";const ct=Math.max(Pe,D+g.offsetTop+(Ke?H:0)+Ie)+ie;c.style.height=ct+"px",g.scrollTop=Y-Pe+g.offsetTop}c.style.margin=`${ni}px 0`,c.style.minHeight=ne+"px",c.style.maxHeight=L+"px",s?.(),requestAnimationFrame(()=>j.current=!0)}},[x,i.trigger,i.valueNode,c,m,g,y,C,i.dir,s]);wr(()=>N(),[N]);const[P,w]=v.useState();wr(()=>{m&&w(window.getComputedStyle(m).zIndex)},[m]);const S=v.useCallback(E=>{E&&b.current===!0&&(N(),k?.(),b.current=!1)},[N,k]);return e.jsx(JQ,{scope:r,contentWrapper:c,shouldExpandOnScrollRef:j,onScrollButtonChange:S,children:e.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:P},children:e.jsx(gt.div,{...a,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});p3.displayName=XQ;var ZQ="SelectPopperPosition",n1=v.forwardRef((t,n)=>{const{__scopeSelect:r,align:s="start",collisionPadding:a=ni,...i}=t,o=jv(r);return e.jsx(av,{...o,...i,ref:n,align:s,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});n1.displayName=ZQ;var[JQ,SC]=Fu(Sc,{}),r1="SelectViewport",x3=v.forwardRef((t,n)=>{const{__scopeSelect:r,nonce:s,...a}=t,i=Ml(r1,r),o=SC(r1,r),c=cn(n,i.onViewportChange),u=v.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),e.jsx(vv.Slot,{scope:r,children:e.jsx(gt.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ot(a.onScroll,m=>{const h=m.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:x}=o;if(x?.current&&f){const j=Math.abs(u.current-h.scrollTop);if(j>0){const b=window.innerHeight-ni*2,g=parseFloat(f.style.minHeight),y=parseFloat(f.style.height),C=Math.max(g,y);if(C<b){const k=C+j,N=Math.min(b,k),P=k-N;f.style.height=N+"px",f.style.bottom==="0px"&&(h.scrollTop=P>0?P:0,f.style.justifyContent="flex-end")}}}u.current=h.scrollTop})})})]})});x3.displayName=r1;var g3="SelectGroup",[eX,tX]=Fu(g3),nX=v.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,a=jr();return e.jsx(eX,{scope:r,id:a,children:e.jsx(gt.div,{role:"group","aria-labelledby":a,...s,ref:n})})});nX.displayName=g3;var v3="SelectLabel",y3=v.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,a=tX(v3,r);return e.jsx(gt.div,{id:a.id,...s,ref:n})});y3.displayName=v3;var Kx="SelectItem",[rX,j3]=Fu(Kx),b3=v.forwardRef((t,n)=>{const{__scopeSelect:r,value:s,disabled:a=!1,textValue:i,...o}=t,c=Tl(Kx,r),u=Ml(Kx,r),m=c.value===s,[h,f]=v.useState(i??""),[x,j]=v.useState(!1),b=cn(n,k=>u.itemRefCallback?.(k,s,a)),g=jr(),y=v.useRef("touch"),C=()=>{a||(c.onValueChange(s),c.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(rX,{scope:r,value:s,disabled:a,textId:g,isSelected:m,onItemTextChange:v.useCallback(k=>{f(N=>N||(k?.textContent??"").trim())},[]),children:e.jsx(vv.ItemSlot,{scope:r,value:s,disabled:a,textValue:h,children:e.jsx(gt.div,{role:"option","aria-labelledby":g,"data-highlighted":x?"":void 0,"aria-selected":m&&x,"data-state":m?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:b,onFocus:ot(o.onFocus,()=>j(!0)),onBlur:ot(o.onBlur,()=>j(!1)),onClick:ot(o.onClick,()=>{y.current!=="mouse"&&C()}),onPointerUp:ot(o.onPointerUp,()=>{y.current==="mouse"&&C()}),onPointerDown:ot(o.onPointerDown,k=>{y.current=k.pointerType}),onPointerMove:ot(o.onPointerMove,k=>{y.current=k.pointerType,a?u.onItemLeave?.():y.current==="mouse"&&k.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ot(o.onPointerLeave,k=>{k.currentTarget===document.activeElement&&u.onItemLeave?.()}),onKeyDown:ot(o.onKeyDown,k=>{u.searchRef?.current!==""&&k.key===" "||(zQ.includes(k.key)&&C(),k.key===" "&&k.preventDefault())})})})})});b3.displayName=Kx;var Hm="SelectItemText",w3=v.forwardRef((t,n)=>{const{__scopeSelect:r,className:s,style:a,...i}=t,o=Tl(Hm,r),c=Ml(Hm,r),u=j3(Hm,r),m=WQ(Hm,r),[h,f]=v.useState(null),x=cn(n,C=>f(C),u.onItemTextChange,C=>c.itemTextRefCallback?.(C,u.value,u.disabled)),j=h?.textContent,b=v.useMemo(()=>e.jsx("option",{value:u.value,disabled:u.disabled,children:j},u.value),[u.disabled,u.value,j]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=m;return wr(()=>(g(b),()=>y(b)),[g,y,b]),e.jsxs(e.Fragment,{children:[e.jsx(gt.span,{id:u.textId,...i,ref:x}),u.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Ou.createPortal(i.children,o.valueNode):null]})});w3.displayName=Hm;var _3="SelectItemIndicator",N3=v.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t;return j3(_3,r).isSelected?e.jsx(gt.span,{"aria-hidden":!0,...s,ref:n}):null});N3.displayName=_3;var s1="SelectScrollUpButton",S3=v.forwardRef((t,n)=>{const r=Ml(s1,t.__scopeSelect),s=SC(s1,t.__scopeSelect),[a,i]=v.useState(!1),o=cn(n,s.onScrollButtonChange);return wr(()=>{if(r.viewport&&r.isPositioned){let c=function(){const m=u.scrollTop>0;i(m)};const u=r.viewport;return c(),u.addEventListener("scroll",c),()=>u.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),a?e.jsx(k3,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:u}=r;c&&u&&(c.scrollTop=c.scrollTop-u.offsetHeight)}}):null});S3.displayName=s1;var a1="SelectScrollDownButton",C3=v.forwardRef((t,n)=>{const r=Ml(a1,t.__scopeSelect),s=SC(a1,t.__scopeSelect),[a,i]=v.useState(!1),o=cn(n,s.onScrollButtonChange);return wr(()=>{if(r.viewport&&r.isPositioned){let c=function(){const m=u.scrollHeight-u.clientHeight,h=Math.ceil(u.scrollTop)<m;i(h)};const u=r.viewport;return c(),u.addEventListener("scroll",c),()=>u.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),a?e.jsx(k3,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:u}=r;c&&u&&(c.scrollTop=c.scrollTop+u.offsetHeight)}}):null});C3.displayName=a1;var k3=v.forwardRef((t,n)=>{const{__scopeSelect:r,onAutoScroll:s,...a}=t,i=Ml("SelectScrollButton",r),o=v.useRef(null),c=yv(r),u=v.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return v.useEffect(()=>()=>u(),[u]),wr(()=>{c().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[c]),e.jsx(gt.div,{"aria-hidden":!0,...a,ref:n,style:{flexShrink:0,...a.style},onPointerDown:ot(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(s,50))}),onPointerMove:ot(a.onPointerMove,()=>{i.onItemLeave?.(),o.current===null&&(o.current=window.setInterval(s,50))}),onPointerLeave:ot(a.onPointerLeave,()=>{u()})})}),sX="SelectSeparator",P3=v.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t;return e.jsx(gt.div,{"aria-hidden":!0,...s,ref:n})});P3.displayName=sX;var i1="SelectArrow",aX=v.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,a=jv(r),i=Tl(i1,r),o=Ml(i1,r);return i.open&&o.position==="popper"?e.jsx(iv,{...a,...s,ref:n}):null});aX.displayName=i1;function A3(t){return t===""||t===void 0}var E3=v.forwardRef((t,n)=>{const{value:r,...s}=t,a=v.useRef(null),i=cn(n,a),o=NC(r);return v.useEffect(()=>{const c=a.current,u=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(u,"value").set;if(o!==r&&h){const f=new Event("change",{bubbles:!0});h.call(c,r),c.dispatchEvent(f)}},[o,r]),e.jsx(xf,{asChild:!0,children:e.jsx("select",{...s,ref:i,defaultValue:r})})});E3.displayName="BubbleSelect";function O3(t){const n=ss(t),r=v.useRef(""),s=v.useRef(0),a=v.useCallback(o=>{const c=r.current+o;n(c),(function u(m){r.current=m,window.clearTimeout(s.current),m!==""&&(s.current=window.setTimeout(()=>u(""),1e3))})(c)},[n]),i=v.useCallback(()=>{r.current="",window.clearTimeout(s.current)},[]);return v.useEffect(()=>()=>window.clearTimeout(s.current),[]),[r,a,i]}function T3(t,n,r){const a=n.length>1&&Array.from(n).every(m=>m===n[0])?n[0]:n,i=r?t.indexOf(r):-1;let o=iX(t,Math.max(i,0));a.length===1&&(o=o.filter(m=>m!==r));const u=o.find(m=>m.textValue.toLowerCase().startsWith(a.toLowerCase()));return u!==r?u:void 0}function iX(t,n){return t.map((r,s)=>t[(n+s)%t.length])}var oX=a3,M3=o3,lX=c3,cX=d3,dX=u3,R3=m3,uX=x3,D3=y3,$3=b3,mX=w3,hX=N3,F3=S3,L3=C3,I3=P3;const Qe=oX,Xe=lX,He=v.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(M3,{ref:s,className:We("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[n,e.jsx(cX,{asChild:!0,children:e.jsx(Xg,{className:"h-4 w-4 opacity-50"})})]}));He.displayName=M3.displayName;const q3=v.forwardRef(({className:t,...n},r)=>e.jsx(F3,{ref:r,className:We("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx(fW,{className:"h-4 w-4"})}));q3.displayName=F3.displayName;const B3=v.forwardRef(({className:t,...n},r)=>e.jsx(L3,{ref:r,className:We("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx(Xg,{className:"h-4 w-4"})}));B3.displayName=L3.displayName;const Ge=v.forwardRef(({className:t,children:n,position:r="popper",...s},a)=>e.jsx(dX,{children:e.jsxs(R3,{ref:a,className:We("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...s,children:[e.jsx(q3,{}),e.jsx(uX,{className:We("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(B3,{})]})}));Ge.displayName=R3.displayName;const fX=v.forwardRef(({className:t,...n},r)=>e.jsx(D3,{ref:r,className:We("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n}));fX.displayName=D3.displayName;const ee=v.forwardRef(({className:t,children:n,...r},s)=>e.jsxs($3,{ref:s,className:We("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(hX,{children:e.jsx(fs,{className:"h-4 w-4"})})}),e.jsx(mX,{children:n})]}));ee.displayName=$3.displayName;const pX=v.forwardRef(({className:t,...n},r)=>e.jsx(I3,{ref:r,className:We("-mx-1 my-1 h-px bg-muted",t),...n}));pX.displayName=I3.displayName;var CC="Dialog",[z3,V3]=Kr(CC),[xX,yi]=z3(CC),U3=t=>{const{__scopeDialog:n,children:r,open:s,defaultOpen:a,onOpenChange:i,modal:o=!0}=t,c=v.useRef(null),u=v.useRef(null),[m=!1,h]=Zs({prop:s,defaultProp:a,onChange:i});return e.jsx(xX,{scope:n,triggerRef:c,contentRef:u,contentId:jr(),titleId:jr(),descriptionId:jr(),open:m,onOpenChange:h,onOpenToggle:v.useCallback(()=>h(f=>!f),[h]),modal:o,children:r})};U3.displayName=CC;var K3="DialogTrigger",W3=v.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=yi(K3,r),i=cn(n,a.triggerRef);return e.jsx(gt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":AC(a.open),...s,ref:i,onClick:ot(t.onClick,a.onOpenToggle)})});W3.displayName=K3;var kC="DialogPortal",[gX,H3]=z3(kC,{forceMount:void 0}),G3=t=>{const{__scopeDialog:n,forceMount:r,children:s,container:a}=t,i=yi(kC,n);return e.jsx(gX,{scope:n,forceMount:r,children:v.Children.map(s,o=>e.jsx(Rs,{present:r||i.open,children:e.jsx(Tu,{asChild:!0,container:a,children:o})}))})};G3.displayName=kC;var Wx="DialogOverlay",Y3=v.forwardRef((t,n)=>{const r=H3(Wx,t.__scopeDialog),{forceMount:s=r.forceMount,...a}=t,i=yi(Wx,t.__scopeDialog);return i.modal?e.jsx(Rs,{present:s||i.open,children:e.jsx(yX,{...a,ref:n})}):null});Y3.displayName=Wx;var vX=yl("DialogOverlay.RemoveScroll"),yX=v.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=yi(Wx,r);return e.jsx(_f,{as:vX,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(gt.div,{"data-state":AC(a.open),...s,ref:n,style:{pointerEvents:"auto",...s.style}})})}),Cc="DialogContent",Q3=v.forwardRef((t,n)=>{const r=H3(Cc,t.__scopeDialog),{forceMount:s=r.forceMount,...a}=t,i=yi(Cc,t.__scopeDialog);return e.jsx(Rs,{present:s||i.open,children:i.modal?e.jsx(jX,{...a,ref:n}):e.jsx(bX,{...a,ref:n})})});Q3.displayName=Cc;var jX=v.forwardRef((t,n)=>{const r=yi(Cc,t.__scopeDialog),s=v.useRef(null),a=cn(n,r.contentRef,s);return v.useEffect(()=>{const i=s.current;if(i)return xv(i)},[]),e.jsx(X3,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ot(t.onCloseAutoFocus,i=>{i.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:ot(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&i.preventDefault()}),onFocusOutside:ot(t.onFocusOutside,i=>i.preventDefault())})}),bX=v.forwardRef((t,n)=>{const r=yi(Cc,t.__scopeDialog),s=v.useRef(!1),a=v.useRef(!1);return e.jsx(X3,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{t.onCloseAutoFocus?.(i),i.defaultPrevented||(s.current||r.triggerRef.current?.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{t.onInteractOutside?.(i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;r.triggerRef.current?.contains(o)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),X3=v.forwardRef((t,n)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=t,c=yi(Cc,r),u=v.useRef(null),m=cn(n,u);return pv(),e.jsxs(e.Fragment,{children:[e.jsx(wf,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(Dc,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":AC(c.open),...o,ref:m,onDismiss:()=>c.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(_X,{titleId:c.titleId}),e.jsx(SX,{contentRef:u,descriptionId:c.descriptionId})]})]})}),PC="DialogTitle",Z3=v.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=yi(PC,r);return e.jsx(gt.h2,{id:a.titleId,...s,ref:n})});Z3.displayName=PC;var J3="DialogDescription",eq=v.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=yi(J3,r);return e.jsx(gt.p,{id:a.descriptionId,...s,ref:n})});eq.displayName=J3;var tq="DialogClose",nq=v.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=yi(tq,r);return e.jsx(gt.button,{type:"button",...s,ref:n,onClick:ot(t.onClick,()=>a.onOpenChange(!1))})});nq.displayName=tq;function AC(t){return t?"open":"closed"}var rq="DialogTitleWarning",[wX,sq]=vK(rq,{contentName:Cc,titleName:PC,docsSlug:"dialog"}),_X=({titleId:t})=>{const n=sq(rq),r=`\`${n.contentName}\` requires a \`${n.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${n.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${n.docsSlug}`;return v.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},NX="DialogDescriptionWarning",SX=({contentRef:t,descriptionId:n})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${sq(NX).contentName}}.`;return v.useEffect(()=>{const a=t.current?.getAttribute("aria-describedby");n&&a&&(document.getElementById(n)||console.warn(s))},[s,t,n]),null},bv=U3,aq=W3,wv=G3,Lu=Y3,Iu=Q3,Sf=Z3,Cf=eq,_v=nq;const Vt=bv,lo=aq,CX=wv,iq=v.forwardRef(({className:t,...n},r)=>e.jsx(Lu,{ref:r,className:We("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));iq.displayName=Lu.displayName;const It=v.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(CX,{children:[e.jsx(iq,{}),e.jsxs(Iu,{ref:s,className:We("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[n,e.jsxs(_v,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));It.displayName=Iu.displayName;const qt=({className:t,...n})=>e.jsx("div",{className:We("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});qt.displayName="DialogHeader";const nn=({className:t,...n})=>e.jsx("div",{className:We("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});nn.displayName="DialogFooter";const Bt=v.forwardRef(({className:t,...n},r)=>e.jsx(Sf,{ref:r,className:We("text-lg font-semibold leading-none tracking-tight",t),...n}));Bt.displayName=Sf.displayName;const Qt=v.forwardRef(({className:t,...n},r)=>e.jsx(Cf,{ref:r,className:We("text-sm text-muted-foreground",t),...n}));Qt.displayName=Cf.displayName;const jb=1024;function kX(){const[t,n]=v.useState(void 0);return v.useEffect(()=>{const r=window.matchMedia(`(max-width: ${jb-1}px)`),s=()=>{n(window.innerWidth<jb)};return r.addEventListener("change",s),n(window.innerWidth<jb),()=>r.removeEventListener("change",s)},[]),!!t}var PX="Separator",tO="horizontal",AX=["horizontal","vertical"],oq=v.forwardRef((t,n)=>{const{decorative:r,orientation:s=tO,...a}=t,i=EX(s)?s:tO,c=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(gt.div,{"data-orientation":i,...c,...a,ref:n})});oq.displayName=PX;function EX(t){return AX.includes(t)}var lq=oq;const OX=v.forwardRef(({className:t,orientation:n="horizontal",decorative:r=!0,...s},a)=>e.jsx(lq,{ref:a,decorative:r,orientation:n,className:We("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...s}));OX.displayName=lq.displayName;const TX=bv,MX=wv,cq=v.forwardRef(({className:t,...n},r)=>e.jsx(Lu,{className:We("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:r}));cq.displayName=Lu.displayName;const RX=$c("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),dq=v.forwardRef(({side:t="right",className:n,children:r,...s},a)=>e.jsxs(MX,{children:[e.jsx(cq,{}),e.jsxs(Iu,{ref:a,className:We(RX({side:t}),n),...s,children:[r,e.jsxs(_v,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));dq.displayName=Iu.displayName;const uq=({className:t,...n})=>e.jsx("div",{className:We("flex flex-col space-y-2 text-center sm:text-left",t),...n});uq.displayName="SheetHeader";const mq=v.forwardRef(({className:t,...n},r)=>e.jsx(Sf,{ref:r,className:We("text-lg font-semibold text-foreground",t),...n}));mq.displayName=Sf.displayName;const hq=v.forwardRef(({className:t,...n},r)=>e.jsx(Cf,{ref:r,className:We("text-sm text-muted-foreground",t),...n}));hq.displayName=Cf.displayName;function bt({className:t,...n}){return e.jsx("div",{className:We("animate-pulse rounded-md bg-muted",t),...n})}const DX="sidebar_state",$X=3600*24*7,FX="16rem",LX="18rem",IX="3rem",qX="b",fq=v.createContext(null);function kf(){const t=v.useContext(fq);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}function BX({defaultOpen:t=!0,open:n,onOpenChange:r,className:s,style:a,children:i,...o}){const c=kX(),[u,m]=v.useState(!1),[h,f]=v.useState(t),x=n??h,j=v.useCallback(C=>{const k=typeof C=="function"?C(x):C;r?r(k):f(k),document.cookie=`${DX}=${k}; path=/; max-age=${$X}`},[r,x]),b=v.useCallback(()=>c?m(C=>!C):j(C=>!C),[c,j,m]);v.useEffect(()=>{const C=k=>{k.key===qX&&(k.metaKey||k.ctrlKey)&&(k.preventDefault(),b())};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[b]);const g=x?"expanded":"collapsed",y=v.useMemo(()=>({state:g,open:x,setOpen:j,isMobile:c,openMobile:u,setOpenMobile:m,toggleSidebar:b}),[g,x,j,c,u,m,b]);return e.jsx(fq.Provider,{value:y,children:e.jsx(mI,{delayDuration:0,children:e.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":FX,"--sidebar-width-icon":IX,...a},className:We("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",s),...o,children:i})})})}function zX({side:t="left",variant:n="sidebar",collapsible:r="offcanvas",className:s,children:a,...i}){const{isMobile:o,state:c,openMobile:u,setOpenMobile:m}=kf();return r==="none"?e.jsx("div",{"data-slot":"sidebar",className:We("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",s),...i,children:a}):o?e.jsx(TX,{open:u,onOpenChange:m,...i,children:e.jsxs(dq,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden",style:{"--sidebar-width":LX},side:t,children:[e.jsxs(uq,{className:"sr-only",children:[e.jsx(mq,{children:"Sidebar"}),e.jsx(hq,{children:"Displays the mobile sidebar."})]}),e.jsx("div",{className:"flex h-full w-full flex-col",children:a})]})}):e.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":c,"data-collapsible":c==="collapsed"?r:"","data-variant":n,"data-side":t,"data-slot":"sidebar",children:[e.jsx("div",{"data-slot":"sidebar-gap",className:We("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",n==="floating"||n==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]")}),e.jsx("div",{"data-slot":"sidebar-container",className:We("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",n==="floating"||n==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",s),...i,children:e.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:a})})]})}function VX({className:t,onClick:n,...r}){const{toggleSidebar:s}=kf();return e.jsxs(B,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:We("h-7 w-7",t),onClick:a=>{n?.(a),s()},...r,children:[e.jsx(OW,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function UX({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:We("flex flex-col gap-2 p-2",t),...n})}function KX({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:We("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...n})}function bb({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:We("relative flex w-full min-w-0 flex-col p-2",t),...n})}function nO({className:t,asChild:n=!1,...r}){const s=n?Gg:"div";return e.jsx(s,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:We("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...r})}function rO({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:We("w-full text-sm",t),...n})}function WX({className:t,...n}){return e.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:We("flex w-full min-w-0 flex-col gap-1",t),...n})}function HX({className:t,...n}){return e.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:We("group/menu-item relative",t),...n})}const GX=$c("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function YX({asChild:t=!1,isActive:n=!1,variant:r="default",size:s="default",tooltip:a,className:i,...o}){const c=t?Gg:"button",{isMobile:u,state:m}=kf(),h=e.jsx(c,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":s,"data-active":n,className:We(GX({variant:r,size:s}),i),...o});return a?(typeof a=="string"&&(a={children:a}),e.jsxs(HH,{children:[e.jsx(GH,{asChild:!0,children:h}),e.jsx(hI,{side:"right",align:"center",hidden:m!=="collapsed"||u,...a})]})):h}var EC="Avatar",[QX]=Kr(EC),[XX,pq]=QX(EC),xq=v.forwardRef((t,n)=>{const{__scopeAvatar:r,...s}=t,[a,i]=v.useState("idle");return e.jsx(XX,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:e.jsx(gt.span,{...s,ref:n})})});xq.displayName=EC;var gq="AvatarImage",vq=v.forwardRef((t,n)=>{const{__scopeAvatar:r,src:s,onLoadingStatusChange:a=()=>{},...i}=t,o=pq(gq,r),c=ZX(s,i),u=ss(m=>{a(m),o.onImageLoadingStatusChange(m)});return wr(()=>{c!=="idle"&&u(c)},[c,u]),c==="loaded"?e.jsx(gt.img,{...i,ref:n,src:s}):null});vq.displayName=gq;var yq="AvatarFallback",jq=v.forwardRef((t,n)=>{const{__scopeAvatar:r,delayMs:s,...a}=t,i=pq(yq,r),[o,c]=v.useState(s===void 0);return v.useEffect(()=>{if(s!==void 0){const u=window.setTimeout(()=>c(!0),s);return()=>window.clearTimeout(u)}},[s]),o&&i.imageLoadingStatus!=="loaded"?e.jsx(gt.span,{...a,ref:n}):null});jq.displayName=yq;function sO(t,n){return t?n?(t.src!==n&&(t.src=n),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ZX(t,{referrerPolicy:n,crossOrigin:r}){const s=eZ(),a=v.useRef(null),i=s?(a.current||(a.current=new window.Image),a.current):null,[o,c]=v.useState(()=>sO(i,t));return wr(()=>{c(sO(i,t))},[i,t]),wr(()=>{const u=f=>()=>{c(f)};if(!i)return;const m=u("loaded"),h=u("error");return i.addEventListener("load",m),i.addEventListener("error",h),n&&(i.referrerPolicy=n),typeof r=="string"&&(i.crossOrigin=r),()=>{i.removeEventListener("load",m),i.removeEventListener("error",h)}},[i,r,n]),o}function JX(){return()=>{}}function eZ(){return v.useSyncExternalStore(JX,()=>!0,()=>!1)}var bq=xq,wq=vq,_q=jq;const o1=v.forwardRef(({className:t,...n},r)=>e.jsx(bq,{ref:r,className:We(`
      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10
      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,t),...n}));o1.displayName=bq.displayName;const tZ=v.forwardRef(({className:t,...n},r)=>e.jsx(wq,{ref:r,className:We("aspect-square h-full w-full",t),...n}));tZ.displayName=wq.displayName;const l1=v.forwardRef(({className:t,...n},r)=>e.jsx(_q,{ref:r,className:We("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...n}));l1.displayName=_q.displayName;var OC="Popover",[Nq]=Kr(OC,[Al]),Pf=Al(),[nZ,Rl]=Nq(OC),Sq=t=>{const{__scopePopover:n,children:r,open:s,defaultOpen:a,onOpenChange:i,modal:o=!1}=t,c=Pf(n),u=v.useRef(null),[m,h]=v.useState(!1),[f=!1,x]=Zs({prop:s,defaultProp:a,onChange:i});return e.jsx(sv,{...c,children:e.jsx(nZ,{scope:n,contentId:jr(),triggerRef:u,open:f,onOpenChange:x,onOpenToggle:v.useCallback(()=>x(j=>!j),[x]),hasCustomAnchor:m,onCustomAnchorAdd:v.useCallback(()=>h(!0),[]),onCustomAnchorRemove:v.useCallback(()=>h(!1),[]),modal:o,children:r})})};Sq.displayName=OC;var Cq="PopoverAnchor",rZ=v.forwardRef((t,n)=>{const{__scopePopover:r,...s}=t,a=Rl(Cq,r),i=Pf(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=a;return v.useEffect(()=>(o(),()=>c()),[o,c]),e.jsx(vf,{...i,...s,ref:n})});rZ.displayName=Cq;var kq="PopoverTrigger",Pq=v.forwardRef((t,n)=>{const{__scopePopover:r,...s}=t,a=Rl(kq,r),i=Pf(r),o=cn(n,a.triggerRef),c=e.jsx(gt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Mq(a.open),...s,ref:o,onClick:ot(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?c:e.jsx(vf,{asChild:!0,...i,children:c})});Pq.displayName=kq;var TC="PopoverPortal",[sZ,aZ]=Nq(TC,{forceMount:void 0}),Aq=t=>{const{__scopePopover:n,forceMount:r,children:s,container:a}=t,i=Rl(TC,n);return e.jsx(sZ,{scope:n,forceMount:r,children:e.jsx(Rs,{present:r||i.open,children:e.jsx(Tu,{asChild:!0,container:a,children:s})})})};Aq.displayName=TC;var Zd="PopoverContent",Eq=v.forwardRef((t,n)=>{const r=aZ(Zd,t.__scopePopover),{forceMount:s=r.forceMount,...a}=t,i=Rl(Zd,t.__scopePopover);return e.jsx(Rs,{present:s||i.open,children:i.modal?e.jsx(oZ,{...a,ref:n}):e.jsx(lZ,{...a,ref:n})})});Eq.displayName=Zd;var iZ=yl("PopoverContent.RemoveScroll"),oZ=v.forwardRef((t,n)=>{const r=Rl(Zd,t.__scopePopover),s=v.useRef(null),a=cn(n,s),i=v.useRef(!1);return v.useEffect(()=>{const o=s.current;if(o)return xv(o)},[]),e.jsx(_f,{as:iZ,allowPinchZoom:!0,children:e.jsx(Oq,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ot(t.onCloseAutoFocus,o=>{o.preventDefault(),i.current||r.triggerRef.current?.focus()}),onPointerDownOutside:ot(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,m=c.button===2||u;i.current=m},{checkForDefaultPrevented:!1}),onFocusOutside:ot(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),lZ=v.forwardRef((t,n)=>{const r=Rl(Zd,t.__scopePopover),s=v.useRef(!1),a=v.useRef(!1);return e.jsx(Oq,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{t.onCloseAutoFocus?.(i),i.defaultPrevented||(s.current||r.triggerRef.current?.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{t.onInteractOutside?.(i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;r.triggerRef.current?.contains(o)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),Oq=v.forwardRef((t,n)=>{const{__scopePopover:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:m,onInteractOutside:h,...f}=t,x=Rl(Zd,r),j=Pf(r);return pv(),e.jsx(wf,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(Dc,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:h,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:m,onDismiss:()=>x.onOpenChange(!1),children:e.jsx(av,{"data-state":Mq(x.open),role:"dialog",id:x.contentId,...j,...f,ref:n,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Tq="PopoverClose",cZ=v.forwardRef((t,n)=>{const{__scopePopover:r,...s}=t,a=Rl(Tq,r);return e.jsx(gt.button,{type:"button",...s,ref:n,onClick:ot(t.onClick,()=>a.onOpenChange(!1))})});cZ.displayName=Tq;var dZ="PopoverArrow",uZ=v.forwardRef((t,n)=>{const{__scopePopover:r,...s}=t,a=Pf(r);return e.jsx(iv,{...a,...s,ref:n})});uZ.displayName=dZ;function Mq(t){return t?"open":"closed"}var mZ=Sq,hZ=Pq,fZ=Aq,Rq=Eq;const hc=mZ,fc=hZ,pl=v.forwardRef(({className:t,align:n="center",sideOffset:r=4,...s},a)=>e.jsx(fZ,{children:e.jsx(Rq,{ref:a,align:n,sideOffset:r,className:We("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...s})}));pl.displayName=Rq.displayName;function pZ(t){if(!t)return"";const n=new Date(t),s=new Date().getTime()-n.getTime(),a=Math.floor(s/6e4);if(a<1)return"just now";if(a<60)return`${a}m ago`;const i=Math.floor(a/60);if(i<24)return`${i}h ago`;const o=Math.floor(i/24);return o<7?`${o}d ago`:n.toLocaleDateString()}const xZ={info:Zg,warning:Ur,success:ps,error:Cs},gZ={info:"text-blue-500",warning:"text-yellow-500",success:"text-green-500",error:"text-destructive"};function vZ({organizationId:t}){const[n,r]=v.useState(!1),{data:s,isLoading:a}=$e({queryKey:["/api/organizations",t,"notifications"],enabled:!!t,refetchInterval:6e4}),i=Le({mutationFn:async m=>Be("PATCH",`/api/organizations/${t}/notifications/${m}/read`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"notifications"]})}}),o=Le({mutationFn:async()=>Be("PATCH",`/api/organizations/${t}/notifications/read-all`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"notifications"]})}}),c=s?.unread_count||0,u=s?.notifications||[];return e.jsxs(hc,{open:n,onOpenChange:r,children:[e.jsx(fc,{asChild:!0,children:e.jsxs(B,{variant:"ghost",size:"icon",className:"relative","data-testid":"button-notifications",children:[e.jsx(lE,{className:"h-4 w-4"}),c>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-destructive text-[10px] text-destructive-foreground",children:c>9?"9+":c})]})}),e.jsxs(pl,{className:"w-80 p-0",align:"end",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 p-3 border-b",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Notifications"}),c>0&&e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>o.mutate(),disabled:o.isPending,"data-testid":"button-mark-all-read",children:[e.jsx(hW,{className:"mr-1 h-3 w-3"}),"Mark all read"]})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:a?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ln,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):u.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(lE,{className:"h-8 w-8 mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):u.map(m=>{const h=xZ[m.notification_type]||Zg,f=gZ[m.notification_type]||"text-muted-foreground";return e.jsxs("div",{className:`flex gap-3 p-3 border-b last:border-b-0 cursor-pointer hover-elevate ${m.is_read?"":"bg-muted/40"}`,onClick:()=>{m.is_read||i.mutate(m.id),m.link&&(window.location.href=m.link,r(!1))},"data-testid":`notification-item-${m.id}`,children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(h,{className:`h-4 w-4 ${f}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-1",children:[e.jsx("p",{className:`text-sm font-medium truncate ${m.is_read?"text-muted-foreground":""}`,children:m.title}),!m.is_read&&e.jsx("span",{className:"flex-shrink-0 h-2 w-2 rounded-full bg-primary mt-1.5"})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mt-0.5",children:m.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:pZ(m.created_at)})]})]},m.id)})})]})]})}function tr({organizationId:t}){const n=gs(),[r,s]=v.useState(!1),a=async()=>{s(!0),await n.invalidateQueries({predicate:i=>{const o=i.queryKey;return!!(Array.isArray(o)&&o[0]==="/api/organizations"&&o[1]===t)}}),setTimeout(()=>s(!1),600)};return e.jsxs(B,{variant:"outline",size:"sm",onClick:a,disabled:r,children:[e.jsx(mi,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})}function fr(t){const{data:n}=$e({queryKey:["/api/organizations",t,"settings"],enabled:!!t}),r=n?.find(i=>i.setting_key==="currency")?.setting_value||"KES",s=Ux(r);return{currency:r,symbol:s,formatAmount:i=>HY(i,r)}}function yZ({organizationId:t,organizationName:n}){const{formatAmount:r}=fr(t),{data:s,isLoading:a,error:i}=$e({queryKey:["/api/organizations",t,"analytics","dashboard"],queryFn:async()=>{const o=await fetch(`/api/organizations/${t}/analytics/dashboard`,{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch dashboard data");return o.json()}});return i?e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"Dashboard"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Overview of ",n]})]}),e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center justify-center py-8 md:py-12 text-center",children:[e.jsx(Cs,{className:"h-10 w-10 md:h-12 md:w-12 text-destructive mb-3 md:mb-4"}),e.jsx("h3",{className:"font-medium text-sm md:text-base",children:"Unable to load dashboard"}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground",children:"Please try again later"})]})})]}):e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"Dashboard"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Overview of ",n]})]}),e.jsx(tr,{organizationId:t})]}),e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold mb-2 md:mb-3",children:"Organization"}),e.jsxs("div",{className:"grid gap-3 md:gap-4 grid-cols-3",children:[e.jsx(ca,{label:"Members",value:s?.total_members,icon:pn,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-950",isLoading:a}),e.jsx(ca,{label:"Staff",value:s?.total_staff,icon:fh,color:"text-indigo-600",bgColor:"bg-indigo-50 dark:bg-indigo-950",isLoading:a}),e.jsx(ca,{label:"Branches",value:s?.total_branches,icon:Yn,color:"text-slate-600",bgColor:"bg-slate-50 dark:bg-slate-900",isLoading:a})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold mb-2 md:mb-3",children:"Member Funds"}),e.jsxs("div",{className:"grid gap-3 md:gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsx(ca,{label:"Total Savings",value:s?r(s.total_savings):void 0,icon:Nx,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-950",isLoading:a}),e.jsx(ca,{label:"Total Shares",value:s?r(s.total_shares):void 0,icon:Ys,color:"text-teal-600",bgColor:"bg-teal-50 dark:bg-teal-950",isLoading:a})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold mb-2 md:mb-3",children:"Loan Portfolio"}),e.jsxs("div",{className:"grid gap-3 md:gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(ca,{label:"Disbursed",value:s?r(s.total_disbursed):void 0,icon:Mu,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-950",isLoading:a}),e.jsx(ca,{label:"Outstanding",value:s?r(s.total_outstanding):void 0,icon:gW,color:"text-red-600",bgColor:"bg-red-50 dark:bg-red-950",isLoading:a}),e.jsx(ca,{label:"Collected",value:s?r(s.total_repaid):void 0,icon:bL,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-950",isLoading:a}),e.jsx(ca,{label:"Collection Rate",value:s?`${s.collection_rate.toFixed(1)}%`:void 0,icon:ev,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-950",isLoading:a})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold mb-2 md:mb-3",children:"Loan Applications"}),e.jsxs("div",{className:"grid gap-3 md:gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(ca,{label:"Total",value:s?.total_loans,icon:tn,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-950",isLoading:a}),e.jsx(ca,{label:"Pending",value:s?.pending_loans,icon:bn,color:"text-yellow-600",bgColor:"bg-yellow-50 dark:bg-yellow-950",isLoading:a}),e.jsx(ca,{label:"Approved",value:s?.approved_loans,icon:ps,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-950",isLoading:a}),e.jsx(ca,{label:"Disbursed",value:s?.disbursed_loans,icon:xa,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-950",isLoading:a})]})]}),s&&s.default_count>0&&e.jsxs(oe,{className:"border-destructive/50 bg-destructive/5",children:[e.jsx(we,{className:"pb-2 md:pb-3 px-4 md:px-6 pt-4 md:pt-6",children:e.jsxs(_e,{className:"flex items-center gap-2 text-destructive text-sm md:text-base",children:[e.jsx(Ur,{className:"h-4 w-4 md:h-5 md:w-5"}),"Defaults & Collections"]})}),e.jsx(de,{className:"px-4 md:px-6 pb-4 md:pb-6",children:e.jsx("div",{className:"flex items-center gap-3 md:gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl md:text-3xl font-bold text-destructive",children:s.default_count}),e.jsxs("p",{className:"text-xs md:text-sm text-muted-foreground",children:[s.default_count===1?"loan":"loans"," currently overdue or in collection"]})]})})})]})]})]})}function ca({label:t,value:n,icon:r,color:s,bgColor:a,isLoading:i}){return e.jsx(oe,{className:"overflow-hidden",children:e.jsxs(de,{className:"flex items-center gap-2.5 md:gap-4 p-3 md:p-5",children:[e.jsx("div",{className:`rounded-full p-2 md:p-3 ${a} flex-shrink-0`,children:e.jsx(r,{className:`h-4 w-4 md:h-5 md:w-5 ${s}`})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[i?e.jsx(bt,{className:"h-5 md:h-7 w-16 md:w-20 mb-0.5 md:mb-1"}):e.jsx("p",{className:"text-base sm:text-lg md:text-2xl font-bold truncate",children:n??0}),e.jsx("p",{className:"text-[11px] md:text-sm text-muted-foreground truncate",children:t})]})]})})}const jZ=$c("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function ze({className:t,variant:n,...r}){return e.jsx("div",{className:We(jZ({variant:n}),t),...r})}const kt=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:We("w-full caption-bottom text-sm",t),...n})}));kt.displayName="Table";const Rt=v.forwardRef(({className:t,...n},r)=>e.jsx("thead",{ref:r,className:We("[&_tr]:border-b",t),...n}));Rt.displayName="TableHeader";const Pt=v.forwardRef(({className:t,...n},r)=>e.jsx("tbody",{ref:r,className:We("[&_tr:last-child]:border-0",t),...n}));Pt.displayName="TableBody";const bZ=v.forwardRef(({className:t,...n},r)=>e.jsx("tfoot",{ref:r,className:We("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n}));bZ.displayName="TableFooter";const qe=v.forwardRef(({className:t,...n},r)=>e.jsx("tr",{ref:r,className:We("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n}));qe.displayName="TableRow";const Q=v.forwardRef(({className:t,...n},r)=>e.jsx("th",{ref:r,className:We("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...n}));Q.displayName="TableHead";const V=v.forwardRef(({className:t,...n},r)=>e.jsx("td",{ref:r,className:We("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...n}));V.displayName="TableCell";const wZ=v.forwardRef(({className:t,...n},r)=>e.jsx("caption",{ref:r,className:We("mt-4 text-sm text-muted-foreground",t),...n}));wZ.displayName="TableCaption";const _Z=me.object({name:me.string().min(2,"Branch name is required"),address:me.string().optional(),phone:me.string().optional(),email:me.string().email("Invalid email").optional().or(me.literal(""))});function NZ({organizationId:t}){const{toast:n}=Xt(),[r,s]=v.useState(!1),[a,i]=v.useState(null),[o,c]=v.useState(null),{data:u,isLoading:m}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const y=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!y.ok)throw new Error("Failed to fetch branches");return y.json()}}),h=$n({resolver:Fn(_Z),defaultValues:{name:"",address:"",phone:"",email:""}}),f=Le({mutationFn:async y=>Be("POST",`/api/organizations/${t}/branches`,y),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"branches"]}),s(!1),h.reset(),n({title:"Branch created successfully"})},onError:()=>{n({title:"Failed to create branch",variant:"destructive"})}}),x=Le({mutationFn:async y=>{if(a)return Be("PATCH",`/api/organizations/${t}/branches/${a.id}`,y)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"branches"]}),i(null),h.reset(),n({title:"Branch updated successfully"})},onError:()=>{n({title:"Failed to update branch",variant:"destructive"})}}),j=Le({mutationFn:async()=>{if(o)return Be("DELETE",`/api/organizations/${t}/branches/${o.id}`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"branches"]}),c(null),n({title:"Branch deleted successfully"})},onError:()=>{n({title:"Failed to delete branch",variant:"destructive"})}}),b=y=>{i(y),h.reset({name:y.name,address:y.address||"",phone:y.phone||"",email:y.email||""})},g=y=>{a?x.mutate(y):f.mutate(y)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Branches"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your organization's branches"})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(_e,{children:"All Branches"}),e.jsxs(dt,{children:[u?.length||0," branches total"]})]}),e.jsxs(B,{onClick:()=>{h.reset(),s(!0)},"data-testid":"button-add-branch",className:"shrink-0",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Branch"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),e.jsx(de,{children:m?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):u&&u.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Name"}),e.jsx(Q,{children:"Code"}),e.jsx(Q,{children:"Location"}),e.jsx(Q,{children:"Contact"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:u.map(y=>e.jsxs(qe,{"data-testid":`row-branch-${y.id}`,children:[e.jsx(V,{className:"font-medium",children:y.name}),e.jsx(V,{children:y.code||"-"}),e.jsx(V,{children:y.address?e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Jm,{className:"h-3 w-3"}),y.address]}):"-"}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-1",children:[y.phone&&e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ic,{className:"h-3 w-3"}),y.phone]}),y.email&&e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ja,{className:"h-3 w-3"}),y.email]})]})}),e.jsx(V,{children:e.jsx(ze,{variant:y.is_active?"default":"secondary",children:y.is_active?"Active":"Inactive"})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>b(y),"data-testid":`button-edit-branch-${y.id}`,children:e.jsx(Ba,{className:"h-4 w-4"})}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>c(y),"data-testid":`button-delete-branch-${y.id}`,children:e.jsx(ba,{className:"h-4 w-4"})})]})})]},y.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Yn,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No branches yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Create your first branch to get started"}),e.jsxs(B,{onClick:()=>s(!0),"data-testid":"button-add-first-branch",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Add Branch"]})]})})]}),e.jsx(Vt,{open:r||!!a,onOpenChange:y=>{y||(s(!1),i(null),h.reset())},children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:a?"Edit Branch":"Add New Branch"}),e.jsx(Qt,{children:a?"Update branch details":"Create a new branch for your organization"})]}),e.jsx(Qn,{...h,children:e.jsxs("form",{onSubmit:h.handleSubmit(g),className:"space-y-4",children:[e.jsx(je,{control:h.control,name:"name",render:({field:y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Branch Name"}),e.jsx(ye,{children:e.jsx(re,{...y,placeholder:"Main Branch","data-testid":"input-branch-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:h.control,name:"address",render:({field:y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Address"}),e.jsx(ye,{children:e.jsx(re,{...y,placeholder:"123 Main Street","data-testid":"input-branch-address"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:h.control,name:"phone",render:({field:y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone"}),e.jsx(ye,{children:e.jsx(re,{...y,placeholder:"+254 700 000000","data-testid":"input-branch-phone"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:h.control,name:"email",render:({field:y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Email"}),e.jsx(ye,{children:e.jsx(re,{...y,type:"email",placeholder:"branch@example.com","data-testid":"input-branch-email"})}),e.jsx(Ne,{})]})})]}),e.jsxs(nn,{children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>{s(!1),i(null),h.reset()},children:"Cancel"}),e.jsx(B,{type:"submit",disabled:f.isPending||x.isPending,"data-testid":"button-save-branch",children:f.isPending||x.isPending?"Saving...":"Save"})]})]})})]})}),e.jsx(Vt,{open:!!o,onOpenChange:y=>!y&&c(null),children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Delete Branch"}),e.jsxs(Qt,{children:['Are you sure you want to delete "',o?.name,'"? This action cannot be undone.']})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>c(null),children:"Cancel"}),e.jsx(B,{variant:"destructive",onClick:()=>j.mutate(),disabled:j.isPending,"data-testid":"button-confirm-delete",children:j.isPending?"Deleting...":"Delete"})]})]})})]})}var wb="rovingFocusGroup.onEntryFocus",SZ={bubbles:!1,cancelable:!0},Nv="RovingFocusGroup",[c1,Dq,CZ]=pf(Nv),[kZ,Sv]=Kr(Nv,[CZ]),[PZ,AZ]=kZ(Nv),$q=v.forwardRef((t,n)=>e.jsx(c1.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(c1.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(EZ,{...t,ref:n})})}));$q.displayName=Nv;var EZ=v.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:r,orientation:s,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:m,preventScrollOnEntryFocus:h=!1,...f}=t,x=v.useRef(null),j=cn(n,x),b=bf(i),[g=null,y]=Zs({prop:o,defaultProp:c,onChange:u}),[C,k]=v.useState(!1),N=ss(m),P=Dq(r),w=v.useRef(!1),[S,E]=v.useState(0);return v.useEffect(()=>{const R=x.current;if(R)return R.addEventListener(wb,N),()=>R.removeEventListener(wb,N)},[N]),e.jsx(PZ,{scope:r,orientation:s,dir:b,loop:a,currentTabStopId:g,onItemFocus:v.useCallback(R=>y(R),[y]),onItemShiftTab:v.useCallback(()=>k(!0),[]),onFocusableItemAdd:v.useCallback(()=>E(R=>R+1),[]),onFocusableItemRemove:v.useCallback(()=>E(R=>R-1),[]),children:e.jsx(gt.div,{tabIndex:C||S===0?-1:0,"data-orientation":s,...f,ref:j,style:{outline:"none",...t.style},onMouseDown:ot(t.onMouseDown,()=>{w.current=!0}),onFocus:ot(t.onFocus,R=>{const T=!w.current;if(R.target===R.currentTarget&&T&&!C){const U=new CustomEvent(wb,SZ);if(R.currentTarget.dispatchEvent(U),!U.defaultPrevented){const M=P().filter(z=>z.focusable),L=M.find(z=>z.active),q=M.find(z=>z.id===g),D=[L,q,...M].filter(Boolean).map(z=>z.ref.current);Iq(D,h)}}w.current=!1}),onBlur:ot(t.onBlur,()=>k(!1))})})}),Fq="RovingFocusGroupItem",Lq=v.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:r,focusable:s=!0,active:a=!1,tabStopId:i,...o}=t,c=jr(),u=i||c,m=AZ(Fq,r),h=m.currentTabStopId===u,f=Dq(r),{onFocusableItemAdd:x,onFocusableItemRemove:j}=m;return v.useEffect(()=>{if(s)return x(),()=>j()},[s,x,j]),e.jsx(c1.ItemSlot,{scope:r,id:u,focusable:s,active:a,children:e.jsx(gt.span,{tabIndex:h?0:-1,"data-orientation":m.orientation,...o,ref:n,onMouseDown:ot(t.onMouseDown,b=>{s?m.onItemFocus(u):b.preventDefault()}),onFocus:ot(t.onFocus,()=>m.onItemFocus(u)),onKeyDown:ot(t.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){m.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const g=MZ(b,m.orientation,m.dir);if(g!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let C=f().filter(k=>k.focusable).map(k=>k.ref.current);if(g==="last")C.reverse();else if(g==="prev"||g==="next"){g==="prev"&&C.reverse();const k=C.indexOf(b.currentTarget);C=m.loop?RZ(C,k+1):C.slice(k+1)}setTimeout(()=>Iq(C))}})})})});Lq.displayName=Fq;var OZ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function TZ(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function MZ(t,n,r){const s=TZ(t.key,r);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return OZ[s]}function Iq(t,n=!1){const r=document.activeElement;for(const s of t)if(s===r||(s.focus({preventScroll:n}),document.activeElement!==r))return}function RZ(t,n){return t.map((r,s)=>t[(n+s)%t.length])}var qq=$q,Bq=Lq,d1=["Enter"," "],DZ=["ArrowDown","PageUp","Home"],zq=["ArrowUp","PageDown","End"],$Z=[...DZ,...zq],FZ={ltr:[...d1,"ArrowRight"],rtl:[...d1,"ArrowLeft"]},LZ={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Af="Menu",[Eh,IZ,qZ]=pf(Af),[Fc,Vq]=Kr(Af,[qZ,Al,Sv]),Cv=Al(),Uq=Sv(),[BZ,Lc]=Fc(Af),[zZ,Ef]=Fc(Af),Kq=t=>{const{__scopeMenu:n,open:r=!1,children:s,dir:a,onOpenChange:i,modal:o=!0}=t,c=Cv(n),[u,m]=v.useState(null),h=v.useRef(!1),f=ss(i),x=bf(a);return v.useEffect(()=>{const j=()=>{h.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>h.current=!1;return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),e.jsx(sv,{...c,children:e.jsx(BZ,{scope:n,open:r,onOpenChange:f,content:u,onContentChange:m,children:e.jsx(zZ,{scope:n,onClose:v.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:h,dir:x,modal:o,children:s})})})};Kq.displayName=Af;var VZ="MenuAnchor",MC=v.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t,a=Cv(r);return e.jsx(vf,{...a,...s,ref:n})});MC.displayName=VZ;var RC="MenuPortal",[UZ,Wq]=Fc(RC,{forceMount:void 0}),Hq=t=>{const{__scopeMenu:n,forceMount:r,children:s,container:a}=t,i=Lc(RC,n);return e.jsx(UZ,{scope:n,forceMount:r,children:e.jsx(Rs,{present:r||i.open,children:e.jsx(Tu,{asChild:!0,container:a,children:s})})})};Hq.displayName=RC;var Ia="MenuContent",[KZ,DC]=Fc(Ia),Gq=v.forwardRef((t,n)=>{const r=Wq(Ia,t.__scopeMenu),{forceMount:s=r.forceMount,...a}=t,i=Lc(Ia,t.__scopeMenu),o=Ef(Ia,t.__scopeMenu);return e.jsx(Eh.Provider,{scope:t.__scopeMenu,children:e.jsx(Rs,{present:s||i.open,children:e.jsx(Eh.Slot,{scope:t.__scopeMenu,children:o.modal?e.jsx(WZ,{...a,ref:n}):e.jsx(HZ,{...a,ref:n})})})})}),WZ=v.forwardRef((t,n)=>{const r=Lc(Ia,t.__scopeMenu),s=v.useRef(null),a=cn(n,s);return v.useEffect(()=>{const i=s.current;if(i)return xv(i)},[]),e.jsx($C,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:ot(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),HZ=v.forwardRef((t,n)=>{const r=Lc(Ia,t.__scopeMenu);return e.jsx($C,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),GZ=yl("MenuContent.ScrollLock"),$C=v.forwardRef((t,n)=>{const{__scopeMenu:r,loop:s=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEntryFocus:u,onEscapeKeyDown:m,onPointerDownOutside:h,onFocusOutside:f,onInteractOutside:x,onDismiss:j,disableOutsideScroll:b,...g}=t,y=Lc(Ia,r),C=Ef(Ia,r),k=Cv(r),N=Uq(r),P=IZ(r),[w,S]=v.useState(null),E=v.useRef(null),R=cn(n,E,y.onContentChange),T=v.useRef(0),U=v.useRef(""),M=v.useRef(0),L=v.useRef(null),q=v.useRef("right"),$=v.useRef(0),D=b?_f:v.Fragment,z=b?{as:GZ,allowPinchZoom:!0}:void 0,J=X=>{const ne=U.current+X,W=P().filter(Ce=>!Ce.disabled),H=document.activeElement,fe=W.find(Ce=>Ce.ref.current===H)?.textValue,Pe=W.map(Ce=>Ce.textValue),Re=iJ(Pe,ne,fe),Ie=W.find(Ce=>Ce.textValue===Re)?.ref.current;(function Ce(Y){U.current=Y,window.clearTimeout(T.current),Y!==""&&(T.current=window.setTimeout(()=>Ce(""),1e3))})(ne),Ie&&setTimeout(()=>Ie.focus())};v.useEffect(()=>()=>window.clearTimeout(T.current),[]),pv();const I=v.useCallback(X=>q.current===L.current?.side&&lJ(X,L.current?.area),[]);return e.jsx(KZ,{scope:r,searchRef:U,onItemEnter:v.useCallback(X=>{I(X)&&X.preventDefault()},[I]),onItemLeave:v.useCallback(X=>{I(X)||(E.current?.focus(),S(null))},[I]),onTriggerLeave:v.useCallback(X=>{I(X)&&X.preventDefault()},[I]),pointerGraceTimerRef:M,onPointerGraceIntentChange:v.useCallback(X=>{L.current=X},[]),children:e.jsx(D,{...z,children:e.jsx(wf,{asChild:!0,trapped:a,onMountAutoFocus:ot(i,X=>{X.preventDefault(),E.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:e.jsx(Dc,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:m,onPointerDownOutside:h,onFocusOutside:f,onInteractOutside:x,onDismiss:j,children:e.jsx(qq,{asChild:!0,...N,dir:C.dir,orientation:"vertical",loop:s,currentTabStopId:w,onCurrentTabStopIdChange:S,onEntryFocus:ot(u,X=>{C.isUsingKeyboardRef.current||X.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(av,{role:"menu","aria-orientation":"vertical","data-state":d5(y.open),"data-radix-menu-content":"",dir:C.dir,...k,...g,ref:R,style:{outline:"none",...g.style},onKeyDown:ot(g.onKeyDown,X=>{const W=X.target.closest("[data-radix-menu-content]")===X.currentTarget,H=X.ctrlKey||X.altKey||X.metaKey,fe=X.key.length===1;W&&(X.key==="Tab"&&X.preventDefault(),!H&&fe&&J(X.key));const Pe=E.current;if(X.target!==Pe||!$Z.includes(X.key))return;X.preventDefault();const Ie=P().filter(Ce=>!Ce.disabled).map(Ce=>Ce.ref.current);zq.includes(X.key)&&Ie.reverse(),sJ(Ie)}),onBlur:ot(t.onBlur,X=>{X.currentTarget.contains(X.target)||(window.clearTimeout(T.current),U.current="")}),onPointerMove:ot(t.onPointerMove,Oh(X=>{const ne=X.target,W=$.current!==X.clientX;if(X.currentTarget.contains(ne)&&W){const H=X.clientX>$.current?"right":"left";q.current=H,$.current=X.clientX}}))})})})})})})});Gq.displayName=Ia;var YZ="MenuGroup",FC=v.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t;return e.jsx(gt.div,{role:"group",...s,ref:n})});FC.displayName=YZ;var QZ="MenuLabel",Yq=v.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t;return e.jsx(gt.div,{...s,ref:n})});Yq.displayName=QZ;var Hx="MenuItem",aO="menu.itemSelect",kv=v.forwardRef((t,n)=>{const{disabled:r=!1,onSelect:s,...a}=t,i=v.useRef(null),o=Ef(Hx,t.__scopeMenu),c=DC(Hx,t.__scopeMenu),u=cn(n,i),m=v.useRef(!1),h=()=>{const f=i.current;if(!r&&f){const x=new CustomEvent(aO,{bubbles:!0,cancelable:!0});f.addEventListener(aO,j=>s?.(j),{once:!0}),XS(f,x),x.defaultPrevented?m.current=!1:o.onClose()}};return e.jsx(Qq,{...a,ref:u,disabled:r,onClick:ot(t.onClick,h),onPointerDown:f=>{t.onPointerDown?.(f),m.current=!0},onPointerUp:ot(t.onPointerUp,f=>{m.current||f.currentTarget?.click()}),onKeyDown:ot(t.onKeyDown,f=>{const x=c.searchRef.current!=="";r||x&&f.key===" "||d1.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});kv.displayName=Hx;var Qq=v.forwardRef((t,n)=>{const{__scopeMenu:r,disabled:s=!1,textValue:a,...i}=t,o=DC(Hx,r),c=Uq(r),u=v.useRef(null),m=cn(n,u),[h,f]=v.useState(!1),[x,j]=v.useState("");return v.useEffect(()=>{const b=u.current;b&&j((b.textContent??"").trim())},[i.children]),e.jsx(Eh.ItemSlot,{scope:r,disabled:s,textValue:a??x,children:e.jsx(Bq,{asChild:!0,...c,focusable:!s,children:e.jsx(gt.div,{role:"menuitem","data-highlighted":h?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:m,onPointerMove:ot(t.onPointerMove,Oh(b=>{s?o.onItemLeave(b):(o.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ot(t.onPointerLeave,Oh(b=>o.onItemLeave(b))),onFocus:ot(t.onFocus,()=>f(!0)),onBlur:ot(t.onBlur,()=>f(!1))})})})}),XZ="MenuCheckboxItem",Xq=v.forwardRef((t,n)=>{const{checked:r=!1,onCheckedChange:s,...a}=t;return e.jsx(n5,{scope:t.__scopeMenu,checked:r,children:e.jsx(kv,{role:"menuitemcheckbox","aria-checked":Gx(r)?"mixed":r,...a,ref:n,"data-state":IC(r),onSelect:ot(a.onSelect,()=>s?.(Gx(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Xq.displayName=XZ;var Zq="MenuRadioGroup",[ZZ,JZ]=Fc(Zq,{value:void 0,onValueChange:()=>{}}),Jq=v.forwardRef((t,n)=>{const{value:r,onValueChange:s,...a}=t,i=ss(s);return e.jsx(ZZ,{scope:t.__scopeMenu,value:r,onValueChange:i,children:e.jsx(FC,{...a,ref:n})})});Jq.displayName=Zq;var e5="MenuRadioItem",t5=v.forwardRef((t,n)=>{const{value:r,...s}=t,a=JZ(e5,t.__scopeMenu),i=r===a.value;return e.jsx(n5,{scope:t.__scopeMenu,checked:i,children:e.jsx(kv,{role:"menuitemradio","aria-checked":i,...s,ref:n,"data-state":IC(i),onSelect:ot(s.onSelect,()=>a.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});t5.displayName=e5;var LC="MenuItemIndicator",[n5,eJ]=Fc(LC,{checked:!1}),r5=v.forwardRef((t,n)=>{const{__scopeMenu:r,forceMount:s,...a}=t,i=eJ(LC,r);return e.jsx(Rs,{present:s||Gx(i.checked)||i.checked===!0,children:e.jsx(gt.span,{...a,ref:n,"data-state":IC(i.checked)})})});r5.displayName=LC;var tJ="MenuSeparator",s5=v.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t;return e.jsx(gt.div,{role:"separator","aria-orientation":"horizontal",...s,ref:n})});s5.displayName=tJ;var nJ="MenuArrow",a5=v.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t,a=Cv(r);return e.jsx(iv,{...a,...s,ref:n})});a5.displayName=nJ;var rJ="MenuSub",[qbe,i5]=Fc(rJ),Gm="MenuSubTrigger",o5=v.forwardRef((t,n)=>{const r=Lc(Gm,t.__scopeMenu),s=Ef(Gm,t.__scopeMenu),a=i5(Gm,t.__scopeMenu),i=DC(Gm,t.__scopeMenu),o=v.useRef(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:u}=i,m={__scopeMenu:t.__scopeMenu},h=v.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return v.useEffect(()=>h,[h]),v.useEffect(()=>{const f=c.current;return()=>{window.clearTimeout(f),u(null)}},[c,u]),e.jsx(MC,{asChild:!0,...m,children:e.jsx(Qq,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":d5(r.open),...t,ref:xo(n,a.onTriggerChange),onClick:f=>{t.onClick?.(f),!(t.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:ot(t.onPointerMove,Oh(f=>{i.onItemEnter(f),!f.defaultPrevented&&!t.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),h()},100))})),onPointerLeave:ot(t.onPointerLeave,Oh(f=>{h();const x=r.content?.getBoundingClientRect();if(x){const j=r.content?.dataset.side,b=j==="right",g=b?-5:5,y=x[b?"left":"right"],C=x[b?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+g,y:f.clientY},{x:y,y:x.top},{x:C,y:x.top},{x:C,y:x.bottom},{x:y,y:x.bottom}],side:j}),window.clearTimeout(c.current),c.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:ot(t.onKeyDown,f=>{const x=i.searchRef.current!=="";t.disabled||x&&f.key===" "||FZ[s.dir].includes(f.key)&&(r.onOpenChange(!0),r.content?.focus(),f.preventDefault())})})})});o5.displayName=Gm;var l5="MenuSubContent",c5=v.forwardRef((t,n)=>{const r=Wq(Ia,t.__scopeMenu),{forceMount:s=r.forceMount,...a}=t,i=Lc(Ia,t.__scopeMenu),o=Ef(Ia,t.__scopeMenu),c=i5(l5,t.__scopeMenu),u=v.useRef(null),m=cn(n,u);return e.jsx(Eh.Provider,{scope:t.__scopeMenu,children:e.jsx(Rs,{present:s||i.open,children:e.jsx(Eh.Slot,{scope:t.__scopeMenu,children:e.jsx($C,{id:c.contentId,"aria-labelledby":c.triggerId,...a,ref:m,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:h=>{o.isUsingKeyboardRef.current&&u.current?.focus(),h.preventDefault()},onCloseAutoFocus:h=>h.preventDefault(),onFocusOutside:ot(t.onFocusOutside,h=>{h.target!==c.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:ot(t.onEscapeKeyDown,h=>{o.onClose(),h.preventDefault()}),onKeyDown:ot(t.onKeyDown,h=>{const f=h.currentTarget.contains(h.target),x=LZ[o.dir].includes(h.key);f&&x&&(i.onOpenChange(!1),c.trigger?.focus(),h.preventDefault())})})})})})});c5.displayName=l5;function d5(t){return t?"open":"closed"}function Gx(t){return t==="indeterminate"}function IC(t){return Gx(t)?"indeterminate":t?"checked":"unchecked"}function sJ(t){const n=document.activeElement;for(const r of t)if(r===n||(r.focus(),document.activeElement!==n))return}function aJ(t,n){return t.map((r,s)=>t[(n+s)%t.length])}function iJ(t,n,r){const a=n.length>1&&Array.from(n).every(m=>m===n[0])?n[0]:n,i=r?t.indexOf(r):-1;let o=aJ(t,Math.max(i,0));a.length===1&&(o=o.filter(m=>m!==r));const u=o.find(m=>m.toLowerCase().startsWith(a.toLowerCase()));return u!==r?u:void 0}function oJ(t,n){const{x:r,y:s}=t;let a=!1;for(let i=0,o=n.length-1;i<n.length;o=i++){const c=n[i].x,u=n[i].y,m=n[o].x,h=n[o].y;u>s!=h>s&&r<(m-c)*(s-u)/(h-u)+c&&(a=!a)}return a}function lJ(t,n){if(!n)return!1;const r={x:t.clientX,y:t.clientY};return oJ(r,n)}function Oh(t){return n=>n.pointerType==="mouse"?t(n):void 0}var cJ=Kq,dJ=MC,uJ=Hq,mJ=Gq,hJ=FC,fJ=Yq,pJ=kv,xJ=Xq,gJ=Jq,vJ=t5,yJ=r5,jJ=s5,bJ=a5,wJ=o5,_J=c5,qC="DropdownMenu",[NJ]=Kr(qC,[Vq]),Ds=Vq(),[SJ,u5]=NJ(qC),m5=t=>{const{__scopeDropdownMenu:n,children:r,dir:s,open:a,defaultOpen:i,onOpenChange:o,modal:c=!0}=t,u=Ds(n),m=v.useRef(null),[h=!1,f]=Zs({prop:a,defaultProp:i,onChange:o});return e.jsx(SJ,{scope:n,triggerId:jr(),triggerRef:m,contentId:jr(),open:h,onOpenChange:f,onOpenToggle:v.useCallback(()=>f(x=>!x),[f]),modal:c,children:e.jsx(cJ,{...u,open:h,onOpenChange:f,dir:s,modal:c,children:r})})};m5.displayName=qC;var h5="DropdownMenuTrigger",f5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,disabled:s=!1,...a}=t,i=u5(h5,r),o=Ds(r);return e.jsx(dJ,{asChild:!0,...o,children:e.jsx(gt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...a,ref:xo(n,i.triggerRef),onPointerDown:ot(t.onPointerDown,c=>{!s&&c.button===0&&c.ctrlKey===!1&&(i.onOpenToggle(),i.open||c.preventDefault())}),onKeyDown:ot(t.onKeyDown,c=>{s||(["Enter"," "].includes(c.key)&&i.onOpenToggle(),c.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})})});f5.displayName=h5;var CJ="DropdownMenuPortal",p5=t=>{const{__scopeDropdownMenu:n,...r}=t,s=Ds(n);return e.jsx(uJ,{...s,...r})};p5.displayName=CJ;var x5="DropdownMenuContent",g5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=u5(x5,r),i=Ds(r),o=v.useRef(!1);return e.jsx(mJ,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...s,ref:n,onCloseAutoFocus:ot(t.onCloseAutoFocus,c=>{o.current||a.triggerRef.current?.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:ot(t.onInteractOutside,c=>{const u=c.detail.originalEvent,m=u.button===0&&u.ctrlKey===!0,h=u.button===2||m;(!a.modal||h)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});g5.displayName=x5;var kJ="DropdownMenuGroup",PJ=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(hJ,{...a,...s,ref:n})});PJ.displayName=kJ;var AJ="DropdownMenuLabel",v5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(fJ,{...a,...s,ref:n})});v5.displayName=AJ;var EJ="DropdownMenuItem",y5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(pJ,{...a,...s,ref:n})});y5.displayName=EJ;var OJ="DropdownMenuCheckboxItem",j5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(xJ,{...a,...s,ref:n})});j5.displayName=OJ;var TJ="DropdownMenuRadioGroup",MJ=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(gJ,{...a,...s,ref:n})});MJ.displayName=TJ;var RJ="DropdownMenuRadioItem",b5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(vJ,{...a,...s,ref:n})});b5.displayName=RJ;var DJ="DropdownMenuItemIndicator",w5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(yJ,{...a,...s,ref:n})});w5.displayName=DJ;var $J="DropdownMenuSeparator",_5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(jJ,{...a,...s,ref:n})});_5.displayName=$J;var FJ="DropdownMenuArrow",LJ=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(bJ,{...a,...s,ref:n})});LJ.displayName=FJ;var IJ="DropdownMenuSubTrigger",N5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(wJ,{...a,...s,ref:n})});N5.displayName=IJ;var qJ="DropdownMenuSubContent",S5=v.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,a=Ds(r);return e.jsx(_J,{...a,...s,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});S5.displayName=qJ;var BJ=m5,zJ=f5,VJ=p5,C5=g5,k5=v5,P5=y5,A5=j5,E5=b5,O5=w5,T5=_5,M5=N5,R5=S5;const UJ=BJ,KJ=zJ,WJ=v.forwardRef(({className:t,inset:n,children:r,...s},a)=>e.jsxs(M5,{ref:a,className:We("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...s,children:[r,e.jsx(Os,{className:"ml-auto"})]}));WJ.displayName=M5.displayName;const HJ=v.forwardRef(({className:t,...n},r)=>e.jsx(R5,{ref:r,className:We("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n}));HJ.displayName=R5.displayName;const D5=v.forwardRef(({className:t,sideOffset:n=4,...r},s)=>e.jsx(VJ,{children:e.jsx(C5,{ref:s,sideOffset:n,className:We("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...r})}));D5.displayName=C5.displayName;const tc=v.forwardRef(({className:t,inset:n,...r},s)=>e.jsx(P5,{ref:s,className:We("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...r}));tc.displayName=P5.displayName;const GJ=v.forwardRef(({className:t,children:n,checked:r,...s},a)=>e.jsxs(A5,{ref:a,className:We("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(O5,{children:e.jsx(fs,{className:"h-4 w-4"})})}),n]}));GJ.displayName=A5.displayName;const YJ=v.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(E5,{ref:s,className:We("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(O5,{children:e.jsx(jW,{className:"h-2 w-2 fill-current"})})}),n]}));YJ.displayName=E5.displayName;const QJ=v.forwardRef(({className:t,inset:n,...r},s)=>e.jsx(k5,{ref:s,className:We("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...r}));QJ.displayName=k5.displayName;const u1=v.forwardRef(({className:t,...n},r)=>e.jsx(T5,{ref:r,className:We("-mx-1 my-1 h-px bg-muted",t),...n}));u1.displayName=T5.displayName;function _r(t,n){const r=wC(t),s=r.hasPermission(`${n}:read`),a=r.hasPermission(`${n}:write`);return{...r,canRead:s,canWrite:a,resource:n}}const Nr={TELLER_STATION:"teller_station",FLOAT_MANAGEMENT:"float_management",STAFF:"staff",MEMBERS:"members",LOAN_PRODUCTS:"loan_products",LOANS:"loans",REPAYMENTS:"repayments",GUARANTORS:"guarantors",TRANSACTIONS:"transactions",FIXED_DEPOSITS:"fixed_deposits",DIVIDENDS:"dividends",CHART_OF_ACCOUNTS:"chart_of_accounts",JOURNAL_ENTRIES:"journal_entries",DEFAULTS:"defaults",RESTRUCTURE:"restructure",SMS:"sms",HR:"hr",LEAVE:"leave",EXPENSES:"expenses",ROLES:"roles"},XJ=me.object({first_name:me.string().min(1,"First name is required"),last_name:me.string().min(1,"Last name is required"),username:me.string().min(1,"Username is required").regex(/^[a-zA-Z0-9._-]+$/,"Username can only contain letters, numbers, dots, underscores, and hyphens"),secondary_email:me.string().email("Valid email is required").optional().or(me.literal("")),phone:me.string().optional(),password:me.string().min(6,"Password is required (min 6 characters)"),role:me.string().default("staff"),branch_id:me.string().min(1,"Branch is required"),national_id:me.string().min(1,"National ID is required"),date_of_birth:me.string().min(1,"Date of birth is required"),gender:me.string().optional(),next_of_kin_name:me.string().optional(),next_of_kin_phone:me.string().optional(),next_of_kin_relationship:me.string().optional()}),iO=[{value:"passport_photo",label:"Passport Photo"},{value:"id_front",label:"ID Card (Front)"},{value:"id_back",label:"ID Card (Back)"},{value:"cv_resume",label:"CV / Resume"},{value:"academic_certificate",label:"Academic Certificate"},{value:"professional_certificate",label:"Professional Certificate"},{value:"appointment_letter",label:"Appointment Letter"},{value:"contract",label:"Employment Contract"},{value:"kra_pin",label:"KRA PIN Certificate"},{value:"good_conduct",label:"Good Conduct Certificate"},{value:"other",label:"Other Document"}];function ZJ({organizationId:t,onBack:n}){const{toast:r}=Xt(),{user:s}=No(),a=v.useRef(null),[i,o]=v.useState(null),[c,u]=v.useState([]),[m,h]=v.useState(""),[f,x]=v.useState(""),[j,b]=v.useState([]),[g,y]=v.useState(!1),C=s?.branchId,k=s?.role,N=!C||k==="admin"||k==="owner",{data:P}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const z=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!z.ok)throw new Error("Failed to fetch branches");return z.json()}}),{data:w}=$e({queryKey:["/api/organizations",t,"roles"],queryFn:async()=>{const z=await fetch(`/api/organizations/${t}/roles`,{credentials:"include"});if(!z.ok)throw new Error("Failed to fetch roles");return z.json()}}),{data:S}=$e({queryKey:["/api/organizations",t],queryFn:async()=>{const z=await fetch(`/api/organizations/${t}`,{credentials:"include"});if(!z.ok)throw new Error("Failed to fetch organization");return z.json()}}),E=S?.name?.toLowerCase().replace(/[^a-z0-9]/g,"")||"organization",R=$n({resolver:Fn(XJ),defaultValues:{first_name:"",last_name:"",username:"",secondary_email:"",phone:"",password:"",role:"staff",branch_id:C||"",national_id:"",date_of_birth:"",gender:"",next_of_kin_name:"",next_of_kin_phone:"",next_of_kin_relationship:""}});v.useEffect(()=>{!N&&C&&R.setValue("branch_id",C)},[C,N]),v.useEffect(()=>{P&&P.length===1&&!R.getValues("branch_id")&&R.setValue("branch_id",P[0].id)},[P,R]);const T=v.useRef(c);T.current=c;const U=Le({mutationFn:async z=>{const J={...z};return!N&&C&&(J.branch_id=C),(await Be("POST",`/api/organizations/${t}/staff`,J)).json()},onSuccess:z=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]});const J=[...T.current];J.length>0?(o(z.id),q(z.id,J)):(r({title:"Staff member added",description:"The new staff member has been registered successfully."}),n())},onError:z=>{r({title:"Error",description:Vn(z),variant:"destructive"})}}),M=z=>{if(!m){r({title:"Select document type",description:"Please select a document type before adding a file.",variant:"destructive"});return}u(J=>[...J,{file:z,documentType:m,description:f}]),h(""),x(""),a.current&&(a.current.value="")},L=z=>{u(J=>J.filter((I,X)=>X!==z))},q=async(z,J)=>{y(!0);const I=[];for(const ne of J)try{const W=new FormData;W.append("file",ne.file),W.append("document_type",ne.documentType),ne.description&&W.append("description",ne.description);const H=await fetch(`/api/organizations/${t}/staff/${z}/documents`,{method:"POST",body:W,credentials:"include"});if(H.ok){const fe=await H.json();I.push(fe)}}catch(W){console.error("Failed to upload document:",W)}b(I),y(!1),u([]);const X=J.length-I.length;r({title:"Staff member added",description:X>0?`Staff created. ${I.length} documents uploaded, ${X} failed.`:`Staff created with ${I.length} documents uploaded successfully.`}),n()},$=z=>{U.mutate(z)},D=z=>z<1024?`${z} B`:z<1024*1024?`${(z/1024).toFixed(1)} KB`:`${(z/(1024*1024)).toFixed(1)} MB`;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:n,children:e.jsx($r,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Add New Staff Member"}),e.jsx("p",{className:"text-muted-foreground",children:"Register a new staff member to your organization"})]})]})}),e.jsx(Qn,{...R,children:e.jsxs("form",{onSubmit:R.handleSubmit($),className:"space-y-6",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($d,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Basic Information"})]})}),e.jsx(de,{children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:R.control,name:"first_name",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["First Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...z,placeholder:"Enter first name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:R.control,name:"last_name",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Last Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...z,placeholder:"Enter last name"})}),e.jsx(Ne,{})]})})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ja,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Contact Details"})]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:R.control,name:"username",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Work Email ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsxs("div",{className:"flex",children:[e.jsx(re,{...z,placeholder:"username",className:"rounded-r-none"}),e.jsxs("span",{className:"inline-flex items-center px-3 bg-muted border border-l-0 border-input rounded-r-md text-sm text-muted-foreground",children:["@",E,".com"]})]})}),e.jsx(Rn,{children:"This will be their login email"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:R.control,name:"phone",render:({field:z})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...z,placeholder:"e.g., 0712345678"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:R.control,name:"secondary_email",render:({field:z})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Personal Email (Optional)"}),e.jsx(ye,{children:e.jsx(re,{...z,type:"email",placeholder:"Personal email for payslip CC"})}),e.jsx(Rn,{children:"Payslip emails will be CC'd to this address"}),e.jsx(Ne,{})]})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Security"})]})}),e.jsx(de,{children:e.jsx(je,{control:R.control,name:"password",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Login Password ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...z,type:"password",placeholder:"Minimum 6 characters"})}),e.jsx(Rn,{children:"This password allows the staff member to log into the system"}),e.jsx(Ne,{})]})})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(NL,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Personal Information"})]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:R.control,name:"national_id",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["National ID Number ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...z,placeholder:"e.g., 12345678"})}),e.jsx(Rn,{children:"Used as payslip PDF password"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:R.control,name:"date_of_birth",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Date of Birth ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...z,type:"date"})}),e.jsx(Ne,{})]})})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.jsx(je,{control:R.control,name:"gender",render:({field:z})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Gender"}),e.jsxs(Qe,{onValueChange:z.onChange,value:z.value||"",children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select gender"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"male",children:"Male"}),e.jsx(ee,{value:"female",children:"Female"}),e.jsx(ee,{value:"other",children:"Other"})]})]}),e.jsx(Ne,{})]})})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Next of Kin"})]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:R.control,name:"next_of_kin_name",render:({field:z})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Full Name"}),e.jsx(ye,{children:e.jsx(re,{...z,placeholder:"Next of kin full name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:R.control,name:"next_of_kin_phone",render:({field:z})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...z,placeholder:"Phone number"})}),e.jsx(Ne,{})]})})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.jsx(je,{control:R.control,name:"next_of_kin_relationship",render:({field:z})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Relationship"}),e.jsxs(Qe,{onValueChange:z.onChange,value:z.value||"",children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select relationship"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"spouse",children:"Spouse"}),e.jsx(ee,{value:"parent",children:"Parent"}),e.jsx(ee,{value:"sibling",children:"Sibling"}),e.jsx(ee,{value:"child",children:"Child"}),e.jsx(ee,{value:"other",children:"Other"})]})]}),e.jsx(Ne,{})]})})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yn,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Assignment"})]})}),e.jsx(de,{children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:R.control,name:"role",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Role ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{onValueChange:z.onChange,value:z.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select role"})})}),e.jsx(Ge,{children:(w||[]).map(J=>e.jsx(ee,{value:J.name,children:J.name.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase())},J.name))})]}),e.jsx(Ne,{})]})}),!(P&&P.length===1)&&e.jsx(je,{control:R.control,name:"branch_id",render:({field:z})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Branch ",e.jsx("span",{className:"text-destructive",children:"*"})]}),N?e.jsxs(Qe,{onValueChange:z.onChange,value:z.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select branch"})})}),e.jsx(Ge,{children:P?.map(J=>e.jsx(ee,{value:J.id,children:J.name},J.id))})]}):e.jsx("div",{className:"text-sm text-muted-foreground p-3 bg-muted rounded-md border",children:P?.find(J=>J.id===C)?.name||"Your assigned branch"}),e.jsx(Ne,{})]})})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(SW,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Documents"})]}),e.jsx(dt,{children:"Upload staff documents such as ID copies, certificates, and contracts. Files will be uploaded when you register the staff member."})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Document Type"}),e.jsxs(Qe,{value:m,onValueChange:h,children:[e.jsx(He,{className:"mt-1.5",children:e.jsx(Xe,{placeholder:"Select document type"})}),e.jsx(Ge,{children:iO.map(z=>e.jsx(ee,{value:z.value,children:z.label},z.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description (Optional)"}),e.jsx(re,{className:"mt-1.5",value:f,onChange:z=>x(z.target.value),placeholder:"Brief description"})]})]}),e.jsxs("div",{children:[e.jsx("input",{ref:a,type:"file",className:"hidden",accept:".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx",onChange:z=>{const J=z.target.files?.[0];J&&M(J)}}),e.jsxs(B,{type:"button",variant:"outline",onClick:()=>a.current?.click(),disabled:!m,children:[e.jsx(CL,{className:"h-4 w-4 mr-2"}),"Choose File"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Supported: JPG, PNG, PDF, DOC. Max 5MB per file."})]}),c.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Queued Documents (",c.length,")"]}),c.map((z,J)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(tn,{className:"h-4 w-4 text-primary flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:z.file.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[iO.find(I=>I.value===z.documentType)?.label,"  ",D(z.file.size)]})]})]}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",onClick:()=>L(J),children:e.jsx(ba,{className:"h-4 w-4 text-destructive"})})]},J))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(B,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsx(B,{type:"submit",disabled:U.isPending||g,children:g?"Uploading Documents...":U.isPending?"Registering...":"Register Staff Member"})]})]})})]})}const JJ=me.object({first_name:me.string().min(1,"First name is required"),last_name:me.string().min(1,"Last name is required"),email:me.string().email("Valid email is required"),secondary_email:me.string().email("Valid email is required").optional().or(me.literal("")),phone:me.string().optional(),role:me.string().default("staff"),branch_id:me.string().optional(),national_id:me.string().optional(),date_of_birth:me.string().optional(),gender:me.string().optional(),next_of_kin_name:me.string().optional(),next_of_kin_phone:me.string().optional(),next_of_kin_relationship:me.string().optional()});function eee({organizationId:t,staffData:n,onBack:r}){const{toast:s}=Xt(),{user:a}=No(),[i,o]=v.useState(""),[c,u]=v.useState(""),m=a?.branchId,h=a?.role,f=!m||h==="admin"||h==="owner",{data:x}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch branches");return S.json()}}),{data:j}=$e({queryKey:["/api/organizations",t,"roles"],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/roles`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch roles");return S.json()}}),b=n,g=$n({resolver:Fn(JJ),defaultValues:{first_name:n.first_name,last_name:n.last_name,email:n.email,secondary_email:n.secondary_email||"",phone:n.phone||"",role:n.role,branch_id:n.branch_id||void 0,national_id:b.profile?.national_id||"",date_of_birth:b.profile?.date_of_birth||"",gender:b.profile?.gender||"",next_of_kin_name:b.profile?.next_of_kin_name||"",next_of_kin_phone:b.profile?.next_of_kin_phone||"",next_of_kin_relationship:b.profile?.next_of_kin_relationship||""}}),y=Le({mutationFn:async S=>Be("PATCH",`/api/organizations/${t}/staff/${n.id}`,S),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]}),s({title:"Staff member updated successfully"}),r()},onError:()=>{s({title:"Failed to update staff member",variant:"destructive"})}}),C=Le({mutationFn:async()=>Be("POST",`/api/organizations/${t}/staff/${n.id}/set-approval-pin`,{pin:i}),onSuccess:()=>{o(""),u(""),s({title:"Approval PIN set successfully"})},onError:S=>{s({title:"Failed to set approval PIN",description:Vn(S),variant:"destructive"})}}),k=()=>{if(i.length<4||i.length>6||!/^\d+$/.test(i)){s({title:"PIN must be 4-6 digits",variant:"destructive"});return}if(i!==c){s({title:"PINs do not match",variant:"destructive"});return}C.mutate()},N=S=>{y.mutate(S)},P=g.watch("role"),w=["manager","admin","supervisor","owner"].includes(P||"");return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:r,children:e.jsx($r,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Staff Member"}),e.jsxs("p",{className:"text-muted-foreground",children:[n.first_name," ",n.last_name]})]})]})}),e.jsx(Qn,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit(N),className:"space-y-6",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($d,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Basic Information"})]})}),e.jsx(de,{children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:g.control,name:"first_name",render:({field:S})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["First Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...S,placeholder:"Enter first name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:g.control,name:"last_name",render:({field:S})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Last Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...S,placeholder:"Enter last name"})}),e.jsx(Ne,{})]})})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ja,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Contact Details"})]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Work Email"}),e.jsx(re,{value:n.email||"",disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Email cannot be changed"})]}),e.jsx(je,{control:g.control,name:"phone",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...S,placeholder:"e.g., 0712345678"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:g.control,name:"secondary_email",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Personal Email (Optional)"}),e.jsx(ye,{children:e.jsx(re,{...S,type:"email",placeholder:"Personal email for payslip CC"})}),e.jsx(Rn,{children:"Payslip emails will be CC'd to this address"}),e.jsx(Ne,{})]})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(NL,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Personal Information"})]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:g.control,name:"national_id",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"National ID Number"}),e.jsx(ye,{children:e.jsx(re,{...S,placeholder:"e.g., 12345678"})}),e.jsx(Rn,{children:"Used as payslip PDF password"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:g.control,name:"date_of_birth",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Date of Birth"}),e.jsx(ye,{children:e.jsx(re,{...S,type:"date"})}),e.jsx(Ne,{})]})})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.jsx(je,{control:g.control,name:"gender",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Gender"}),e.jsxs(Qe,{onValueChange:S.onChange,value:S.value||"",children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select gender"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"male",children:"Male"}),e.jsx(ee,{value:"female",children:"Female"}),e.jsx(ee,{value:"other",children:"Other"})]})]}),e.jsx(Ne,{})]})})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Next of Kin"})]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:g.control,name:"next_of_kin_name",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Full Name"}),e.jsx(ye,{children:e.jsx(re,{...S,placeholder:"Next of kin full name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:g.control,name:"next_of_kin_phone",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...S,placeholder:"Phone number"})}),e.jsx(Ne,{})]})})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.jsx(je,{control:g.control,name:"next_of_kin_relationship",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Relationship"}),e.jsxs(Qe,{onValueChange:S.onChange,value:S.value||"",children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select relationship"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"spouse",children:"Spouse"}),e.jsx(ee,{value:"parent",children:"Parent"}),e.jsx(ee,{value:"sibling",children:"Sibling"}),e.jsx(ee,{value:"child",children:"Child"}),e.jsx(ee,{value:"other",children:"Other"})]})]}),e.jsx(Ne,{})]})})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yn,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Assignment"})]})}),e.jsx(de,{children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:g.control,name:"role",render:({field:S})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Role ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{onValueChange:S.onChange,value:S.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select role"})})}),e.jsx(Ge,{children:(j||[]).map(E=>e.jsx(ee,{value:E.name,children:E.name.replace(/_/g," ").replace(/\b\w/g,R=>R.toUpperCase())},E.name))})]}),e.jsx(Ne,{})]})}),!(x&&x.length===1)&&e.jsx(je,{control:g.control,name:"branch_id",render:({field:S})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Branch"}),f?e.jsxs(Qe,{onValueChange:S.onChange,value:S.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select branch"})})}),e.jsx(Ge,{children:x?.map(E=>e.jsx(ee,{value:E.id,children:E.name},E.id))})]}):e.jsx("div",{className:"text-sm text-muted-foreground p-3 bg-muted rounded-md border",children:x?.find(E=>E.id===m)?.name||"Your assigned branch"}),e.jsx(Ne,{})]})})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(B,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),e.jsx(B,{type:"submit",disabled:y.isPending,children:y.isPending?"Saving...":"Save Changes"})]})]})}),w&&e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hh,{className:"h-5 w-5 text-primary"}),e.jsx(_e,{children:"Approval PIN"})]}),e.jsx(dt,{children:"Set a 4-6 digit PIN for this staff member to approve float shortages and other sensitive operations at the teller station."})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"approval-pin",children:"New PIN"}),e.jsx(re,{id:"approval-pin",type:"password",inputMode:"numeric",maxLength:6,placeholder:"Enter 4-6 digit PIN",value:i,onChange:S=>o(S.target.value.replace(/\D/g,"")),"data-testid":"input-approval-pin"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"confirm-pin",children:"Confirm PIN"}),e.jsx(re,{id:"confirm-pin",type:"password",inputMode:"numeric",maxLength:6,placeholder:"Re-enter PIN",value:c,onChange:S=>u(S.target.value.replace(/\D/g,"")),"data-testid":"input-confirm-approval-pin"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(B,{type:"button",onClick:k,disabled:!i||!c||C.isPending,"data-testid":"button-set-approval-pin",children:[C.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(hh,{className:"mr-2 h-4 w-4"}),"Set Approval PIN"]})})]})]})]})}function tee({organizationId:t}){const{toast:n}=Xt(),{user:r}=No(),[s,a]=v.useState(!1),[i,o]=v.useState(!1),[c,u]=v.useState(null),[m,h]=v.useState(null),[f,x]=v.useState(null),[j,b]=v.useState(""),[g,y]=v.useState(1),[C,k]=v.useState(""),[N,P]=v.useState(""),w=15,{canWrite:S}=_r(t,Nr.STAFF);v.useEffect(()=>{const ne=setTimeout(()=>{P(C)},400);return()=>clearTimeout(ne)},[C]),r?.branchId,r?.role;const{data:E,isLoading:R}=$e({queryKey:["/api/organizations",t,"staff",N,g],queryFn:async()=>{const ne=new URLSearchParams;N.trim()&&ne.append("search",N.trim()),ne.append("page",g.toString()),ne.append("per_page",w.toString());const W=await fetch(`/api/organizations/${t}/staff?${ne.toString()}`,{credentials:"include"});if(!W.ok)throw new Error("Failed to fetch staff");return W.json()}}),T=E?.items,U=E?.total||0,M=E?.total_pages||0,{data:L}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const ne=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!ne.ok)throw new Error("Failed to fetch branches");return ne.json()}}),q=Le({mutationFn:async()=>{if(m)return Be("DELETE",`/api/organizations/${t}/staff/${m.id}`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]}),h(null),n({title:"Staff member deleted successfully"})},onError:ne=>{h(null),n({title:"Cannot delete staff",description:Vn(ne),variant:"destructive"})}}),$=Le({mutationFn:async ne=>Be("PUT",`/api/organizations/${t}/hr/staff/${ne}/lock`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]}),n({title:"Staff account locked"})},onError:()=>{n({title:"Failed to lock account",variant:"destructive"})}}),D=Le({mutationFn:async ne=>Be("PUT",`/api/organizations/${t}/hr/staff/${ne}/unlock`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]}),n({title:"Staff account unlocked"})},onError:()=>{n({title:"Failed to unlock account",variant:"destructive"})}}),z=Le({mutationFn:async ne=>Be("PUT",`/api/organizations/${t}/hr/staff/${ne}/activate`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]}),n({title:"Staff activated"})},onError:()=>{n({title:"Failed to activate staff",variant:"destructive"})}}),J=Le({mutationFn:async ne=>Be("PUT",`/api/organizations/${t}/hr/staff/${ne}/deactivate`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]}),n({title:"Staff deactivated"})},onError:()=>{n({title:"Failed to deactivate staff",variant:"destructive"})}}),I=Le({mutationFn:async()=>{if(f)return Be("PUT",`/api/organizations/${t}/hr/staff/${f.id}/reset-password`,{new_password:j})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff"]}),x(null),b(""),n({title:"Password reset successfully"})},onError:()=>{n({title:"Failed to reset password",variant:"destructive"})}});if(s)return e.jsx(ZJ,{organizationId:t,onBack:()=>a(!1)});if(i&&c)return e.jsx(eee,{organizationId:t,staffData:c,onBack:()=>{o(!1),u(null)}});const X=ne=>{switch(ne){case"admin":return"destructive";case"manager":return"default";case"loan_officer":return"secondary";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Staff Management"}),e.jsxs("p",{className:"text-muted-foreground",children:[U," staff member",U!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),S&&e.jsxs(B,{onClick:()=>a(!0),"data-testid":"button-add-staff",className:"shrink-0",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Staff"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(za,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search by name, email, or employee number...",value:C,onChange:ne=>{k(ne.target.value),y(1)},className:"pl-9"})]}),C&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>{k(""),y(1)},children:"Clear"})]}),R?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):T&&T.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Name"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Employee #"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Contact"}),e.jsx(Q,{children:"Role"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Branch"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:T.map(ne=>e.jsxs(qe,{"data-testid":`row-staff-${ne.id}`,children:[e.jsxs(V,{className:"font-medium",children:[e.jsxs("div",{children:[ne.first_name," ",ne.last_name]}),e.jsx("div",{className:"text-sm text-muted-foreground sm:hidden",children:ne.staff_number||""})]}),e.jsx(V,{className:"hidden sm:table-cell",children:ne.staff_number||"-"}),e.jsx(V,{className:"hidden md:table-cell",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ja,{className:"h-3 w-3"}),ne.email]}),ne.phone&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(ic,{className:"h-3 w-3"}),ne.phone]})]})}),e.jsx(V,{children:e.jsx(ze,{variant:X(ne.role),children:ne.role.replace("_"," ")})}),e.jsx(V,{className:"hidden lg:table-cell",children:ne.branch_name||"-"}),e.jsx(V,{className:"hidden sm:table-cell",children:e.jsx(ze,{variant:ne.is_active?"default":"secondary",children:ne.is_active?"Active":"Inactive"})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[S&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{u(ne),o(!0)},"data-testid":`button-edit-staff-${ne.id}`,children:e.jsx(Ba,{className:"h-4 w-4"})}),S&&e.jsxs(UJ,{children:[e.jsx(KJ,{asChild:!0,children:e.jsx(B,{variant:"ghost",size:"icon",children:e.jsx(NW,{className:"h-4 w-4"})})}),e.jsxs(D5,{align:"end",children:[e.jsxs(tc,{onClick:()=>x(ne),children:[e.jsx(hh,{className:"mr-2 h-4 w-4"}),"Reset Password"]}),e.jsx(u1,{}),ne.is_locked?e.jsxs(tc,{onClick:()=>D.mutate(ne.id),children:[e.jsx(SL,{className:"mr-2 h-4 w-4"}),"Unlock Account"]}):e.jsxs(tc,{onClick:()=>$.mutate(ne.id),children:[e.jsx(hl,{className:"mr-2 h-4 w-4"}),"Lock Account"]}),ne.is_active?e.jsxs(tc,{onClick:()=>J.mutate(ne.id),children:[e.jsx(FW,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):e.jsxs(tc,{onClick:()=>z.mutate(ne.id),children:[e.jsx(kL,{className:"mr-2 h-4 w-4"}),"Activate"]}),e.jsx(u1,{}),e.jsxs(tc,{onClick:()=>h(ne),className:"text-destructive",children:[e.jsx(ba,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})})]},ne.id))})]})}),M>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(g-1)*w+1,"-",Math.min(g*w,U)," of ",U," staff"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>y(ne=>Math.max(1,ne-1)),disabled:g<=1,children:e.jsx(vi,{className:"h-4 w-4"})}),Array.from({length:M},(ne,W)=>W+1).filter(ne=>ne===1||ne===M||Math.abs(ne-g)<=1).map((ne,W,H)=>e.jsxs("span",{children:[W>0&&H[W-1]!==ne-1&&e.jsx("span",{className:"px-1 text-muted-foreground",children:"..."}),e.jsx(B,{variant:ne===g?"default":"outline",size:"sm",className:"w-8 h-8 p-0",onClick:()=>y(ne),children:ne})]},ne)),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>y(ne=>Math.min(M,ne+1)),disabled:g>=M,children:e.jsx(Os,{className:"h-4 w-4"})})]})]})]}):C?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(za,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No results found"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:['No staff match "',C,'"']}),e.jsx(B,{variant:"outline",onClick:()=>{k(""),y(1)},children:"Clear Search"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(pn,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No staff members yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Add your first staff member to get started"}),S&&e.jsxs(B,{onClick:()=>a(!0),"data-testid":"button-add-first-staff",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Add Staff"]})]})]})}),e.jsx(Vt,{open:!!m,onOpenChange:ne=>!ne&&h(null),children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Delete Staff Member"}),e.jsxs(Qt,{children:['Are you sure you want to delete "',m?.first_name," ",m?.last_name,'"? This action cannot be undone.']})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>h(null),children:"Cancel"}),e.jsx(B,{variant:"destructive",onClick:()=>q.mutate(),disabled:q.isPending,"data-testid":"button-confirm-delete-staff",children:q.isPending?"Deleting...":"Delete"})]})]})}),e.jsx(Vt,{open:!!f,onOpenChange:ne=>{ne||(x(null),b(""))},children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Reset Password"}),e.jsxs(Qt,{children:["Set a new password for ",f?.first_name," ",f?.last_name]})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"New Password"}),e.jsx(re,{type:"password",placeholder:"Enter new password (min 6 characters)",value:j,onChange:ne=>b(ne.target.value)})]})}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>{x(null),b("")},children:"Cancel"}),e.jsx(B,{onClick:()=>I.mutate(),disabled:j.length<6||I.isPending,children:I.isPending?"Resetting...":"Reset Password"})]})]})})]})}const fn=v.forwardRef(({className:t,...n},r)=>e.jsx("textarea",{className:We("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));fn.displayName="Textarea";var BC="Tabs",[nee]=Kr(BC,[Sv]),$5=Sv(),[ree,zC]=nee(BC),F5=v.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:u="automatic",...m}=t,h=bf(c),[f,x]=Zs({prop:s,onChange:a,defaultProp:i});return e.jsx(ree,{scope:r,baseId:jr(),value:f,onValueChange:x,orientation:o,dir:h,activationMode:u,children:e.jsx(gt.div,{dir:h,"data-orientation":o,...m,ref:n})})});F5.displayName=BC;var L5="TabsList",I5=v.forwardRef((t,n)=>{const{__scopeTabs:r,loop:s=!0,...a}=t,i=zC(L5,r),o=$5(r);return e.jsx(qq,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:s,children:e.jsx(gt.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:n})})});I5.displayName=L5;var q5="TabsTrigger",B5=v.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,disabled:a=!1,...i}=t,o=zC(q5,r),c=$5(r),u=U5(o.baseId,s),m=K5(o.baseId,s),h=s===o.value;return e.jsx(Bq,{asChild:!0,...c,focusable:!a,active:h,children:e.jsx(gt.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":m,"data-state":h?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:u,...i,ref:n,onMouseDown:ot(t.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?o.onValueChange(s):f.preventDefault()}),onKeyDown:ot(t.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(s)}),onFocus:ot(t.onFocus,()=>{const f=o.activationMode!=="manual";!h&&!a&&f&&o.onValueChange(s)})})})});B5.displayName=q5;var z5="TabsContent",V5=v.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,forceMount:a,children:i,...o}=t,c=zC(z5,r),u=U5(c.baseId,s),m=K5(c.baseId,s),h=s===c.value,f=v.useRef(h);return v.useEffect(()=>{const x=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(x)},[]),e.jsx(Rs,{present:a||h,children:({present:x})=>e.jsx(gt.div,{"data-state":h?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!x,id:m,tabIndex:0,...o,ref:n,style:{...t.style,animationDuration:f.current?"0s":void 0},children:x&&i})})});V5.displayName=z5;function U5(t,n){return`${t}-trigger-${n}`}function K5(t,n){return`${t}-content-${n}`}var see=F5,W5=I5,H5=B5,G5=V5;const $s=see,vs=v.forwardRef(({className:t,...n},r)=>e.jsx(W5,{ref:r,className:We("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...n}));vs.displayName=W5.displayName;const _t=v.forwardRef(({className:t,...n},r)=>e.jsx(H5,{ref:r,className:We("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...n}));_t.displayName=H5.displayName;const Nt=v.forwardRef(({className:t,...n},r)=>e.jsx(G5,{ref:r,className:We("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n}));Nt.displayName=G5.displayName;var Y5="AlertDialog",[aee]=Kr(Y5,[V3]),So=V3(),Q5=t=>{const{__scopeAlertDialog:n,...r}=t,s=So(n);return e.jsx(bv,{...s,...r,modal:!0})};Q5.displayName=Y5;var iee="AlertDialogTrigger",oee=v.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,a=So(r);return e.jsx(aq,{...a,...s,ref:n})});oee.displayName=iee;var lee="AlertDialogPortal",X5=t=>{const{__scopeAlertDialog:n,...r}=t,s=So(n);return e.jsx(wv,{...s,...r})};X5.displayName=lee;var cee="AlertDialogOverlay",Z5=v.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,a=So(r);return e.jsx(Lu,{...a,...s,ref:n})});Z5.displayName=cee;var Bd="AlertDialogContent",[dee,uee]=aee(Bd),mee=YF("AlertDialogContent"),J5=v.forwardRef((t,n)=>{const{__scopeAlertDialog:r,children:s,...a}=t,i=So(r),o=v.useRef(null),c=cn(n,o),u=v.useRef(null);return e.jsx(wX,{contentName:Bd,titleName:e6,docsSlug:"alert-dialog",children:e.jsx(dee,{scope:r,cancelRef:u,children:e.jsxs(Iu,{role:"alertdialog",...i,...a,ref:c,onOpenAutoFocus:ot(a.onOpenAutoFocus,m=>{m.preventDefault(),u.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(mee,{children:s}),e.jsx(fee,{contentRef:o})]})})})});J5.displayName=Bd;var e6="AlertDialogTitle",t6=v.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,a=So(r);return e.jsx(Sf,{...a,...s,ref:n})});t6.displayName=e6;var n6="AlertDialogDescription",r6=v.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,a=So(r);return e.jsx(Cf,{...a,...s,ref:n})});r6.displayName=n6;var hee="AlertDialogAction",s6=v.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,a=So(r);return e.jsx(_v,{...a,...s,ref:n})});s6.displayName=hee;var a6="AlertDialogCancel",i6=v.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,{cancelRef:a}=uee(a6,r),i=So(r),o=cn(n,a);return e.jsx(_v,{...i,...s,ref:o})});i6.displayName=a6;var fee=({contentRef:t})=>{const n=`\`${Bd}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Bd}\` by passing a \`${n6}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Bd}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return v.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(n)},[n,t]),null},pee=Q5,xee=X5,o6=Z5,l6=J5,c6=s6,d6=i6,u6=t6,m6=r6;const oO=pee,gee=xee,h6=v.forwardRef(({className:t,...n},r)=>e.jsx(o6,{className:We("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:r}));h6.displayName=o6.displayName;const m1=v.forwardRef(({className:t,...n},r)=>e.jsxs(gee,{children:[e.jsx(h6,{}),e.jsx(l6,{ref:r,className:We("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n})]}));m1.displayName=l6.displayName;const h1=({className:t,...n})=>e.jsx("div",{className:We("flex flex-col space-y-2 text-center sm:text-left",t),...n});h1.displayName="AlertDialogHeader";const f1=({className:t,...n})=>e.jsx("div",{className:We("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});f1.displayName="AlertDialogFooter";const p1=v.forwardRef(({className:t,...n},r)=>e.jsx(u6,{ref:r,className:We("text-lg font-semibold",t),...n}));p1.displayName=u6.displayName;const x1=v.forwardRef(({className:t,...n},r)=>e.jsx(m6,{ref:r,className:We("text-sm text-muted-foreground",t),...n}));x1.displayName=m6.displayName;const g1=v.forwardRef(({className:t,...n},r)=>e.jsx(c6,{ref:r,className:We(yC(),t),...n}));g1.displayName=c6.displayName;const v1=v.forwardRef(({className:t,...n},r)=>e.jsx(d6,{ref:r,className:We(yC({variant:"outline"}),"mt-2 sm:mt-0",t),...n}));v1.displayName=d6.displayName;function f6({organizationId:t,memberId:n,onBack:r}){const{symbol:s}=fr(t),[a,i]=v.useState("all"),[o,c]=v.useState(""),[u,m]=v.useState(""),{data:h,isLoading:f}=$e({queryKey:["/api/organizations",t,"members",n],queryFn:async()=>{const E=await fetch(`/api/organizations/${t}/members/${n}`,{credentials:"include"});if(!E.ok)throw new Error("Failed to load member");return E.json()}}),{data:x,isLoading:j}=$e({queryKey:["/api/organizations",t,"transactions","member",n,a],queryFn:async()=>{let E=`/api/organizations/${t}/transactions?member_id=${n}&page_size=100`;a!=="all"&&(E+=`&account_type=${a}`);const R=await fetch(E,{credentials:"include"});if(!R.ok)return[];const T=await R.json();return Array.isArray(T)?T:T.items||[]}}),{data:b=[],isLoading:g}=$e({queryKey:["/api/organizations",t,"fixed-deposits","member",n],queryFn:async()=>{const E=await fetch(`/api/organizations/${t}/fixed-deposits?member_id=${n}`,{credentials:"include"});return E.ok?E.json():[]}}),y=E=>({deposit:"Deposit",withdrawal:"Withdrawal",transfer:"Transfer",loan_disbursement:"Loan Disbursement",loan_repayment:"Loan Repayment",penalty_charge:"Late Penalty",auto_deduction:"Auto Deduction",interest_posting:"Interest Posting",dividend_payment:"Dividend Payment",share_purchase:"Share Purchase",share_sale:"Share Sale",fixed_deposit:"Fixed Deposit",fd_withdrawal:"FD Withdrawal",fd_interest:"FD Interest"})[E]||E.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase()),C=E=>E==="deposit"||E==="loan_disbursement"||E==="dividend_payment"||E==="fd_interest"||E==="interest_posting"?"default":E==="penalty_charge"?"destructive":E==="withdrawal"||E==="loan_repayment"||E==="auto_deduction"?"secondary":"outline",k=x?.filter(E=>!(o&&new Date(E.created_at)<new Date(o)||u&&new Date(E.created_at)>new Date(u+"T23:59:59")))||[],N=()=>{const E=window.open("","_blank");if(!E)return;const R=`
      <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #1e3a5f; padding-bottom: 10px; }
        .header h1 { margin: 0; font-size: 24px; color: #1e3a5f; }
        .header p { margin: 5px 0; color: #666; }
        .balances { display: flex; gap: 20px; margin-bottom: 20px; }
        .balance-box { flex: 1; padding: 10px; border: 1px solid #ddd; text-align: center; border-radius: 6px; }
        .balance-box .label { font-size: 12px; color: #666; }
        .balance-box .amount { font-size: 18px; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 12px; }
        th { background-color: #1e3a5f; color: white; font-weight: bold; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .credit { color: green; }
        .debit { color: #c00; }
        .footer { margin-top: 20px; text-align: center; font-size: 11px; color: #999; border-top: 1px solid #ddd; padding-top: 10px; }
        @media print { body { -webkit-print-color-adjust: exact; } }
      </style>
    `,T=["deposit","loan_disbursement","dividend_payment","fd_interest","interest_posting"];E.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Account Statement - ${h?.first_name} ${h?.last_name}</title>
          ${R}
        </head>
        <body>
          <div class="header">
            <h1>Account Statement</h1>
            <p><strong>${h?.first_name} ${h?.last_name}</strong></p>
            <p>Member No: ${h?.member_number}</p>
            ${h?.branch_name?`<p>Branch: ${h?.branch_name}</p>`:""}
            <p>Generated: ${new Date().toLocaleDateString()}</p>
            ${a!=="all"?`<p>Account: ${a.toUpperCase()}</p>`:""}
            ${o||u?`<p>Period: ${o||"Start"} to ${u||"Present"}</p>`:""}
          </div>

          <div class="balances">
            <div class="balance-box">
              <div class="label">Savings Balance</div>
              <div class="amount">${s} ${(h?.savings_balance||0).toLocaleString()}</div>
            </div>
            <div class="balance-box">
              <div class="label">Shares Balance</div>
              <div class="amount">${s} ${(h?.shares_balance||0).toLocaleString()}</div>
            </div>
            <div class="balance-box">
              <div class="label">Deposits Balance</div>
              <div class="amount">${s} ${(h?.deposits_balance||0).toLocaleString()}</div>
            </div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Tx No.</th>
                <th>Type</th>
                <th>Account</th>
                <th style="text-align:right">Debit</th>
                <th style="text-align:right">Credit</th>
                <th style="text-align:right">Balance</th>
                <th>Reference</th>
              </tr>
            </thead>
            <tbody>
              ${k.map(U=>{const M=T.includes(U.transaction_type),L=`${s} ${Number(U.amount).toLocaleString()}`;return`
                <tr>
                  <td>${new Date(U.created_at).toLocaleDateString()}</td>
                  <td>${U.transaction_number}</td>
                  <td>${y(U.transaction_type)}</td>
                  <td>${U.account_type}</td>
                  <td style="text-align:right" class="debit">${M?"":L}</td>
                  <td style="text-align:right" class="credit">${M?L:""}</td>
                  <td style="text-align:right">${s} ${Number(U.balance_after).toLocaleString()}</td>
                  <td>${U.reference||"-"}</td>
                </tr>`}).join("")}
            </tbody>
          </table>

          <div class="footer">
            <p>Total Transactions: ${k.length}</p>
            <p>This is a computer-generated statement and does not require a signature.</p>
          </div>
        </body>
      </html>
    `),E.document.close()},[P,w]=v.useState(!1),S=async()=>{w(!0);try{const E=new URLSearchParams;a&&a!=="all"&&E.set("account_type",a),o&&E.set("start_date",o),u&&E.set("end_date",u);const R=E.toString()?`?${E.toString()}`:"",T=await fetch(`/api/organizations/${t}/members/${n}/statement/pdf${R}`,{credentials:"include"});if(!T.ok)throw new Error("Failed to generate PDF");const U=await T.blob(),M=window.URL.createObjectURL(U),L=document.createElement("a");L.href=M,L.download=`statement_${h?.member_number||"member"}_${new Date().toISOString().slice(0,10)}.pdf`,document.body.appendChild(L),L.click(),document.body.removeChild(L),window.URL.revokeObjectURL(M)}catch(E){console.error("PDF download error:",E)}finally{w(!1)}};return f?e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(bt,{className:"h-8 w-48"}),e.jsx(bt,{className:"h-32 w-full"}),e.jsx(bt,{className:"h-64 w-full"})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:r,children:e.jsx($r,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Account Statement"}),e.jsxs("p",{className:"text-muted-foreground",children:[h?.first_name," ",h?.last_name," (",h?.member_number,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",onClick:N,className:"gap-2","data-testid":"button-view-statement",children:[e.jsx(tC,{className:"h-4 w-4"}),"View Statement"]}),e.jsxs(B,{onClick:S,disabled:P,className:"gap-2","data-testid":"button-download-statement",children:[e.jsx($a,{className:"h-4 w-4"}),P?"Generating...":"Download PDF"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(oe,{children:e.jsxs(de,{className:"pt-4 text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Savings"}),e.jsxs("div",{className:"text-xl font-bold",children:[s," ",(h?.savings_balance||0).toLocaleString()]})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4 text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Shares"}),e.jsxs("div",{className:"text-xl font-bold",children:[s," ",(h?.shares_balance||0).toLocaleString()]})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4 text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Deposits"}),e.jsxs("div",{className:"text-xl font-bold",children:[s," ",(h?.deposits_balance||0).toLocaleString()]})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"h-5 w-5"}),"Transactions"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"From:"}),e.jsx(re,{type:"date",value:o,onChange:E=>c(E.target.value),className:"w-36"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"To:"}),e.jsx(re,{type:"date",value:u,onChange:E=>m(E.target.value),className:"w-36"})]}),e.jsxs(Qe,{value:a,onValueChange:i,children:[e.jsx(He,{className:"w-40",children:e.jsx(Xe,{placeholder:"Account Type"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Accounts"}),e.jsx(ee,{value:"savings",children:"Savings"}),e.jsx(ee,{value:"shares",children:"Shares"}),e.jsx(ee,{value:"deposits",children:"Deposits"})]})]})]})]})}),e.jsxs(de,{children:[j?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((E,R)=>e.jsx(bt,{className:"h-12 w-full"},R))}):k.length>0?e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Date"}),e.jsx(Q,{children:"Tx No."}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Account"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{className:"text-right",children:"Balance After"}),e.jsx(Q,{children:"Reference"})]})}),e.jsx(Pt,{children:k.map(E=>e.jsxs(qe,{children:[e.jsx(V,{className:"text-sm",children:new Date(E.created_at).toLocaleDateString()}),e.jsx(V,{className:"font-mono text-sm",children:E.transaction_number}),e.jsx(V,{children:e.jsx(ze,{variant:C(E.transaction_type),children:y(E.transaction_type)})}),e.jsx(V,{className:"capitalize",children:E.account_type}),e.jsxs(V,{className:`text-right font-medium ${["deposit","loan_disbursement","dividend_payment","fd_interest","interest_posting"].includes(E.transaction_type)?"text-green-600":"text-red-600"}`,children:[["deposit","loan_disbursement","dividend_payment","fd_interest","interest_posting"].includes(E.transaction_type)?"+":"-",s," ",Number(E.amount).toLocaleString()]}),e.jsxs(V,{className:"text-right",children:[s," ",Number(E.balance_after).toLocaleString()]}),e.jsx(V,{className:"text-sm text-muted-foreground",children:E.reference||"-"})]},E.id))})]}):e.jsx("div",{className:"py-12 text-center text-muted-foreground",children:"No transactions found for the selected filters"}),k.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t text-sm text-muted-foreground text-center",children:["Showing ",k.length," transaction(s)"]})]})]}),b.length>0&&e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"h-5 w-5"}),"Fixed Deposits"]})}),e.jsx(de,{children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Deposit #"}),e.jsx(Q,{children:"Product"}),e.jsx(Q,{className:"text-right",children:"Principal"}),e.jsx(Q,{children:"Rate"}),e.jsx(Q,{children:"Term"}),e.jsx(Q,{children:"Maturity Date"}),e.jsx(Q,{className:"text-right",children:"Maturity Amount"}),e.jsx(Q,{children:"Status"})]})}),e.jsx(Pt,{children:b.map(E=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono text-sm",children:E.deposit_number}),e.jsx(V,{children:E.product_name}),e.jsxs(V,{className:"text-right",children:[s," ",Number(E.principal_amount).toLocaleString()]}),e.jsxs(V,{children:[E.interest_rate,"%"]}),e.jsxs(V,{children:[E.term_months," months"]}),e.jsx(V,{children:new Date(E.maturity_date).toLocaleDateString()}),e.jsxs(V,{className:"text-right font-medium text-green-600",children:[s," ",Number(E.maturity_amount).toLocaleString()]}),e.jsx(V,{children:e.jsx(ze,{variant:E.status==="active"?"default":E.status==="closed"?"secondary":"outline",children:E.status})})]},E.deposit_number))})]})})]})]})}const vee=me.object({first_name:me.string().min(1,"First name is required"),middle_name:me.string().optional(),last_name:me.string().min(1,"Last name is required"),email:me.string().email().optional().or(me.literal("")),phone:me.string().min(1,"Phone is required"),phone_secondary:me.string().optional(),id_type:me.string().optional(),id_number:me.string().optional(),kra_pin:me.string().optional(),date_of_birth:me.string().optional(),gender:me.string().optional(),marital_status:me.string().optional(),nationality:me.string().optional(),address:me.string().optional(),postal_code:me.string().optional(),city:me.string().optional(),county:me.string().optional(),country:me.string().optional(),next_of_kin_name:me.string().optional(),next_of_kin_phone:me.string().optional(),next_of_kin_relationship:me.string().optional(),next_of_kin_id_number:me.string().optional(),next_of_kin_address:me.string().optional(),next_of_kin_2_name:me.string().optional(),next_of_kin_2_phone:me.string().optional(),next_of_kin_2_relationship:me.string().optional(),employment_status:me.string().optional(),employer_name:me.string().optional(),employer_address:me.string().optional(),employer_phone:me.string().optional(),occupation:me.string().optional(),monthly_income:me.string().optional(),employment_date:me.string().optional(),bank_name:me.string().optional(),bank_branch:me.string().optional(),bank_account_number:me.string().optional(),bank_account_name:me.string().optional(),branch_id:me.string().optional(),membership_type:me.string().optional(),registration_fee_paid:me.string().optional(),share_capital:me.string().optional()}),yee=["Baringo","Bomet","Bungoma","Busia","Elgeyo-Marakwet","Embu","Garissa","Homa Bay","Isiolo","Kajiado","Kakamega","Kericho","Kiambu","Kilifi","Kirinyaga","Kisii","Kisumu","Kitui","Kwale","Laikipia","Lamu","Machakos","Makueni","Mandera","Marsabit","Meru","Migori","Mombasa","Murang'a","Nairobi","Nakuru","Nandi","Narok","Nyamira","Nyandarua","Nyeri","Samburu","Siaya","Taita-Taveta","Tana River","Tharaka-Nithi","Trans-Nzoia","Turkana","Uasin Gishu","Vihiga","Wajir","West Pokot"],jee=["Kenya Commercial Bank (KCB)","Equity Bank","Co-operative Bank","Absa Bank Kenya","Standard Chartered Bank","NCBA Bank","I&M Bank","Diamond Trust Bank","Family Bank","Stanbic Bank","Bank of Africa","National Bank of Kenya","Prime Bank","Sidian Bank","Victoria Commercial Bank","Guardian Bank","Gulf African Bank","First Community Bank","Credit Bank","Consolidated Bank","Development Bank of Kenya","Citibank"],lO=[{value:"passport_photo",label:"Passport Photo",icon:mW},{value:"id_front",label:"ID Card (Front)",icon:tn},{value:"id_back",label:"ID Card (Back)",icon:tn},{value:"signature",label:"Signature",icon:tn},{value:"proof_of_address",label:"Proof of Address",icon:Jm},{value:"payslip",label:"Payslip",icon:VN},{value:"bank_statement",label:"Bank Statement",icon:Yn},{value:"other",label:"Other Document",icon:VN}];function bee({organizationId:t,memberId:n}){const{toast:r}=Xt(),[s,a]=v.useState(!1),[i,o]=v.useState(""),[c,u]=v.useState(""),[m,h]=v.useState(null),[f,x]=v.useState(null),{data:j,isLoading:b}=$e({queryKey:["/api/organizations",t,"members",n,"documents"],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/members/${n}/documents`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch documents");return S.json()}}),g=Le({mutationFn:async({file:S,documentType:E,description:R})=>{const T=new FormData;T.append("file",S),T.append("document_type",E),T.append("description",R);const U=await fetch(`/api/organizations/${t}/members/${n}/documents`,{method:"POST",credentials:"include",body:T});if(!U.ok){const M=await U.json();throw new Error(M.detail||"Failed to upload document")}return U.json()},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members",n,"documents"]}),a(!1),h(null),o(""),u(""),x(null),r({title:"Document uploaded successfully"})},onError:S=>{r({title:"Failed to upload document",description:Vn(S),variant:"destructive"})}}),y=Le({mutationFn:async S=>{const E=await fetch(`/api/organizations/${t}/members/${n}/documents/${S}`,{method:"DELETE",credentials:"include"});if(!E.ok)throw new Error("Failed to delete document");return E.json()},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members",n,"documents"]}),r({title:"Document deleted"})},onError:()=>{r({title:"Failed to delete document",variant:"destructive"})}}),C=Le({mutationFn:async S=>{const E=await fetch(`/api/organizations/${t}/members/${n}/documents/${S}/verify`,{method:"PUT",credentials:"include"});if(!E.ok)throw new Error("Failed to verify document");return E.json()},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members",n,"documents"]}),r({title:"Document verified"})},onError:()=>{r({title:"Failed to verify document",variant:"destructive"})}}),k=S=>{const E=S.target.files?.[0];if(E)if(h(E),E.type.startsWith("image/")){const R=URL.createObjectURL(E);x(R)}else x(null)},N=()=>{!m||!i||g.mutate({file:m,documentType:i,description:c})},P=S=>S<1024?`${S} B`:S<1024*1024?`${(S/1024).toFixed(1)} KB`:`${(S/(1024*1024)).toFixed(1)} MB`,w=(S,E)=>E?.startsWith("image/")?PW:lO.find(T=>T.value===S)?.icon||VN;return e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs(_e,{className:"text-base flex items-center gap-2",children:[e.jsx(tn,{className:"h-4 w-4"}),"Documents & ID Copies"]}),e.jsxs(B,{size:"sm",onClick:()=>a(!0),"data-testid":"button-upload-document",children:[e.jsx(CL,{className:"h-4 w-4 mr-1"}),"Upload"]})]})}),e.jsx(de,{children:b?e.jsxs("div",{className:"space-y-2",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):j&&j.length>0?e.jsx("div",{className:"space-y-3",children:j.map(S=>{const E=w(S.document_type,S.mime_type);return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 p-3 bg-muted/50 rounded-lg","data-testid":`document-item-${S.id}`,children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-2 bg-background rounded-lg shrink-0",children:e.jsx(E,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:S.document_type_label}),e.jsx("div",{className:"text-sm text-muted-foreground truncate",children:S.file_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:P(S.file_size)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0 ml-auto",children:[S.is_verified?e.jsxs(ze,{variant:"default",className:"gap-1",children:[e.jsx(Es,{className:"h-3 w-3"}),"Verified"]}):e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>C.mutate(S.id),disabled:C.isPending,"data-testid":`button-verify-${S.id}`,children:[e.jsx(yr,{className:"h-3 w-3 mr-1"}),"Verify"]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>window.open(`/api/organizations/${t}/members/${n}/documents/${S.id}/file`,"_blank"),"data-testid":`button-view-${S.id}`,children:e.jsx(Ts,{className:"h-4 w-4"})}),e.jsx("a",{href:`/api/organizations/${t}/members/${n}/documents/${S.id}/file?download=1`,download:!0,children:e.jsx(B,{size:"icon",variant:"ghost","data-testid":`button-download-${S.id}`,children:e.jsx($a,{className:"h-4 w-4"})})}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>y.mutate(S.id),disabled:y.isPending,"data-testid":`button-delete-${S.id}`,children:e.jsx(ba,{className:"h-4 w-4 text-destructive"})})]})]},S.id)})}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(tn,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No documents uploaded yet"}),e.jsx("p",{className:"text-sm",children:"Upload ID copies, passport photos, and other documents"})]})}),e.jsx(Vt,{open:s,onOpenChange:S=>{S||(h(null),o(""),u(""),x(null)),a(S)},children:e.jsxs(It,{className:"max-w-md",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Upload Document"}),e.jsx(Qt,{children:"Upload a document or ID copy for this member"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Document Type ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{value:i,onValueChange:o,children:[e.jsx(He,{"data-testid":"select-document-type",children:e.jsx(Xe,{placeholder:"Select document type..."})}),e.jsx(Ge,{children:lO.map(S=>e.jsx(ee,{value:S.value,children:S.label},S.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Select File ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(re,{type:"file",accept:"image/*,.pdf,.doc,.docx",onChange:k,"data-testid":"input-file-upload"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accepted: Images, PDF, Word documents. Max 5MB."})]}),f&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:f,alt:"Preview",className:"w-full h-40 object-contain rounded-lg bg-muted"}),e.jsx(B,{size:"sm",variant:"secondary",className:"absolute top-2 right-2",onClick:()=>{h(null),x(null)},"data-testid":"button-remove-preview",children:e.jsx(rs,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description (Optional)"}),e.jsx(re,{value:c,onChange:S=>u(S.target.value),placeholder:"Add a note about this document...","data-testid":"input-document-description"})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>a(!1),"data-testid":"button-cancel-upload",children:"Cancel"}),e.jsx(B,{onClick:N,disabled:!m||!i||g.isPending,"data-testid":"button-confirm-upload",children:g.isPending?"Uploading...":"Upload Document"})]})]})})]})}function wee({organizationId:t}){const{toast:n}=Xt(),{user:r}=No(),{currency:s,symbol:a}=fr(t),{canWrite:i,hasPermission:o}=_r(t,Nr.MEMBERS),c=o("members:activate"),u=o("members:suspend"),[m,h]=v.useState("list"),[f,x]=v.useState(null),[j,b]=v.useState(null),[g,y]=v.useState(null),[C,k]=v.useState("personal"),[N,P]=v.useState("all"),[w,S]=v.useState(""),[E,R]=v.useState(""),[T,U]=v.useState(1),M=20;v.useEffect(()=>{const F=setTimeout(()=>{R(w)},400);return()=>clearTimeout(F)},[w]);const L=r?.branchId,q=r?.role,$=!L||q==="admin"||q==="owner",{data:D,isLoading:z}=$e({queryKey:["/api/organizations",t,"members",N,E,T],queryFn:async()=>{const F=new URLSearchParams;N&&N!=="all"&&F.append("branch_id",N),E.trim()&&F.append("search",E.trim()),F.append("page",T.toString()),F.append("per_page",M.toString());const Ue=`/api/organizations/${t}/members?${F.toString()}`,Z=await fetch(Ue,{credentials:"include"});if(!Z.ok)throw new Error("Failed to fetch members");return Z.json()}}),J=D?.items,I=D?.total||0,X=D?.total_pages||0,{data:ne}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const F=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!F.ok)throw new Error("Failed to fetch branches");return F.json()}});v.useEffect(()=>{ne&&ne.length===1&&P(ne[0].id)},[ne]);const{data:W}=$e({queryKey:["/api/organizations",t],queryFn:async()=>{const F=await fetch(`/api/organizations/${t}`,{credentials:"include"});if(!F.ok)throw new Error("Failed to fetch organization");return F.json()}}),H=$n({resolver:Fn(vee),defaultValues:{first_name:"",middle_name:"",last_name:"",email:"",phone:"",phone_secondary:"",id_type:"",id_number:"",kra_pin:"",date_of_birth:"",gender:"",marital_status:"",nationality:"Kenyan",address:"",postal_code:"",city:"",county:"",country:"Kenya",next_of_kin_name:"",next_of_kin_phone:"",next_of_kin_relationship:"",next_of_kin_id_number:"",next_of_kin_address:"",next_of_kin_2_name:"",next_of_kin_2_phone:"",next_of_kin_2_relationship:"",employment_status:"",employer_name:"",employer_address:"",employer_phone:"",occupation:"",monthly_income:"",employment_date:"",bank_name:"",bank_branch:"",bank_account_number:"",bank_account_name:"",branch_id:"",membership_type:"ordinary",registration_fee_paid:"",share_capital:""}}),fe=ne&&ne.length===1;v.useEffect(()=>{fe&&!H.getValues("branch_id")&&H.setValue("branch_id",ne[0].id)},[fe,ne,H]);const Pe=Le({mutationFn:async F=>{const Ue={...F};if(!$&&L&&(Ue.branch_id=L),fe&&!Ue.branch_id&&(Ue.branch_id=ne[0].id),$&&!Ue.branch_id)throw new Error("Please select a branch");return(await Be("POST",`/api/organizations/${t}/members`,Ue)).json()},onSuccess:F=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),n({title:"Success",description:"Member registered successfully. You can continue filling other tabs."}),F&&(x(F),h("edit"),H.reset({first_name:F.first_name||"",middle_name:F.middle_name||"",last_name:F.last_name||"",email:F.email||"",phone:F.phone||"",phone_secondary:F.phone_secondary||"",id_type:F.id_type||"",id_number:F.id_number||"",kra_pin:F.kra_pin||"",date_of_birth:F.date_of_birth||"",gender:F.gender||"",marital_status:F.marital_status||"",nationality:F.nationality||"",address:F.address||"",postal_code:F.postal_code||"",city:F.city||"",county:F.county||"",country:F.country||"",next_of_kin_name:F.next_of_kin_name||"",next_of_kin_phone:F.next_of_kin_phone||"",next_of_kin_relationship:F.next_of_kin_relationship||"",next_of_kin_id_number:F.next_of_kin_id_number||"",next_of_kin_address:F.next_of_kin_address||"",next_of_kin_2_name:F.next_of_kin_2_name||"",next_of_kin_2_phone:F.next_of_kin_2_phone||"",next_of_kin_2_relationship:F.next_of_kin_2_relationship||"",next_of_kin_2_id_number:F.next_of_kin_2_id_number||"",next_of_kin_2_address:F.next_of_kin_2_address||"",employer_name:F.employer_name||"",employer_address:F.employer_address||"",employer_phone:F.employer_phone||"",job_title:F.job_title||"",employment_type:F.employment_type||"",monthly_income:F.monthly_income||"",branch_id:F.branch_id||"",notes:F.notes||""}))},onError:F=>{n({title:"Failed to create member",description:Vn(F),variant:"destructive"})}}),Re=Le({mutationFn:async F=>(await Be("PATCH",`/api/organizations/${t}/members/${f.id}`,F)).json(),onSuccess:F=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),n({title:"Success",description:"Member updated successfully"}),F&&x(F)},onError:F=>{n({title:"Failed to update member",description:Vn(F),variant:"destructive"})}}),Ie=Le({mutationFn:async F=>{await Be("DELETE",`/api/organizations/${t}/members/${F}`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),n({title:"Success",description:"Member deleted successfully"}),b(null)},onError:F=>{n({title:"Failed to delete member",description:Vn(F),variant:"destructive"})}}),Ce=Le({mutationFn:async F=>(await Be("PUT",`/api/organizations/${t}/members/${F}/activate`)).json(),onSuccess:F=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),x(F),n({title:"Success",description:"Member account activated successfully"})},onError:F=>{n({title:"Failed to activate member",description:Vn(F),variant:"destructive"})}}),Y=Le({mutationFn:async F=>(await Be("PUT",`/api/organizations/${t}/members/${F}/suspend`)).json(),onSuccess:F=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),x(F),n({title:"Success",description:"Member account suspended"})},onError:F=>{n({title:"Failed to suspend member",description:Vn(F),variant:"destructive"})}}),ie=()=>{H.reset({first_name:"",middle_name:"",last_name:"",email:"",phone:"",phone_secondary:"",id_type:"",id_number:"",kra_pin:"",date_of_birth:"",gender:"",marital_status:"",nationality:"Kenyan",address:"",postal_code:"",city:"",county:"",country:"Kenya",next_of_kin_name:"",next_of_kin_phone:"",next_of_kin_relationship:"",next_of_kin_id_number:"",next_of_kin_address:"",next_of_kin_2_name:"",next_of_kin_2_phone:"",next_of_kin_2_relationship:"",employment_status:"",employer_name:"",employer_address:"",employer_phone:"",occupation:"",monthly_income:"",employment_date:"",bank_name:"",bank_branch:"",bank_account_number:"",bank_account_name:"",branch_id:"",membership_type:"ordinary",registration_fee_paid:"",share_capital:""}),x(null),k("personal")},Ee=()=>{ie(),h("new")},Ke=F=>{x(F),H.reset({first_name:F.first_name||"",middle_name:F.middle_name||"",last_name:F.last_name||"",email:F.email||"",phone:F.phone||"",phone_secondary:F.phone_secondary||"",id_type:F.id_type||"",id_number:F.id_number||"",kra_pin:F.kra_pin||"",date_of_birth:F.date_of_birth||"",gender:F.gender||"",marital_status:F.marital_status||"",nationality:F.nationality||"Kenyan",address:F.address||"",postal_code:F.postal_code||"",city:F.city||"",county:F.county||"",country:F.country||"Kenya",next_of_kin_name:F.next_of_kin_name||"",next_of_kin_phone:F.next_of_kin_phone||"",next_of_kin_relationship:F.next_of_kin_relationship||"",next_of_kin_id_number:F.next_of_kin_id_number||"",next_of_kin_address:F.next_of_kin_address||"",next_of_kin_2_name:F.next_of_kin_2_name||"",next_of_kin_2_phone:F.next_of_kin_2_phone||"",next_of_kin_2_relationship:F.next_of_kin_2_relationship||"",employment_status:F.employment_status||"",employer_name:F.employer_name||"",employer_address:F.employer_address||"",employer_phone:F.employer_phone||"",occupation:F.occupation||"",monthly_income:F.monthly_income||"",employment_date:F.employment_date||"",bank_name:F.bank_name||"",bank_branch:F.bank_branch||"",bank_account_number:F.bank_account_number||"",bank_account_name:F.bank_account_name||"",branch_id:F.branch_id||"",membership_type:F.membership_type||"ordinary",registration_fee_paid:F.registration_fee_paid||"",share_capital:F.share_capital||""}),h("edit")},Te=F=>{x(F),h("view")},ct=F=>({...F,email:F.email||null,middle_name:F.middle_name||null,phone_secondary:F.phone_secondary||null,id_type:F.id_type||null,id_number:F.id_number||null,kra_pin:F.kra_pin||null,date_of_birth:F.date_of_birth||null,gender:F.gender||null,marital_status:F.marital_status||null,nationality:F.nationality||null,address:F.address||null,postal_code:F.postal_code||null,city:F.city||null,county:F.county||null,country:F.country||null,next_of_kin_name:F.next_of_kin_name||null,next_of_kin_phone:F.next_of_kin_phone||null,next_of_kin_relationship:F.next_of_kin_relationship||null,next_of_kin_id_number:F.next_of_kin_id_number||null,next_of_kin_address:F.next_of_kin_address||null,next_of_kin_2_name:F.next_of_kin_2_name||null,next_of_kin_2_phone:F.next_of_kin_2_phone||null,next_of_kin_2_relationship:F.next_of_kin_2_relationship||null,employment_status:F.employment_status||null,employer_name:F.employer_name||null,employer_address:F.employer_address||null,employer_phone:F.employer_phone||null,occupation:F.occupation||null,monthly_income:F.monthly_income?parseFloat(F.monthly_income):null,employment_date:F.employment_date||null,bank_name:F.bank_name||null,bank_branch:F.bank_branch||null,bank_account_number:F.bank_account_number||null,bank_account_name:F.bank_account_name||null,branch_id:F.branch_id||null,membership_type:F.membership_type||null,registration_fee_paid:F.registration_fee_paid?parseFloat(F.registration_fee_paid):null,share_capital:F.share_capital?parseFloat(F.share_capital):null}),ut=F=>{m==="edit"&&f?Re.mutate(F):Pe.mutate(F)},Dt=async F=>{const Ue=ct(F),Z=Ue.id_number;if(Z){const xe=m==="edit"&&f,Ae=xe?f?.id_number:null;if(Z!==Ae)try{const Je=xe?`?exclude_member_id=${f.id}`:"",ae=await fetch(`/api/organizations/${t}/members/check-id/${encodeURIComponent(Z)}${Je}`,{credentials:"include"});if(ae.ok){const Me=await ae.json();if(Me.conflict){if(!Me.can_proceed){n({title:"Duplicate ID Number",description:`A member with ID number '${Z}' already exists (${Me.member_name} - ${Me.member_number}, Status: ${Me.status})`,variant:"destructive"});return}y({member_name:Me.member_name,member_number:Me.member_number,status:Me.status,pendingData:Ue});return}}}catch{}}ut(Ue)},be=()=>{ie(),h("list")},pt=F=>{const Ue=F==="membership"?te():G(),Z=new Blob([Ue],{type:"text/html"}),xe=URL.createObjectURL(Z),Ae=document.createElement("a");Ae.href=xe,Ae.download=`blank_${F}_form.html`,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),URL.revokeObjectURL(xe),n({title:"Downloaded",description:`Blank ${F} form downloaded successfully`})},te=()=>{const F=W?.name||"SACCO / MICROFINANCE",Ue=W?.email||"",Z=W?.phone||"",xe=W?.address||"";return`<!DOCTYPE html>
<html>
<head>
  <title>Membership Application Form - ${F}</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .org-header { text-align: center; margin-bottom: 20px; border-bottom: 3px solid #333; padding-bottom: 15px; }
    .org-name { font-size: 24px; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
    .org-details { font-size: 12px; color: #555; }
    h1 { text-align: center; margin-top: 10px; font-size: 18px; }
    h2 { background: #f0f0f0; padding: 8px; margin-top: 20px; }
    .row { display: flex; margin-bottom: 10px; }
    .field { flex: 1; margin-right: 15px; }
    .field:last-child { margin-right: 0; }
    label { display: block; font-weight: bold; margin-bottom: 3px; font-size: 12px; }
    .line { border-bottom: 1px solid #333; min-height: 25px; }
    .checkbox-group { display: flex; gap: 20px; }
    .checkbox { display: flex; align-items: center; gap: 5px; }
    .box { width: 15px; height: 15px; border: 1px solid #333; }
    .signature-area { display: flex; justify-content: space-between; margin-top: 40px; }
    .signature-box { text-align: center; width: 200px; }
    .signature-line { border-top: 1px solid #333; margin-top: 50px; padding-top: 5px; }
    .form-number { text-align: right; font-size: 11px; color: #666; }
    @media print { body { margin: 0; padding: 10px; } }
  </style>
</head>
<body>
  <div class="org-header">
    <div class="org-name">${F}</div>
    <div class="org-details">
      ${xe?xe+"<br>":""}
      ${Z?"Tel: "+Z:""} ${Ue?" | Email: "+Ue:""}
    </div>
  </div>
  
  <h1>MEMBERSHIP APPLICATION FORM</h1>
  <div class="form-number">Form No: _________________ Date: _________________</div>
  
  <h2>Section A: Personal Information</h2>
  <div class="row">
    <div class="field"><label>First Name</label><div class="line"></div></div>
    <div class="field"><label>Middle Name</label><div class="line"></div></div>
    <div class="field"><label>Last Name</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Date of Birth</label><div class="line"></div></div>
    <div class="field">
      <label>Gender</label>
      <div class="checkbox-group">
        <div class="checkbox"><div class="box"></div> Male</div>
        <div class="checkbox"><div class="box"></div> Female</div>
      </div>
    </div>
    <div class="field"><label>Marital Status</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>ID Type (National ID/Passport/Alien ID)</label><div class="line"></div></div>
    <div class="field"><label>ID Number</label><div class="line"></div></div>
    <div class="field"><label>KRA PIN</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Phone Number (Primary)</label><div class="line"></div></div>
    <div class="field"><label>Phone Number (Secondary)</label><div class="line"></div></div>
    <div class="field"><label>Email Address</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Nationality</label><div class="line"></div></div>
  </div>

  <h2>Section B: Address Information</h2>
  <div class="row">
    <div class="field" style="flex:2"><label>Physical Address</label><div class="line"></div></div>
    <div class="field"><label>P.O. Box</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>City/Town</label><div class="line"></div></div>
    <div class="field"><label>County</label><div class="line"></div></div>
    <div class="field"><label>Country</label><div class="line"></div></div>
  </div>

  <h2>Section C: Next of Kin (Primary)</h2>
  <div class="row">
    <div class="field"><label>Full Name</label><div class="line"></div></div>
    <div class="field"><label>Relationship</label><div class="line"></div></div>
    <div class="field"><label>Phone Number</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>ID Number</label><div class="line"></div></div>
    <div class="field" style="flex:2"><label>Address</label><div class="line"></div></div>
  </div>

  <h2>Section D: Next of Kin (Secondary)</h2>
  <div class="row">
    <div class="field"><label>Full Name</label><div class="line"></div></div>
    <div class="field"><label>Relationship</label><div class="line"></div></div>
    <div class="field"><label>Phone Number</label><div class="line"></div></div>
  </div>

  <h2>Section E: Employment Information</h2>
  <div class="row">
    <div class="field">
      <label>Employment Status</label>
      <div class="checkbox-group">
        <div class="checkbox"><div class="box"></div> Employed</div>
        <div class="checkbox"><div class="box"></div> Self-Employed</div>
        <div class="checkbox"><div class="box"></div> Business</div>
        <div class="checkbox"><div class="box"></div> Retired</div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="field"><label>Employer/Business Name</label><div class="line"></div></div>
    <div class="field"><label>Occupation/Position</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field" style="flex:2"><label>Employer Address</label><div class="line"></div></div>
    <div class="field"><label>Employer Phone</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Monthly Income (${s})</label><div class="line"></div></div>
    <div class="field"><label>Employment/Start Date</label><div class="line"></div></div>
  </div>

  <h2>Section F: Bank Details</h2>
  <div class="row">
    <div class="field"><label>Bank Name</label><div class="line"></div></div>
    <div class="field"><label>Branch</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Account Number</label><div class="line"></div></div>
    <div class="field"><label>Account Name</label><div class="line"></div></div>
  </div>

  <h2>Section G: Membership Details</h2>
  <div class="row">
    <div class="field"><label>Branch (Office)</label><div class="line"></div></div>
    <div class="field"><label>Registration Fee (${s})</label><div class="line"></div></div>
    <div class="field"><label>Share Capital (${s})</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field">
      <label>Membership Type</label>
      <div class="checkbox-group">
        <div class="checkbox"><div class="box"></div> Ordinary</div>
        <div class="checkbox"><div class="box"></div> Premium</div>
        <div class="checkbox"><div class="box"></div> Corporate</div>
      </div>
    </div>
  </div>

  <h2>Declaration</h2>
  <p style="font-size:12px">I hereby declare that all the information provided above is true and accurate to the best of my knowledge. I agree to abide by the rules and regulations of the organization.</p>

  <div class="signature-area">
    <div class="signature-box">
      <div class="signature-line">Applicant's Signature</div>
    </div>
    <div class="signature-box">
      <div class="signature-line">Date</div>
    </div>
    <div class="signature-box">
      <div class="signature-line">Official Use Only</div>
    </div>
  </div>
</body>
</html>`},G=()=>{const F=W?.name||"SACCO / MICROFINANCE",Ue=W?.email||"",Z=W?.phone||"",xe=W?.address||"";return`<!DOCTYPE html>
<html>
<head>
  <title>Loan Application Form - ${F}</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .org-header { text-align: center; margin-bottom: 20px; border-bottom: 3px solid #333; padding-bottom: 15px; }
    .org-name { font-size: 24px; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
    .org-details { font-size: 12px; color: #555; }
    h1 { text-align: center; margin-top: 10px; font-size: 18px; }
    h2 { background: #f0f0f0; padding: 8px; margin-top: 20px; }
    .row { display: flex; margin-bottom: 10px; }
    .field { flex: 1; margin-right: 15px; }
    .field:last-child { margin-right: 0; }
    label { display: block; font-weight: bold; margin-bottom: 3px; font-size: 12px; }
    .line { border-bottom: 1px solid #333; min-height: 25px; }
    .checkbox-group { display: flex; gap: 20px; }
    .checkbox { display: flex; align-items: center; gap: 5px; }
    .box { width: 15px; height: 15px; border: 1px solid #333; }
    .signature-area { display: flex; justify-content: space-between; margin-top: 40px; }
    .signature-box { text-align: center; width: 200px; }
    .signature-line { border-top: 1px solid #333; margin-top: 50px; padding-top: 5px; }
    .large-field { min-height: 60px; }
    .form-number { text-align: right; font-size: 11px; color: #666; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #333; padding: 8px; text-align: left; }
    th { background: #f0f0f0; }
    @media print { body { margin: 0; padding: 10px; } }
  </style>
</head>
<body>
  <div class="org-header">
    <div class="org-name">${F}</div>
    <div class="org-details">
      ${xe?xe+"<br>":""}
      ${Z?"Tel: "+Z:""} ${Ue?" | Email: "+Ue:""}
    </div>
  </div>
  
  <h1>LOAN APPLICATION FORM</h1>
  <div class="form-number">Form No: _________________ Date: _________________</div>

  <h2>Section A: Applicant Information</h2>
  <div class="row">
    <div class="field"><label>Member Number</label><div class="line"></div></div>
    <div class="field"><label>Full Name</label><div class="line"></div></div>
    <div class="field"><label>ID Number</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Phone Number</label><div class="line"></div></div>
    <div class="field"><label>Email</label><div class="line"></div></div>
    <div class="field"><label>Branch</label><div class="line"></div></div>
  </div>

  <h2>Section B: Loan Details</h2>
  <div class="row">
    <div class="field"><label>Loan Amount Requested (${s})</label><div class="line"></div></div>
    <div class="field"><label>Repayment Period (Months)</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field" style="flex:1"><label>Purpose of Loan</label><div class="line large-field"></div></div>
  </div>

  <h2>Section C: Disbursement Method</h2>
  <div class="row">
    <div class="field">
      <label>Preferred Method</label>
      <div class="checkbox-group">
        <div class="checkbox"><div class="box"></div> M-Pesa</div>
        <div class="checkbox"><div class="box"></div> Bank Transfer</div>
        <div class="checkbox"><div class="box"></div> Cash</div>
        <div class="checkbox"><div class="box"></div> Cheque</div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="field"><label>M-Pesa Number (if applicable)</label><div class="line"></div></div>
    <div class="field"><label>Bank Account Number (if applicable)</label><div class="line"></div></div>
  </div>

  <h2>Section D: Guarantor Information</h2>
  <table>
    <tr>
      <th>No.</th>
      <th>Full Name</th>
      <th>Member Number</th>
      <th>ID Number</th>
      <th>Phone</th>
      <th>Amount Guaranteed (${s})</th>
      <th>Signature</th>
    </tr>
    <tr><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    <tr><td>2</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    <tr><td>3</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
  </table>

  <h2>Section E: Security/Collateral (if applicable)</h2>
  <div class="row">
    <div class="field"><label>Type of Security</label><div class="line"></div></div>
    <div class="field"><label>Estimated Value (${s})</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Description</label><div class="line large-field"></div></div>
  </div>

  <h2>Declaration</h2>
  <p style="font-size:12px">I/We hereby apply for the loan stated above and declare that all information provided is true and accurate. I/We understand and agree to the terms and conditions of the loan and undertake to repay the loan as per the agreed schedule.</p>

  <div class="signature-area">
    <div class="signature-box">
      <div class="signature-line">Applicant's Signature</div>
    </div>
    <div class="signature-box">
      <div class="signature-line">Date</div>
    </div>
  </div>

  <h2 style="margin-top: 40px;">Official Use Only</h2>
  <div class="row">
    <div class="field"><label>Loan Officer</label><div class="line"></div></div>
    <div class="field"><label>Date Received</label><div class="line"></div></div>
    <div class="field"><label>Application Number</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field">
      <label>Decision</label>
      <div class="checkbox-group">
        <div class="checkbox"><div class="box"></div> Approved</div>
        <div class="checkbox"><div class="box"></div> Rejected</div>
        <div class="checkbox"><div class="box"></div> Pending</div>
      </div>
    </div>
    <div class="field"><label>Approved Amount (${s})</label><div class="line"></div></div>
  </div>
  <div class="row">
    <div class="field"><label>Comments</label><div class="line large-field"></div></div>
  </div>
  <div class="signature-area">
    <div class="signature-box">
      <div class="signature-line">Approved By</div>
    </div>
    <div class="signature-box">
      <div class="signature-line">Date</div>
    </div>
  </div>
</body>
</html>`};if(m==="list")return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold flex items-center gap-2",children:[e.jsx(pn,{className:"h-5 w-5 sm:h-6 sm:w-6 shrink-0"}),e.jsx("span",{className:"truncate",children:"Members"})]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[I," registered member",I!==1?"s":""]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0 flex-wrap",children:[e.jsx(tr,{organizationId:t}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>pt("membership"),"data-testid":"button-download-membership-form",children:[e.jsx($a,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Membership Form"}),e.jsx("span",{className:"sm:hidden",children:"Member"})]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>pt("loan"),"data-testid":"button-download-loan-form",children:[e.jsx($a,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Loan Form"}),e.jsx("span",{className:"sm:hidden",children:"Loan"})]}),e.jsxs(B,{variant:"outline",onClick:()=>{window.open(`/api/organizations/${t}/export/members`,"_blank")},"data-testid":"button-export-members",children:[e.jsx($a,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"}),e.jsx("span",{className:"sm:hidden",children:"CSV"})]}),i&&e.jsxs(B,{onClick:Ee,"data-testid":"button-new-member",children:[e.jsx(mn,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Register Member"}),e.jsx("span",{className:"sm:hidden",children:"Register"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(za,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search by name, phone, member #, ID...",value:w,onChange:F=>{S(F.target.value),U(1)},className:"pl-9"})]}),w&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>{S(""),U(1)},children:"Clear"}),$&&ne&&ne.length>1&&e.jsxs(Qe,{value:N,onValueChange:F=>{P(F),U(1)},children:[e.jsx(He,{className:"w-[200px]",children:e.jsx(Xe,{placeholder:"All Branches"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Branches"}),ne.map(F=>e.jsx(ee,{value:F.id,children:F.name},F.id))]})]})]}),z?e.jsx(oe,{children:e.jsx(de,{className:"p-4 sm:p-6",children:e.jsx(bt,{className:"h-48 w-full"})})}):J&&J.length>0?e.jsxs(oe,{children:[e.jsx("div",{className:"overflow-x-auto -mx-0 sm:-mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Member #"}),e.jsx(Q,{children:"Name"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Phone"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"ID Number"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:J.map(F=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:F.member_number}),e.jsxs(V,{children:[e.jsxs("div",{children:[F.first_name," ",F.middle_name||""," ",F.last_name]}),e.jsx("div",{className:"text-sm text-muted-foreground md:hidden",children:F.phone})]}),e.jsx(V,{className:"hidden md:table-cell",children:F.phone}),e.jsx(V,{className:"hidden lg:table-cell",children:F.id_number||"-"}),e.jsx(V,{children:e.jsx(ze,{variant:F.status==="active"?"default":"secondary",children:F.status})}),e.jsx(V,{children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>Te(F),"data-testid":`button-view-member-${F.id}`,children:e.jsx(Ts,{className:"h-4 w-4"})}),i&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>Ke(F),"data-testid":`button-edit-member-${F.id}`,children:e.jsx(Ba,{className:"h-4 w-4"})}),i&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>b(F),"data-testid":`button-delete-member-${F.id}`,children:e.jsx(ba,{className:"h-4 w-4 text-red-500"})})]})})]},F.id))})]})}),X>1&&e.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-t",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(T-1)*M+1,"-",Math.min(T*M,I)," of ",I," members"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>U(F=>Math.max(1,F-1)),disabled:T<=1,children:e.jsx(vi,{className:"h-4 w-4"})}),Array.from({length:X},(F,Ue)=>Ue+1).filter(F=>F===1||F===X||Math.abs(F-T)<=1).map((F,Ue,Z)=>e.jsxs("span",{children:[Ue>0&&Z[Ue-1]!==F-1&&e.jsx("span",{className:"px-1 text-muted-foreground",children:"..."}),e.jsx(B,{variant:F===T?"default":"outline",size:"sm",className:"w-8 h-8 p-0",onClick:()=>U(F),children:F})]},F)),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>U(F=>Math.min(X,F+1)),disabled:T>=X,children:e.jsx(Os,{className:"h-4 w-4"})})]})]})]}):w?e.jsx(oe,{children:e.jsxs(de,{className:"p-8 sm:p-12 text-center",children:[e.jsx(za,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Results Found"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:['No members match "',w,'"']}),e.jsx(B,{variant:"outline",onClick:()=>{S(""),U(1)},children:"Clear Search"})]})}):e.jsx(oe,{children:e.jsxs(de,{className:"p-8 sm:p-12 text-center",children:[e.jsx(pn,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Members Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start by registering your first member"}),i&&e.jsxs(B,{onClick:Ee,"data-testid":"button-new-member-empty",children:[e.jsx(mn,{className:"h-4 w-4 mr-2"}),"Register Member"]})]})}),e.jsx(oO,{open:!!j,onOpenChange:()=>b(null),children:e.jsxs(m1,{children:[e.jsxs(h1,{children:[e.jsx(p1,{children:"Delete Member"}),e.jsxs(x1,{children:["Are you sure you want to delete ",j?.first_name," ",j?.last_name,"? This action cannot be undone."]})]}),e.jsxs(f1,{children:[e.jsx(v1,{children:"Cancel"}),e.jsx(g1,{onClick:()=>j&&Ie.mutate(j.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(oO,{open:!!g,onOpenChange:()=>y(null),children:e.jsxs(m1,{children:[e.jsxs(h1,{children:[e.jsx(p1,{children:"Duplicate ID Number Found"}),e.jsx(x1,{asChild:!0,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:["Another member already has this ID number, but their account is currently ",e.jsx(ze,{variant:"secondary",className:"mx-1",children:g?.status}),"."]}),e.jsxs("div",{className:"rounded-md border p-3 space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",g?.member_name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Member No:"})," ",g?.member_number]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",g?.status]})]}),e.jsx("p",{children:"Do you want to proceed with saving this member using the same ID number?"})]})})]}),e.jsxs(f1,{children:[e.jsx(v1,{"data-testid":"button-cancel-id-conflict",children:"Cancel"}),e.jsx(g1,{"data-testid":"button-confirm-id-conflict",onClick:()=>{g?.pendingData&&ut(g.pendingData),y(null)},children:"Proceed"})]})]})})]});if(m==="statement"&&f)return e.jsx(f6,{organizationId:t,memberId:f.id,onBack:()=>h("view")});if(m==="view"&&f){const F=f;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:be,"data-testid":"button-back",children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold truncate",children:[F.first_name," ",F.middle_name||""," ",F.last_name]}),e.jsxs("p",{className:"text-muted-foreground",children:["Member #",F.member_number]})]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0 flex-wrap",children:[e.jsx(ze,{variant:F.status==="active"?"default":F.status==="suspended"?"destructive":"secondary",className:"capitalize",children:F.status}),F.status==="pending"&&c&&e.jsxs(B,{variant:"default",onClick:()=>Ce.mutate(F.id),disabled:Ce.isPending,"data-testid":"button-activate-member",children:[e.jsx(yr,{className:"h-4 w-4 mr-1"}),Ce.isPending?"Activating...":"Activate"]}),F.status==="active"&&u&&e.jsxs(B,{variant:"outline",onClick:()=>Y.mutate(F.id),disabled:Y.isPending,"data-testid":"button-suspend-member",children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),Y.isPending?"Suspending...":"Suspend"]}),F.status==="suspended"&&c&&e.jsxs(B,{variant:"default",onClick:()=>Ce.mutate(F.id),disabled:Ce.isPending,"data-testid":"button-reactivate-member",children:[e.jsx(yr,{className:"h-4 w-4 mr-1"}),Ce.isPending?"Activating...":"Reactivate"]}),e.jsxs(B,{variant:"outline",onClick:()=>h("statement"),"data-testid":"button-view-statement",children:[e.jsx(Ts,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"View Statement"})]}),e.jsxs(B,{variant:"outline",onClick:async()=>{try{const Ue=await fetch(`/api/organizations/${t}/members/${F.id}/statement/pdf`,{credentials:"include"});if(!Ue.ok)throw new Error("Failed to download PDF");const Z=await Ue.blob(),xe=URL.createObjectURL(Z),Ae=document.createElement("a");Ae.href=xe,Ae.download=`statement-${F.member_number||"member"}.pdf`,Ae.click(),URL.revokeObjectURL(xe),n({title:"Downloaded",description:"PDF statement downloaded successfully"})}catch{n({title:"Error",description:"Failed to download PDF statement",variant:"destructive"})}},"data-testid":"button-download-pdf-statement",children:[e.jsx($a,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"PDF"})]}),i&&e.jsxs(B,{variant:"outline",onClick:()=>Ke(F),"data-testid":"button-edit-view",children:[e.jsx(Ba,{className:"h-4 w-4 mr-1"}),"Edit"]})]})]}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 lg:grid-cols-2",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-base flex items-center gap-2",children:[e.jsx($d,{className:"h-4 w-4"}),"Personal Information"]})}),e.jsxs(de,{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Full Name"}),e.jsxs("div",{className:"font-medium",children:[F.first_name," ",F.middle_name||""," ",F.last_name]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Phone"}),e.jsx("div",{className:"font-medium",children:F.phone})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("div",{className:"font-medium truncate",children:F.email||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"ID Type"}),e.jsx("div",{className:"font-medium capitalize",children:F.id_type?.replace("_"," ")||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"ID Number"}),e.jsx("div",{className:"font-medium",children:F.id_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"KRA PIN"}),e.jsx("div",{className:"font-medium",children:F.kra_pin||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Date of Birth"}),e.jsx("div",{className:"font-medium",children:F.date_of_birth||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Gender"}),e.jsx("div",{className:"font-medium capitalize",children:F.gender||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Marital Status"}),e.jsx("div",{className:"font-medium capitalize",children:F.marital_status||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Nationality"}),e.jsx("div",{className:"font-medium",children:F.nationality||"-"})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-base flex items-center gap-2",children:[e.jsx(Jm,{className:"h-4 w-4"}),"Address Information"]})}),e.jsxs(de,{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Physical Address"}),e.jsx("div",{className:"font-medium",children:F.address||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Postal Code"}),e.jsx("div",{className:"font-medium",children:F.postal_code||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"City"}),e.jsx("div",{className:"font-medium",children:F.city||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"County"}),e.jsx("div",{className:"font-medium",children:F.county||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Country"}),e.jsx("div",{className:"font-medium",children:F.country||"-"})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-base flex items-center gap-2",children:[e.jsx(Kp,{className:"h-4 w-4"}),"Next of Kin"]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-2",children:"Primary Next of Kin"}),e.jsxs("div",{className:"grid gap-2 grid-cols-1 sm:grid-cols-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"})," ",F.next_of_kin_name||"-"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Relationship:"})," ",F.next_of_kin_relationship||"-"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Phone:"})," ",F.next_of_kin_phone||"-"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ID Number:"})," ",F.next_of_kin_id_number||"-"]})]})]}),F.next_of_kin_2_name&&e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-2",children:"Secondary Next of Kin"}),e.jsxs("div",{className:"grid gap-2 grid-cols-1 sm:grid-cols-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"})," ",F.next_of_kin_2_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Relationship:"})," ",F.next_of_kin_2_relationship||"-"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Phone:"})," ",F.next_of_kin_2_phone||"-"]})]})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-base flex items-center gap-2",children:[e.jsx(ib,{className:"h-4 w-4"}),"Employment Information"]})}),e.jsxs(de,{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Employment Status"}),e.jsx("div",{className:"font-medium capitalize",children:F.employment_status?.replace("_"," ")||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Occupation"}),e.jsx("div",{className:"font-medium",children:F.occupation||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Employer"}),e.jsx("div",{className:"font-medium",children:F.employer_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Monthly Income"}),e.jsx("div",{className:"font-medium",children:F.monthly_income?`${a} ${Number(F.monthly_income).toLocaleString()}`:"-"})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-base flex items-center gap-2",children:[e.jsx(Yn,{className:"h-4 w-4"}),"Bank Details"]})}),e.jsxs(de,{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Bank Name"}),e.jsx("div",{className:"font-medium",children:F.bank_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Branch"}),e.jsx("div",{className:"font-medium",children:F.bank_branch||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Account Number"}),e.jsx("div",{className:"font-medium",children:F.bank_account_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Account Name"}),e.jsx("div",{className:"font-medium",children:F.bank_account_name||"-"})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-base flex items-center gap-2",children:[e.jsx(tn,{className:"h-4 w-4"}),"Account Balances"]})}),e.jsxs(de,{className:"grid gap-3 grid-cols-1 sm:grid-cols-3",children:[e.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Savings"}),e.jsxs("div",{className:"text-lg font-bold",children:[a," ",Number(F.savings_balance||0).toLocaleString()]}),Number(F.savings_pending||0)>0&&e.jsxs("div",{className:"text-xs text-amber-600",children:["+ ",a," ",Number(F.savings_pending).toLocaleString()," pending"]})]}),e.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Shares"}),e.jsxs("div",{className:"text-lg font-bold",children:[a," ",Number(F.shares_balance||0).toLocaleString()]}),Number(F.shares_pending||0)>0&&e.jsxs("div",{className:"text-xs text-amber-600",children:["+ ",a," ",Number(F.shares_pending).toLocaleString()," pending"]})]}),e.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Deposits"}),e.jsxs("div",{className:"text-lg font-bold",children:[a," ",Number(F.deposits_balance||0).toLocaleString()]}),Number(F.deposits_pending||0)>0&&e.jsxs("div",{className:"text-xs text-amber-600",children:["+ ",a," ",Number(F.deposits_pending).toLocaleString()," pending"]})]})]})]})]}),e.jsx(bee,{organizationId:t,memberId:F.id})]})}return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:be,"data-testid":"button-back",children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:m==="edit"?"Edit Member":"Register New Member"}),e.jsx("p",{className:"text-muted-foreground",children:m==="edit"?`Editing ${f?.first_name} ${f?.last_name}`:"Complete the membership application form"})]})]}),e.jsx(Qn,{...H,children:e.jsxs("form",{onSubmit:H.handleSubmit(Dt),children:[e.jsxs($s,{value:C,onValueChange:k,children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(vs,{className:"mb-4 w-max sm:w-auto",children:[e.jsxs(_t,{value:"personal",className:"gap-1",children:[e.jsx($d,{className:"h-4 w-4 hidden sm:block"}),"Personal"]}),e.jsxs(_t,{value:"address",className:"gap-1",children:[e.jsx(Jm,{className:"h-4 w-4 hidden sm:block"}),"Address"]}),e.jsxs(_t,{value:"nextofkin",className:"gap-1",children:[e.jsx(Kp,{className:"h-4 w-4 hidden sm:block"}),"Next of Kin"]}),e.jsxs(_t,{value:"employment",className:"gap-1",children:[e.jsx(ib,{className:"h-4 w-4 hidden sm:block"}),"Employment"]}),e.jsxs(_t,{value:"bank",className:"gap-1",children:[e.jsx(Yn,{className:"h-4 w-4 hidden sm:block"}),"Bank"]}),e.jsxs(_t,{value:"membership",className:"gap-1",children:[e.jsx(tn,{className:"h-4 w-4 hidden sm:block"}),"Membership"]})]})}),e.jsx(Nt,{value:"personal",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx($d,{className:"h-5 w-5"}),"Personal Information"]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsx(je,{control:H.control,name:"branch_id",render:({field:F})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Branch ",$&&e.jsx("span",{className:"text-destructive",children:"*"})]}),fe?e.jsx("div",{className:"text-sm p-2 bg-muted rounded",children:ne[0].name}):$?e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-branch",children:e.jsx(Xe,{placeholder:"Select branch (required)"})})}),e.jsx(Ge,{children:ne?.map(Ue=>e.jsx(ee,{value:Ue.id,children:Ue.name},Ue.id))})]}):e.jsx("div",{className:"text-sm text-muted-foreground p-2 bg-muted rounded",children:ne?.find(Ue=>Ue.id===L)?.name||"Your assigned branch"}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(je,{control:H.control,name:"first_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"First Name *"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-first-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"middle_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Middle Name"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-middle-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"last_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Last Name *"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-last-name"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"phone",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number *"}),e.jsx(ye,{children:e.jsx(re,{...F,placeholder:"+254...","data-testid":"input-phone"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"phone_secondary",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Secondary Phone"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-phone-secondary"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:H.control,name:"email",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Email Address"}),e.jsx(ye,{children:e.jsx(re,{type:"email",...F,"data-testid":"input-email"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(je,{control:H.control,name:"id_type",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"ID Type"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-id-type",children:e.jsx(Xe,{placeholder:"Select ID type"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"national_id",children:"National ID"}),e.jsx(ee,{value:"passport",children:"Passport"}),e.jsx(ee,{value:"alien_id",children:"Alien ID"}),e.jsx(ee,{value:"military_id",children:"Military ID"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"id_number",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"ID Number"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-id-number"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"kra_pin",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"KRA PIN"}),e.jsx(ye,{children:e.jsx(re,{...F,placeholder:"A00...","data-testid":"input-kra-pin"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-2 sm:grid-cols-4",children:[e.jsx(je,{control:H.control,name:"date_of_birth",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Date of Birth"}),e.jsx(ye,{children:e.jsx(re,{type:"date",...F,"data-testid":"input-dob"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"gender",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Gender"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-gender",children:e.jsx(Xe,{placeholder:"Select"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"male",children:"Male"}),e.jsx(ee,{value:"female",children:"Female"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"marital_status",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Marital Status"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-marital-status",children:e.jsx(Xe,{placeholder:"Select"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"single",children:"Single"}),e.jsx(ee,{value:"married",children:"Married"}),e.jsx(ee,{value:"divorced",children:"Divorced"}),e.jsx(ee,{value:"widowed",children:"Widowed"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"nationality",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Nationality"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-nationality"})}),e.jsx(Ne,{})]})})]})]})]})}),e.jsx(Nt,{value:"address",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Jm,{className:"h-5 w-5"}),"Address Information"]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsx(je,{control:H.control,name:"address",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Physical Address"}),e.jsx(ye,{children:e.jsx(fn,{...F,rows:2,"data-testid":"input-address"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"postal_code",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"P.O. Box"}),e.jsx(ye,{children:e.jsx(re,{...F,placeholder:"00100","data-testid":"input-postal-code"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"city",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"City/Town"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-city"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"county",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"County"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-county",children:e.jsx(Xe,{placeholder:"Select county"})})}),e.jsx(Ge,{children:yee.map(Ue=>e.jsx(ee,{value:Ue,children:Ue},Ue))})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"country",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Country"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-country"})}),e.jsx(Ne,{})]})})]})]})]})}),e.jsx(Nt,{value:"nextofkin",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Kp,{className:"h-5 w-5"}),"Primary Next of Kin"]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"next_of_kin_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Full Name"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-nok-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"next_of_kin_relationship",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Relationship"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-nok-relationship",children:e.jsx(Xe,{placeholder:"Select relationship"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"spouse",children:"Spouse"}),e.jsx(ee,{value:"parent",children:"Parent"}),e.jsx(ee,{value:"child",children:"Child"}),e.jsx(ee,{value:"sibling",children:"Sibling"}),e.jsx(ee,{value:"relative",children:"Other Relative"}),e.jsx(ee,{value:"friend",children:"Friend"})]})]}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"next_of_kin_phone",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-nok-phone"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"next_of_kin_id_number",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"ID Number"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-nok-id"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:H.control,name:"next_of_kin_address",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Address"}),e.jsx(ye,{children:e.jsx(fn,{...F,rows:2,"data-testid":"input-nok-address"})}),e.jsx(Ne,{})]})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Kp,{className:"h-5 w-5"}),"Secondary Next of Kin (Optional)"]})}),e.jsx(de,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(je,{control:H.control,name:"next_of_kin_2_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Full Name"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-nok2-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"next_of_kin_2_relationship",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Relationship"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-nok2-relationship",children:e.jsx(Xe,{placeholder:"Select"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"spouse",children:"Spouse"}),e.jsx(ee,{value:"parent",children:"Parent"}),e.jsx(ee,{value:"child",children:"Child"}),e.jsx(ee,{value:"sibling",children:"Sibling"}),e.jsx(ee,{value:"relative",children:"Other Relative"}),e.jsx(ee,{value:"friend",children:"Friend"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"next_of_kin_2_phone",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-nok2-phone"})}),e.jsx(Ne,{})]})})]})})]})]})}),e.jsx(Nt,{value:"employment",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(ib,{className:"h-5 w-5"}),"Employment Information"]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"employment_status",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Employment Status"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-employment-status",children:e.jsx(Xe,{placeholder:"Select status"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"employed",children:"Employed"}),e.jsx(ee,{value:"self_employed",children:"Self Employed"}),e.jsx(ee,{value:"business",children:"Business Owner"}),e.jsx(ee,{value:"unemployed",children:"Unemployed"}),e.jsx(ee,{value:"retired",children:"Retired"}),e.jsx(ee,{value:"student",children:"Student"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"occupation",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Occupation / Position"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-occupation"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"employer_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Employer / Business Name"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-employer-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"employer_phone",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Employer Phone"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-employer-phone"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:H.control,name:"employer_address",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Employer Address"}),e.jsx(ye,{children:e.jsx(fn,{...F,rows:2,"data-testid":"input-employer-address"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"monthly_income",render:({field:F})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Monthly Income (",s,")"]}),e.jsx(ye,{children:e.jsx(re,{type:"number",...F,"data-testid":"input-monthly-income"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"employment_date",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Employment Start Date"}),e.jsx(ye,{children:e.jsx(re,{type:"date",...F,"data-testid":"input-employment-date"})}),e.jsx(Ne,{})]})})]})]})]})}),e.jsx(Nt,{value:"bank",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Yn,{className:"h-5 w-5"}),"Bank Details"]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"bank_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Bank Name"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-bank-name",children:e.jsx(Xe,{placeholder:"Select bank"})})}),e.jsx(Ge,{children:jee.map(Ue=>e.jsx(ee,{value:Ue,children:Ue},Ue))})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"bank_branch",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Bank Branch"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-bank-branch"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"bank_account_number",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Account Number"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-bank-account-number"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"bank_account_name",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Account Name"}),e.jsx(ye,{children:e.jsx(re,{...F,"data-testid":"input-bank-account-name"})}),e.jsx(Ne,{})]})})]})]})]})}),e.jsx(Nt,{value:"membership",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"h-5 w-5"}),"Membership Details"]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:e.jsx(je,{control:H.control,name:"membership_type",render:({field:F})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Membership Type"}),e.jsxs(Qe,{onValueChange:F.onChange,value:F.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-membership-type",children:e.jsx(Xe,{placeholder:"Select type"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"ordinary",children:"Ordinary"}),e.jsx(ee,{value:"premium",children:"Premium"}),e.jsx(ee,{value:"corporate",children:"Corporate"})]})]}),e.jsx(Ne,{})]})})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:H.control,name:"registration_fee_paid",render:({field:F})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Registration Fee (",s,")"]}),e.jsx(ye,{children:e.jsx(re,{type:"number",...F,"data-testid":"input-registration-fee"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:H.control,name:"share_capital",render:({field:F})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Share Capital (",s,")"]}),e.jsx(ye,{children:e.jsx(re,{type:"number",...F,"data-testid":"input-share-capital"})}),e.jsx(Ne,{})]})})]})]})]})})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx(B,{type:"button",variant:"outline",onClick:be,"data-testid":"button-cancel",children:"Cancel"}),e.jsx(B,{type:"submit",disabled:Pe.isPending||Re.isPending,"data-testid":"button-submit",children:Pe.isPending||Re.isPending?"Saving...":m==="edit"?"Update Member":"Register Member"})]})]})})]})}var VC="Switch",[_ee]=Kr(VC),[Nee,See]=_ee(VC),p6=v.forwardRef((t,n)=>{const{__scopeSwitch:r,name:s,checked:a,defaultChecked:i,required:o,disabled:c,value:u="on",onCheckedChange:m,form:h,...f}=t,[x,j]=v.useState(null),b=cn(n,N=>j(N)),g=v.useRef(!1),y=x?h||!!x.closest("form"):!0,[C=!1,k]=Zs({prop:a,defaultProp:i,onChange:m});return e.jsxs(Nee,{scope:r,checked:C,disabled:c,children:[e.jsx(gt.button,{type:"button",role:"switch","aria-checked":C,"aria-required":o,"data-state":v6(C),"data-disabled":c?"":void 0,disabled:c,value:u,...f,ref:b,onClick:ot(t.onClick,N=>{k(P=>!P),y&&(g.current=N.isPropagationStopped(),g.current||N.stopPropagation())})}),y&&e.jsx(Cee,{control:x,bubbles:!g.current,name:s,value:u,checked:C,required:o,disabled:c,form:h,style:{transform:"translateX(-100%)"}})]})});p6.displayName=VC;var x6="SwitchThumb",g6=v.forwardRef((t,n)=>{const{__scopeSwitch:r,...s}=t,a=See(x6,r);return e.jsx(gt.span,{"data-state":v6(a.checked),"data-disabled":a.disabled?"":void 0,...s,ref:n})});g6.displayName=x6;var Cee=t=>{const{control:n,checked:r,bubbles:s=!0,...a}=t,i=v.useRef(null),o=NC(r),c=dC(n);return v.useEffect(()=>{const u=i.current,m=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(m,"checked").set;if(o!==r&&f){const x=new Event("click",{bubbles:s});f.call(u,r),u.dispatchEvent(x)}},[o,r,s]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:i,style:{...t.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function v6(t){return t?"checked":"unchecked"}var y6=p6,kee=g6;const ts=v.forwardRef(({className:t,...n},r)=>e.jsx(y6,{className:We("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...n,ref:r,children:e.jsx(kee,{className:We("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ts.displayName=y6.displayName;const Pee=me.object({name:me.string().min(1,"Product name is required"),description:me.string().optional(),interest_rate:me.string().min(1,"Interest rate is required"),interest_rate_period:me.enum(["monthly","annual","weekly"]).default("monthly"),interest_type:me.enum(["flat","reducing_balance"]).default("reducing_balance"),repayment_frequency:me.enum(["daily","weekly","bi_weekly","monthly"]).default("monthly"),min_amount:me.string().min(1,"Minimum amount is required"),max_amount:me.string().min(1,"Maximum amount is required"),min_term_months:me.coerce.number().min(1,"Minimum term is required"),max_term_months:me.coerce.number().min(1,"Maximum term is required"),processing_fee:me.string().default("0"),insurance_fee:me.string().default("0"),appraisal_fee:me.string().default("0"),excise_duty_rate:me.string().default("20"),credit_life_insurance_rate:me.string().default("0"),credit_life_insurance_freq:me.enum(["annual","per_period"]).default("annual"),late_payment_penalty:me.string().default("0"),grace_period_days:me.coerce.number().default(0),requires_guarantor:me.boolean().default(!1),min_guarantors:me.coerce.number().default(0),max_guarantors:me.coerce.number().default(3),shares_multiplier:me.string().default("0"),min_shares_required:me.string().default("0"),deduct_interest_upfront:me.boolean().default(!1),allow_multiple_loans:me.boolean().default(!0),require_good_standing:me.boolean().default(!1),is_active:me.boolean().default(!0)}),Aee=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"bi_weekly",label:"Bi-Weekly"},{value:"monthly",label:"Monthly"}],gd=t=>{if(!t)return"0%";const n=typeof t=="string"?parseFloat(t):t;return`${n%1===0?n.toString():n.toFixed(2).replace(/\.?0+$/,"")}%`};function Eee({organizationId:t}){const{toast:n}=Xt(),[r,s]=v.useState("list"),[a,i]=v.useState(null),[o,c]=v.useState(null),{canWrite:u}=_r(t,Nr.LOAN_PRODUCTS),{data:m,isLoading:h}=$e({queryKey:["/api/organizations",t,"loan-products"],queryFn:async()=>{const w=await fetch(`/api/organizations/${t}/loan-products`,{credentials:"include"});if(!w.ok)throw new Error("Failed to fetch loan products");return w.json()}}),f=$n({resolver:Fn(Pee),defaultValues:{name:"",description:"",interest_rate:"",interest_rate_period:"monthly",interest_type:"reducing_balance",repayment_frequency:"monthly",min_amount:"",max_amount:"",min_term_months:1,max_term_months:12,processing_fee:"0",insurance_fee:"0",appraisal_fee:"0",excise_duty_rate:"20",credit_life_insurance_rate:"0",credit_life_insurance_freq:"annual",late_payment_penalty:"0",grace_period_days:0,requires_guarantor:!1,min_guarantors:0,max_guarantors:3,shares_multiplier:"0",min_shares_required:"0",deduct_interest_upfront:!1,allow_multiple_loans:!0,require_good_standing:!1,is_active:!0}}),x="months",j=w=>"months",b=Le({mutationFn:async w=>Be("POST",`/api/organizations/${t}/loan-products`,w),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-products"]}),s("list"),f.reset(),n({title:"Loan product created successfully"})},onError:()=>{n({title:"Failed to create loan product",variant:"destructive"})}}),g=Le({mutationFn:async w=>{if(a)return Be("PATCH",`/api/organizations/${t}/loan-products/${a.id}`,w)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-products"]}),s("list"),i(null),f.reset(),n({title:"Loan product updated successfully"})},onError:()=>{n({title:"Failed to update loan product",variant:"destructive"})}}),y=Le({mutationFn:async()=>{if(!o)return;const w=await fetch(`/api/organizations/${t}/loan-products/${o.id}`,{method:"DELETE",credentials:"include"});if(!w.ok){const S=await w.json();throw new Error(S.detail||"Failed to delete loan product")}return w.json()},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-products"]}),c(null),n({title:"Loan product deleted successfully"})},onError:w=>{c(null),n({title:w.message,variant:"destructive"})}}),C=()=>{f.reset(),i(null),s("new")},k=w=>{i(w),f.reset({name:w.name,description:w.description||"",interest_rate:String(parseFloat(w.interest_rate)||0),interest_rate_period:w.interest_rate_period||"monthly",interest_type:w.interest_type,repayment_frequency:w.repayment_frequency||"monthly",min_amount:w.min_amount,max_amount:w.max_amount,min_term_months:w.min_term_months,max_term_months:w.max_term_months,processing_fee:String(parseFloat(w.processing_fee)||0),insurance_fee:String(parseFloat(w.insurance_fee)||0),appraisal_fee:String(parseFloat(w.appraisal_fee)||0),excise_duty_rate:String(parseFloat(w.excise_duty_rate)??20),credit_life_insurance_rate:String(parseFloat(w.credit_life_insurance_rate)||0),credit_life_insurance_freq:w.credit_life_insurance_freq||"annual",late_payment_penalty:String(parseFloat(w.late_payment_penalty)||0),grace_period_days:w.grace_period_days||0,requires_guarantor:w.requires_guarantor,min_guarantors:w.min_guarantors||0,max_guarantors:w.max_guarantors||3,shares_multiplier:String(parseFloat(w.shares_multiplier)??0),min_shares_required:String(parseFloat(w.min_shares_required)??0),deduct_interest_upfront:w.deduct_interest_upfront||!1,allow_multiple_loans:w.allow_multiple_loans!==!1,require_good_standing:w.require_good_standing||!1,is_active:w.is_active}),s("edit")},N=w=>{r==="edit"?g.mutate(w):b.mutate(w)},P=()=>{s("list"),i(null),f.reset()};return r==="new"||r==="edit"?e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:P,"data-testid":"button-back-products",children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:r==="edit"?"Edit Loan Product":"New Loan Product"}),e.jsx("p",{className:"text-muted-foreground",children:r==="edit"?`Editing: ${a?.name}`:"Configure a new loan product for your organization"})]})]}),e.jsx(Qn,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(N),className:"space-y-6",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Basic Information"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsx(je,{control:f.control,name:"name",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Product Name"}),e.jsx(ye,{children:e.jsx(re,{...w,placeholder:"e.g. Business Loan","data-testid":"input-product-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"description",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Description"}),e.jsx(ye,{children:e.jsx(fn,{...w,placeholder:"Describe this loan product...","data-testid":"input-product-description"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"is_active",render:({field:w})=>e.jsxs(ge,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(ve,{children:"Active"}),e.jsx(Rn,{children:"Product is available for new loan applications"})]}),e.jsx(ye,{children:e.jsx(ts,{checked:w.value,onCheckedChange:w.onChange,"data-testid":"switch-product-active"})})]})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Interest & Repayment"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(je,{control:f.control,name:"interest_rate",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Interest Rate (%)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.01",placeholder:"12.5","data-testid":"input-product-interest"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"interest_rate_period",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Rate Period"}),e.jsxs(Qe,{onValueChange:w.onChange,value:w.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-product-rate-period",children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"monthly",children:"Per Month"}),e.jsx(ee,{value:"annual",children:"Per Year"}),e.jsx(ee,{value:"weekly",children:"Per Week"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"interest_type",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Interest Type"}),e.jsxs(Qe,{onValueChange:w.onChange,value:w.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-product-interest-type",children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"reducing_balance",children:"Reducing Balance"}),e.jsx(ee,{value:"flat",children:"Flat Rate"})]})]}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:f.control,name:"repayment_frequency",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Repayment Frequency"}),e.jsxs(Qe,{onValueChange:w.onChange,value:w.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-product-frequency",children:e.jsx(Xe,{})})}),e.jsx(Ge,{children:Aee.map(S=>e.jsx(ee,{value:S.value,children:S.label},S.value))})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"grace_period_days",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Grace Period (days)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",placeholder:"0","data-testid":"input-product-grace-period"})}),e.jsx(Rn,{children:"Days before late penalty applies"}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:f.control,name:"deduct_interest_upfront",render:({field:w})=>e.jsxs(ge,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(ve,{children:"Deduct Interest Upfront"}),e.jsx(Rn,{children:"Deduct total interest from principal before disbursement"})]}),e.jsx(ye,{children:e.jsx(ts,{checked:w.value,onCheckedChange:w.onChange,"data-testid":"switch-product-deduct-interest"})})]})}),e.jsx(je,{control:f.control,name:"allow_multiple_loans",render:({field:w})=>e.jsxs(ge,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(ve,{children:"Allow Multiple Loans"}),e.jsx(Rn,{children:"Allow a member to have more than one active loan of this product type"})]}),e.jsx(ye,{children:e.jsx(ts,{checked:w.value,onCheckedChange:w.onChange,"data-testid":"switch-product-allow-multiple"})})]})}),e.jsx(je,{control:f.control,name:"require_good_standing",render:({field:w})=>e.jsxs(ge,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(ve,{children:"Require Good Standing"}),e.jsx(Rn,{children:"Member must have no overdue payments on any existing loans to apply"})]}),e.jsx(ye,{children:e.jsx(ts,{checked:w.value,onCheckedChange:w.onChange,"data-testid":"switch-product-require-good-standing"})})]})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Loan Limits"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:f.control,name:"min_amount",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Minimum Amount"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",placeholder:"10000","data-testid":"input-product-min-amount"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"max_amount",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Maximum Amount"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",placeholder:"1000000","data-testid":"input-product-max-amount"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:f.control,name:"min_term_months",render:({field:w})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Minimum Term (",x,")"]}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number","data-testid":"input-product-min-term"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"max_term_months",render:({field:w})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Maximum Term (",x,")"]}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number","data-testid":"input-product-max-term"})}),e.jsx(Ne,{})]})})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Fees & Charges"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(je,{control:f.control,name:"processing_fee",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Processing Fee (%)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.01",placeholder:"0","data-testid":"input-product-processing-fee"})}),e.jsx(Rn,{children:"One-time fee at disbursement"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"insurance_fee",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Insurance Fee (%)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.01",placeholder:"0","data-testid":"input-product-insurance-fee"})}),e.jsx(Rn,{children:"One-time fee at disbursement"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"appraisal_fee",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Appraisal Fee (%)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.01",placeholder:"0"})}),e.jsx(Rn,{children:"One-time valuation fee"}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(je,{control:f.control,name:"excise_duty_rate",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Excise Duty (%)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.01",placeholder:"20"})}),e.jsx(Rn,{children:"Tax on fees (Kenya: 20%)"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"credit_life_insurance_rate",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Credit Life Insurance (%)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.01",placeholder:"0"})}),e.jsx(Rn,{children:"Recurring on reducing balance"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"credit_life_insurance_freq",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"CLI Frequency"}),e.jsxs(Qe,{onValueChange:w.onChange,defaultValue:w.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select frequency"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"annual",children:"Annual Rate"}),e.jsx(ee,{value:"per_period",children:"Per Period Rate"})]})]}),e.jsx(Rn,{children:"How the rate is applied"}),e.jsx(Ne,{})]})})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-3",children:e.jsx(je,{control:f.control,name:"late_payment_penalty",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Late Payment Penalty (%)"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.01",placeholder:"0","data-testid":"input-product-late-penalty"})}),e.jsx(Rn,{children:"Applied to overdue payments"}),e.jsx(Ne,{})]})})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Guarantor Settings"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsx(je,{control:f.control,name:"requires_guarantor",render:({field:w})=>e.jsxs(ge,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(ve,{children:"Requires Guarantor"}),e.jsx(Rn,{children:"Loan applications must have guarantors"})]}),e.jsx(ye,{children:e.jsx(ts,{checked:w.value,onCheckedChange:w.onChange,"data-testid":"switch-product-guarantor"})})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:f.control,name:"min_guarantors",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Minimum Guarantors"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",min:"0","data-testid":"input-product-min-guarantors"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"max_guarantors",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Maximum Guarantors"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",min:"0","data-testid":"input-product-max-guarantors"})}),e.jsx(Ne,{})]})})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Shares-Based Eligibility"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Standard SACCO practice: Members can borrow a multiple of their share capital (e.g., 3x shares = can borrow up to 3 times their shares balance)."}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:f.control,name:"shares_multiplier",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Shares Multiplier"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"0.5",min:"0",placeholder:"3","data-testid":"input-product-shares-multiplier"})}),e.jsx(Rn,{children:"Maximum loan = Shares  Multiplier (0 to disable)"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:f.control,name:"min_shares_required",render:({field:w})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Minimum Shares Required"}),e.jsx(ye,{children:e.jsx(re,{...w,type:"number",step:"100",min:"0",placeholder:"0","data-testid":"input-product-min-shares"})}),e.jsx(Rn,{children:"Minimum shares balance to qualify (0 = no minimum)"}),e.jsx(Ne,{})]})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-end",children:[e.jsx(B,{type:"button",variant:"outline",onClick:P,children:"Cancel"}),e.jsx(B,{type:"submit",disabled:b.isPending||g.isPending,"data-testid":"button-save-product",children:b.isPending||g.isPending?"Saving...":r==="edit"?"Update Product":"Create Product"})]})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Loan Products"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure loan products for your organization"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),u&&e.jsxs(B,{onClick:C,"data-testid":"button-add-product",className:"shrink-0",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Product"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]}),e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:h?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):m&&m.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Name"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Code"}),e.jsx(Q,{children:"Interest"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Fees"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Amount Range"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Term Range"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:m.map(w=>e.jsxs(qe,{"data-testid":`row-product-${w.id}`,children:[e.jsxs(V,{className:"font-medium",children:[e.jsx("div",{children:w.name}),e.jsx("div",{className:"text-xs text-muted-foreground sm:hidden",children:w.code||""})]}),e.jsx(V,{className:"hidden sm:table-cell",children:w.code||"-"}),e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[gd(w.interest_rate)," ",w.interest_rate_period==="annual"?"p.a.":w.interest_rate_period==="weekly"?"p.w.":"p.m."," (",w.interest_type?.replace("_"," "),")"]})}),e.jsx(V,{className:"hidden lg:table-cell",children:e.jsxs("div",{className:"text-xs space-y-0.5",children:[parseFloat(w.processing_fee||0)>0&&e.jsxs("div",{children:["Proc: ",gd(w.processing_fee)]}),parseFloat(w.insurance_fee||0)>0&&e.jsxs("div",{children:["Ins: ",gd(w.insurance_fee)]}),parseFloat(w.appraisal_fee||0)>0&&e.jsxs("div",{children:["Appr: ",gd(w.appraisal_fee)]}),parseFloat(w.credit_life_insurance_rate||0)>0&&e.jsxs("div",{children:["CLI: ",gd(w.credit_life_insurance_rate),"/yr"]}),parseFloat(w.late_payment_penalty||0)>0&&e.jsxs("div",{children:["Late: ",gd(w.late_payment_penalty)]}),!parseFloat(w.processing_fee||0)&&!parseFloat(w.insurance_fee||0)&&!parseFloat(w.appraisal_fee||0)&&!parseFloat(w.credit_life_insurance_rate||0)&&!parseFloat(w.late_payment_penalty||0)&&"-"]})}),e.jsxs(V,{className:"hidden md:table-cell",children:[parseFloat(w.min_amount).toLocaleString()," - ",parseFloat(w.max_amount).toLocaleString()]}),e.jsxs(V,{className:"hidden lg:table-cell",children:[w.min_term_months," - ",w.max_term_months," ",j()]}),e.jsx(V,{className:"hidden sm:table-cell",children:e.jsx(ze,{variant:w.is_active?"default":"secondary",children:w.is_active?"Active":"Inactive"})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[u&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>k(w),"data-testid":`button-edit-product-${w.id}`,children:e.jsx(Ba,{className:"h-4 w-4"})}),u&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>c(w),"data-testid":`button-delete-product-${w.id}`,children:e.jsx(ba,{className:"h-4 w-4"})})]})})]},w.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(ns,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No Loan Products"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create loan products to start processing loans"}),u&&e.jsxs(B,{onClick:C,"data-testid":"button-add-product-empty",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Add First Product"]})]})})}),e.jsx(Vt,{open:!!o,onOpenChange:w=>!w&&c(null),children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Delete Loan Product"}),e.jsxs(Qt,{children:['Are you sure you want to delete "',o?.name,'"? This action cannot be undone.']})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>c(null),children:"Cancel"}),e.jsx(B,{variant:"destructive",onClick:()=>y.mutate(),disabled:y.isPending,"data-testid":"button-confirm-delete-product",children:y.isPending?"Deleting...":"Delete"})]})]})})]})}var UC="Checkbox",[Oee]=Kr(UC),[Tee,Mee]=Oee(UC),j6=v.forwardRef((t,n)=>{const{__scopeCheckbox:r,name:s,checked:a,defaultChecked:i,required:o,disabled:c,value:u="on",onCheckedChange:m,form:h,...f}=t,[x,j]=v.useState(null),b=cn(n,P=>j(P)),g=v.useRef(!1),y=x?h||!!x.closest("form"):!0,[C=!1,k]=Zs({prop:a,defaultProp:i,onChange:m}),N=v.useRef(C);return v.useEffect(()=>{const P=x?.form;if(P){const w=()=>k(N.current);return P.addEventListener("reset",w),()=>P.removeEventListener("reset",w)}},[x,k]),e.jsxs(Tee,{scope:r,state:C,disabled:c,children:[e.jsx(gt.button,{type:"button",role:"checkbox","aria-checked":xl(C)?"mixed":C,"aria-required":o,"data-state":_6(C),"data-disabled":c?"":void 0,disabled:c,value:u,...f,ref:b,onKeyDown:ot(t.onKeyDown,P=>{P.key==="Enter"&&P.preventDefault()}),onClick:ot(t.onClick,P=>{k(w=>xl(w)?!0:!w),y&&(g.current=P.isPropagationStopped(),g.current||P.stopPropagation())})}),y&&e.jsx(Ree,{control:x,bubbles:!g.current,name:s,value:u,checked:C,required:o,disabled:c,form:h,style:{transform:"translateX(-100%)"},defaultChecked:xl(i)?!1:i})]})});j6.displayName=UC;var b6="CheckboxIndicator",w6=v.forwardRef((t,n)=>{const{__scopeCheckbox:r,forceMount:s,...a}=t,i=Mee(b6,r);return e.jsx(Rs,{present:s||xl(i.state)||i.state===!0,children:e.jsx(gt.span,{"data-state":_6(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:n,style:{pointerEvents:"none",...t.style}})})});w6.displayName=b6;var Ree=t=>{const{control:n,checked:r,bubbles:s=!0,defaultChecked:a,...i}=t,o=v.useRef(null),c=NC(r),u=dC(n);v.useEffect(()=>{const h=o.current,f=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==r&&j){const b=new Event("click",{bubbles:s});h.indeterminate=xl(r),j.call(h,xl(r)?!1:r),h.dispatchEvent(b)}},[c,r,s]);const m=v.useRef(xl(r)?!1:r);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??m.current,...i,tabIndex:-1,ref:o,style:{...t.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function xl(t){return t==="indeterminate"}function _6(t){return xl(t)?"indeterminate":t?"checked":"unchecked"}var N6=j6,Dee=w6;const Ai=v.forwardRef(({className:t,...n},r)=>e.jsx(N6,{ref:r,className:We("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...n,children:e.jsx(Dee,{className:We("flex items-center justify-center text-current"),children:e.jsx(fs,{className:"h-4 w-4"})})}));Ai.displayName=N6.displayName;var cO=1,$ee=.9,Fee=.8,Lee=.17,_b=.1,Nb=.999,Iee=.9999,qee=.99,Bee=/[\\\/_+.#"@\[\(\{&]/,zee=/[\\\/_+.#"@\[\(\{&]/g,Vee=/[\s-]/,S6=/[\s-]/g;function y1(t,n,r,s,a,i,o){if(i===n.length)return a===t.length?cO:qee;var c=`${a},${i}`;if(o[c]!==void 0)return o[c];for(var u=s.charAt(i),m=r.indexOf(u,a),h=0,f,x,j,b;m>=0;)f=y1(t,n,r,s,m+1,i+1,o),f>h&&(m===a?f*=cO:Bee.test(t.charAt(m-1))?(f*=Fee,j=t.slice(a,m-1).match(zee),j&&a>0&&(f*=Math.pow(Nb,j.length))):Vee.test(t.charAt(m-1))?(f*=$ee,b=t.slice(a,m-1).match(S6),b&&a>0&&(f*=Math.pow(Nb,b.length))):(f*=Lee,a>0&&(f*=Math.pow(Nb,m-a))),t.charAt(m)!==n.charAt(i)&&(f*=Iee)),(f<_b&&r.charAt(m-1)===s.charAt(i+1)||s.charAt(i+1)===s.charAt(i)&&r.charAt(m-1)!==s.charAt(i))&&(x=y1(t,n,r,s,m+1,i+2,o),x*_b>f&&(f=x*_b)),f>h&&(h=f),m=r.indexOf(u,m+1);return o[c]=h,h}function dO(t){return t.toLowerCase().replace(S6," ")}function Uee(t,n,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,y1(t,n,dO(t),dO(n),0,0,{})}var Om='[cmdk-group=""]',Sb='[cmdk-group-items=""]',Kee='[cmdk-group-heading=""]',C6='[cmdk-item=""]',uO=`${C6}:not([aria-disabled="true"])`,j1="cmdk-item-select",Nd="data-value",Wee=(t,n,r)=>Uee(t,n,r),k6=v.createContext(void 0),Of=()=>v.useContext(k6),P6=v.createContext(void 0),KC=()=>v.useContext(P6),A6=v.createContext(void 0),E6=v.forwardRef((t,n)=>{let r=Sd(()=>{var H,fe;return{search:"",value:(fe=(H=t.value)!=null?H:t.defaultValue)!=null?fe:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),s=Sd(()=>new Set),a=Sd(()=>new Map),i=Sd(()=>new Map),o=Sd(()=>new Set),c=O6(t),{label:u,children:m,value:h,onValueChange:f,filter:x,shouldFilter:j,loop:b,disablePointerSelection:g=!1,vimBindings:y=!0,...C}=t,k=jr(),N=jr(),P=jr(),w=v.useRef(null),S=rte();kc(()=>{if(h!==void 0){let H=h.trim();r.current.value=H,E.emit()}},[h]),kc(()=>{S(6,q)},[]);let E=v.useMemo(()=>({subscribe:H=>(o.current.add(H),()=>o.current.delete(H)),snapshot:()=>r.current,setState:(H,fe,Pe)=>{var Re,Ie,Ce,Y;if(!Object.is(r.current[H],fe)){if(r.current[H]=fe,H==="search")L(),U(),S(1,M);else if(H==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let ie=document.getElementById(P);ie?ie.focus():(Re=document.getElementById(k))==null||Re.focus()}if(S(7,()=>{var ie;r.current.selectedItemId=(ie=$())==null?void 0:ie.id,E.emit()}),Pe||S(5,q),((Ie=c.current)==null?void 0:Ie.value)!==void 0){let ie=fe??"";(Y=(Ce=c.current).onValueChange)==null||Y.call(Ce,ie);return}}E.emit()}},emit:()=>{o.current.forEach(H=>H())}}),[]),R=v.useMemo(()=>({value:(H,fe,Pe)=>{var Re;fe!==((Re=i.current.get(H))==null?void 0:Re.value)&&(i.current.set(H,{value:fe,keywords:Pe}),r.current.filtered.items.set(H,T(fe,Pe)),S(2,()=>{U(),E.emit()}))},item:(H,fe)=>(s.current.add(H),fe&&(a.current.has(fe)?a.current.get(fe).add(H):a.current.set(fe,new Set([H]))),S(3,()=>{L(),U(),r.current.value||M(),E.emit()}),()=>{i.current.delete(H),s.current.delete(H),r.current.filtered.items.delete(H);let Pe=$();S(4,()=>{L(),Pe?.getAttribute("id")===H&&M(),E.emit()})}),group:H=>(a.current.has(H)||a.current.set(H,new Set),()=>{i.current.delete(H),a.current.delete(H)}),filter:()=>c.current.shouldFilter,label:u||t["aria-label"],getDisablePointerSelection:()=>c.current.disablePointerSelection,listId:k,inputId:P,labelId:N,listInnerRef:w}),[]);function T(H,fe){var Pe,Re;let Ie=(Re=(Pe=c.current)==null?void 0:Pe.filter)!=null?Re:Wee;return H?Ie(H,r.current.search,fe):0}function U(){if(!r.current.search||c.current.shouldFilter===!1)return;let H=r.current.filtered.items,fe=[];r.current.filtered.groups.forEach(Re=>{let Ie=a.current.get(Re),Ce=0;Ie.forEach(Y=>{let ie=H.get(Y);Ce=Math.max(ie,Ce)}),fe.push([Re,Ce])});let Pe=w.current;D().sort((Re,Ie)=>{var Ce,Y;let ie=Re.getAttribute("id"),Ee=Ie.getAttribute("id");return((Ce=H.get(Ee))!=null?Ce:0)-((Y=H.get(ie))!=null?Y:0)}).forEach(Re=>{let Ie=Re.closest(Sb);Ie?Ie.appendChild(Re.parentElement===Ie?Re:Re.closest(`${Sb} > *`)):Pe.appendChild(Re.parentElement===Pe?Re:Re.closest(`${Sb} > *`))}),fe.sort((Re,Ie)=>Ie[1]-Re[1]).forEach(Re=>{var Ie;let Ce=(Ie=w.current)==null?void 0:Ie.querySelector(`${Om}[${Nd}="${encodeURIComponent(Re[0])}"]`);Ce?.parentElement.appendChild(Ce)})}function M(){let H=D().find(Pe=>Pe.getAttribute("aria-disabled")!=="true"),fe=H?.getAttribute(Nd);E.setState("value",fe||void 0)}function L(){var H,fe,Pe,Re;if(!r.current.search||c.current.shouldFilter===!1){r.current.filtered.count=s.current.size;return}r.current.filtered.groups=new Set;let Ie=0;for(let Ce of s.current){let Y=(fe=(H=i.current.get(Ce))==null?void 0:H.value)!=null?fe:"",ie=(Re=(Pe=i.current.get(Ce))==null?void 0:Pe.keywords)!=null?Re:[],Ee=T(Y,ie);r.current.filtered.items.set(Ce,Ee),Ee>0&&Ie++}for(let[Ce,Y]of a.current)for(let ie of Y)if(r.current.filtered.items.get(ie)>0){r.current.filtered.groups.add(Ce);break}r.current.filtered.count=Ie}function q(){var H,fe,Pe;let Re=$();Re&&(((H=Re.parentElement)==null?void 0:H.firstChild)===Re&&((Pe=(fe=Re.closest(Om))==null?void 0:fe.querySelector(Kee))==null||Pe.scrollIntoView({block:"nearest"})),Re.scrollIntoView({block:"nearest"}))}function $(){var H;return(H=w.current)==null?void 0:H.querySelector(`${C6}[aria-selected="true"]`)}function D(){var H;return Array.from(((H=w.current)==null?void 0:H.querySelectorAll(uO))||[])}function z(H){let fe=D()[H];fe&&E.setState("value",fe.getAttribute(Nd))}function J(H){var fe;let Pe=$(),Re=D(),Ie=Re.findIndex(Y=>Y===Pe),Ce=Re[Ie+H];(fe=c.current)!=null&&fe.loop&&(Ce=Ie+H<0?Re[Re.length-1]:Ie+H===Re.length?Re[0]:Re[Ie+H]),Ce&&E.setState("value",Ce.getAttribute(Nd))}function I(H){let fe=$(),Pe=fe?.closest(Om),Re;for(;Pe&&!Re;)Pe=H>0?tte(Pe,Om):nte(Pe,Om),Re=Pe?.querySelector(uO);Re?E.setState("value",Re.getAttribute(Nd)):J(H)}let X=()=>z(D().length-1),ne=H=>{H.preventDefault(),H.metaKey?X():H.altKey?I(1):J(1)},W=H=>{H.preventDefault(),H.metaKey?z(0):H.altKey?I(-1):J(-1)};return v.createElement(gt.div,{ref:n,tabIndex:-1,...C,"cmdk-root":"",onKeyDown:H=>{var fe;(fe=C.onKeyDown)==null||fe.call(C,H);let Pe=H.nativeEvent.isComposing||H.keyCode===229;if(!(H.defaultPrevented||Pe))switch(H.key){case"n":case"j":{y&&H.ctrlKey&&ne(H);break}case"ArrowDown":{ne(H);break}case"p":case"k":{y&&H.ctrlKey&&W(H);break}case"ArrowUp":{W(H);break}case"Home":{H.preventDefault(),z(0);break}case"End":{H.preventDefault(),X();break}case"Enter":{H.preventDefault();let Re=$();if(Re){let Ie=new Event(j1);Re.dispatchEvent(Ie)}}}}},v.createElement("label",{"cmdk-label":"",htmlFor:R.inputId,id:R.labelId,style:ate},u),Pv(t,H=>v.createElement(P6.Provider,{value:E},v.createElement(k6.Provider,{value:R},H))))}),Hee=v.forwardRef((t,n)=>{var r,s;let a=jr(),i=v.useRef(null),o=v.useContext(A6),c=Of(),u=O6(t),m=(s=(r=u.current)==null?void 0:r.forceMount)!=null?s:o?.forceMount;kc(()=>{if(!m)return c.item(a,o?.id)},[m]);let h=T6(a,i,[t.value,t.children,i],t.keywords),f=KC(),x=kl(S=>S.value&&S.value===h.current),j=kl(S=>m||c.filter()===!1?!0:S.search?S.filtered.items.get(a)>0:!0);v.useEffect(()=>{let S=i.current;if(!(!S||t.disabled))return S.addEventListener(j1,b),()=>S.removeEventListener(j1,b)},[j,t.onSelect,t.disabled]);function b(){var S,E;g(),(E=(S=u.current).onSelect)==null||E.call(S,h.current)}function g(){f.setState("value",h.current,!0)}if(!j)return null;let{disabled:y,value:C,onSelect:k,forceMount:N,keywords:P,...w}=t;return v.createElement(gt.div,{ref:xo(i,n),...w,id:a,"cmdk-item":"",role:"option","aria-disabled":!!y,"aria-selected":!!x,"data-disabled":!!y,"data-selected":!!x,onPointerMove:y||c.getDisablePointerSelection()?void 0:g,onClick:y?void 0:b},t.children)}),Gee=v.forwardRef((t,n)=>{let{heading:r,children:s,forceMount:a,...i}=t,o=jr(),c=v.useRef(null),u=v.useRef(null),m=jr(),h=Of(),f=kl(j=>a||h.filter()===!1?!0:j.search?j.filtered.groups.has(o):!0);kc(()=>h.group(o),[]),T6(o,c,[t.value,t.heading,u]);let x=v.useMemo(()=>({id:o,forceMount:a}),[a]);return v.createElement(gt.div,{ref:xo(c,n),...i,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},r&&v.createElement("div",{ref:u,"cmdk-group-heading":"","aria-hidden":!0,id:m},r),Pv(t,j=>v.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?m:void 0},v.createElement(A6.Provider,{value:x},j))))}),Yee=v.forwardRef((t,n)=>{let{alwaysRender:r,...s}=t,a=v.useRef(null),i=kl(o=>!o.search);return!r&&!i?null:v.createElement(gt.div,{ref:xo(a,n),...s,"cmdk-separator":"",role:"separator"})}),Qee=v.forwardRef((t,n)=>{let{onValueChange:r,...s}=t,a=t.value!=null,i=KC(),o=kl(m=>m.search),c=kl(m=>m.selectedItemId),u=Of();return v.useEffect(()=>{t.value!=null&&i.setState("search",t.value)},[t.value]),v.createElement(gt.input,{ref:n,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":u.listId,"aria-labelledby":u.labelId,"aria-activedescendant":c,id:u.inputId,type:"text",value:a?t.value:o,onChange:m=>{a||i.setState("search",m.target.value),r?.(m.target.value)}})}),Xee=v.forwardRef((t,n)=>{let{children:r,label:s="Suggestions",...a}=t,i=v.useRef(null),o=v.useRef(null),c=kl(m=>m.selectedItemId),u=Of();return v.useEffect(()=>{if(o.current&&i.current){let m=o.current,h=i.current,f,x=new ResizeObserver(()=>{f=requestAnimationFrame(()=>{let j=m.offsetHeight;h.style.setProperty("--cmdk-list-height",j.toFixed(1)+"px")})});return x.observe(m),()=>{cancelAnimationFrame(f),x.unobserve(m)}}},[]),v.createElement(gt.div,{ref:xo(i,n),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":c,"aria-label":s,id:u.listId},Pv(t,m=>v.createElement("div",{ref:xo(o,u.listInnerRef),"cmdk-list-sizer":""},m)))}),Zee=v.forwardRef((t,n)=>{let{open:r,onOpenChange:s,overlayClassName:a,contentClassName:i,container:o,...c}=t;return v.createElement(bv,{open:r,onOpenChange:s},v.createElement(wv,{container:o},v.createElement(Lu,{"cmdk-overlay":"",className:a}),v.createElement(Iu,{"aria-label":t.label,"cmdk-dialog":"",className:i},v.createElement(E6,{ref:n,...c}))))}),Jee=v.forwardRef((t,n)=>kl(r=>r.filtered.count===0)?v.createElement(gt.div,{ref:n,...t,"cmdk-empty":"",role:"presentation"}):null),ete=v.forwardRef((t,n)=>{let{progress:r,children:s,label:a="Loading...",...i}=t;return v.createElement(gt.div,{ref:n,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Pv(t,o=>v.createElement("div",{"aria-hidden":!0},o)))}),Js=Object.assign(E6,{List:Xee,Item:Hee,Input:Qee,Group:Gee,Separator:Yee,Dialog:Zee,Empty:Jee,Loading:ete});function tte(t,n){let r=t.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function nte(t,n){let r=t.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function O6(t){let n=v.useRef(t);return kc(()=>{n.current=t}),n}var kc=typeof window>"u"?v.useEffect:v.useLayoutEffect;function Sd(t){let n=v.useRef();return n.current===void 0&&(n.current=t()),n}function kl(t){let n=KC(),r=()=>t(n.snapshot());return v.useSyncExternalStore(n.subscribe,r,r)}function T6(t,n,r,s=[]){let a=v.useRef(),i=Of();return kc(()=>{var o;let c=(()=>{var m;for(let h of r){if(typeof h=="string")return h.trim();if(typeof h=="object"&&"current"in h)return h.current?(m=h.current.textContent)==null?void 0:m.trim():a.current}})(),u=s.map(m=>m.trim());i.value(t,c,u),(o=n.current)==null||o.setAttribute(Nd,c),a.current=c}),a}var rte=()=>{let[t,n]=v.useState(),r=Sd(()=>new Map);return kc(()=>{r.current.forEach(s=>s()),r.current=new Map},[t]),(s,a)=>{r.current.set(s,a),n({})}};function ste(t){let n=t.type;return typeof n=="function"?n(t.props):"render"in n?n.render(t.props):t}function Pv({asChild:t,children:n},r){return t&&v.isValidElement(n)?v.cloneElement(ste(n),{ref:n.ref},r(n.props.children)):r(n)}var ate={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Jd=v.forwardRef(({className:t,...n},r)=>e.jsx(Js,{ref:r,className:We("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...n}));Jd.displayName=Js.displayName;const eu=v.forwardRef(({className:t,...n},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(za,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(Js.Input,{ref:r,className:We("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...n})]}));eu.displayName=Js.Input.displayName;const tu=v.forwardRef(({className:t,...n},r)=>e.jsx(Js.List,{ref:r,className:We("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...n}));tu.displayName=Js.List.displayName;const nu=v.forwardRef((t,n)=>e.jsx(Js.Empty,{ref:n,className:"py-6 text-center text-sm",...t}));nu.displayName=Js.Empty.displayName;const ru=v.forwardRef(({className:t,...n},r)=>e.jsx(Js.Group,{ref:r,className:We("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...n}));ru.displayName=Js.Group.displayName;const ite=v.forwardRef(({className:t,...n},r)=>e.jsx(Js.Separator,{ref:r,className:We("-mx-1 h-px bg-border",t),...n}));ite.displayName=Js.Separator.displayName;const su=v.forwardRef(({className:t,...n},r)=>e.jsx(Js.Item,{ref:r,className:We("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...n}));su.displayName=Js.Item.displayName;const ote=me.object({guarantor_id:me.string().min(1,"Select a member"),amount_guaranteed:me.string().min(1,"Amount is required"),relationship_to_borrower:me.string().min(1,"Select relationship to borrower")}),lte=[{value:"spouse",label:"Spouse"},{value:"family",label:"Family Member"},{value:"colleague",label:"Work Colleague"},{value:"friend",label:"Friend"},{value:"business_partner",label:"Business Partner"},{value:"neighbor",label:"Neighbor"},{value:"other",label:"Other"}];function cte({organizationId:t,loanId:n,loanStatus:r,loanAmount:s=0}){const{toast:a}=Xt(),[i,o]=v.useState(!1),[c,u]=v.useState(null),[m,h]=v.useState(""),[f,x]=v.useState(null),[j,b]=v.useState(!1),{canWrite:g}=_r(t,Nr.GUARANTORS),y=(r==="pending"||r==="under_review")&&g,{data:C,isLoading:k}=$e({queryKey:[`/api/organizations/${t}/loans/${n}/guarantors`]}),{data:N,isLoading:P}=$e({queryKey:[`/api/organizations/${t}/loans/${n}/eligible-guarantors`],enabled:i}),w=$n({resolver:Fn(ote),defaultValues:{guarantor_id:"",amount_guaranteed:"",relationship_to_borrower:""}}),S=`/api/organizations/${t}/loans/${n}/guarantors`,E=`/api/organizations/${t}/loans/${n}/eligible-guarantors`,R=Le({mutationFn:async I=>Be("POST",`/api/organizations/${t}/loans/${n}/guarantors`,{guarantor_id:I.guarantor_id,amount_guaranteed:parseFloat(I.amount_guaranteed),relationship_to_borrower:I.relationship_to_borrower}),onSuccess:()=>{Fe.invalidateQueries({queryKey:[S]}),Fe.invalidateQueries({queryKey:[E]}),o(!1),x(null),w.reset(),a({title:"Guarantor added successfully"})},onError:I=>{a({title:"Failed to add guarantor",description:Vn(I),variant:"destructive"})}}),T=Le({mutationFn:async I=>Be("PUT",`/api/organizations/${t}/guarantors/${I}/accept`),onSuccess:()=>{Fe.invalidateQueries({queryKey:[S]}),a({title:"Guarantee accepted"})},onError:I=>{a({title:"Failed to accept guarantee",description:Vn(I),variant:"destructive"})}}),U=Le({mutationFn:async({id:I,reason:X})=>Be("PUT",`/api/organizations/${t}/guarantors/${I}/reject`,{rejection_reason:X}),onSuccess:()=>{Fe.invalidateQueries({queryKey:[S]}),Fe.invalidateQueries({queryKey:[E]}),u(null),h(""),a({title:"Guarantee rejected"})},onError:I=>{a({title:"Failed to reject guarantee",description:Vn(I),variant:"destructive"})}}),M=Le({mutationFn:async I=>Be("DELETE",`/api/organizations/${t}/guarantors/${I}`),onSuccess:()=>{Fe.invalidateQueries({queryKey:[S]}),Fe.invalidateQueries({queryKey:[E]}),a({title:"Guarantor removed"})},onError:I=>{a({title:"Failed to remove guarantor",description:Vn(I),variant:"destructive"})}}),L=I=>{R.mutate(I)},q=I=>{const X={pending:"secondary",accepted:"default",rejected:"destructive",released:"outline",called:"destructive"};return e.jsx(ze,{variant:X[I]||"secondary",children:I})},$=I=>I==null?"-":I.toLocaleString(),D=C?.reduce((I,X)=>I+(X.status!=="rejected"?Number(X.amount_guaranteed):0),0)||0,z=C?.filter(I=>I.status==="accepted").length||0,J=C?.filter(I=>I.status==="pending").length||0;return k?e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(bt,{className:"h-6 w-32"})}),e.jsx(de,{children:e.jsx(bt,{className:"h-24 w-full"})})]}):e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5"}),"Loan Guarantors"]}),e.jsxs(dt,{children:["Members guaranteeing this loan (",z," accepted, ",J," pending)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),y&&e.jsxs(B,{onClick:()=>o(!0),size:"sm","data-testid":"button-add-guarantor",children:[e.jsx(Cx,{className:"h-4 w-4 mr-2"}),"Add Guarantor"]})]})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Guaranteed"}),e.jsx("p",{className:"text-lg font-semibold",children:$(D)})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Loan Amount"}),e.jsx("p",{className:"text-lg font-semibold",children:$(s)})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Coverage"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s>0?(D/s*100).toFixed(0):0,"%"]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Guarantors"}),e.jsx("p",{className:"text-lg font-semibold",children:C?.length||0})]})]}),C&&C.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Guarantor"}),e.jsx(Q,{children:"Relationship"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{className:"text-right",children:"%"}),e.jsx(Q,{children:"Savings at Guarantee"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:C.map(I=>e.jsxs(qe,{"data-testid":`guarantor-row-${I.id}`,children:[e.jsx(V,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[I.guarantor?.first_name," ",I.guarantor?.last_name]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:I.guarantor?.member_number}),I.guarantor?.phone&&e.jsx("p",{className:"text-xs text-muted-foreground",children:I.guarantor.phone})]})}),e.jsx(V,{children:e.jsx("span",{className:"capitalize",children:I.relationship_to_borrower?.replace("_"," ")||"-"})}),e.jsx(V,{className:"text-right font-medium",children:$(Number(I.amount_guaranteed))}),e.jsx(V,{className:"text-right",children:I.guarantee_percentage?`${Number(I.guarantee_percentage).toFixed(0)}%`:"-"}),e.jsx(V,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{children:["Savings: ",$(Number(I.guarantor_savings_at_guarantee))]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Capacity: ",$(Number(I.available_guarantee_capacity))]})]})}),e.jsx(V,{children:e.jsxs("div",{className:"space-y-1",children:[q(I.status),I.rejection_reason&&e.jsx("p",{className:"text-xs text-destructive",children:I.rejection_reason}),I.consent_given&&I.consent_date&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Consent: ",new Date(I.consent_date).toLocaleDateString()]})]})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[I.status==="pending"&&y&&e.jsxs(e.Fragment,{children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>T.mutate(I.id),disabled:T.isPending,"data-testid":`button-accept-${I.id}`,title:"Accept Guarantee",children:e.jsx(fs,{className:"h-4 w-4 text-green-600"})}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>u(I),"data-testid":`button-reject-${I.id}`,title:"Reject Guarantee",children:e.jsx(rs,{className:"h-4 w-4 text-red-600"})})]}),y&&I.status!=="accepted"&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>M.mutate(I.id),disabled:M.isPending,"data-testid":`button-remove-${I.id}`,title:"Remove Guarantor",children:e.jsx(ba,{className:"h-4 w-4 text-destructive"})})]})})]},I.id))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Es,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No guarantors added yet"}),y&&e.jsx(B,{variant:"link",onClick:()=>o(!0),children:"Add a guarantor"})]})]}),e.jsx(Vt,{open:i,onOpenChange:o,children:e.jsxs(It,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(Cx,{className:"h-5 w-5"}),"Add Loan Guarantor"]}),e.jsx(Qt,{children:"Select an eligible member to guarantee this loan. Members must have sufficient savings and no defaults."})]}),e.jsx(Qn,{...w,children:e.jsxs("form",{onSubmit:w.handleSubmit(L),className:"space-y-6",children:[e.jsx(je,{control:w.control,name:"guarantor_id",render:({field:I})=>e.jsxs(ge,{className:"flex flex-col",children:[e.jsxs(ve,{children:["Select Guarantor ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(hc,{open:j,onOpenChange:b,children:[e.jsx(fc,{asChild:!0,children:e.jsx(ye,{children:e.jsxs(B,{variant:"outline",role:"combobox","data-testid":"select-guarantor",className:We("w-full justify-between",!I.value&&"text-muted-foreground"),children:[I.value?N?.find(X=>X.member_id===I.value)?.member_name||"Select a member...":"Search by name, member number, ID number, phone, email...",e.jsx(uh,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(pl,{className:"w-[450px] p-0",align:"start",children:e.jsxs(Jd,{children:[e.jsx(eu,{placeholder:"Search by name, member number, ID number, phone, email..."}),e.jsx(tu,{children:P?e.jsx("div",{className:"p-4 text-center",children:"Loading eligible members..."}):e.jsxs(e.Fragment,{children:[e.jsx(nu,{children:"No eligible members found."}),e.jsx(ru,{children:N?.map(X=>e.jsx(su,{value:`${X.member_name} ${X.member_number} ${X.id_number||""} ${X.phone||""} ${X.email||""}`,disabled:!X.is_eligible,onSelect:()=>{I.onChange(X.member_id),x(X),b(!1)},children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[X.is_eligible?e.jsx(fs,{className:"h-3 w-3 text-green-600 shrink-0"}):e.jsx(Ur,{className:"h-3 w-3 text-amber-500 shrink-0"}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsxs("span",{className:"truncate",children:[X.member_name," (",X.member_number,")"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Capacity: ",$(X.available_guarantee_capacity)]})]})]})},X.member_id))})]})})]})})]}),e.jsx(Ne,{})]})}),f&&e.jsx(oe,{className:f.is_eligible?"border-green-200 bg-green-50/50":"border-amber-200 bg-amber-50/50",children:e.jsxs(de,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:f.member_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.member_number})]}),e.jsx(ze,{variant:f.is_eligible?"default":"secondary",children:f.is_eligible?"Eligible":"Not Eligible"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ys,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Savings"}),e.jsx("p",{className:"font-medium",children:$(f.savings_balance)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ev,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Max Capacity"}),e.jsx("p",{className:"font-medium",children:$(f.max_guarantee_capacity)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current Exposure"}),e.jsx("p",{className:"font-medium",children:$(f.current_guarantee_exposure)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Available"}),e.jsx("p",{className:"font-medium text-green-600",children:$(f.available_guarantee_capacity)})]})]})]}),!f.is_eligible&&e.jsxs("div",{className:"mt-3 p-2 bg-amber-100 rounded text-sm",children:[e.jsx("p",{className:"font-medium text-amber-800",children:"Eligibility Issues:"}),e.jsx("ul",{className:"list-disc list-inside text-amber-700",children:f.eligibility_reasons.map((I,X)=>e.jsx("li",{children:I},X))})]})]})}),e.jsx(je,{control:w.control,name:"relationship_to_borrower",render:({field:I})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Relationship to Borrower ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{onValueChange:I.onChange,value:I.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-relationship",children:e.jsx(Xe,{placeholder:"Select relationship..."})})}),e.jsx(Ge,{children:lte.map(X=>e.jsx(ee,{value:X.value,children:X.label},X.value))})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:w.control,name:"amount_guaranteed",render:({field:I})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Amount to Guarantee ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{type:"number",step:"0.01",placeholder:"Enter amount",...I,"data-testid":"input-amount"})}),e.jsx(Rn,{children:f&&e.jsxs(e.Fragment,{children:["Available capacity: ",$(f.available_guarantee_capacity),s>0&&I.value&&e.jsxs(e.Fragment,{children:[" | Coverage: ",(parseFloat(I.value)/s*100).toFixed(1),"% of loan"]})]})}),e.jsx(Ne,{})]})}),e.jsxs(nn,{children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>{o(!1),w.reset(),x(null)},children:"Cancel"}),e.jsx(B,{type:"submit",disabled:R.isPending||!f?.is_eligible,"data-testid":"button-submit-guarantor",children:R.isPending?"Adding...":"Add Guarantor"})]})]})})]})}),e.jsx(Vt,{open:!!c,onOpenChange:I=>{I||(u(null),h(""))},children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-destructive"}),"Reject Guarantee"]}),e.jsxs(Qt,{children:["Provide a reason for rejecting this guarantee request from"," ",c?.guarantor?.first_name," ",c?.guarantor?.last_name]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Rejection Reason ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(fn,{value:m,onChange:I=>h(I.target.value),placeholder:"Explain why the guarantee is being rejected...",rows:3,"data-testid":"input-reject-reason"})]})}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>{u(null),h("")},children:"Cancel"}),e.jsx(B,{variant:"destructive",onClick:()=>c&&U.mutate({id:c.id,reason:m}),disabled:!m.trim()||U.isPending,"data-testid":"button-confirm-reject",children:U.isPending?"Rejecting...":"Reject Guarantee"})]})]})})]})}function dte({organizationId:t,loanId:n,loanStatus:r,currentTerm:s,currentRate:a,currentMonthlyPayment:i,outstandingBalance:o,repaymentFrequency:c="monthly"}){const{toast:u}=Xt(),{formatAmount:m}=fr(t),[h,f]=v.useState(!1),x="months",{canWrite:j}=_r(t,Nr.RESTRUCTURE),[b,g]=v.useState("extend_term"),[y,C]=v.useState(""),[k,N]=v.useState(""),[P,w]=v.useState(""),[S,E]=v.useState(""),[R,T]=v.useState(""),[U,M]=v.useState(""),L=r==="disbursed"&&j,{data:q,isLoading:$}=$e({queryKey:["/api/organizations",t,"loans",n,"restructures"],queryFn:async()=>{const W=await fetch(`/api/organizations/${t}/loans/${n}/restructures`,{credentials:"include"});if(!W.ok)throw new Error("Failed to fetch restructures");return W.json()}}),{data:D,isFetching:z}=$e({queryKey:["/api/organizations",t,"loans",n,"restructure","preview",b,y,k],queryFn:async()=>{const W=new URLSearchParams({restructure_type:b});y&&W.append("new_term_months",y),k&&W.append("new_interest_rate",k);const H=await fetch(`/api/organizations/${t}/loans/${n}/restructure/preview?${W}`,{credentials:"include"});if(!H.ok)throw new Error("Failed to fetch preview");return H.json()},enabled:h&&(b==="extend_term"||b==="adjust_interest")}),J=Le({mutationFn:async()=>{const W={restructure_type:b,reason:U};return b==="extend_term"&&(W.new_term_months=parseInt(y)),b==="reduce_installment"&&(W.new_monthly_repayment=parseFloat(P)),b==="adjust_interest"&&(W.new_interest_rate=parseFloat(k)),b==="waive_penalty"&&(W.penalty_waived=parseFloat(S)),b==="grace_period"&&(W.grace_period_days=parseInt(R)),Be("POST",`/api/organizations/${t}/loans/${n}/restructure`,W)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loans",n,"restructures"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),f(!1),I(),u({title:"Loan restructured successfully"})},onError:W=>{u({title:W.message||"Failed to restructure loan",variant:"destructive"})}}),I=()=>{g("extend_term"),C(""),N(""),w(""),E(""),T(""),M("")},X=W=>m(W||0),ne=W=>{switch(W){case"extend_term":return"Term Extension";case"reduce_installment":return"Reduced Installment";case"adjust_interest":return"Interest Adjustment";case"waive_penalty":return"Penalty Waiver";case"grace_period":return"Grace Period";default:return W}};return e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(mi,{className:"h-5 w-5"}),"Loan Restructuring"]}),e.jsx(dt,{children:"Modify loan terms to help borrower"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),L&&e.jsxs(B,{onClick:()=>f(!0),"data-testid":"button-restructure",className:"shrink-0",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Restructure"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})}),e.jsxs(de,{children:[e.jsxs("div",{className:"mb-6 grid gap-4 grid-cols-2 md:grid-cols-4",children:[e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Current Term"}),e.jsxs("div",{className:"text-lg font-bold",children:[s," ",x]})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Interest Rate"}),e.jsxs("div",{className:"text-lg font-bold",children:[a,"%"]})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Monthly Payment"}),e.jsx("div",{className:"text-lg font-bold",children:X(i)})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Outstanding"}),e.jsx("div",{className:"text-lg font-bold",children:X(o)})]})]}),$?e.jsx(bt,{className:"h-24"}):q&&q.length>0?e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Restructure History"}),e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Date"}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Changes"}),e.jsx(Q,{children:"Reason"})]})}),e.jsx(Pt,{children:q.map(W=>e.jsxs(qe,{children:[e.jsx(V,{children:new Date(W.created_at).toLocaleDateString()}),e.jsx(V,{children:e.jsx(ze,{variant:"outline",children:ne(W.restructure_type)})}),e.jsxs(V,{children:[W.new_term_months&&e.jsxs("span",{className:"text-sm",children:[W.old_term_months," ",e.jsx(ab,{className:"inline h-3 w-3"})," ",W.new_term_months," ",x]}),W.new_interest_rate!==void 0&&e.jsxs("span",{className:"text-sm",children:[W.old_interest_rate,"% ",e.jsx(ab,{className:"inline h-3 w-3"})," ",W.new_interest_rate,"%"]}),W.new_monthly_repayment!==void 0&&e.jsxs("span",{className:"text-sm",children:[X(W.old_monthly_repayment||0)," ",e.jsx(ab,{className:"inline h-3 w-3"})," ",X(W.new_monthly_repayment)]}),W.penalty_waived&&e.jsxs("span",{className:"text-sm",children:["Waived: ",X(W.penalty_waived)]}),W.grace_period_days&&e.jsxs("span",{className:"text-sm",children:["Grace: ",W.grace_period_days," days"]})]}),e.jsx(V,{className:"max-w-xs truncate",children:W.reason||"-"})]},W.id))})]})})]}):e.jsx("p",{className:"text-center text-muted-foreground py-6",children:"No restructuring history"})]}),e.jsx(Vt,{open:h,onOpenChange:f,children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Restructure Loan"}),e.jsx(Qt,{children:"Modify loan terms to accommodate borrower"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Restructure Type"}),e.jsxs(Qe,{value:b,onValueChange:g,children:[e.jsx(He,{"data-testid":"select-restructure-type",children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"extend_term",children:"Extend Term"}),e.jsx(ee,{value:"reduce_installment",children:"Reduce Installment"}),e.jsx(ee,{value:"adjust_interest",children:"Adjust Interest Rate"}),e.jsx(ee,{value:"waive_penalty",children:"Waive Penalty"}),e.jsx(ee,{value:"grace_period",children:"Grant Grace Period"})]})]})]}),b==="extend_term"&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:["New Term (",x,")"]}),e.jsx(re,{type:"number",value:y,onChange:W=>C(W.target.value),placeholder:`Current: ${s}`,"data-testid":"input-new-term"})]}),b==="reduce_installment"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"New Monthly Payment"}),e.jsx(re,{type:"number",step:"0.01",value:P,onChange:W=>w(W.target.value),placeholder:`Current: ${i}`,"data-testid":"input-new-payment"})]}),b==="adjust_interest"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"New Interest Rate (%)"}),e.jsx(re,{type:"number",step:"0.1",value:k,onChange:W=>N(W.target.value),placeholder:`Current: ${a}%`,"data-testid":"input-new-rate"})]}),b==="waive_penalty"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Penalty Amount to Waive"}),e.jsx(re,{type:"number",step:"0.01",value:S,onChange:W=>E(W.target.value),placeholder:"0.00","data-testid":"input-penalty"})]}),b==="grace_period"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Grace Period (days)"}),e.jsx(re,{type:"number",value:R,onChange:W=>T(W.target.value),placeholder:"30","data-testid":"input-grace-days"})]}),D&&!z&&(b==="extend_term"||b==="adjust_interest")&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Preview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("div",{children:"Current Monthly:"}),e.jsx("div",{className:"font-medium",children:X(D.current.monthly_repayment)}),e.jsx("div",{children:"Proposed Monthly:"}),e.jsx("div",{className:"font-medium",children:X(D.proposed.monthly_repayment)}),e.jsx("div",{children:"Monthly Savings:"}),e.jsx("div",{className:"font-medium text-green-600",children:X(D.savings.monthly_savings)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Reason"}),e.jsx(fn,{value:U,onChange:W=>M(W.target.value),placeholder:"Reason for restructuring...",className:"resize-none","data-testid":"input-reason"})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>{f(!1),I()},children:"Cancel"}),e.jsx(B,{onClick:()=>J.mutate(),disabled:J.isPending,"data-testid":"button-submit-restructure",children:J.isPending?"Processing...":"Apply Restructure"})]})]})})]})}class ute extends v.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Loan detail error:",n,r)}render(){return this.state.hasError?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Something went wrong loading loan details."}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:this.state.error?.message}),e.jsx(B,{onClick:()=>this.setState({hasError:!1,error:null}),children:"Try Again"})]}):this.props.children}}const Tm=t=>{if(t==null)return"0%";const n=typeof t=="string"?parseFloat(t):t;return isNaN(n)?"0%":n%1===0?`${n}%`:`${parseFloat(n.toFixed(2))}%`};function mte({organizationId:t,loanId:n}){const[r,s]=v.useState(1),a=12,{symbol:i}=fr(t),{data:o,isLoading:c,error:u}=$e({queryKey:["/api/organizations",t,"loans",n,"schedule"],queryFn:async()=>{const b=await fetch(`/api/organizations/${t}/loans/${n}/schedule`,{credentials:"include"});if(!b.ok)throw new Error("Failed to fetch schedule");return b.json()}}),m=b=>`${i} ${b.toLocaleString()}`,h=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),f=()=>{if(!o)return;const b=["Instalment","Due Date","Principal","Interest","Total","Balance","Paid","Status"],g=o.schedule.map(P=>[P.installment_number,P.due_date,P.principal,P.interest,P.total_payment,P.balance_after,(P.paid_principal||0)+(P.paid_interest||0)+(P.paid_penalty||0),P.status||"pending"]),y=[b.join(","),...g.map(P=>P.join(","))].join(`
`),C=new Blob([y],{type:"text/csv"}),k=URL.createObjectURL(C),N=document.createElement("a");N.href=k,N.download=`loan-schedule-${o.application_number}.csv`,N.click(),URL.revokeObjectURL(k)};if(c)return e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:e.jsx(bt,{className:"h-48"})})});if(u||!o)return e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Failed to load schedule"})})});const x=Math.ceil(o.schedule.length/a),j=o.schedule.slice((r-1)*a,r*a);return e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(_e,{className:"text-base",children:"Repayment Schedule"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.term_months," instalments of ",m(o.monthly_payment)," at ",o.interest_rate,"% per period",o.interest_deducted_upfront&&e.jsx("span",{className:"ml-2 text-xs bg-amber-100 text-amber-800 px-2 py-0.5 rounded",children:"Interest deducted upfront"})]})]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:f,"data-testid":"button-download-schedule",children:[e.jsx($a,{className:"mr-2 h-4 w-4"}),"Download"]})]}),e.jsxs(de,{children:[e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsx(kt,{children:(()=>{const b=o.schedule.some(g=>(g.insurance||0)>0);return e.jsxs(e.Fragment,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"w-16",children:"#"}),e.jsx(Q,{children:"Due Date"}),e.jsx(Q,{className:"text-right",children:"Principal"}),e.jsx(Q,{className:"text-right",children:"Interest"}),b&&e.jsx(Q,{className:"text-right",children:"Insurance"}),e.jsx(Q,{className:"text-right",children:"Total"}),e.jsx(Q,{className:"text-right",children:"Balance"}),e.jsx(Q,{className:"text-right",children:"Paid"}),e.jsx(Q,{children:"Status"})]})}),e.jsx(Pt,{children:j.map(g=>{const y=(g.paid_principal||0)+(g.paid_interest||0)+(g.paid_penalty||0)+(g.paid_insurance||0),C={paid:"bg-green-100 text-green-800",partial:"bg-yellow-100 text-yellow-800",overdue:"bg-red-100 text-red-800",pending:"bg-gray-100 text-gray-800"};return e.jsxs(qe,{"data-testid":`row-instalment-${g.installment_number}`,children:[e.jsx(V,{className:"font-medium",children:g.installment_number}),e.jsx(V,{children:h(g.due_date)}),e.jsx(V,{className:"text-right",children:m(g.principal)}),e.jsx(V,{className:"text-right",children:m(g.interest)}),b&&e.jsx(V,{className:"text-right",children:m(g.insurance||0)}),e.jsx(V,{className:"text-right font-medium",children:m(g.total_payment)}),e.jsx(V,{className:"text-right",children:m(g.balance_after)}),e.jsx(V,{className:"text-right",children:m(y)}),e.jsx(V,{children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${C[g.status||"pending"]||C.pending}`,children:(g.status||"pending").charAt(0).toUpperCase()+(g.status||"pending").slice(1)})})]},g.installment_number)})})]})})()})}),x>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(r-1)*a+1,"-",Math.min(r*a,o.schedule.length)," of ",o.schedule.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>s(b=>Math.max(1,b-1)),disabled:r===1,"data-testid":"button-schedule-prev",children:e.jsx(vi,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:["Page ",r," of ",x]}),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>s(b=>Math.min(x,b+1)),disabled:r===x,"data-testid":"button-schedule-next",children:e.jsx(Os,{className:"h-4 w-4"})})]})]})]})]})}function hte({organizationId:t,loanId:n,loanData:r}){const{symbol:s}=fr(t),{data:a,isLoading:i}=$e({queryKey:["/api/organizations",t,"repayments",{loan_id:n}],queryFn:async()=>{const N=await fetch(`/api/organizations/${t}/repayments?loan_id=${n}`,{credentials:"include"});if(!N.ok)throw new Error("Failed to fetch repayments");const P=await N.json();return Array.isArray(P)?P:P.items||[]}}),{data:o}=$e({queryKey:["/api/organizations",t,"loans",n,"schedule"],queryFn:async()=>{const N=await fetch(`/api/organizations/${t}/loans/${n}/schedule`,{credentials:"include"});if(!N.ok)throw new Error("Failed to fetch schedule");return N.json()}}),c=N=>{const P=typeof N=="string"?parseFloat(N):N||0;return`${s} ${P.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})}`},u=N=>new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),m=o?.summary,h=m?.total_paid||0,f=m?.total_paid_principal||0,x=m?.total_paid_interest||0,j=m?.total_paid_penalty||0,b=m?.total_expected||Number(r?.total_repayment||0),g=m?.outstanding_balance||0,y=m?.amount_overdue||0,C=m?.overdue_count||0,k=N=>({cash:"Cash",mpesa:"M-Pesa",bank_transfer:"Bank Transfer",cheque:"Cheque"})[N||""]||N||"-";return i?e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:e.jsx(bt,{className:"h-48"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(oe,{children:e.jsxs(de,{className:"pt-4 pb-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Paid"}),e.jsx("div",{className:"text-xl font-bold text-green-600",children:c(h)}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["of ",c(b)," total"]})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4 pb-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Outstanding Balance"}),e.jsx("div",{className:"text-xl font-bold",children:c(g)}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Remaining to pay"})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4 pb-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Amount Overdue"}),e.jsx("div",{className:`text-xl font-bold ${y>0?"text-red-600":"text-green-600"}`,children:c(y)}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:y>0?`${C} instalment(s) past due`:"All caught up"})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4 pb-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Next Due"}),e.jsx("div",{className:"text-xl font-bold",children:m?.next_due_amount?c(m.next_due_amount):"-"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:m?.next_due_date?u(m.next_due_date):"Fully paid"})]})})]}),o&&o.schedule.length>0&&e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{className:"text-base",children:"Instalment Status"})}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"w-16",children:"#"}),e.jsx(Q,{children:"Due Date"}),e.jsx(Q,{className:"text-right",children:"Amount Due"}),e.jsx(Q,{className:"text-right",children:"Paid"}),e.jsx(Q,{className:"text-right",children:"Balance"}),e.jsx(Q,{children:"Status"})]})}),e.jsx(Pt,{children:o.schedule.map(N=>{const P=(N.paid_principal||0)+(N.paid_interest||0)+(N.paid_penalty||0),w=Math.max(0,N.total_payment-P),S=N.status||"pending";return e.jsxs(qe,{className:S==="overdue"?"bg-red-50 dark:bg-red-950/30":"",children:[e.jsx(V,{className:"font-medium",children:N.installment_number}),e.jsx(V,{children:u(N.due_date)}),e.jsx(V,{className:"text-right",children:c(N.total_payment)}),e.jsx(V,{className:"text-right",children:c(P)}),e.jsx(V,{className:"text-right",children:c(w)}),e.jsx(V,{children:S==="paid"?e.jsxs(ze,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200 dark:bg-green-950 dark:text-green-400 dark:border-green-800",children:[e.jsx(ps,{className:"mr-1 h-3 w-3"})," Paid"]}):S==="overdue"?e.jsxs(ze,{variant:"destructive",children:[e.jsx(La,{className:"mr-1 h-3 w-3"})," Overdue"]}):S==="partial"?e.jsxs(ze,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-950 dark:text-yellow-400 dark:border-yellow-800",children:[e.jsx(bn,{className:"mr-1 h-3 w-3"})," Partial"]}):e.jsxs(ze,{variant:"outline",children:[e.jsx(bn,{className:"mr-1 h-3 w-3"})," Pending"]})})]},N.installment_number)})})]})})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"text-base",children:["Payment Transactions (",a?.length||0,")"]})}),e.jsx(de,{children:!a||a.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No payments recorded yet"}):e.jsxs("div",{className:"overflow-x-auto -mx-6 px-6",children:[e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Receipt #"}),e.jsx(Q,{children:"Date"}),e.jsx(Q,{className:"text-right",children:"Total"}),e.jsx(Q,{className:"text-right",children:"Principal"}),e.jsx(Q,{className:"text-right",children:"Interest"}),e.jsx(Q,{className:"text-right",children:"Penalty"}),e.jsx(Q,{children:"Method"}),e.jsx(Q,{children:"Reference"})]})}),e.jsx(Pt,{children:a.map(N=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:N.repayment_number}),e.jsx(V,{children:u(N.payment_date)}),e.jsx(V,{className:"text-right font-medium text-green-600",children:c(N.amount)}),e.jsx(V,{className:"text-right",children:c(N.principal_amount)}),e.jsx(V,{className:"text-right",children:c(N.interest_amount)}),e.jsx(V,{className:"text-right",children:c(N.penalty_amount)}),e.jsx(V,{children:k(N.payment_method)}),e.jsx(V,{className:"text-muted-foreground",children:N.reference||"-"})]},N.id))})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t grid gap-2 sm:grid-cols-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Paid:"})," ",e.jsx("span",{className:"font-medium",children:c(h)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Principal:"})," ",e.jsx("span",{className:"font-medium",children:c(f)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Interest:"})," ",e.jsx("span",{className:"font-medium",children:c(x)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Penalties:"})," ",e.jsx("span",{className:"font-medium",children:c(j)})]})]})]})})]})]})}const fte=/^(\+254|0)[17]\d{8}$/,mO=me.object({member_id:me.string().min(1,"Member is required"),product_id:me.string().min(1,"Loan product is required"),amount:me.string().min(1,"Amount is required"),term:me.coerce.number().min(1,"Term is required"),purpose:me.string().min(1,"Purpose is required"),purpose_details:me.string().optional(),disbursement_method:me.string().min(1,"Disbursement method is required"),disbursement_account:me.string().optional(),disbursement_phone:me.string().optional(),guarantor_ids:me.array(me.string()).optional()}).superRefine((t,n)=>{t.disbursement_method==="mpesa"&&(!t.disbursement_phone||t.disbursement_phone.trim()===""?n.addIssue({code:me.ZodIssueCode.custom,message:"M-Pesa phone number is required",path:["disbursement_phone"]}):fte.test(t.disbursement_phone.replace(/\s/g,""))||n.addIssue({code:me.ZodIssueCode.custom,message:"Enter a valid phone number (e.g., 0712345678 or +254712345678)",path:["disbursement_phone"]})),t.disbursement_method==="bank_transfer"&&(!t.disbursement_account||t.disbursement_account.trim()==="")&&n.addIssue({code:me.ZodIssueCode.custom,message:"Bank account number is required",path:["disbursement_account"]})}),hO=["Business expansion","Working capital","Asset purchase","Education fees","Medical expenses","Home improvement","Agriculture","Emergency","Debt consolidation","Other"],pte=[{value:"mpesa",label:"M-Pesa"},{value:"bank_transfer",label:"Bank Transfer"},{value:"cash",label:"Cash at Branch"},{value:"cheque",label:"Cheque"}],Cb={pending:"secondary",under_review:"outline",approved:"default",rejected:"destructive",cancelled:"outline",pending_disbursement:"outline",disbursed:"default",completed:"default",defaulted:"destructive"};function xte({organizationId:t}){const{toast:n}=Xt(),{symbol:r}=fr(t),[s,a]=v.useState("list"),[i,o]=v.useState(null),[c,u]=v.useState(""),[m,h]=v.useState(""),[f,x]=v.useState(null),[j,b]=v.useState(""),[g,y]=v.useState(""),[C,k]=v.useState(!1),[N,P]=v.useState(null),[w,S]=v.useState(""),[E,R]=v.useState(""),[T,U]=v.useState(""),[M,L]=v.useState(!1),[q,$]=v.useState(!1),[D,z]=v.useState("all"),[J,I]=v.useState("all"),[X,ne]=v.useState("all"),[W,H]=v.useState(""),[fe,Pe]=v.useState(""),[Re,Ie]=v.useState(""),[Ce,Y]=v.useState(""),[ie,Ee]=v.useState(1),[Ke,Te]=v.useState(!1),ct=20,{canWrite:ut,hasPermission:Dt}=_r(t,Nr.LOANS),be=Dt("loans:approve"),pt=Dt("loans:reject"),te=Dt("loans:process"),{hasFeature:G}=Ol(t),F=G("mpesa_integration"),Ue=G("bank_integration"),[Z,xe]=v.useState(null),[Ae,Je]=v.useState(null),[ae,Me]=v.useState(!1),[lt,Zt]=v.useState(!1),[sn,_n]=v.useState([]),[Ka,Wa]=v.useState(!1),[Fs,Oo]=v.useState(!1),{user:ta}=No(),Hr=ta?.branchId,Ls=ta?.role,wi=!Hr||Ls==="admin"||Ls==="owner",Is=async ce=>{Oo(!0),Wa(!1);try{const At=new URLSearchParams({export_type:ce});J&&J!=="all"&&At.append("status",J),X&&X!=="all"&&At.append("product_id",X),D&&D!=="all"&&At.append("branch_id",D),W&&At.append("date_from",W),fe&&At.append("date_to",fe),Ce&&At.append("search",Ce);const $t=await fetch(`/api/organizations/${t}/loans/export?${At}`,{credentials:"include"});if(!$t.ok)throw new Error("Export failed");const Tn=await $t.blob(),St=window.URL.createObjectURL(Tn),dn=document.createElement("a");dn.href=St;const xn=$t.headers.get("content-disposition")?.match(/filename=(.+)/)?.[1]||"loans_export.xlsx";dn.download=xn,document.body.appendChild(dn),dn.click(),dn.remove(),window.URL.revokeObjectURL(St),n({title:"Export Complete",description:"Loan data has been downloaded"})}catch(At){n({title:"Export Failed",description:Vn(At),variant:"destructive"})}finally{Oo(!1)}},as=ce=>ce?!ce.is_active||ce.status!==void 0&&ce.status!=="active":!1,{data:Gr}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const ce=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!ce.ok)throw new Error("Failed to fetch branches");return ce.json()}}),{data:To}=$e({queryKey:["/api/organizations",t,"loan-products"],queryFn:async()=>{const ce=await fetch(`/api/organizations/${t}/loan-products`,{credentials:"include"});if(!ce.ok)throw new Error("Failed to fetch loan products");return ce.json()}});v.useEffect(()=>{Gr&&Gr.length===1&&z(Gr[0].id)},[Gr]),v.useEffect(()=>{const ce=setTimeout(()=>Y(Re),300);return()=>clearTimeout(ce)},[Re]),v.useEffect(()=>{Ee(1)},[Ce,J,D,X,W,fe]);const{data:Mo,isLoading:Vc}=$e({queryKey:["/api/organizations",t,"loan-applications",D,J,X,W,fe,Ce,ie,ct],queryFn:async()=>{const ce=new URLSearchParams;D&&D!=="all"&&ce.append("branch_id",D),J&&J!=="all"&&ce.append("status",J),X&&X!=="all"&&ce.append("product_id",X),W&&ce.append("date_from",W),fe&&ce.append("date_to",fe),Ce&&ce.append("search",Ce),ce.append("page",String(ie)),ce.append("page_size",String(ct));const At=`/api/organizations/${t}/loan-applications?${ce.toString()}`,$t=await fetch(At,{credentials:"include"});if(!$t.ok)throw new Error("Failed to fetch loan applications");return $t.json()}}),na=Mo?.data,nr=Mo?.pagination,wa=s==="new"||s==="edit",{data:ys}=$e({queryKey:["/api/organizations",t,"loan-products","active"],queryFn:async()=>{const ce=await fetch(`/api/organizations/${t}/loan-products?active=true`,{credentials:"include"});if(!ce.ok)throw new Error("Failed to fetch loan products");return ce.json()},enabled:wa}),{data:Sr}=$e({queryKey:["/api/organizations",t,"members"],queryFn:async()=>{const ce=await fetch(`/api/organizations/${t}/members`,{credentials:"include"});if(!ce.ok)throw new Error("Failed to fetch members");return ce.json()},enabled:wa}),is=$n({resolver:Fn(mO),defaultValues:{member_id:"",product_id:"",amount:"",term:12,purpose:"",purpose_details:"",disbursement_method:"",disbursement_account:"",disbursement_phone:"",guarantor_ids:[]}});ys?.find(ce=>ce.id===is.watch("product_id"));const ra=Le({mutationFn:async ce=>{const At=Sr?.find($t=>$t.id===ce.member_id);if(as(At))throw new Error("Cannot submit loan application for an inactive member. Please activate the member first.");return Be("POST",`/api/organizations/${t}/loan-applications`,ce)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),a("list"),is.reset(),n({title:"Loan application submitted successfully"})},onError:ce=>{n({title:"Failed to submit loan application",description:Vn(ce),variant:"destructive"})}}),Ln=Le({mutationFn:async({id:ce,comments:At,conditions:$t})=>Be("POST",`/api/organizations/${t}/loan-applications/${ce}/approve`,{comments:At,conditions:$t}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),x(null),b(""),y(""),k(!1),xe(null),n({title:"Loan application approved successfully"})},onError:ce=>{n({title:"Failed to approve application",description:Vn(ce),variant:"destructive"})}}),Cr=Le({mutationFn:async({id:ce,reason:At,category:$t})=>{const Tn=$t?`[${$t}] ${At}`:At;return Be("POST",`/api/organizations/${t}/loan-applications/${ce}/reject`,{reason:Tn})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),o(null),u(""),h(""),$(!1),xe(null),n({title:"Loan application rejected"})},onError:ce=>{n({title:"Failed to reject application",description:Vn(ce),variant:"destructive"})}}),qs=Le({mutationFn:async({id:ce,method:At,account:$t,phone:Tn})=>(await Be("POST",`/api/organizations/${t}/loan-applications/${ce}/disburse`,{disbursement_method:At,disbursement_account:$t,disbursement_phone:Tn})).json(),onSuccess:ce=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"loans"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"transactions"]}),P(null),S(""),R(""),U(""),L(!1),xe(null),ce?.status==="pending_disbursement"?n({title:"M-Pesa disbursement initiated",description:"The loan will be marked as disbursed once M-Pesa confirms the payment was sent successfully."}):n({title:"Loan disbursed successfully"})},onError:ce=>{n({title:"Failed to disburse loan",description:Vn(ce),variant:"destructive"})}}),_a=Le({mutationFn:async({id:ce,data:At})=>Be("PUT",`/api/organizations/${t}/loan-applications/${ce}`,At),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),a("list"),Je(null),sa.reset(),n({title:"Loan application updated and resubmitted"})},onError:ce=>{n({title:"Failed to update loan application",description:Vn(ce),variant:"destructive"})}}),sa=$n({resolver:Fn(mO),defaultValues:{member_id:"",product_id:"",amount:"",term:12,purpose:"",purpose_details:"",disbursement_method:"",disbursement_account:"",disbursement_phone:"",guarantor_ids:[]}});ys?.find(ce=>ce.id===sa.watch("product_id"));const Ro=ce=>{if(!Ae)return;const At=Sr?.find(St=>St.id===Ae.member_id);if(as(At)){n({title:"Cannot submit loan application",description:"This member is inactive and cannot apply for loans. Please activate the member first.",variant:"destructive"});return}const $t=ce.purpose==="Other"&&ce.purpose_details?`Other: ${ce.purpose_details}`:ce.purpose,Tn={loan_product_id:ce.product_id,amount:parseFloat(ce.amount),term_months:ce.term,purpose:$t||null,disbursement_method:ce.disbursement_method,disbursement_account:ce.disbursement_account||null,disbursement_phone:ce.disbursement_phone||null};_a.mutate({id:Ae.id,data:Tn})},Ha=ce=>{const At=ce.purpose||"",$t=hO.includes(At)||At.startsWith("Other:");sa.reset({member_id:ce.member_id,product_id:ce.loan_product_id,amount:String(parseFloat(ce.amount)),term:ce.term_months||12,purpose:At.startsWith("Other:")?"Other":$t?At:"Other",purpose_details:At.startsWith("Other:")?At.replace("Other: ",""):$t?"":At,disbursement_method:ce.disbursement_method||"",disbursement_account:ce.disbursement_account||"",disbursement_phone:ce.disbursement_phone||"",guarantor_ids:[]}),Je(ce),a("edit")},Do=ce=>{const At=ce.purpose==="Other"&&ce.purpose_details?`Other: ${ce.purpose_details}`:ce.purpose,$t=sn.filter(St=>St.charge_name.trim()&&parseFloat(St.amount)>0),Tn={member_id:ce.member_id,loan_product_id:ce.product_id,amount:parseFloat(ce.amount),term_months:ce.term,purpose:At||null,disbursement_method:ce.disbursement_method,disbursement_account:ce.disbursement_account||null,disbursement_phone:ce.disbursement_phone||null,guarantors:ce.guarantor_ids?.map(St=>({guarantor_id:St,amount_guaranteed:parseFloat(ce.amount)}))||[],extra_charges:$t.map(St=>({charge_name:St.charge_name.trim(),amount:parseFloat(St.amount)}))};ra.mutate(Tn)},Yr={daily:365,weekly:52,bi_weekly:26,monthly:12},_i=(ce,At)=>Math.max(Math.round(ce*(Yr[At]||12)/12),1),Ni=ce=>{const At=ce?.repayment_frequency||ys?.find(Tn=>Tn.id===(ce?.product_id||ce?.loan_product_id))?.repayment_frequency||"monthly",$t={daily:{period:"months",payment:"Daily Payment",rateLabel:"per day",instalmentUnit:"daily"},weekly:{period:"months",payment:"Weekly Payment",rateLabel:"per week",instalmentUnit:"weekly"},bi_weekly:{period:"months",payment:"Bi-Weekly Payment",rateLabel:"per 2 weeks",instalmentUnit:"bi-weekly"},monthly:{period:"months",payment:"Monthly Payment",rateLabel:"per month",instalmentUnit:"monthly"}};return{...$t[At]||$t.monthly,freq:At}};if(Z){const ce=Z,At=Ni(Z),$t=nt=>{if(!nt)return"-";try{return new Date(nt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"-"}},Tn=nt=>({mpesa:"M-Pesa",bank_transfer:"Bank Transfer",cash:"Cash at Branch",cheque:"Cheque"})[nt||""]||nt||"-",St=(nt,xn)=>{try{const En=Mn=>Mn?new Date(Mn).toLocaleDateString():"-",Xn=Mn=>{const In=parseFloat(String(Mn||"0"));return isNaN(In)?0:In},ir=["LOAN STATEMENT","",`Loan Number: ${xn.application_number||"-"}`,`Member: ${nt.member_first_name||""} ${nt.member_last_name||""}`,`Member Number: ${nt.member?.member_number||"-"}`,`Product: ${nt.product_name||"-"}`,"","LOAN DETAILS",`Principal Amount: ${r} ${Xn(xn.amount).toLocaleString()}`,`Interest Rate: ${xn.interest_rate||0}% p.a.`,`Term: ${xn.term_months||0} months (${_i(xn.term_months||0,At.freq)} ${At.instalmentUnit} instalments)`,`${At.payment}: ${r} ${Xn(xn.monthly_repayment).toLocaleString()}`,`Total Interest: ${r} ${Xn(xn.total_interest).toLocaleString()}`,`Total Repayment: ${r} ${Xn(xn.total_repayment).toLocaleString()}`,"","STATUS",`Status: ${xn.status||"-"}`,`Applied: ${En(nt.applied_at||nt.created_at)}`,nt.approved_at?`Approved: ${En(nt.approved_at)}`:null,nt.disbursed_at?`Disbursed: ${En(nt.disbursed_at)}`:null,"","REPAYMENT STATUS",`Amount Disbursed: ${r} ${Xn(xn.amount_disbursed).toLocaleString()}`,`Amount Repaid: ${r} ${Xn(xn.amount_repaid).toLocaleString()}`,`Outstanding Balance: ${r} ${Xn(xn.outstanding_balance).toLocaleString()}`,"",`Generated: ${new Date().toLocaleString()}`].filter(Boolean).join(`
`),Bs=new Blob([ir],{type:"text/plain"}),Lr=URL.createObjectURL(Bs),kr=document.createElement("a");kr.href=Lr,kr.download=`loan-statement-${xn.application_number||"unknown"}.txt`,kr.click(),URL.revokeObjectURL(Lr),n({title:"Downloaded",description:"Loan statement downloaded successfully"})}catch{n({title:"Error",description:"Failed to generate loan statement",variant:"destructive"})}},dn=nt=>{if(nt==null||nt==="")return 0;const xn=parseFloat(String(nt));return isNaN(xn)?0:xn};return e.jsxs(ute,{fallback:e.jsx("div",{children:"Error loading loan"}),children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>xe(null),"data-testid":"button-back",children:e.jsx($r,{className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Loan ",Z?.application_number||"Unknown"]}),e.jsxs("p",{className:"text-muted-foreground",children:[ce.member_first_name," ",ce.member_last_name," - ",ce.product_name]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 shrink-0",children:[e.jsx(ze,{variant:Cb[Z.status||"pending"]||"secondary",className:"capitalize",children:(Z.status||"pending").replace("_"," ")}),e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>St(ce,Z),"data-testid":"button-download-loan-statement",children:[e.jsx($a,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Statement"})]}),Z.status==="pending"&&be&&e.jsxs(B,{size:"sm",variant:"default",onClick:()=>x(Z),"data-testid":"button-approve-detail",children:[e.jsx(fs,{className:"h-4 w-4 mr-1"}),"Approve"]}),Z.status==="pending"&&pt&&e.jsxs(B,{size:"sm",variant:"destructive",onClick:()=>o(Z),"data-testid":"button-reject-detail",children:[e.jsx(rs,{className:"h-4 w-4 mr-1"}),"Reject"]}),Z.status==="approved"&&te&&e.jsxs(B,{size:"sm",variant:"default",onClick:()=>{const nt=Z;S(nt.disbursement_method||""),R(nt.disbursement_account||""),U(nt.disbursement_phone||""),P(Z)},"data-testid":"button-disburse-detail",children:[e.jsx(xa,{className:"h-4 w-4 mr-1"}),"Disburse Loan"]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{className:"text-base",children:"Applicant Information"})}),e.jsx(de,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Member Name"}),e.jsxs("div",{className:"font-medium",children:[ce.member_first_name," ",ce.member_last_name]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Member Number"}),e.jsx("div",{className:"font-medium",children:ce.member?.member_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Phone"}),e.jsx("div",{className:"font-medium",children:ce.member?.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("div",{className:"font-medium",children:ce.member?.email||"-"})]})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{className:"text-base",children:"Loan Product"})}),e.jsxs(de,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Product Name"}),e.jsx("div",{className:"font-medium",children:ce.product_name||ce.loan_product?.name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Interest Type"}),e.jsx("div",{className:"font-medium capitalize",children:(ce.loan_product?.interest_type||"-").replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Processing Fee"}),e.jsx("div",{className:"font-medium",children:ce.processing_fee?`${parseFloat(ce.processing_fee).toLocaleString()}`:"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Insurance Fee"}),e.jsx("div",{className:"font-medium",children:ce.insurance_fee?`${parseFloat(ce.insurance_fee).toLocaleString()}`:"-"})]}),parseFloat(ce.appraisal_fee||"0")>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Appraisal Fee"}),e.jsx("div",{className:"font-medium",children:parseFloat(ce.appraisal_fee).toLocaleString()})]}),parseFloat(ce.excise_duty||"0")>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Excise Duty"}),e.jsx("div",{className:"font-medium",children:parseFloat(ce.excise_duty).toLocaleString()})]}),parseFloat(ce.total_fees||"0")>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Fees"}),e.jsx("div",{className:"font-medium",children:parseFloat(ce.total_fees).toLocaleString()})]}),parseFloat(ce.total_insurance||"0")>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Credit Life Insurance"}),e.jsx("div",{className:"font-medium",children:parseFloat(ce.total_insurance).toLocaleString()})]})]}),ce.extra_charges&&ce.extra_charges.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Extra Charges"}),e.jsxs("div",{className:"space-y-1",children:[ce.extra_charges.map(nt=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:nt.charge_name}),e.jsx("span",{className:"font-medium",children:parseFloat(String(nt.amount||"0")).toLocaleString()})]},nt.id)),e.jsxs("div",{className:"flex justify-between text-sm font-medium pt-1 border-t",children:[e.jsx("span",{children:"Total Extra Charges"}),e.jsx("span",{children:ce.extra_charges.reduce((nt,xn)=>nt+parseFloat(String(xn.amount||"0")),0).toLocaleString()})]})]})]})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{className:"text-base",children:"Loan Details"})}),e.jsx(de,{children:e.jsxs("div",{className:"grid gap-4 grid-cols-2 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Principal Amount"}),e.jsx("div",{className:"text-lg font-bold",children:dn(Z.amount).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Term"}),e.jsxs("div",{className:"text-lg font-bold",children:[ce.term_months||0," months"]}),At.freq!=="monthly"&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",_i(ce.term_months||0,At.freq)," ",At.instalmentUnit," instalments)"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Interest Rate"}),e.jsxs("div",{className:"text-lg font-bold",children:[Z.interest_rate||0,"% ",At.rateLabel||"per period"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Interest"}),e.jsx("div",{className:"text-lg font-bold",children:dn(ce.total_interest).toLocaleString()}),Z.interest_deducted_upfront&&e.jsx("div",{className:"text-xs text-amber-600 font-medium",children:"Deducted at disbursement"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Z.interest_deducted_upfront?"Total Installments Due":"Total Repayment"}),e.jsx("div",{className:"text-lg font-bold",children:Z.interest_deducted_upfront?dn(Z.amount).toLocaleString():dn(ce.total_repayment).toLocaleString()}),Z.interest_deducted_upfront&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Principal only (interest already paid)"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:At.payment}),e.jsx("div",{className:"text-lg font-bold",children:dn(Z.monthly_repayment).toLocaleString()})]}),["disbursed","closed","defaulted"].includes(Z.status)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Amount Disbursed"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:dn(Z.amount_disbursed).toLocaleString()}),Z.interest_deducted_upfront&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"(Interest deducted upfront)"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Amount Repaid"}),e.jsx("div",{className:"text-lg font-bold text-blue-600",children:dn(Z.amount_repaid).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Outstanding Balance"}),e.jsx("div",{className:"text-lg font-bold text-orange-600",children:dn(Z.outstanding_balance).toLocaleString()})]})]})]})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{className:"text-base",children:"Purpose & Disbursement"})}),e.jsx(de,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Purpose of Loan"}),e.jsx("div",{className:"font-medium",children:Z.purpose||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Disbursement Method"}),e.jsx("div",{className:"font-medium",children:Tn(ce.disbursement_method)})]}),ce.disbursement_method==="mpesa"&&ce.disbursement_phone&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"M-Pesa Number"}),e.jsx("div",{className:"font-medium",children:ce.disbursement_phone})]}),ce.disbursement_method==="bank_transfer"&&ce.disbursement_account&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Bank Account"}),e.jsx("div",{className:"font-medium",children:ce.disbursement_account})]})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{className:"text-base",children:"Timeline & Staff"})}),e.jsxs(de,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Applied On"}),e.jsx("div",{className:"font-medium",children:$t(ce.applied_at||ce.created_at)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Applied By (Staff)"}),e.jsx("div",{className:"font-medium",children:ce.created_by_name||"-"})]}),ce.approved_at&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Approved On"}),e.jsx("div",{className:"font-medium text-green-600",children:$t(ce.approved_at)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Reviewed By"}),e.jsx("div",{className:"font-medium",children:ce.reviewed_by_name||"-"})]})]}),ce.rejected_at&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Rejected On"}),e.jsx("div",{className:"font-medium text-red-600",children:$t(ce.rejected_at)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Rejected By"}),e.jsx("div",{className:"font-medium",children:ce.reviewed_by_name||"-"})]})]}),ce.disbursed_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Disbursed On"}),e.jsx("div",{className:"font-medium text-blue-600",children:$t(ce.disbursed_at)})]}),ce.closed_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Closed On"}),e.jsx("div",{className:"font-medium",children:$t(ce.closed_at)})]}),ce.next_payment_date&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Next Payment Due"}),e.jsx("div",{className:"font-medium",children:$t(ce.next_payment_date)})]})]}),Z.status==="rejected"&&ce.rejection_reason&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-950 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"Rejection Reason"}),e.jsx("div",{className:"text-red-800 dark:text-red-200",children:ce.rejection_reason})]})]})]})]}),e.jsxs($s,{defaultValue:"payments",children:[e.jsxs(vs,{className:"flex-wrap",children:[e.jsx(_t,{value:"payments",children:"Payments"}),e.jsx(_t,{value:"schedule",children:"Schedule"}),e.jsx(_t,{value:"guarantors",children:"Guarantors"}),e.jsx(_t,{value:"restructure",children:"Restructuring"})]}),e.jsx(Nt,{value:"payments",className:"mt-4",children:e.jsx(hte,{organizationId:t,loanId:Z.id,loanData:ce})}),e.jsx(Nt,{value:"schedule",className:"mt-4",children:e.jsx(mte,{organizationId:t,loanId:Z.id})}),e.jsx(Nt,{value:"guarantors",className:"mt-4",children:e.jsx(cte,{organizationId:t,loanId:Z.id,loanStatus:Z.status,loanAmount:Number(Z.amount)})}),e.jsx(Nt,{value:"restructure",className:"mt-4",children:e.jsx(dte,{organizationId:t,loanId:Z.id,loanStatus:Z.status,currentTerm:ce.term_months,currentRate:dn(Z.interest_rate),currentMonthlyPayment:dn(Z.monthly_repayment),outstandingBalance:dn(Z.outstanding_balance),repaymentFrequency:Z.repayment_frequency||"monthly"})})]})]}),e.jsx(Vt,{open:!!f,onOpenChange:nt=>{nt||(x(null),b(""),y(""))},children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5 text-green-600"}),"Approve Loan Application"]}),e.jsxs(Qt,{children:["Review and approve application ",f?.application_number]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Applicant"}),e.jsxs("span",{className:"font-medium",children:[f?.member_first_name," ",f?.member_last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loan Amount"}),e.jsx("span",{className:"font-medium",children:parseFloat(f?.amount||"0").toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Term"}),e.jsxs("span",{className:"font-medium",children:[f?.term_months||0," ",Ni(f).period]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Review Comments"}),e.jsx(fn,{value:j,onChange:nt=>b(nt.target.value),placeholder:"Add any review notes or observations...",className:"resize-none",rows:3,"data-testid":"input-approve-comments-detail"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Approval Conditions (Optional)"}),e.jsx(fn,{value:g,onChange:nt=>y(nt.target.value),placeholder:"Any conditions for this approval...",className:"resize-none",rows:2,"data-testid":"input-approve-conditions-detail"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t",children:[e.jsx(Ai,{id:"approve-confirm-detail",checked:C,onCheckedChange:nt=>k(!!nt),"data-testid":"checkbox-approve-confirm-detail"}),e.jsx("label",{htmlFor:"approve-confirm-detail",className:"text-sm font-medium cursor-pointer",children:"I confirm that I have reviewed this application and approve the loan"})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{x(null),b(""),y(""),k(!1)},"data-testid":"button-cancel-approve-detail",children:"Cancel"}),e.jsx(B,{variant:"default",onClick:()=>f&&Ln.mutate({id:f.id,comments:j,conditions:g}),disabled:Ln.isPending||!C,"data-testid":"button-confirm-approve-detail",children:Ln.isPending?"Approving...":"Confirm Approval"})]})]})}),e.jsx(Vt,{open:!!i,onOpenChange:nt=>{nt||(o(null),u(""),h(""))},children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-600"}),"Reject Loan Application"]}),e.jsxs(Qt,{children:["Reject application ",i?.application_number]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Rejection Category"}),e.jsxs(Qe,{value:m,onValueChange:h,children:[e.jsx(He,{"data-testid":"select-reject-category-detail",children:e.jsx(Xe,{placeholder:"Select reason category"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"Insufficient Income",children:"Insufficient Income"}),e.jsx(ee,{value:"Poor Credit History",children:"Poor Credit History"}),e.jsx(ee,{value:"Incomplete Documentation",children:"Incomplete Documentation"}),e.jsx(ee,{value:"Exceeds Lending Limits",children:"Exceeds Lending Limits"}),e.jsx(ee,{value:"Guarantor Issues",children:"Guarantor Issues"}),e.jsx(ee,{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Rejection Reason"}),e.jsx(fn,{value:c,onChange:nt=>u(nt.target.value),placeholder:"Provide detailed reason for rejection...",className:"resize-none",rows:4,"data-testid":"input-reject-reason-detail"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t",children:[e.jsx(Ai,{id:"reject-confirm-detail",checked:q,onCheckedChange:nt=>$(!!nt),"data-testid":"checkbox-reject-confirm-detail"}),e.jsx("label",{htmlFor:"reject-confirm-detail",className:"text-sm font-medium cursor-pointer",children:"I confirm that I want to reject this loan application"})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{o(null),u(""),h(""),$(!1)},"data-testid":"button-cancel-reject-detail",children:"Cancel"}),e.jsx(B,{variant:"destructive",onClick:()=>i&&Cr.mutate({id:i.id,reason:c,category:m}),disabled:Cr.isPending||!c.trim()||!q,"data-testid":"button-confirm-reject-detail",children:Cr.isPending?"Rejecting...":"Confirm Rejection"})]})]})}),e.jsx(Vt,{open:!!N,onOpenChange:nt=>{nt||P(null)},children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(xa,{className:"h-5 w-5 text-blue-600"}),"Disburse Loan"]}),e.jsxs(Qt,{children:["Disburse loan ",N?.application_number]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[(()=>{const nt=N,xn=ys?.find(In=>In.id===nt?.loan_product_id),En=parseFloat(nt?.amount||"0"),Xn=parseFloat(nt?.processing_fee||"0"),ir=parseFloat(nt?.insurance_fee||"0"),Bs=parseFloat(nt?.total_interest||"0"),Lr=xn?.deduct_interest_upfront||!1,kr=Lr?Bs:0,Mn=En-Xn-ir-kr;return e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loan Amount"}),e.jsx("span",{className:"font-medium",children:En.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Processing Fee"}),e.jsxs("span",{className:"font-medium",children:["-",Xn.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Insurance Fee"}),e.jsxs("span",{className:"font-medium",children:["-",ir.toLocaleString()]})]}),Lr&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Interest (Upfront)"}),e.jsxs("span",{className:"font-medium text-amber-600",children:["-",kr.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t pt-2 mt-2",children:[e.jsx("span",{children:"Net Disbursement"}),e.jsx("span",{className:"text-green-600",children:Mn.toLocaleString()})]})]})})(),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Disbursement Method"}),e.jsxs(Qe,{value:w,onValueChange:S,children:[e.jsx(He,{"data-testid":"select-disburse-method-detail",children:e.jsx(Xe,{placeholder:"Select method"})}),e.jsxs(Ge,{children:[F&&e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),Ue&&e.jsx(ee,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(ee,{value:"cash",children:"Cash"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]})]}),F&&w==="mpesa"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"M-Pesa Number"}),e.jsx(re,{value:T,onChange:nt=>U(nt.target.value),placeholder:"e.g. 0712345678","data-testid":"input-disburse-phone-detail"})]}),Ue&&w==="bank_transfer"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Bank Account"}),e.jsx(re,{value:E,onChange:nt=>R(nt.target.value),placeholder:"Account number","data-testid":"input-disburse-account-detail"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t",children:[e.jsx(Ai,{id:"disburse-confirm-detail",checked:M,onCheckedChange:nt=>L(!!nt),"data-testid":"checkbox-disburse-confirm-detail"}),e.jsx("label",{htmlFor:"disburse-confirm-detail",className:"text-sm font-medium cursor-pointer",children:"I confirm the disbursement details are correct and authorize this payment"})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{P(null),S(""),R(""),U(""),L(!1)},"data-testid":"button-cancel-disburse-detail",children:"Cancel"}),e.jsx(B,{variant:"default",onClick:()=>N&&qs.mutate({id:N.id,method:w,account:E,phone:T}),disabled:qs.isPending||!w||!M,"data-testid":"button-confirm-disburse-detail",children:qs.isPending?"Processing...":"Confirm Disbursement"})]})]})})]})}Sr?.find(ce=>ce.id===is.watch("member_id")),is.watch("disbursement_method"),sa.watch("disbursement_method"),is.watch("purpose"),sa.watch("purpose");const $o=(ce,At,$t,Tn)=>{const St=ys?.find(Tt=>Tt.id===ce.watch("product_id")),dn=Sr?.find(Tt=>Tt.id===ce.watch("member_id")),nt=ce.watch("disbursement_method"),xn=ce.watch("purpose"),En=parseFloat(ce.watch("amount")||"0"),Xn=ce.watch("term")||0,ir=St?.repayment_frequency||"monthly",Bs={daily:{period:"Months",payment:"Daily Payment",instalmentUnit:"daily"},weekly:{period:"Months",payment:"Weekly Payment",instalmentUnit:"weekly"},bi_weekly:{period:"Months",payment:"Bi-Weekly Payment",instalmentUnit:"bi-weekly"},monthly:{period:"Months",payment:"Monthly Payment",instalmentUnit:"monthly"}},Lr=Bs[ir]||Bs.monthly,kr=St?.interest_rate_period||"monthly",Mn=St?parseFloat(St.interest_rate)/100:0,or=((Tt,mt,dr)=>{const pr={daily:365,weekly:52,bi_weekly:26,monthly:12,annual:1},vn=pr[dr]||12,Gu=pr[mt]||12;return mt==="annual"?Tt/vn:Gu===vn?Tt:Tt*Gu/vn})(Mn,kr,ir),Qr=_i(Xn,ir),se=St?.interest_type==="flat"?En*or*Qr:or>0&&Qr>0?En*or*Math.pow(1+or,Qr)/(Math.pow(1+or,Qr)-1)*Qr-En:0,et=Qr>0?(En+se)/Qr:0,Mt=St?En*(parseFloat(St.processing_fee||"0")/100):0,Ht=St?En*(parseFloat(St.insurance_fee||"0")/100):0,on=St?En*(parseFloat(St.appraisal_fee||"0")/100):0,Zn=Mt+Ht+on,Ga=St?parseFloat(St.excise_duty_rate||"20")/100:.2,Pr=Zn*Ga,Na=Zn+Pr,Wi=sn.reduce((Tt,mt)=>Tt+(parseFloat(mt.amount)||0),0);return e.jsx(Qn,{...ce,children:e.jsxs("form",{onSubmit:ce.handleSubmit(At),className:"space-y-6",children:[e.jsx(oe,{children:e.jsxs(de,{className:"pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg border-b pb-2",children:"Applicant Information"}),$t&&Ae?e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Member"}),e.jsx("div",{className:"font-medium",children:Ae.member_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:Ae.member_number})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Application Number"}),e.jsx("div",{className:"font-medium",children:Ae.application_number}),Ae.status==="rejected"&&Ae.rejection_reason&&e.jsxs("div",{className:"text-xs text-destructive mt-1",children:["Rejected: ",Ae.rejection_reason]})]})]}):e.jsx(je,{control:ce.control,name:"member_id",render:({field:Tt})=>e.jsxs(ge,{className:"flex flex-col",children:[e.jsxs(ve,{children:["Select Member ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(hc,{open:ae,onOpenChange:Me,children:[e.jsx(fc,{asChild:!0,children:e.jsx(ye,{children:e.jsxs(B,{variant:"outline",role:"combobox","data-testid":"select-application-member",className:We("w-full justify-between",!Tt.value&&"text-muted-foreground"),children:[Tt.value?(()=>{const mt=Sr?.find(dr=>dr.id===Tt.value);return mt?`${mt.member_number} - ${mt.first_name} ${mt.last_name}`:"Select member..."})():"Search and select member...",e.jsx(uh,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(pl,{className:"w-[400px] p-0",align:"start",children:e.jsxs(Jd,{children:[e.jsx(eu,{placeholder:"Search by name, member number, ID number, phone or email..."}),e.jsxs(tu,{children:[e.jsx(nu,{children:"No member found."}),e.jsx(ru,{children:Sr?.map(mt=>{const dr=as(mt);return e.jsxs(su,{value:`${mt.member_number} ${mt.first_name} ${mt.last_name} ${mt.phone||""} ${mt.email||""} ${mt.id_number||""}`,onSelect:()=>{Tt.onChange(mt.id),Me(!1)},children:[e.jsx(fs,{className:We("mr-2 h-4 w-4",mt.id===Tt.value?"opacity-100":"opacity-0")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:We(dr&&"text-muted-foreground"),children:[mt.member_number," - ",mt.first_name," ",mt.last_name,dr&&e.jsx("span",{className:"ml-2 text-xs text-destructive",children:"(Inactive)"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:mt.phone||mt.email||"No contact"})]})]},mt.id)})})]})]})})]}),as(dn)&&e.jsxs("div",{className:"mt-2 p-3 bg-destructive/10 border border-destructive/30 rounded-md text-sm flex items-center gap-2",children:[e.jsx(Ur,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"text-destructive font-medium",children:"This member is inactive and cannot apply for loans. Please activate the member first."})]}),dn&&!as(dn)&&e.jsxs("div",{className:"mt-2 p-3 bg-muted rounded-md text-sm grid gap-2 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Savings:"})," ",parseFloat(dn.savings_balance||"0").toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shares:"})," ",parseFloat(dn.shares_balance||"0").toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Deposits:"})," ",parseFloat(dn.deposits_balance||"0").toLocaleString()]})]}),e.jsx(Ne,{})]})})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg border-b pb-2",children:"Loan Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(je,{control:ce.control,name:"product_id",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Loan Product ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{onValueChange:mt=>{Tt.onChange(mt);const dr=ys?.find(pr=>pr.id===mt);dr&&ce.setValue("term",dr.max_term_months)},value:Tt.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-application-product",children:e.jsx(Xe,{placeholder:"Select loan product..."})})}),e.jsx(Ge,{children:ys?.map(mt=>e.jsxs(ee,{value:mt.id,children:[mt.name," - ",Tm(mt.interest_rate)," (",mt.interest_type?.replace("_"," "),")"]},mt.id))})]}),St&&e.jsxs("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-950 rounded-md text-sm",children:[e.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount Range:"})," ",parseFloat(St.min_amount).toLocaleString()," - ",parseFloat(St.max_amount).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Term Range:"})," ",St.min_term_months," - ",St.max_term_months," months"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Processing Fee:"})," ",Tm(St.processing_fee)]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Insurance Fee:"})," ",Tm(St.insurance_fee)]}),parseFloat(St.appraisal_fee||"0")>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Appraisal Fee:"})," ",Tm(St.appraisal_fee)]}),parseFloat(St.credit_life_insurance_rate||"0")>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Credit Life Ins:"})," ",Tm(St.credit_life_insurance_rate),"/yr"]})]}),St.requires_guarantor&&e.jsx("div",{className:"mt-2 text-amber-600 dark:text-amber-400 font-medium",children:"This product requires a guarantor"})]}),St&&dn&&parseFloat(St.shares_multiplier||"3")>0&&e.jsxs("div",{className:"mt-2 p-3 bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-md text-sm","data-testid":"eligibility-info",children:[e.jsx("div",{className:"font-medium text-amber-800 dark:text-amber-200 mb-1",children:"Shares-Based Eligibility"}),e.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Member Shares:"})," ",e.jsx("span",{className:"font-medium",children:parseFloat(dn.shares_balance||"0").toLocaleString()})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-muted-foreground",children:["Max Eligible (",St.shares_multiplier||"3","x):"]})," ",e.jsx("span",{className:"font-medium text-green-700 dark:text-green-400",children:(parseFloat(dn.shares_balance||"0")*parseFloat(St.shares_multiplier||"3")).toLocaleString()})]})]}),parseFloat(St.min_shares_required||"0")>0&&parseFloat(dn.shares_balance||"0")<parseFloat(St.min_shares_required||"0")&&e.jsxs("div",{className:"mt-2 text-destructive font-medium",children:["Minimum shares required: ",parseFloat(St.min_shares_required).toLocaleString()," (current: ",parseFloat(dn.shares_balance||"0").toLocaleString(),")"]})]}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(je,{control:ce.control,name:"amount",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Loan Amount ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...Tt,type:"number",placeholder:"Enter amount","data-testid":"input-application-amount"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:ce.control,name:"term",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Repayment Term (Months) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...Tt,type:"number",placeholder:"e.g. 12","data-testid":"input-application-term"})}),ir!=="monthly"&&Xn>0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Qr," ",Lr.instalmentUnit," instalments"]}),e.jsx(Ne,{})]})})]}),St&&En>0&&Xn>0&&e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-950 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsxs("h4",{className:"font-medium mb-3 text-green-800 dark:text-green-200",children:["Loan Calculation Preview ",ir!=="monthly"&&e.jsxs("span",{className:"font-normal text-xs",children:["(",Qr," ",Lr.instalmentUnit," instalments over ",Xn," months)"]})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4 text-sm",children:[e.jsxs("div",{className:"p-2 bg-white dark:bg-background rounded",children:[e.jsx("div",{className:"text-muted-foreground",children:"Principal"}),e.jsx("div",{className:"text-lg font-bold",children:En.toLocaleString()})]}),e.jsxs("div",{className:"p-2 bg-white dark:bg-background rounded",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Interest"}),e.jsx("div",{className:"text-lg font-bold",children:se.toLocaleString(void 0,{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"p-2 bg-white dark:bg-background rounded",children:[e.jsx("div",{className:"text-muted-foreground",children:Lr.payment}),e.jsx("div",{className:"text-lg font-bold",children:et.toLocaleString(void 0,{maximumFractionDigits:0})})]}),e.jsxs("div",{className:"p-2 bg-white dark:bg-background rounded",children:[e.jsx("div",{className:"text-muted-foreground",children:"Total Repayment"}),e.jsx("div",{className:"text-lg font-bold",children:(En+se).toLocaleString(void 0,{maximumFractionDigits:0})})]})]}),(Na>0||Wi>0||St.deduct_interest_upfront)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-green-200 dark:border-green-800 text-sm",children:[e.jsx("div",{className:"text-muted-foreground",children:"Upfront Deductions (from disbursement):"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-1",children:[Mt>0&&e.jsxs("span",{children:["Processing: ",Mt.toLocaleString()]}),Ht>0&&e.jsxs("span",{children:["Insurance: ",Ht.toLocaleString()]}),on>0&&e.jsxs("span",{children:["Appraisal: ",on.toLocaleString()]}),Pr>0&&e.jsxs("span",{children:["Excise Duty: ",Math.round(Pr).toLocaleString()]}),Wi>0&&e.jsxs("span",{children:["Extra Charges: ",Wi.toLocaleString()]}),St.deduct_interest_upfront&&e.jsxs("span",{className:"text-amber-600",children:["Interest (Upfront): ",se.toLocaleString(void 0,{maximumFractionDigits:0})]}),e.jsxs("span",{className:"font-medium",children:["Net Disbursement: ",(En-Na-Wi-(St.deduct_interest_upfront?se:0)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg border-b pb-2",children:"Purpose of Loan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(je,{control:ce.control,name:"purpose",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Loan Purpose ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{onValueChange:Tt.onChange,value:Tt.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-application-purpose",children:e.jsx(Xe,{placeholder:"Select purpose..."})})}),e.jsx(Ge,{children:hO.map(mt=>e.jsx(ee,{value:mt,children:mt},mt))})]}),e.jsx(Ne,{})]})}),xn==="Other"&&e.jsx(je,{control:ce.control,name:"purpose_details",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Please specify"}),e.jsx(ye,{children:e.jsx(fn,{...Tt,className:"resize-none",placeholder:"Describe the purpose of the loan...","data-testid":"input-application-purpose-details"})}),e.jsx(Ne,{})]})})]})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg border-b pb-2",children:"Disbursement Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(je,{control:ce.control,name:"disbursement_method",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Disbursement Method ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{onValueChange:Tt.onChange,value:Tt.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-disbursement-method",children:e.jsx(Xe,{placeholder:"How should funds be disbursed?"})})}),e.jsx(Ge,{children:pte.map(mt=>e.jsx(ee,{value:mt.value,children:mt.label},mt.value))})]}),e.jsx(Ne,{})]})}),nt==="mpesa"&&e.jsx(je,{control:ce.control,name:"disbursement_phone",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["M-Pesa Phone Number ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...Tt,placeholder:"e.g. 254712345678","data-testid":"input-disbursement-phone"})}),e.jsx(Ne,{})]})}),nt==="bank_transfer"&&e.jsx(je,{control:ce.control,name:"disbursement_account",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Bank Account Number ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...Tt,placeholder:"Enter bank account number","data-testid":"input-disbursement-account"})}),e.jsx(Ne,{})]})}),nt==="cheque"&&e.jsx(je,{control:ce.control,name:"disbursement_account",render:({field:Tt})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Cheque Payee Name"}),e.jsx(ye,{children:e.jsx(re,{...Tt,placeholder:"Name to appear on cheque","data-testid":"input-disbursement-cheque"})}),e.jsx(Ne,{})]})})]})]})}),!$t&&e.jsx(oe,{children:e.jsxs(de,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b pb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Extra Charges"}),e.jsxs(B,{type:"button",variant:"outline",size:"sm",onClick:()=>_n([...sn,{charge_name:"",amount:""}]),children:[e.jsx(mn,{className:"h-4 w-4 mr-1"})," Add Charge"]})]}),sn.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:'No extra charges added. Click "Add Charge" to add fees like application forms, registration, etc.'}):e.jsxs("div",{className:"space-y-3",children:[sn.map((Tt,mt)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(re,{placeholder:"Charge name (e.g., Application Form)",value:Tt.charge_name,onChange:dr=>{const pr=[...sn];pr[mt].charge_name=dr.target.value,_n(pr)}})}),e.jsx("div",{className:"w-40",children:e.jsx(re,{type:"number",placeholder:"Amount",min:"0",step:"0.01",value:Tt.amount,onChange:dr=>{const pr=[...sn];pr[mt].amount=dr.target.value,_n(pr)}})}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>_n(sn.filter((dr,pr)=>pr!==mt)),children:e.jsx(rs,{className:"h-4 w-4"})})]},mt)),e.jsxs("div",{className:"flex justify-end pt-2 border-t text-sm font-medium",children:["Total Extra Charges: ",sn.reduce((Tt,mt)=>Tt+(parseFloat(mt.amount)||0),0).toLocaleString()]})]})]})}),St?.requires_guarantor&&!$t&&e.jsx(oe,{children:e.jsxs(de,{className:"pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg border-b pb-2",children:"Guarantor Information"}),e.jsx(je,{control:ce.control,name:"guarantor_ids",render:({field:Tt})=>e.jsxs(ge,{className:"flex flex-col",children:[e.jsxs(ve,{children:["Select Guarantor(s) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(hc,{open:lt,onOpenChange:Zt,children:[e.jsx(fc,{asChild:!0,children:e.jsx(ye,{children:e.jsxs(B,{variant:"outline",role:"combobox","data-testid":"select-application-guarantor",className:We("w-full justify-between",(!Tt.value||Tt.value.length===0)&&"text-muted-foreground"),children:[Tt.value&&Tt.value.length>0?`${Tt.value.length} guarantor(s) selected`:"Search and add guarantor...",e.jsx(uh,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(pl,{className:"w-[400px] p-0",align:"start",children:e.jsxs(Jd,{children:[e.jsx(eu,{placeholder:"Search by name, member number, ID number, phone or email..."}),e.jsxs(tu,{children:[e.jsx(nu,{children:"No member found."}),e.jsx(ru,{children:Sr?.filter(mt=>mt.id!==ce.watch("member_id")&&!Tt.value?.includes(mt.id)).map(mt=>e.jsx(su,{value:`${mt.member_number} ${mt.first_name} ${mt.last_name} ${mt.phone||""} ${mt.email||""} ${mt.id_number||""}`,onSelect:()=>{Tt.onChange([...Tt.value||[],mt.id]),Zt(!1)},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{children:[mt.member_number," - ",mt.first_name," ",mt.last_name]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:mt.phone||mt.email||"No contact"})]})},mt.id))})]})]})})]}),Tt.value&&Tt.value.length>0&&e.jsx("div",{className:"mt-2 space-y-2",children:Tt.value.map(mt=>{const dr=Sr?.find(pr=>pr.id===mt);return dr?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[e.jsxs("span",{children:[dr.first_name," ",dr.last_name," (",dr.member_number,")"]}),e.jsx(B,{type:"button",variant:"ghost",size:"sm",onClick:()=>Tt.onChange(Tt.value?.filter(pr=>pr!==mt)),children:e.jsx(rs,{className:"h-4 w-4"})})]},mt):null})}),e.jsx(Ne,{})]})})]})}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>{a("list"),ce.reset(),Je(null),_n([])},children:"Cancel"}),e.jsx(B,{type:"submit",disabled:Tn,"data-testid":"button-submit-application",children:Tn?$t?"Updating...":"Submitting...":$t?"Update & Resubmit":"Submit Application"})]})]})})};return s==="new"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{a("list"),is.reset(),_n([])},"data-testid":"button-back",children:e.jsx($r,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"New Loan Application"}),e.jsx("p",{className:"text-muted-foreground",children:"Complete all sections to submit a loan application"})]})]}),$o(is,Do,!1,ra.isPending)]}):s==="edit"&&Ae?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{a("list"),Je(null),sa.reset()},"data-testid":"button-back",children:e.jsx($r,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Loan Application"}),e.jsx("p",{className:"text-muted-foreground",children:"Update the application details and resubmit for review"})]}),e.jsx(ze,{variant:Cb[Ae.status]||"secondary",className:"ml-auto capitalize",children:Ae.status.replace("_"," ")})]}),$o(sa,Ro,!0,_a.isPending)]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Loan Applications"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage loan applications"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),e.jsxs(hc,{open:Ka,onOpenChange:Wa,children:[e.jsx(fc,{asChild:!0,children:e.jsxs(B,{variant:"outline",size:"sm",disabled:Fs,"data-testid":"button-export-loans",className:"gap-1.5 h-10",children:[e.jsx($a,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:Fs?"Exporting...":"Export"})]})}),e.jsx(pl,{className:"w-56 p-1",align:"end",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(B,{variant:"ghost",size:"sm",className:"w-full justify-start text-sm font-normal",onClick:()=>Is("filtered"),"data-testid":"button-export-filtered",children:[e.jsx(hE,{className:"h-4 w-4 mr-2 text-primary"})," Download Current View"]}),e.jsx("div",{className:"border-t my-1"}),e.jsxs(B,{variant:"ghost",size:"sm",className:"w-full justify-start text-sm font-normal",onClick:()=>Is("due_today"),"data-testid":"button-export-due-today",children:[e.jsx(bn,{className:"h-4 w-4 mr-2 text-yellow-500"})," Due Today"]}),e.jsxs(B,{variant:"ghost",size:"sm",className:"w-full justify-start text-sm font-normal",onClick:()=>Is("overdue"),"data-testid":"button-export-overdue",children:[e.jsx(Ur,{className:"h-4 w-4 mr-2 text-red-500"})," Overdue Loans"]}),e.jsxs(B,{variant:"ghost",size:"sm",className:"w-full justify-start text-sm font-normal",onClick:()=>Is("due_this_week"),"data-testid":"button-export-due-week",children:[e.jsx(cE,{className:"h-4 w-4 mr-2 text-blue-500"})," Due This Week"]}),e.jsx("div",{className:"border-t my-1"}),e.jsxs(B,{variant:"ghost",size:"sm",className:"w-full justify-start text-sm font-normal",onClick:()=>Is("all"),"data-testid":"button-export-all",children:[e.jsx(tn,{className:"h-4 w-4 mr-2"})," All Active Loans"]})]})})]}),ut&&e.jsxs(B,{onClick:()=>{is.reset(),a("new")},"data-testid":"button-new-application",className:"shrink-0",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"New Application"}),e.jsx("span",{className:"sm:hidden",children:"New"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(za,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search by member name or application number...",value:Re,onChange:ce=>Ie(ce.target.value),className:"pl-9","data-testid":"input-search-loans"})]}),e.jsxs(Qe,{value:J,onValueChange:I,children:[e.jsx(He,{className:"w-[160px]","data-testid":"select-status-filter",children:e.jsx(Xe,{placeholder:"All Statuses"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Statuses"}),e.jsx(ee,{value:"pending",children:"Pending"}),e.jsx(ee,{value:"under_review",children:"Under Review"}),e.jsx(ee,{value:"approved",children:"Approved"}),e.jsx(ee,{value:"rejected",children:"Rejected"}),e.jsx(ee,{value:"disbursed",children:"Disbursed"}),e.jsx(ee,{value:"closed",children:"Closed"}),e.jsx(ee,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs(B,{variant:Ke?"secondary":"outline",size:"sm",onClick:()=>Te(!Ke),className:"gap-1.5 h-10","data-testid":"button-more-filters",children:[e.jsx(hE,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"More Filters"}),(X!=="all"||W||fe||D!=="all"&&wi)&&e.jsx(ze,{variant:"secondary",className:"ml-1 h-5 px-1.5 text-xs rounded-full",children:[X!=="all",W||fe,D!=="all"&&wi].filter(Boolean).length})]})]}),Ke&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 p-3 bg-muted/50 rounded-lg border",children:[e.jsxs(Qe,{value:X,onValueChange:ne,children:[e.jsx(He,{className:"w-full sm:w-[200px]","data-testid":"select-product-filter",children:e.jsx(Xe,{placeholder:"All Products"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Products"}),To?.map(ce=>e.jsx(ee,{value:ce.id,children:ce.name},ce.id))]})]}),wi&&Gr&&Gr.length>1&&e.jsxs(Qe,{value:D,onValueChange:z,children:[e.jsx(He,{className:"w-full sm:w-[180px]",children:e.jsx(Xe,{placeholder:"All Branches"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Branches"}),Gr.map(ce=>e.jsx(ee,{value:ce.id,children:ce.name},ce.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cE,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx(re,{type:"date",value:W,onChange:ce=>H(ce.target.value),className:"w-full sm:w-[150px]",placeholder:"From","data-testid":"input-date-from"}),e.jsx("span",{className:"text-muted-foreground text-sm",children:"to"}),e.jsx(re,{type:"date",value:fe,onChange:ce=>Pe(ce.target.value),className:"w-full sm:w-[150px]",placeholder:"To","data-testid":"input-date-to"})]}),(X!=="all"||W||fe||D!=="all")&&e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>{ne("all"),z("all"),H(""),Pe("")},className:"gap-1.5 h-10 text-muted-foreground","data-testid":"button-clear-filters",children:[e.jsx(Jg,{className:"h-3.5 w-3.5"}),"Clear"]})]})]}),e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:Vc?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):na&&na.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"hidden sm:table-cell",children:"Application #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Product"}),e.jsx(Q,{children:"Amount"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Term"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:na.map(ce=>e.jsxs(qe,{"data-testid":`row-application-${ce.id}`,children:[e.jsx(V,{className:"font-medium hidden sm:table-cell",children:ce.application_number}),e.jsxs(V,{children:[e.jsx("div",{children:ce.member_name}),e.jsx("div",{className:"text-xs text-muted-foreground md:hidden",children:ce.product_name})]}),e.jsx(V,{className:"hidden md:table-cell",children:ce.product_name}),e.jsx(V,{children:parseFloat(ce.amount).toLocaleString()}),e.jsxs(V,{className:"hidden lg:table-cell",children:[ce.term_months," months"]}),e.jsx(V,{children:e.jsx(ze,{variant:Cb[ce.status]||"secondary",children:ce.status.replace("_"," ")})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>xe(ce),"data-testid":`button-view-${ce.id}`,children:e.jsx(Ts,{className:"h-4 w-4"})}),ut&&["pending","under_review","cancelled","rejected"].includes(ce.status)&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>Ha(ce),title:"Edit application","data-testid":`button-edit-${ce.id}`,children:e.jsx(Ba,{className:"h-4 w-4 text-blue-600"})})]})})]},ce.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(tn,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:Ce||J!=="all"?"No matching loan applications":"No loan applications yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:Ce||J!=="all"?"Try adjusting your search or filters":"Submit your first loan application"}),ut&&!Ce&&J==="all"&&e.jsxs(B,{onClick:()=>a("new"),"data-testid":"button-first-application",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"New Application"]})]})})}),nr&&nr.total_pages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(nr.page-1)*nr.page_size+1,"-",Math.min(nr.page*nr.page_size,nr.total)," of ",nr.total," applications"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{variant:"outline",size:"icon",onClick:()=>Ee(1),disabled:ie<=1,"data-testid":"button-first-page",children:e.jsx(pW,{className:"h-4 w-4"})}),e.jsx(B,{variant:"outline",size:"icon",onClick:()=>Ee(ce=>Math.max(1,ce-1)),disabled:ie<=1,"data-testid":"button-prev-page",children:e.jsx(vi,{className:"h-4 w-4"})}),e.jsxs("span",{className:"px-3 text-sm",children:["Page ",nr.page," of ",nr.total_pages]}),e.jsx(B,{variant:"outline",size:"icon",onClick:()=>Ee(ce=>Math.min(nr.total_pages,ce+1)),disabled:ie>=nr.total_pages,"data-testid":"button-next-page",children:e.jsx(Os,{className:"h-4 w-4"})}),e.jsx(B,{variant:"outline",size:"icon",onClick:()=>Ee(nr.total_pages),disabled:ie>=nr.total_pages,"data-testid":"button-last-page",children:e.jsx(xW,{className:"h-4 w-4"})})]})]}),e.jsx(Vt,{open:!!f,onOpenChange:ce=>{ce||(x(null),b(""),y(""))},children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-5 w-5 text-green-600"}),"Approve Loan Application"]}),e.jsxs(Qt,{children:["Review and approve application ",f?.application_number]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Applicant"}),e.jsxs("span",{className:"font-medium",children:[f?.member_first_name," ",f?.member_last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loan Amount"}),e.jsx("span",{className:"font-medium",children:parseFloat(f?.amount||"0").toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Term"}),e.jsxs("span",{className:"font-medium",children:[f?.term_months||0," ",Ni(f).period]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Review Comments"}),e.jsx(fn,{value:j,onChange:ce=>b(ce.target.value),placeholder:"Add any review notes or observations...",className:"resize-none",rows:3,"data-testid":"input-approve-comments"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Approval Conditions (Optional)"}),e.jsx(fn,{value:g,onChange:ce=>y(ce.target.value),placeholder:"Any conditions for this approval (e.g., must provide additional documentation before disbursement)...",className:"resize-none",rows:2,"data-testid":"input-approve-conditions"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t",children:[e.jsx(Ai,{id:"approve-confirm",checked:C,onCheckedChange:ce=>k(!!ce),"data-testid":"checkbox-approve-confirm"}),e.jsx("label",{htmlFor:"approve-confirm",className:"text-sm font-medium cursor-pointer",children:"I confirm that I have reviewed this application and approve the loan"})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{x(null),b(""),y(""),k(!1)},"data-testid":"button-cancel-approve",children:"Cancel"}),e.jsx(B,{variant:"default",onClick:()=>f&&Ln.mutate({id:f.id,comments:j,conditions:g}),disabled:Ln.isPending||!C,"data-testid":"button-confirm-approve",children:Ln.isPending?"Approving...":"Confirm Approval"})]})]})}),e.jsx(Vt,{open:!!i,onOpenChange:ce=>{ce||(o(null),u(""),h(""))},children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-destructive"}),"Reject Loan Application"]}),e.jsxs(Qt,{children:["Please provide details for rejecting application ",i?.application_number]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Applicant"}),e.jsxs("span",{className:"font-medium",children:[i?.member_first_name," ",i?.member_last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loan Amount"}),e.jsx("span",{className:"font-medium",children:parseFloat(i?.amount||"0").toLocaleString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Rejection Category ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{value:m,onValueChange:h,children:[e.jsx(He,{"data-testid":"select-reject-category",children:e.jsx(Xe,{placeholder:"Select a category..."})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"insufficient_income",children:"Insufficient Income"}),e.jsx(ee,{value:"poor_credit_history",children:"Poor Credit History"}),e.jsx(ee,{value:"existing_loans",children:"Too Many Existing Loans"}),e.jsx(ee,{value:"incomplete_documentation",children:"Incomplete Documentation"}),e.jsx(ee,{value:"exceeds_limit",children:"Exceeds Borrowing Limit"}),e.jsx(ee,{value:"guarantor_issues",children:"Guarantor Requirements Not Met"}),e.jsx(ee,{value:"policy_violation",children:"Policy Violation"}),e.jsx(ee,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Detailed Reason ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(fn,{value:c,onChange:ce=>u(ce.target.value),placeholder:"Provide specific reason for rejection...",className:"resize-none",rows:4,"data-testid":"input-reject-reason"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t",children:[e.jsx(Ai,{id:"reject-confirm",checked:q,onCheckedChange:ce=>$(!!ce),"data-testid":"checkbox-reject-confirm"}),e.jsx("label",{htmlFor:"reject-confirm",className:"text-sm font-medium cursor-pointer",children:"I confirm that I want to reject this loan application"})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{o(null),u(""),h(""),$(!1)},"data-testid":"button-cancel-reject",children:"Cancel"}),e.jsx(B,{variant:"destructive",onClick:()=>i&&Cr.mutate({id:i.id,reason:c,category:m}),disabled:!c.trim()||!m||Cr.isPending||!q,"data-testid":"button-confirm-reject",children:Cr.isPending?"Rejecting...":"Confirm Rejection"})]})]})}),e.jsx(Vt,{open:!!N,onOpenChange:ce=>{ce||(P(null),S(""),R(""),U(""),L(!1))},children:e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(xa,{className:"h-5 w-5 text-green-600"}),"Disburse Loan"]}),e.jsxs(Qt,{children:["Confirm disbursement details for application ",N?.application_number]})]}),e.jsx("div",{className:"space-y-4 py-4",children:(()=>{const ce=N,At=ys?.find(In=>In.id===ce?.loan_product_id),$t=Ni(ce),Tn=parseFloat(ce?.amount||"0"),St=parseFloat(ce?.processing_fee||"0"),dn=parseFloat(ce?.insurance_fee||"0"),nt=parseFloat(ce?.appraisal_fee||"0"),xn=parseFloat(ce?.excise_duty||"0"),En=parseFloat(ce?.total_fees||"0"),Xn=parseFloat(ce?.total_interest||"0"),ir=At?.deduct_interest_upfront||!1,Bs=ir?Xn:0,Lr=ce?.extra_charges||[],kr=Lr.reduce((In,or)=>In+parseFloat(String(or.amount||"0")),0),Mn=Tn-En-kr-Bs;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Loan Summary"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Applicant"}),e.jsxs("span",{className:"font-medium",children:[ce?.member_first_name," ",ce?.member_last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loan Amount"}),e.jsx("span",{className:"font-medium",children:Tn.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Term"}),e.jsxs("span",{className:"font-medium",children:[ce?.term_months||0," ",$t.period]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:$t.payment}),e.jsx("span",{className:"font-medium",children:parseFloat(ce?.monthly_repayment||"0").toLocaleString()})]}),ir&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Interest Method"}),e.jsx("span",{className:"font-medium text-amber-600",children:"Deducted Upfront"})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg space-y-2",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Fee Breakdown"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Loan Principal"}),e.jsx("span",{children:Tn.toLocaleString()})]}),St>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Less: Processing Fee"}),e.jsxs("span",{className:"text-red-600",children:["-",St.toLocaleString()]})]}),dn>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Less: Insurance Fee"}),e.jsxs("span",{className:"text-red-600",children:["-",dn.toLocaleString()]})]}),nt>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Less: Appraisal Fee"}),e.jsxs("span",{className:"text-red-600",children:["-",nt.toLocaleString()]})]}),xn>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Less: Excise Duty (20%)"}),e.jsxs("span",{className:"text-red-600",children:["-",xn.toLocaleString()]})]}),Lr.map(In=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Less: ",In.charge_name]}),e.jsxs("span",{className:"text-red-600",children:["-",parseFloat(String(In.amount||"0")).toLocaleString()]})]},In.id||In.charge_name)),ir&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Less: Interest (Upfront)"}),e.jsxs("span",{className:"text-red-600",children:["-",Bs.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t",children:[e.jsx("span",{children:"Net Disbursement"}),e.jsx("span",{className:"text-green-600",children:Mn.toLocaleString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Disbursement Method ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(Qe,{value:w,onValueChange:S,children:[e.jsx(He,{"data-testid":"select-disburse-method",children:e.jsx(Xe,{placeholder:"Select disbursement method..."})}),e.jsxs(Ge,{children:[F&&e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),Ue&&e.jsx(ee,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(ee,{value:"cash",children:"Cash"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]})]}),F&&w==="mpesa"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["M-Pesa Phone Number ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(re,{value:T,onChange:In=>U(In.target.value),placeholder:"e.g., 0712345678","data-testid":"input-disburse-phone"})]}),Ue&&w==="bank_transfer"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Bank Account Details ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(re,{value:E,onChange:In=>R(In.target.value),placeholder:"Account number and bank name","data-testid":"input-disburse-account"})]}),e.jsxs("div",{className:"flex items-start space-x-2 pt-2",children:[e.jsx(Ai,{id:"disburse-confirm",checked:M,onCheckedChange:In=>L(In===!0),"data-testid":"checkbox-disburse-confirm"}),e.jsxs("label",{htmlFor:"disburse-confirm",className:"text-sm leading-tight cursor-pointer","data-testid":"label-disburse-confirm",children:["I confirm that all details are correct and authorize this disbursement of ",e.jsx("strong",{children:Mn.toLocaleString()})]})]})]})})()}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{P(null),S(""),R(""),U(""),L(!1)},"data-testid":"button-cancel-disburse",children:"Cancel"}),e.jsx(B,{variant:"default",onClick:()=>N&&qs.mutate({id:N.id,method:w,account:E,phone:T}),disabled:!w||!M||w==="mpesa"&&!T||w==="bank_transfer"&&!E||qs.isPending,"data-testid":"button-confirm-disburse",children:qs.isPending?"Processing...":"Confirm Disbursement"})]})]})})]})}const gte=me.object({member_id:me.string().min(1,"Member is required"),transaction_type:me.enum(["deposit","withdrawal","transfer","fee","interest"]),account_type:me.enum(["savings","shares","deposits"]),amount:me.string().min(1,"Amount is required"),payment_method:me.string().optional(),reference:me.string().optional(),description:me.string().optional()});function vte({organizationId:t}){const{toast:n}=Xt(),{symbol:r}=fr(t),[s,a]=v.useState(!1),[i,o]=v.useState(!1),[c,u]=v.useState("all"),[m,h]=v.useState(""),[f,x]=v.useState(""),[j,b]=v.useState(1),g=20,{canWrite:y}=_r(t,Nr.TRANSACTIONS),{user:C}=No(),{hasFeature:k}=Ol(t),N=k("mpesa_integration"),P=k("bank_integration"),[w,S]=v.useState(null),[E,R]=v.useState(0),T=24,[U,M]=v.useState(null);v.useEffect(()=>{if(!w)return;if(E>=T){n({title:"M-Pesa Payment Status Unknown",description:"Could not confirm payment status. If the payment was made, it will be credited shortly.",variant:"destructive"}),S(null),R(0);return}const te=setTimeout(async()=>{try{const F=await(await fetch(`/api/organizations/${t}/mpesa/stk-query`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({checkout_request_id:w.checkoutRequestId})})).json();F.status==="credited"||F.status==="already_credited"?(n({title:"M-Pesa Payment Confirmed",description:F.message||"Deposit has been credited to the member's account."}),S(null),R(0),Fe.invalidateQueries({queryKey:["/api/organizations",t,"transactions"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]})):F.status==="cancelled"||F.status==="failed"||F.status==="timeout"?(n({title:"M-Pesa Payment Not Completed",description:F.message||"The payment was not completed.",variant:"destructive"}),S(null),R(0)):R(Ue=>Ue+1)}catch{R(G=>G+1)}},5e3);return()=>clearTimeout(te)},[w,E,t,n]);const L=C?.branchId,q=C?.role,$=!L||q==="admin"||q==="owner",{data:D}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const te=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!te.ok)throw new Error("Failed to fetch branches");return te.json()}});v.useEffect(()=>{D&&D.length===1&&u(D[0].id)},[D]);const{data:z,isLoading:J,isError:I}=$e({queryKey:["/api/organizations",t,"transactions",c,m,f,j,g],queryFn:async()=>{const te=new URLSearchParams;c&&c!=="all"&&te.append("branch_id",c),m&&te.append("start_date",m),f&&te.append("end_date",f),te.append("page",j.toString()),te.append("page_size",g.toString());const G=`/api/organizations/${t}/transactions?${te.toString()}`,F=await fetch(G,{credentials:"include"});if(!F.ok)throw new Error("Failed to fetch transactions");return F.json()}}),X=z?.items,{data:ne}=$e({queryKey:["/api/organizations",t,"members"],queryFn:async()=>{const te=await fetch(`/api/organizations/${t}/members`,{credentials:"include"});if(!te.ok)throw new Error("Failed to fetch members");return te.json()}}),{data:W}=$e({queryKey:["/api/organizations",t,"settings"],enabled:!!t}),{data:H}=$e({queryKey:["/api/organizations/my"],queryFn:async()=>{const te=await fetch("/api/organizations/my",{credentials:"include"});return te.ok?te.json():[]}}),fe=te=>W?.find(G=>G.setting_key===te)?.setting_value||"",Pe=H?.find(te=>te.organizationId===t||te.organization?.id===t)?.organization,Re=fe("organization_name")||Pe?.name||"Organization",Ie=fe("organization_phone")||Pe?.phone||"",Ce=fe("organization_email")||Pe?.email||fe("email_from_address"),Y=fe("organization_address")||Pe?.address||"",ie=fe("organization_postal"),Ee=fe("organization_website"),Ke=fe("organization_registration_no"),Te=te=>{const G=ne?.find(lt=>lt.id===te.member_id),F=G?`${G.first_name} ${G.last_name}`:"Unknown",Ue=G?.member_number||"",Z=G?.phone||"",xe=new Date(te.created_at),Ae=lt=>`${r} ${Number(lt??0).toLocaleString(void 0,{minimumFractionDigits:2})}`,Je=te.transaction_type.charAt(0).toUpperCase()+te.transaction_type.slice(1),ae=[Y,ie?`P.O. Box ${ie}`:"",Ie?`Tel: ${Ie}`:"",Ce?`Email: ${Ce}`:"",Ee||"",Ke?`Reg No: ${Ke}`:""].filter(Boolean),Me=window.open("","_blank","width=460,height=700");Me&&(Me.document.write(`<!DOCTYPE html>
<html>
<head>
  <title>Receipt - ${te.transaction_number}</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; padding: 0; color: #1a1a1a; background: #fff; }
    .receipt { max-width: 380px; margin: 20px auto; padding: 0 16px; }
    .org-header { text-align: center; padding-bottom: 16px; margin-bottom: 16px; border-bottom: 2px solid #1a1a1a; }
    .org-header h1 { font-size: 22px; font-weight: 700; letter-spacing: 0.5px; margin-bottom: 6px; text-transform: uppercase; }
    .org-contact { font-size: 10px; color: #555; line-height: 1.6; }
    .txn-badge { text-align: center; margin: 14px 0; }
    .txn-badge span {
      display: inline-block; padding: 5px 20px; font-size: 12px; font-weight: 600;
      text-transform: uppercase; letter-spacing: 1.5px; border: 2px solid #1a1a1a; border-radius: 4px;
    }
    .section { margin: 14px 0; }
    .section-title { font-size: 9px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.5px; color: #888; margin-bottom: 8px; }
    .divider { border: none; border-top: 1px solid #ddd; margin: 14px 0; }
    .divider-bold { border: none; border-top: 2px solid #1a1a1a; margin: 14px 0; }
    .row { display: flex; justify-content: space-between; gap: 8px; padding: 3px 0; font-size: 12px; }
    .row .label { color: #666; flex-shrink: 0; }
    .row .value { font-weight: 500; text-align: right; word-break: break-all; }
    .amount-box {
      background: #f5f5f5; border-radius: 6px; padding: 12px 14px; margin: 10px 0;
      display: flex; justify-content: space-between; align-items: center;
    }
    .amount-box .label { font-size: 13px; font-weight: 500; color: #333; }
    .amount-box .value { font-size: 20px; font-weight: 700; color: #1a1a1a; }
    .balance-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin: 8px 0; }
    .balance-item { background: #fafafa; border-radius: 4px; padding: 8px 10px; text-align: center; }
    .balance-item .bal-label { font-size: 9px; text-transform: uppercase; letter-spacing: 1px; color: #888; margin-bottom: 4px; }
    .balance-item .bal-value { font-size: 13px; font-weight: 600; }
    .footer { text-align: center; margin-top: 20px; padding-top: 16px; border-top: 2px solid #1a1a1a; }
    .footer .thanks { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
    .footer .org-foot { font-size: 10px; color: #888; margin-bottom: 2px; }
    .stamp { font-size: 9px; color: #aaa; margin-top: 12px; }
    @media print {
      body { padding: 0; }
      .receipt { margin: 0 auto; }
      .no-print { display: none !important; }
    }
    .btn-row { display: flex; gap: 8px; margin-top: 16px; }
    .print-btn {
      flex: 1; padding: 10px; border: none; border-radius: 6px; font-size: 13px;
      font-weight: 600; cursor: pointer; font-family: 'Inter', sans-serif;
    }
    .print-btn.primary { background: #1a1a1a; color: #fff; }
    .print-btn.primary:hover { background: #333; }
    .print-btn.secondary { background: #f0f0f0; color: #333; }
    .print-btn.secondary:hover { background: #e0e0e0; }
  </style>
</head>
<body>
  <div class="receipt">
    <div class="org-header">
      <h1>${Re}</h1>
      ${ae.length>0?`<div class="org-contact">${ae.join(" &bull; ")}</div>`:""}
    </div>

    <div class="txn-badge"><span>${Je} Receipt</span></div>

    <div class="section">
      <div class="section-title">Transaction Details</div>
      <div class="row"><span class="label">Receipt No</span><span class="value">${te.transaction_number}</span></div>
      <div class="row"><span class="label">Date</span><span class="value">${xe.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})} ${xe.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}</span></div>
      <div class="row"><span class="label">Payment Method</span><span class="value" style="text-transform:capitalize">${te.payment_method||"Cash"}</span></div>
      ${te.reference?`<div class="row"><span class="label">Reference</span><span class="value" style="font-family:monospace;font-size:11px">${te.reference}</span></div>`:""}
    </div>

    <hr class="divider" />

    <div class="section">
      <div class="section-title">Member Information</div>
      <div class="row"><span class="label">Name</span><span class="value">${F}</span></div>
      ${Ue?`<div class="row"><span class="label">Member No</span><span class="value">${Ue}</span></div>`:""}
      ${Z?`<div class="row"><span class="label">Phone</span><span class="value">${Z}</span></div>`:""}
      <div class="row"><span class="label">Account</span><span class="value" style="text-transform:capitalize">${te.account_type}</span></div>
    </div>

    <hr class="divider" />

    <div class="section">
      <div class="section-title">Amount</div>
      <div class="amount-box">
        <span class="label">${Je}</span>
        <span class="value">${Ae(te.amount)}</span>
      </div>
    </div>

    <div class="footer">
      <div class="thanks">Thank you for banking with us</div>
      <div class="org-foot">${Re}</div>
      ${Ie?`<div class="org-foot">${Ie}</div>`:""}
      <div class="stamp">Printed: ${new Date().toLocaleString()}</div>
    </div>

    <div class="btn-row no-print">
      <button class="print-btn primary" onclick="window.print()">Print Receipt</button>
      <button class="print-btn secondary" onclick="window.close()">Close</button>
    </div>
  </div>
</body>
</html>`),Me.document.close())},ct=$n({resolver:Fn(gte),defaultValues:{member_id:"",transaction_type:"deposit",account_type:"savings",amount:"",payment_method:"cash",reference:"",description:""}}),ut=Le({mutationFn:async te=>{const G=await fetch(`/api/organizations/${t}/transactions`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...te,amount:parseFloat(te.amount)})});if(!G.ok){const F=await G.json().catch(()=>({detail:"Failed to record transaction"}));throw new Error(F.detail||"Failed to record transaction")}return G.json()},onSuccess:te=>{te?.stk_push?(a(!1),ct.reset(),n({title:"STK Push Sent",description:"Please check the member's phone to approve the payment. Verifying payment status..."}),te.checkout_request_id&&(R(0),S({checkoutRequestId:te.checkout_request_id}))):(b(1),Fe.invalidateQueries({queryKey:["/api/organizations",t,"transactions"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),a(!1),ct.reset(),n({title:"Transaction recorded successfully"}))},onError:te=>{n({title:te.message||"Failed to record transaction",variant:"destructive"})}}),Dt=te=>{const G=ne?.find(F=>F.id===te);return G?`${G.first_name} ${G.last_name}`:"Unknown"},be=te=>te==="deposit"||te==="interest"?e.jsx(jL,{className:"h-4 w-4 text-green-600"}):e.jsx(Mu,{className:"h-4 w-4 text-red-600"}),pt=te=>`${r} ${(te??0).toLocaleString()}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-transactions-title",children:"Transactions"}),e.jsx("p",{className:"text-muted-foreground",children:"Record deposits, withdrawals, and transfers"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),e.jsxs(B,{variant:"outline",onClick:()=>window.open(`/api/organizations/${t}/export/transactions`,"_blank"),"data-testid":"button-export-transactions",className:"shrink-0",children:[e.jsx($a,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"}),e.jsx("span",{className:"sm:hidden",children:"CSV"})]}),y&&e.jsxs(B,{onClick:()=>a(!0),"data-testid":"button-add-transaction",className:"shrink-0",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"New Transaction"}),e.jsx("span",{className:"sm:hidden",children:"New"})]})]})]}),w&&e.jsx(oe,{className:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/30",children:e.jsxs(de,{className:"flex items-center gap-3 py-3 px-4",children:[e.jsx(ln,{className:"h-5 w-5 animate-spin text-blue-600 dark:text-blue-400 shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100","data-testid":"text-stk-polling-status",children:["Verifying M-Pesa payment... (",E+1,"/",T,")"]}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Waiting for payment confirmation from Safaricom"})]}),e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>{S(null),R(0)},className:"shrink-0 text-blue-600 dark:text-blue-400","data-testid":"button-cancel-stk-polling",children:"Dismiss"})]})}),e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[$&&D&&D.length>1&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Branch"}),e.jsxs(Qe,{value:c,onValueChange:te=>{u(te),b(1)},children:[e.jsx(He,{className:"w-[180px]",children:e.jsx(Xe,{placeholder:"All Branches"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Branches"}),D.map(te=>e.jsx(ee,{value:te.id,children:te.name},te.id))]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"From"}),e.jsx(re,{type:"date",value:m,onChange:te=>{h(te.target.value),b(1)},className:"w-[160px]"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"To"}),e.jsx(re,{type:"date",value:f,onChange:te=>{x(te.target.value),b(1)},className:"w-[160px]"})]}),(m||f)&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>{h(""),x(""),b(1)},children:"Clear dates"})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Transaction History"}),e.jsx(dt,{children:z?`${z.total} transactions found`:"All financial transactions across member accounts"})]}),e.jsx(de,{children:J?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):I?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(La,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-medium",children:"Failed to load transactions"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please try again later"})]}):X&&X.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"hidden sm:table-cell",children:"Transaction #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Account"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{className:"text-right hidden lg:table-cell",children:"Balance After"}),e.jsx(Q,{className:"hidden xl:table-cell",children:"Reference"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Date"}),e.jsx(Q,{className:"w-10"})]})}),e.jsx(Pt,{children:X.map(te=>e.jsxs(qe,{"data-testid":`row-transaction-${te.id}`,children:[e.jsx(V,{className:"font-mono text-sm hidden sm:table-cell",children:te.transaction_number}),e.jsxs(V,{children:[e.jsx("div",{children:Dt(te.member_id)}),e.jsx("div",{className:"text-xs text-muted-foreground sm:hidden",children:new Date(te.created_at).toLocaleDateString()})]}),e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[be(te.transaction_type),e.jsx("span",{className:"capitalize",children:te.transaction_type})]})}),e.jsx(V,{className:"hidden md:table-cell",children:e.jsx(ze,{variant:"outline",className:"capitalize",children:te.account_type})}),e.jsx(V,{className:"text-right font-medium",children:pt(te.amount)}),e.jsx(V,{className:"text-right hidden lg:table-cell",children:pt(te.balance_after)}),e.jsx(V,{className:"hidden xl:table-cell font-mono text-xs",children:te.reference||"-"}),e.jsx(V,{className:"hidden sm:table-cell",children:new Date(te.created_at).toLocaleDateString()}),e.jsx(V,{children:e.jsx(B,{size:"icon",variant:"ghost","data-testid":`button-print-receipt-${te.id}`,onClick:()=>Te(te),children:e.jsx(tC,{className:"h-4 w-4"})})})]},te.id))})]})}),z&&z.total_pages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(j-1)*g+1," to ",Math.min(j*g,z.total)," of ",z.total]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>b(j-1),disabled:j===1,children:[e.jsx(vi,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm px-3",children:["Page ",j," of ",z.total_pages]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>b(j+1),disabled:j>=z.total_pages,children:["Next",e.jsx(Os,{className:"h-4 w-4 ml-1"})]})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Ys,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No transactions yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Record your first transaction to get started"}),y&&e.jsxs(B,{onClick:()=>a(!0),"data-testid":"button-add-first-transaction",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"New Transaction"]})]})})]}),e.jsx(Vt,{open:s,onOpenChange:a,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Record Transaction"}),e.jsx(Qt,{children:"Record a deposit, withdrawal, or transfer"})]}),e.jsx(Qn,{...ct,children:e.jsxs("form",{onSubmit:ct.handleSubmit(te=>ut.mutate(te)),className:"space-y-4",children:[e.jsx(je,{control:ct.control,name:"member_id",render:({field:te})=>e.jsxs(ge,{className:"flex flex-col",children:[e.jsx(ve,{children:"Member"}),e.jsxs(hc,{open:i,onOpenChange:o,children:[e.jsx(fc,{asChild:!0,children:e.jsx(ye,{children:e.jsxs(B,{variant:"outline",role:"combobox","data-testid":"select-member",className:We("w-full justify-between",!te.value&&"text-muted-foreground"),children:[te.value?(()=>{const G=ne?.find(F=>F.id===te.value);return G?`${G.member_number} - ${G.first_name} ${G.last_name}`:"Select member..."})():"Search and select member...",e.jsx(uh,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(pl,{className:"w-[400px] p-0",align:"start",children:e.jsxs(Jd,{children:[e.jsx(eu,{placeholder:"Search by name, member number, ID number, phone or email..."}),e.jsxs(tu,{children:[e.jsx(nu,{children:"No member found."}),e.jsx(ru,{children:ne?.map(G=>e.jsxs(su,{value:`${G.member_number} ${G.first_name} ${G.last_name} ${G.phone||""} ${G.email||""} ${G.id_number||""}`,onSelect:()=>{te.onChange(G.id),o(!1)},children:[e.jsx(fs,{className:We("mr-2 h-4 w-4",G.id===te.value?"opacity-100":"opacity-0")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{children:[G.member_number," - ",G.first_name," ",G.last_name]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:G.phone||G.email||"No contact"})]})]},G.id))})]})]})})]}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:ct.control,name:"transaction_type",render:({field:te})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Transaction Type"}),e.jsxs(Qe,{onValueChange:te.onChange,value:te.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-txn-type",children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"deposit",children:"Deposit"}),e.jsx(ee,{value:"withdrawal",children:"Withdrawal"}),e.jsx(ee,{value:"transfer",children:"Transfer"}),e.jsx(ee,{value:"fee",children:"Fee"}),e.jsx(ee,{value:"interest",children:"Interest"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:ct.control,name:"account_type",render:({field:te})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Account"}),e.jsxs(Qe,{onValueChange:te.onChange,value:te.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-account-type",children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"savings",children:"Savings"}),e.jsx(ee,{value:"shares",children:"Shares"}),e.jsx(ee,{value:"deposits",children:"Deposits"})]})]}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:ct.control,name:"amount",render:({field:te})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Amount"}),e.jsx(ye,{children:e.jsx(re,{...te,type:"number",step:"0.01",placeholder:"0.00","data-testid":"input-amount"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:ct.control,name:"payment_method",render:({field:te})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Payment Method"}),e.jsxs(Qe,{onValueChange:te.onChange,value:te.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-payment-method",children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"cash",children:"Cash"}),N&&e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),P&&e.jsx(ee,{value:"bank",children:"Bank Transfer"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:ct.control,name:"reference",render:({field:te})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Reference"}),e.jsx(ye,{children:e.jsx(re,{...te,placeholder:"Transaction ref","data-testid":"input-reference"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:ct.control,name:"description",render:({field:te})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Description"}),e.jsx(ye,{children:e.jsx(re,{...te,placeholder:"Optional notes","data-testid":"input-description"})}),e.jsx(Ne,{})]})}),e.jsxs(nn,{children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(B,{type:"submit",disabled:ut.isPending,"data-testid":"button-submit-transaction",children:ut.isPending?"Recording...":"Record Transaction"})]})]})})]})})]})}const yte=/^(\+254|0)[17]\d{8}$/,jte=me.object({loan_id:me.string().min(1,"Loan is required"),amount:me.string().min(1,"Amount is required"),payment_method:me.string().optional(),mpesa_phone:me.string().optional(),reference:me.string().optional(),notes:me.string().optional()}).refine(t=>t.payment_method==="mpesa"?!t.mpesa_phone||t.mpesa_phone.trim()===""?!1:yte.test(t.mpesa_phone.replace(/\s/g,"")):!0,{message:"Valid M-Pesa phone number is required (e.g., 0712345678)",path:["mpesa_phone"]});function bte({organizationId:t}){const{toast:n}=Xt(),{symbol:r}=fr(t),[s,a]=v.useState(!1),[i,o]=v.useState(!1),[c,u]=v.useState(""),[m,h]=v.useState(""),[f,x]=v.useState(1),j=20,{canWrite:b}=_r(t,Nr.REPAYMENTS),{hasFeature:g}=Ol(t),y=g("mpesa_integration"),C=g("bank_integration"),{data:k,isLoading:N,isError:P}=$e({queryKey:["/api/organizations",t,"repayments",c,m,f,j],queryFn:async()=>{const $=new URLSearchParams;c&&$.append("start_date",c),m&&$.append("end_date",m),$.append("page",f.toString()),$.append("page_size",j.toString());const D=`/api/organizations/${t}/repayments?${$.toString()}`,z=await fetch(D,{credentials:"include"});if(!z.ok)throw new Error("Failed to fetch repayments");return z.json()}}),w=k?.items,{data:S}=$e({queryKey:["/api/organizations",t,"loan-applications","active"],queryFn:async()=>{const $=await fetch(`/api/organizations/${t}/loan-applications?status=disbursed&page_size=100`,{credentials:"include"});if(!$.ok)throw new Error("Failed to fetch loans");const D=await $.json();return D.data||D}}),{data:E}=$e({queryKey:["/api/organizations",t,"members"],queryFn:async()=>{const $=await fetch(`/api/organizations/${t}/members`,{credentials:"include"});if(!$.ok)throw new Error("Failed to fetch members");return $.json()}}),R=$n({resolver:Fn(jte),defaultValues:{loan_id:"",amount:"",payment_method:"cash",mpesa_phone:"",reference:"",notes:""}}),T=R.watch("payment_method"),U=Le({mutationFn:async $=>(await Be("POST",`/api/organizations/${t}/mpesa/stk-push`,$)).json(),onSuccess:$=>{$.success?n({title:"M-Pesa prompt sent! Please check your phone to complete payment."}):n({title:$.message||"Failed to send M-Pesa prompt",variant:"destructive"})},onError:$=>{n({title:$.message||"Failed to initiate M-Pesa payment",variant:"destructive"})}}),M=Le({mutationFn:async $=>{if($.payment_method==="mpesa"&&$.mpesa_phone){const D=S?.find(I=>I.id===$.loan_id),z=D?E?.find(I=>I.id===D.member_id):null,J=D?.application_number||"Payment";await U.mutateAsync({phone:$.mpesa_phone,amount:parseFloat($.amount),account_reference:J,description:`Loan repayment for ${z?.first_name||"Member"}`,loan_id:$.loan_id})}return Be("POST",`/api/organizations/${t}/repayments`,{...$,amount:parseFloat($.amount)})},onSuccess:()=>{x(1),Fe.invalidateQueries({queryKey:["/api/organizations",t,"repayments"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),a(!1),R.reset(),n({title:"Repayment recorded successfully"})},onError:$=>{n({title:$.message||"Failed to record repayment",variant:"destructive"})}}),L=$=>{const D=S?.find(I=>I.id===$);if(!D)return"Unknown Loan";const z=E?.find(I=>I.id===D.member_id),J=z?`${z.first_name} ${z.last_name}`:"Unknown";return`${D.application_number} - ${J}`},q=$=>`${r} ${$.toLocaleString()}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-repayments-title",children:"Loan Repayments"}),e.jsx("p",{className:"text-muted-foreground",children:"Record and track loan payments"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),b&&e.jsxs(B,{onClick:()=>a(!0),"data-testid":"button-add-repayment",className:"shrink-0",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Record Payment"}),e.jsx("span",{className:"sm:hidden",children:"Record"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"From"}),e.jsx(re,{type:"date",value:c,onChange:$=>{u($.target.value),x(1)},className:"w-[160px]"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"To"}),e.jsx(re,{type:"date",value:m,onChange:$=>{h($.target.value),x(1)},className:"w-[160px]"})]}),(c||m)&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>{u(""),h(""),x(1)},children:"Clear dates"})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Payment History"}),e.jsx(dt,{children:k?`${k.total} repayments found`:"All loan repayments recorded"})]}),e.jsx(de,{children:N?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):P?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(La,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-medium",children:"Failed to load repayments"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please try again later"})]}):w&&w.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"hidden sm:table-cell",children:"Payment #"}),e.jsx(Q,{children:"Loan"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{className:"text-right hidden md:table-cell",children:"Principal"}),e.jsx(Q,{className:"text-right hidden md:table-cell",children:"Interest"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Method"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Date"})]})}),e.jsx(Pt,{children:w.map($=>e.jsxs(qe,{"data-testid":`row-repayment-${$.id}`,children:[e.jsx(V,{className:"font-mono text-sm hidden sm:table-cell",children:$.repayment_number}),e.jsxs(V,{children:[e.jsx("div",{children:L($.loan_id)}),e.jsx("div",{className:"text-xs text-muted-foreground sm:hidden",children:new Date($.payment_date).toLocaleDateString()})]}),e.jsx(V,{className:"text-right font-medium",children:q($.amount)}),e.jsx(V,{className:"text-right hidden md:table-cell",children:q($.principal_amount)}),e.jsx(V,{className:"text-right hidden md:table-cell",children:q($.interest_amount)}),e.jsx(V,{className:"hidden lg:table-cell",children:e.jsx(ze,{variant:"outline",className:"capitalize",children:$.payment_method||"cash"})}),e.jsx(V,{className:"hidden sm:table-cell",children:new Date($.payment_date).toLocaleDateString()})]},$.id))})]})}),k&&k.total_pages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(f-1)*j+1," to ",Math.min(f*j,k.total)," of ",k.total]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>x(f-1),disabled:f===1,children:[e.jsx(vi,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm px-3",children:["Page ",f," of ",k.total_pages]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>x(f+1),disabled:f>=k.total_pages,children:["Next",e.jsx(Os,{className:"h-4 w-4 ml-1"})]})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Ei,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No repayments yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Record a loan payment to get started"}),e.jsxs(B,{onClick:()=>a(!0),"data-testid":"button-add-first-repayment",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Record Payment"]})]})})]}),e.jsx(Vt,{open:s,onOpenChange:a,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Record Loan Payment"}),e.jsx(Qt,{children:"Record a payment against an active loan"})]}),e.jsx(Qn,{...R,children:e.jsxs("form",{onSubmit:R.handleSubmit($=>M.mutate($)),className:"space-y-4",children:[e.jsx(je,{control:R.control,name:"loan_id",render:({field:$})=>{const D=S?.find(I=>I.id===$.value),z=D?E?.find(I=>I.id===D.member_id):null,J=S?.filter(I=>I.status==="disbursed")||[];return e.jsxs(ge,{className:"flex flex-col",children:[e.jsx(ve,{children:"Loan"}),e.jsxs(hc,{open:i,onOpenChange:o,children:[e.jsx(fc,{asChild:!0,children:e.jsx(ye,{children:e.jsxs(B,{variant:"outline",role:"combobox","aria-expanded":i,className:We("w-full justify-between",!$.value&&"text-muted-foreground"),"data-testid":"select-loan",children:[D?e.jsxs("span",{className:"truncate",children:[D.application_number," - ",z?.first_name," ",z?.last_name]}):"Search by name, member number, or ID...",e.jsx(uh,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(pl,{className:"w-[400px] p-0",align:"start",children:e.jsxs(Jd,{children:[e.jsx(eu,{placeholder:"Search by name, member number, ID number, phone..."}),e.jsxs(tu,{children:[e.jsx(nu,{children:"No loan found."}),e.jsx(ru,{children:J.map(I=>{const X=E?.find(W=>W.id===I.member_id),ne=`${X?.first_name||""} ${X?.last_name||""} ${X?.member_number||""} ${X?.id_number||""} ${X?.phone||""} ${I.application_number}`.toLowerCase();return e.jsxs(su,{value:ne,onSelect:()=>{$.onChange(I.id),o(!1)},children:[e.jsx(fs,{className:We("mr-2 h-4 w-4",$.value===I.id?"opacity-100":"opacity-0")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:[X?.first_name," ",X?.last_name]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[I.application_number," | ",X?.member_number||"No member #"," | Balance: ",q(I.outstanding_balance)]})]})]},I.id)})})]})]})})]}),e.jsx(Ne,{})]})}}),e.jsx(je,{control:R.control,name:"amount",render:({field:$})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Amount"}),e.jsx(ye,{children:e.jsx(re,{...$,type:"number",step:"0.01",placeholder:"0.00","data-testid":"input-amount"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:R.control,name:"payment_method",render:({field:$})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Payment Method"}),e.jsxs(Qe,{onValueChange:$.onChange,value:$.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-payment-method",children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"cash",children:"Cash"}),y&&e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),C&&e.jsx(ee,{value:"bank",children:"Bank Transfer"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:R.control,name:"reference",render:({field:$})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Reference"}),e.jsx(ye,{children:e.jsx(re,{...$,placeholder:"Payment ref","data-testid":"input-reference"})}),e.jsx(Ne,{})]})})]}),T==="mpesa"&&e.jsx(je,{control:R.control,name:"mpesa_phone",render:({field:$})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"M-Pesa Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...$,placeholder:"e.g., 0712345678","data-testid":"input-mpesa-phone"})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"An M-Pesa payment prompt will be sent to this number"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:R.control,name:"notes",render:({field:$})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Notes"}),e.jsx(ye,{children:e.jsx(re,{...$,placeholder:"Optional notes","data-testid":"input-notes"})}),e.jsx(Ne,{})]})}),e.jsxs(nn,{children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(B,{type:"submit",disabled:M.isPending,"data-testid":"button-submit-repayment",children:M.isPending?"Recording...":"Record Payment"})]})]})})]})})]})}const wte={summary:"summary",loans:"loans",members:"members",aging:"aging",pnl:"pnl"};function _te({filters:t,onFiltersChange:n,branches:r,onRefresh:s,onExport:a,activeTab:i}){const o=wte[i];return e.jsx(oe,{children:e.jsx(de,{className:"pt-4",children:e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Se,{htmlFor:"start-date",className:"text-xs",children:"Start Date"}),e.jsx(re,{id:"start-date",type:"date",value:t.startDate,onChange:c=>n({...t,startDate:c.target.value}),className:"w-40","data-testid":"input-start-date"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Se,{htmlFor:"end-date",className:"text-xs",children:"End Date"}),e.jsx(re,{id:"end-date",type:"date",value:t.endDate,onChange:c=>n({...t,endDate:c.target.value}),className:"w-40","data-testid":"input-end-date"})]}),r.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(Se,{className:"text-xs",children:"Branch"}),e.jsxs(Qe,{value:t.branchId,onValueChange:c=>n({...t,branchId:c}),children:[e.jsx(He,{className:"w-44","data-testid":"select-branch-filter",children:e.jsx(Xe,{placeholder:"All Branches"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Branches"}),r.map(c=>e.jsx(ee,{value:c.id,children:c.name},c.id))]})]})]}),e.jsxs(B,{variant:"outline",onClick:s,"data-testid":"button-refresh-reports",children:[e.jsx(mi,{className:"h-4 w-4 mr-2"}),"Refresh"]}),o&&e.jsxs(B,{variant:"outline",onClick:()=>a(o),"data-testid":"button-export-reports",children:[e.jsx($a,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})})})}const Nte={pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",approved:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",disbursed:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",defaulted:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",restructured:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",completed:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300",rejected:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",paid:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};function b1(t){return Nte[t]||"bg-gray-100 text-gray-800"}function di(t){return t?new Date(t).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}):"-"}function Ste({data:t,isLoading:n,formatCurrency:r}){return n?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:Array.from({length:8}).map((s,a)=>e.jsx(bt,{className:"h-32"},a))}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Nx,{className:"h-5 w-5"}),"Member Deposits"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(da,{label:"Total Savings",value:r(t?.member_deposits?.total_savings||0),className:"text-primary",testId:"text-total-savings"}),e.jsx(da,{label:"Total Shares",value:r(t?.member_deposits?.total_shares||0),testId:"text-total-shares"}),e.jsx(da,{label:"Fixed Deposits",value:r(t?.member_deposits?.total_deposits||0),testId:"text-total-deposits"}),e.jsx(da,{label:"Total Member Funds",value:r(t?.member_deposits?.total_member_funds||0),className:"text-primary",highlight:!0,testId:"text-total-funds"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ns,{className:"h-5 w-5"}),"Loan Portfolio"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(da,{label:"Active Loans",value:String(t?.loan_portfolio?.active_loans||0),testId:"text-active-loans"}),e.jsx(da,{label:"Outstanding Balance",value:r(t?.loan_portfolio?.total_outstanding||0),className:"text-orange-600",testId:"text-outstanding"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ei,{className:"h-5 w-5"}),"Period Activity (",di(t?.period?.start_date||null)," - ",di(t?.period?.end_date||null),")"]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(da,{label:"Deposits Received",value:r(t?.period_activity?.deposits_received||0),className:"text-green-600",icon:e.jsx(Mu,{className:"h-3 w-3 text-green-500"})}),e.jsx(da,{label:"Withdrawals Made",value:r(t?.period_activity?.withdrawals_made||0),className:"text-red-600",icon:e.jsx(bL,{className:"h-3 w-3 text-red-500"})}),e.jsx(da,{label:"Loans Disbursed",value:r(t?.period_activity?.loans_disbursed||0)}),e.jsx(da,{label:"Collections",value:r(t?.period_activity?.loan_collections||0),className:"text-green-600"}),e.jsx(da,{label:"Interest Income",value:r(t?.period_activity?.interest_income||0),className:"text-blue-600"}),e.jsx(da,{label:"Penalty Income",value:r(t?.period_activity?.penalty_income||0)}),e.jsx(da,{label:"Total Income",value:r(t?.period_activity?.total_income||0),className:"text-primary",highlight:!0})]})]})]})}function da({label:t,value:n,className:r="",highlight:s=!1,icon:a,testId:i}){return e.jsxs(oe,{className:s?"bg-primary/5":"",children:[e.jsx(we,{className:"pb-2",children:e.jsxs(_e,{className:"text-sm font-medium text-muted-foreground flex items-center gap-1",children:[a,t]})}),e.jsx(de,{children:e.jsx("div",{className:`text-2xl font-bold ${r}`,"data-testid":i,children:n})})]})}function Cte({data:t,isLoading:n,formatCurrency:r,statusFilter:s,onStatusFilterChange:a,page:i,onPageChange:o}){const c=t?.loans?.pagination;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap gap-4 mb-4",children:e.jsxs(Qe,{value:s,onValueChange:a,children:[e.jsx(He,{className:"w-44","data-testid":"select-loan-status",children:e.jsx(Xe,{placeholder:"Status"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Statuses"}),e.jsx(ee,{value:"pending",children:"Pending"}),e.jsx(ee,{value:"approved",children:"Approved"}),e.jsx(ee,{value:"disbursed",children:"Disbursed"}),e.jsx(ee,{value:"defaulted",children:"Defaulted"}),e.jsx(ee,{value:"restructured",children:"Restructured"}),e.jsx(ee,{value:"completed",children:"Completed"}),e.jsx(ee,{value:"rejected",children:"Rejected"}),e.jsx(ee,{value:"paid",children:"Paid"})]})]})}),n?e.jsx(bt,{className:"h-64"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Xp,{label:"Total Applications",value:String(t?.summary?.total_applications||0),sub:`Approval Rate: ${(t?.summary?.approval_rate||0).toFixed(1)}%`}),e.jsx(Xp,{label:"Total Applied",value:r(t?.summary?.total_applied_amount||0)}),e.jsx(Xp,{label:"Total Disbursed",value:r(t?.summary?.total_disbursed_amount||0),className:"text-green-600"}),e.jsx(Xp,{label:"Total Outstanding",value:r(t?.summary?.total_outstanding||0),className:"text-orange-600"})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Status Breakdown"})}),e.jsx(de,{children:e.jsx("div",{className:"flex flex-wrap gap-4",children:Object.entries(t?.by_status||{}).map(([u,m])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:b1(u),children:u}),e.jsx("span",{className:"font-semibold",children:m})]},u))})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(_e,{children:"Loan Applications"}),e.jsxs(dt,{children:["Showing ",t?.loans?.items?.length||0," of ",c?.total||0," loans"]})]})})}),e.jsxs(de,{children:[e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Application #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{children:"Applied"}),e.jsx(Q,{children:"Disbursed"}),e.jsx(Q,{className:"text-right",children:"Outstanding"})]})}),e.jsx(Pt,{children:(t?.loans?.items||[]).length===0?e.jsx(qe,{children:e.jsx(V,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No loan applications found"})}):t?.loans?.items.map(u=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono text-sm",children:u.application_number}),e.jsx(V,{children:u.member_name}),e.jsx(V,{className:"text-right",children:r(u.amount)}),e.jsx(V,{children:e.jsx(ze,{className:b1(u.status),children:u.status})}),e.jsx(V,{children:di(u.applied_at)}),e.jsx(V,{children:di(u.disbursed_at)}),e.jsx(V,{className:"text-right",children:r(u.outstanding)})]},u.application_number))})]})}),c&&c.total_pages>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",c.page," of ",c.total_pages]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",disabled:i<=1,onClick:()=>o(i-1),"data-testid":"button-prev-page",children:[e.jsx(vi,{className:"h-4 w-4"}),"Previous"]}),e.jsxs(B,{variant:"outline",size:"sm",disabled:i>=c.total_pages,onClick:()=>o(i+1),"data-testid":"button-next-page",children:["Next",e.jsx(Os,{className:"h-4 w-4"})]})]})]})]})]})]})]})}function Xp({label:t,value:n,sub:r,className:s}){return e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs(de,{children:[e.jsx("div",{className:`text-2xl font-bold ${s||""}`,children:n}),r&&e.jsx("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function kte({members:t,branches:n,formatCurrency:r}){const s=t.filter(i=>i.status==="active").length,a=t.filter(i=>i.status==="pending").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Zp,{label:"Total Members",value:t.length}),e.jsx(Zp,{label:"Active Members",value:s,className:"text-green-600"}),e.jsx(Zp,{label:"Pending Activation",value:a,className:"text-yellow-600"}),e.jsx(Zp,{label:"Branches",value:n.length})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Members by Branch"})}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Branch"}),e.jsx(Q,{className:"text-right",children:"Members"}),e.jsx(Q,{className:"text-right",children:"Total Savings"}),e.jsx(Q,{className:"text-right",children:"Total Shares"}),e.jsx(Q,{className:"text-right",children:"Total Deposits"})]})}),e.jsx(Pt,{children:n.map(i=>{const o=t.filter(c=>c.branch_id===i.id);return e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:i.name}),e.jsx(V,{className:"text-right",children:o.length}),e.jsx(V,{className:"text-right",children:r(o.reduce((c,u)=>c+(u.savings_balance||0),0))}),e.jsx(V,{className:"text-right",children:r(o.reduce((c,u)=>c+(u.shares_balance||0),0))}),e.jsx(V,{className:"text-right",children:r(o.reduce((c,u)=>c+(u.deposits_balance||0),0))})]},i.id)})})]})})})]})]})}function Zp({label:t,value:n,className:r}){return e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsx(de,{children:e.jsx("div",{className:`text-2xl font-bold ${r||""}`,children:n})})]})}const Pte=[{key:"current",label:"Current",badgeClass:"bg-green-50 text-green-700 border-green-200"},{key:"1_30_days",label:"1-30 Days",badgeClass:"bg-yellow-50 text-yellow-700 border-yellow-200"},{key:"31_60_days",label:"31-60 Days",badgeClass:"bg-orange-50 text-orange-700 border-orange-200"},{key:"61_90_days",label:"61-90 Days",badgeClass:"bg-red-50 text-red-700 border-red-200"},{key:"over_90_days",label:"Over 90 Days",badgeClass:"bg-red-100 text-red-800 border-red-300"}];function Ate({data:t,isLoading:n,formatCurrency:r}){if(n)return e.jsx(bt,{className:"h-64"});const s=t?.total_portfolio?.total_outstanding||0,a=u=>s?(u/s*100).toFixed(1):"0",i=s?(((t?.summary?.["31_60_days"]?.total_outstanding||0)+(t?.summary?.["61_90_days"]?.total_outstanding||0)+(t?.summary?.over_90_days?.total_outstanding||0))/s*100).toFixed(2):"0",o=s?((t?.summary?.over_90_days?.total_outstanding||0)/s*100).toFixed(2):"0",c=s?((t?.summary?.current?.total_outstanding||0)/s*100).toFixed(2):"0";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Loan Aging Analysis"}),e.jsxs(dt,{children:["As of ",di(t?.as_of_date||null)]})]}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Aging Bucket"}),e.jsx(Q,{className:"text-right",children:"No. of Loans"}),e.jsx(Q,{className:"text-right",children:"Outstanding Amount"}),e.jsx(Q,{className:"text-right",children:"% of Portfolio"})]})}),e.jsxs(Pt,{children:[Pte.map(u=>{const m=t?.summary?.[u.key];return e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:e.jsx(ze,{variant:"outline",className:u.badgeClass,children:u.label})}),e.jsx(V,{className:"text-right",children:m?.count||0}),e.jsx(V,{className:"text-right",children:r(m?.total_outstanding||0)}),e.jsxs(V,{className:"text-right",children:[a(m?.total_outstanding||0),"%"]})]},u.key)}),e.jsxs(qe,{className:"bg-muted/50 font-semibold",children:[e.jsx(V,{children:"Total Portfolio"}),e.jsx(V,{className:"text-right",children:t?.total_portfolio?.count||0}),e.jsx(V,{className:"text-right",children:r(s)}),e.jsx(V,{className:"text-right",children:"100%"})]})]})]})})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(kb,{label:"PAR > 30 Days",value:`${i}%`,sub:"Portfolio at Risk",className:"text-yellow-600"}),e.jsx(kb,{label:"PAR > 90 Days",value:`${o}%`,sub:"High Risk",className:"text-red-600"}),e.jsx(kb,{label:"Current Ratio",value:`${c}%`,sub:"Performing Loans",className:"text-green-600"})]})]})}function kb({label:t,value:n,sub:r,className:s}){return e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs(de,{children:[e.jsx("div",{className:`text-2xl font-bold ${s}`,children:n}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r})]})]})}function Ete({data:t,isLoading:n,formatCurrency:r}){return n?e.jsx(bt,{className:"h-64"}):e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Profit & Loss Statement"}),e.jsxs(dt,{children:["Period: ",di(t?.period?.start_date||null)," - ",di(t?.period?.end_date||null)]})]}),e.jsx(de,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg mb-3 text-green-600",children:"Income"}),e.jsxs("div",{className:"space-y-2 pl-4",children:[e.jsx(vd,{label:"Interest Income",value:r(t?.income?.interest_income||0)}),e.jsx(vd,{label:"Penalty Income",value:r(t?.income?.penalty_income||0)}),e.jsx(vd,{label:"Processing Fees",value:r(t?.income?.processing_fees||0)}),e.jsx(vd,{label:"Insurance Fees",value:r(t?.income?.insurance_fees||0)}),e.jsx(vd,{label:"Extra Charges",value:r(t?.income?.extra_charges||0)}),e.jsxs("div",{className:"flex justify-between py-2 bg-green-50 dark:bg-green-900/20 px-2 rounded font-semibold",children:[e.jsx("span",{children:"Total Income"}),e.jsx("span",{className:"text-green-600",children:r(t?.income?.total_income||0)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg mb-3 text-red-600",children:"Expenses"}),e.jsxs("div",{className:"space-y-2 pl-4",children:[t?.expenses?.categories&&Object.entries(t.expenses.categories).map(([s,a])=>e.jsx(vd,{label:s,value:r(a)},s)),(!t?.expenses?.categories||Object.keys(t.expenses.categories).length===0)&&e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-muted-foreground",children:"No approved expenses in this period"}),e.jsx("span",{className:"font-medium",children:r(0)})]}),e.jsxs("div",{className:"flex justify-between py-2 bg-red-50 dark:bg-red-900/20 px-2 rounded font-semibold",children:[e.jsx("span",{children:"Total Expenses"}),e.jsx("span",{className:"text-red-600",children:r(t?.expenses?.total_expenses||0)})]})]})]}),e.jsx("div",{className:"pt-4 border-t-2",children:e.jsxs("div",{className:"flex justify-between py-3 bg-primary/10 px-4 rounded-lg",children:[e.jsx("span",{className:"text-lg font-bold",children:"Net Profit"}),e.jsx("span",{className:`text-xl font-bold ${(t?.net_profit||0)>=0?"text-green-600":"text-red-600"}`,children:r(t?.net_profit||0)})]})})]})})]})}function vd({label:t,value:n}){return e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{children:t}),e.jsx("span",{className:"font-medium",children:n})]})}function Ote({organizationId:t,startDate:n,endDate:r,formatCurrency:s}){const[a,i]=v.useState(""),[o,c]=v.useState(""),[u,m]=v.useState("");v.useEffect(()=>{const b=setTimeout(()=>c(a),300);return()=>clearTimeout(b)},[a]);const{data:h}=$e({queryKey:["/api/organizations",t,"reports","member-search",o],queryFn:async()=>{if(!o||o.length<2)return[];const b=await fetch(`/api/organizations/${t}/reports/member-search?query=${encodeURIComponent(o)}&limit=10`,{credentials:"include"});return b.ok?b.json():[]},enabled:o.length>=2}),{data:f,isLoading:x}=$e({queryKey:["/api/organizations",t,"reports","member-statement",u,n,r],queryFn:async()=>{const b=new URLSearchParams;n&&b.append("start_date",n),r&&b.append("end_date",r);const g=await fetch(`/api/organizations/${t}/reports/member-statement/${u}?${b}`,{credentials:"include"});if(!g.ok)throw new Error("Failed to fetch statement");return g.json()},enabled:!!u}),j=o.length>=2&&!u;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Member Statement"}),e.jsx(dt,{children:"Search for a member to view their statement"})]}),e.jsx(de,{className:"space-y-4",children:e.jsxs("div",{className:"max-w-sm relative",children:[e.jsx(Se,{className:"text-xs",children:"Search Member"}),e.jsxs("div",{className:"relative",children:[e.jsx(za,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search by name or member number...",value:a,onChange:b=>{i(b.target.value),b.target.value||m("")},className:"pl-10","data-testid":"input-member-search"})]}),j&&h&&h.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-popover border rounded-md shadow-md max-h-48 overflow-auto",children:h.map(b=>e.jsxs("button",{className:"w-full text-left px-3 py-2 hover:bg-accent text-sm",onClick:()=>{m(b.id),i(`${b.member_number} - ${b.first_name} ${b.last_name}`)},"data-testid":`member-result-${b.id}`,children:[e.jsx("span",{className:"font-mono text-xs mr-2",children:b.member_number}),b.first_name," ",b.last_name]},b.id))}),j&&h&&h.length===0&&o.length>=2&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-popover border rounded-md shadow-md p-3 text-sm text-muted-foreground",children:"No members found"})]})})]}),u&&(x?e.jsx(bt,{className:"h-64"}):f?e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-5 w-5"}),f.member.name]}),e.jsxs(dt,{children:[f.member.member_number," | ",f.member.phone," | ",f.member.email]})]}),e.jsx(de,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx(Jp,{label:"Savings Balance",value:s(f.balances.savings),className:"text-primary"}),e.jsx(Jp,{label:"Shares Balance",value:s(f.balances.shares)}),e.jsx(Jp,{label:"Deposits Balance",value:s(f.balances.deposits)}),e.jsx(Jp,{label:"Loan Outstanding",value:s(f.balances.total_loan_outstanding),className:"text-orange-600"})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Transaction History"}),e.jsxs(dt,{children:[di(f.period.start_date)," - ",di(f.period.end_date)]})]}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Date"}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Account"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{className:"text-right",children:"Balance"}),e.jsx(Q,{children:"Reference"}),e.jsx(Q,{children:"Description"})]})}),e.jsx(Pt,{children:(f.transactions||[]).length===0?e.jsx(qe,{children:e.jsx(V,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No transactions found for this period"})}):f.transactions.map((b,g)=>e.jsxs(qe,{children:[e.jsx(V,{children:di(b.date)}),e.jsx(V,{children:e.jsx(ze,{variant:b.type==="deposit"?"default":"secondary",children:b.type})}),e.jsx(V,{children:b.account}),e.jsxs(V,{className:`text-right ${b.type==="deposit"?"text-green-600":"text-red-600"}`,children:[b.type==="deposit"?"+":"-",s(b.amount)]}),e.jsx(V,{className:"text-right",children:s(b.balance_after)}),e.jsx(V,{className:"font-mono text-xs",children:b.reference}),e.jsx(V,{className:"text-sm text-muted-foreground",children:b.description})]},g))})]})})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Loans Summary"})}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Loan #"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Outstanding"}),e.jsx(Q,{children:"Disbursed"})]})}),e.jsx(Pt,{children:(f.loans_summary||[]).length===0?e.jsx(qe,{children:e.jsx(V,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No loans found"})}):f.loans_summary.map((b,g)=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono",children:b.loan_number}),e.jsx(V,{className:"text-right",children:s(b.amount)}),e.jsx(V,{children:e.jsx(ze,{className:b1(b.status),children:b.status})}),e.jsx(V,{className:"text-right",children:s(b.outstanding)}),e.jsx(V,{children:di(b.disbursed_at)})]},g))})]})})})]})]}):null)]})}function Jp({label:t,value:n,className:r}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t}),e.jsx("p",{className:`text-xl font-bold ${r||""}`,children:n})]})}const w1=new Date,Tte=new Date(w1.getFullYear(),w1.getMonth(),1),fO=t=>t.toISOString().split("T")[0];function Mte({organizationId:t}){const{toast:n}=Xt(),r=gs(),[s,a]=v.useState("summary"),[i,o]=v.useState({startDate:fO(Tte),endDate:fO(w1),branchId:"all"}),[c,u]=v.useState("all"),[m,h]=v.useState(1),f=v.useCallback(q=>{const $=new URLSearchParams;return i.startDate&&$.append("start_date",i.startDate),i.endDate&&$.append("end_date",i.endDate),i.branchId&&i.branchId!=="all"&&$.append("branch_id",i.branchId),q&&Object.entries(q).forEach(([D,z])=>$.append(D,z)),$.toString()},[i]),x=q=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(q),{data:j=[]}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const q=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});return q.ok?q.json():[]}}),{data:b=[]}=$e({queryKey:["/api/organizations",t,"members"],queryFn:async()=>{const q=await fetch(`/api/organizations/${t}/members`,{credentials:"include"});return q.ok?q.json():[]},enabled:s==="members"}),g=f(),{data:y,isLoading:C}=$e({queryKey:["/api/organizations",t,"reports","financial-summary",g],queryFn:async()=>{const q=await fetch(`/api/organizations/${t}/reports/financial-summary?${g}`,{credentials:"include"});if(!q.ok)throw new Error("Failed to fetch summary");return q.json()},enabled:s==="summary"}),k=f({page:String(m),page_size:"20",...c!=="all"?{status:c}:{}}),{data:N,isLoading:P}=$e({queryKey:["/api/organizations",t,"reports","loans",k],queryFn:async()=>{const q=await fetch(`/api/organizations/${t}/reports/loans?${k}`,{credentials:"include"});if(!q.ok)throw new Error("Failed to fetch loan report");return q.json()},enabled:s==="loans"}),w=f(),{data:S,isLoading:E}=$e({queryKey:["/api/organizations",t,"reports","profit-loss",w],queryFn:async()=>{const q=await fetch(`/api/organizations/${t}/reports/profit-loss?${w}`,{credentials:"include"});if(!q.ok)throw new Error("Failed to fetch P&L");return q.json()},enabled:s==="pnl"}),{data:R,isLoading:T}=$e({queryKey:["/api/organizations",t,"reports","aging"],queryFn:async()=>{const q=await fetch(`/api/organizations/${t}/reports/aging`,{credentials:"include"});if(!q.ok)throw new Error("Failed to fetch aging");return q.json()},enabled:s==="aging"}),U=()=>{r.invalidateQueries({predicate:q=>{const $=q.queryKey;return Array.isArray($)&&$.includes("reports")}}),n({title:"Refreshed",description:"Report data has been refreshed."})},M=async q=>{try{const $=new URLSearchParams({report_type:q});i.startDate&&$.append("start_date",i.startDate),i.endDate&&$.append("end_date",i.endDate),i.branchId&&i.branchId!=="all"&&$.append("branch_id",i.branchId),q==="loans"&&c!=="all"&&$.append("status",c);const D=await fetch(`/api/organizations/${t}/reports/export?${$}`,{credentials:"include"});if(!D.ok)throw new Error("Export failed");const z=await D.blob(),J=window.URL.createObjectURL(z),I=document.createElement("a");I.href=J,I.download=`${q}_report.csv`,I.click(),window.URL.revokeObjectURL(J),n({title:"Exported",description:`${q} report downloaded.`})}catch{n({title:"Error",description:"Failed to export report.",variant:"destructive"})}},L=q=>{u(q),h(1)};return e.jsxs("div",{className:"space-y-6 p-4 md:p-6","data-testid":"reports-container",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ri,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Reports"}),e.jsx("p",{className:"text-muted-foreground",children:"Financial reports and analytics"})]})]}),e.jsx(_te,{filters:i,onFiltersChange:o,branches:j,onRefresh:U,onExport:M,activeTab:s}),e.jsxs($s,{value:s,onValueChange:a,children:[e.jsxs(vs,{className:"flex flex-wrap h-auto gap-1",children:[e.jsxs(_t,{value:"summary",className:"gap-1","data-testid":"tab-summary",children:[e.jsx(Ri,{className:"h-4 w-4"})," Summary"]}),e.jsxs(_t,{value:"loans",className:"gap-1","data-testid":"tab-loans",children:[e.jsx(ns,{className:"h-4 w-4"})," Loans"]}),e.jsxs(_t,{value:"members",className:"gap-1","data-testid":"tab-members",children:[e.jsx(pn,{className:"h-4 w-4"})," Members"]}),e.jsxs(_t,{value:"aging",className:"gap-1","data-testid":"tab-aging",children:[e.jsx(bn,{className:"h-4 w-4"})," Aging"]}),e.jsxs(_t,{value:"pnl",className:"gap-1","data-testid":"tab-pnl",children:[e.jsx(ho,{className:"h-4 w-4"})," P&L"]}),e.jsxs(_t,{value:"statement",className:"gap-1","data-testid":"tab-statement",children:[e.jsx(tn,{className:"h-4 w-4"})," Statement"]})]}),e.jsx(Nt,{value:"summary",children:e.jsx(Ste,{data:y,isLoading:C,formatCurrency:x})}),e.jsx(Nt,{value:"loans",children:e.jsx(Cte,{data:N,isLoading:P,formatCurrency:x,statusFilter:c,onStatusFilterChange:L,page:m,onPageChange:h})}),e.jsx(Nt,{value:"members",children:e.jsx(kte,{members:b,branches:j,formatCurrency:x})}),e.jsx(Nt,{value:"aging",children:e.jsx(Ate,{data:R,isLoading:T,formatCurrency:x})}),e.jsx(Nt,{value:"pnl",children:e.jsx(Ete,{data:S,isLoading:E,formatCurrency:x})}),e.jsx(Nt,{value:"statement",children:e.jsx(Ote,{organizationId:t,startDate:i.startDate,endDate:i.endDate,formatCurrency:x})})]})]})}var Pb,pO;function ea(){if(pO)return Pb;pO=1;var t=Array.isArray;return Pb=t,Pb}var Ab,xO;function M6(){if(xO)return Ab;xO=1;var t=typeof qp=="object"&&qp&&qp.Object===Object&&qp;return Ab=t,Ab}var Eb,gO;function Ui(){if(gO)return Eb;gO=1;var t=M6(),n=typeof self=="object"&&self&&self.Object===Object&&self,r=t||n||Function("return this")();return Eb=r,Eb}var Ob,vO;function Tf(){if(vO)return Ob;vO=1;var t=Ui(),n=t.Symbol;return Ob=n,Ob}var Tb,yO;function Rte(){if(yO)return Tb;yO=1;var t=Tf(),n=Object.prototype,r=n.hasOwnProperty,s=n.toString,a=t?t.toStringTag:void 0;function i(o){var c=r.call(o,a),u=o[a];try{o[a]=void 0;var m=!0}catch{}var h=s.call(o);return m&&(c?o[a]=u:delete o[a]),h}return Tb=i,Tb}var Mb,jO;function Dte(){if(jO)return Mb;jO=1;var t=Object.prototype,n=t.toString;function r(s){return n.call(s)}return Mb=r,Mb}var Rb,bO;function Co(){if(bO)return Rb;bO=1;var t=Tf(),n=Rte(),r=Dte(),s="[object Null]",a="[object Undefined]",i=t?t.toStringTag:void 0;function o(c){return c==null?c===void 0?a:s:i&&i in Object(c)?n(c):r(c)}return Rb=o,Rb}var Db,wO;function ko(){if(wO)return Db;wO=1;function t(n){return n!=null&&typeof n=="object"}return Db=t,Db}var $b,_O;function qu(){if(_O)return $b;_O=1;var t=Co(),n=ko(),r="[object Symbol]";function s(a){return typeof a=="symbol"||n(a)&&t(a)==r}return $b=s,$b}var Fb,NO;function WC(){if(NO)return Fb;NO=1;var t=ea(),n=qu(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function a(i,o){if(t(i))return!1;var c=typeof i;return c=="number"||c=="symbol"||c=="boolean"||i==null||n(i)?!0:s.test(i)||!r.test(i)||o!=null&&i in Object(o)}return Fb=a,Fb}var Lb,SO;function Dl(){if(SO)return Lb;SO=1;function t(n){var r=typeof n;return n!=null&&(r=="object"||r=="function")}return Lb=t,Lb}var Ib,CO;function HC(){if(CO)return Ib;CO=1;var t=Co(),n=Dl(),r="[object AsyncFunction]",s="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function o(c){if(!n(c))return!1;var u=t(c);return u==s||u==a||u==r||u==i}return Ib=o,Ib}var qb,kO;function $te(){if(kO)return qb;kO=1;var t=Ui(),n=t["__core-js_shared__"];return qb=n,qb}var Bb,PO;function Fte(){if(PO)return Bb;PO=1;var t=$te(),n=(function(){var s=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""})();function r(s){return!!n&&n in s}return Bb=r,Bb}var zb,AO;function R6(){if(AO)return zb;AO=1;var t=Function.prototype,n=t.toString;function r(s){if(s!=null){try{return n.call(s)}catch{}try{return s+""}catch{}}return""}return zb=r,zb}var Vb,EO;function Lte(){if(EO)return Vb;EO=1;var t=HC(),n=Fte(),r=Dl(),s=R6(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,o=Function.prototype,c=Object.prototype,u=o.toString,m=c.hasOwnProperty,h=RegExp("^"+u.call(m).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(x){if(!r(x)||n(x))return!1;var j=t(x)?h:i;return j.test(s(x))}return Vb=f,Vb}var Ub,OO;function Ite(){if(OO)return Ub;OO=1;function t(n,r){return n?.[r]}return Ub=t,Ub}var Kb,TO;function Ic(){if(TO)return Kb;TO=1;var t=Lte(),n=Ite();function r(s,a){var i=n(s,a);return t(i)?i:void 0}return Kb=r,Kb}var Wb,MO;function Av(){if(MO)return Wb;MO=1;var t=Ic(),n=t(Object,"create");return Wb=n,Wb}var Hb,RO;function qte(){if(RO)return Hb;RO=1;var t=Av();function n(){this.__data__=t?t(null):{},this.size=0}return Hb=n,Hb}var Gb,DO;function Bte(){if(DO)return Gb;DO=1;function t(n){var r=this.has(n)&&delete this.__data__[n];return this.size-=r?1:0,r}return Gb=t,Gb}var Yb,$O;function zte(){if($O)return Yb;$O=1;var t=Av(),n="__lodash_hash_undefined__",r=Object.prototype,s=r.hasOwnProperty;function a(i){var o=this.__data__;if(t){var c=o[i];return c===n?void 0:c}return s.call(o,i)?o[i]:void 0}return Yb=a,Yb}var Qb,FO;function Vte(){if(FO)return Qb;FO=1;var t=Av(),n=Object.prototype,r=n.hasOwnProperty;function s(a){var i=this.__data__;return t?i[a]!==void 0:r.call(i,a)}return Qb=s,Qb}var Xb,LO;function Ute(){if(LO)return Xb;LO=1;var t=Av(),n="__lodash_hash_undefined__";function r(s,a){var i=this.__data__;return this.size+=this.has(s)?0:1,i[s]=t&&a===void 0?n:a,this}return Xb=r,Xb}var Zb,IO;function Kte(){if(IO)return Zb;IO=1;var t=qte(),n=Bte(),r=zte(),s=Vte(),a=Ute();function i(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var m=o[c];this.set(m[0],m[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=s,i.prototype.set=a,Zb=i,Zb}var Jb,qO;function Wte(){if(qO)return Jb;qO=1;function t(){this.__data__=[],this.size=0}return Jb=t,Jb}var e0,BO;function GC(){if(BO)return e0;BO=1;function t(n,r){return n===r||n!==n&&r!==r}return e0=t,e0}var t0,zO;function Ev(){if(zO)return t0;zO=1;var t=GC();function n(r,s){for(var a=r.length;a--;)if(t(r[a][0],s))return a;return-1}return t0=n,t0}var n0,VO;function Hte(){if(VO)return n0;VO=1;var t=Ev(),n=Array.prototype,r=n.splice;function s(a){var i=this.__data__,o=t(i,a);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():r.call(i,o,1),--this.size,!0}return n0=s,n0}var r0,UO;function Gte(){if(UO)return r0;UO=1;var t=Ev();function n(r){var s=this.__data__,a=t(s,r);return a<0?void 0:s[a][1]}return r0=n,r0}var s0,KO;function Yte(){if(KO)return s0;KO=1;var t=Ev();function n(r){return t(this.__data__,r)>-1}return s0=n,s0}var a0,WO;function Qte(){if(WO)return a0;WO=1;var t=Ev();function n(r,s){var a=this.__data__,i=t(a,r);return i<0?(++this.size,a.push([r,s])):a[i][1]=s,this}return a0=n,a0}var i0,HO;function Ov(){if(HO)return i0;HO=1;var t=Wte(),n=Hte(),r=Gte(),s=Yte(),a=Qte();function i(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var m=o[c];this.set(m[0],m[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=s,i.prototype.set=a,i0=i,i0}var o0,GO;function YC(){if(GO)return o0;GO=1;var t=Ic(),n=Ui(),r=t(n,"Map");return o0=r,o0}var l0,YO;function Xte(){if(YO)return l0;YO=1;var t=Kte(),n=Ov(),r=YC();function s(){this.size=0,this.__data__={hash:new t,map:new(r||n),string:new t}}return l0=s,l0}var c0,QO;function Zte(){if(QO)return c0;QO=1;function t(n){var r=typeof n;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?n!=="__proto__":n===null}return c0=t,c0}var d0,XO;function Tv(){if(XO)return d0;XO=1;var t=Zte();function n(r,s){var a=r.__data__;return t(s)?a[typeof s=="string"?"string":"hash"]:a.map}return d0=n,d0}var u0,ZO;function Jte(){if(ZO)return u0;ZO=1;var t=Tv();function n(r){var s=t(this,r).delete(r);return this.size-=s?1:0,s}return u0=n,u0}var m0,JO;function ene(){if(JO)return m0;JO=1;var t=Tv();function n(r){return t(this,r).get(r)}return m0=n,m0}var h0,eT;function tne(){if(eT)return h0;eT=1;var t=Tv();function n(r){return t(this,r).has(r)}return h0=n,h0}var f0,tT;function nne(){if(tT)return f0;tT=1;var t=Tv();function n(r,s){var a=t(this,r),i=a.size;return a.set(r,s),this.size+=a.size==i?0:1,this}return f0=n,f0}var p0,nT;function QC(){if(nT)return p0;nT=1;var t=Xte(),n=Jte(),r=ene(),s=tne(),a=nne();function i(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var m=o[c];this.set(m[0],m[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=s,i.prototype.set=a,p0=i,p0}var x0,rT;function D6(){if(rT)return x0;rT=1;var t=QC(),n="Expected a function";function r(s,a){if(typeof s!="function"||a!=null&&typeof a!="function")throw new TypeError(n);var i=function(){var o=arguments,c=a?a.apply(this,o):o[0],u=i.cache;if(u.has(c))return u.get(c);var m=s.apply(this,o);return i.cache=u.set(c,m)||u,m};return i.cache=new(r.Cache||t),i}return r.Cache=t,x0=r,x0}var g0,sT;function rne(){if(sT)return g0;sT=1;var t=D6(),n=500;function r(s){var a=t(s,function(o){return i.size===n&&i.clear(),o}),i=a.cache;return a}return g0=r,g0}var v0,aT;function sne(){if(aT)return v0;aT=1;var t=rne(),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,s=t(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(n,function(o,c,u,m){i.push(u?m.replace(r,"$1"):c||o)}),i});return v0=s,v0}var y0,iT;function XC(){if(iT)return y0;iT=1;function t(n,r){for(var s=-1,a=n==null?0:n.length,i=Array(a);++s<a;)i[s]=r(n[s],s,n);return i}return y0=t,y0}var j0,oT;function ane(){if(oT)return j0;oT=1;var t=Tf(),n=XC(),r=ea(),s=qu(),a=t?t.prototype:void 0,i=a?a.toString:void 0;function o(c){if(typeof c=="string")return c;if(r(c))return n(c,o)+"";if(s(c))return i?i.call(c):"";var u=c+"";return u=="0"&&1/c==-1/0?"-0":u}return j0=o,j0}var b0,lT;function $6(){if(lT)return b0;lT=1;var t=ane();function n(r){return r==null?"":t(r)}return b0=n,b0}var w0,cT;function F6(){if(cT)return w0;cT=1;var t=ea(),n=WC(),r=sne(),s=$6();function a(i,o){return t(i)?i:n(i,o)?[i]:r(s(i))}return w0=a,w0}var _0,dT;function Mv(){if(dT)return _0;dT=1;var t=qu();function n(r){if(typeof r=="string"||t(r))return r;var s=r+"";return s=="0"&&1/r==-1/0?"-0":s}return _0=n,_0}var N0,uT;function ZC(){if(uT)return N0;uT=1;var t=F6(),n=Mv();function r(s,a){a=t(a,s);for(var i=0,o=a.length;s!=null&&i<o;)s=s[n(a[i++])];return i&&i==o?s:void 0}return N0=r,N0}var S0,mT;function L6(){if(mT)return S0;mT=1;var t=ZC();function n(r,s,a){var i=r==null?void 0:t(r,s);return i===void 0?a:i}return S0=n,S0}var ine=L6();const ya=kn(ine);var C0,hT;function one(){if(hT)return C0;hT=1;function t(n){return n==null}return C0=t,C0}var lne=one();const hn=kn(lne);var k0,fT;function cne(){if(fT)return k0;fT=1;var t=Co(),n=ea(),r=ko(),s="[object String]";function a(i){return typeof i=="string"||!n(i)&&r(i)&&t(i)==s}return k0=a,k0}var dne=cne();const Pc=kn(dne);var une=HC();const Yt=kn(une);var mne=Dl();const Bu=kn(mne);var P0={exports:{}},Nn={};var pT;function hne(){if(pT)return Nn;pT=1;var t=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),b;b=Symbol.for("react.module.reference");function g(y){if(typeof y=="object"&&y!==null){var C=y.$$typeof;switch(C){case t:switch(y=y.type,y){case r:case a:case s:case m:case h:return y;default:switch(y=y&&y.$$typeof,y){case c:case o:case u:case x:case f:case i:return y;default:return C}}case n:return C}}}return Nn.ContextConsumer=o,Nn.ContextProvider=i,Nn.Element=t,Nn.ForwardRef=u,Nn.Fragment=r,Nn.Lazy=x,Nn.Memo=f,Nn.Portal=n,Nn.Profiler=a,Nn.StrictMode=s,Nn.Suspense=m,Nn.SuspenseList=h,Nn.isAsyncMode=function(){return!1},Nn.isConcurrentMode=function(){return!1},Nn.isContextConsumer=function(y){return g(y)===o},Nn.isContextProvider=function(y){return g(y)===i},Nn.isElement=function(y){return typeof y=="object"&&y!==null&&y.$$typeof===t},Nn.isForwardRef=function(y){return g(y)===u},Nn.isFragment=function(y){return g(y)===r},Nn.isLazy=function(y){return g(y)===x},Nn.isMemo=function(y){return g(y)===f},Nn.isPortal=function(y){return g(y)===n},Nn.isProfiler=function(y){return g(y)===a},Nn.isStrictMode=function(y){return g(y)===s},Nn.isSuspense=function(y){return g(y)===m},Nn.isSuspenseList=function(y){return g(y)===h},Nn.isValidElementType=function(y){return typeof y=="string"||typeof y=="function"||y===r||y===a||y===s||y===m||y===h||y===j||typeof y=="object"&&y!==null&&(y.$$typeof===x||y.$$typeof===f||y.$$typeof===i||y.$$typeof===o||y.$$typeof===u||y.$$typeof===b||y.getModuleId!==void 0)},Nn.typeOf=g,Nn}var xT;function fne(){return xT||(xT=1,P0.exports=hne()),P0.exports}var pne=fne(),A0,gT;function I6(){if(gT)return A0;gT=1;var t=Co(),n=ko(),r="[object Number]";function s(a){return typeof a=="number"||n(a)&&t(a)==r}return A0=s,A0}var E0,vT;function xne(){if(vT)return E0;vT=1;var t=I6();function n(r){return t(r)&&r!=+r}return E0=n,E0}var gne=xne();const Mf=kn(gne);var vne=I6();const yne=kn(vne);var ks=function(n){return n===0?0:n>0?1:-1},lc=function(n){return Pc(n)&&n.indexOf("%")===n.length-1},it=function(n){return yne(n)&&!Mf(n)},jne=function(n){return hn(n)},Dr=function(n){return it(n)||Pc(n)},bne=0,Rf=function(n){var r=++bne;return"".concat(n||"").concat(r)},Ps=function(n,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!it(n)&&!Pc(n))return s;var i;if(lc(n)){var o=n.indexOf("%");i=r*parseFloat(n.slice(0,o))/100}else i=+n;return Mf(i)&&(i=s),a&&i>r&&(i=r),i},ul=function(n){if(!n)return null;var r=Object.keys(n);return r&&r.length?n[r[0]]:null},wne=function(n){if(!Array.isArray(n))return!1;for(var r=n.length,s={},a=0;a<r;a++)if(!s[n[a]])s[n[a]]=!0;else return!0;return!1},ol=function(n,r){return it(n)&&it(r)?function(s){return n+s*(r-n)}:function(){return r}};function _1(t,n,r){return!t||!t.length?null:t.find(function(s){return s&&(typeof n=="function"?n(s):ya(s,n))===r})}var _ne=function(n,r){return it(n)&&it(r)?n-r:Pc(n)&&Pc(r)?n.localeCompare(r):n instanceof Date&&r instanceof Date?n.getTime()-r.getTime():String(n).localeCompare(String(r))};function zd(t,n){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(n,r)||t[r]!==n[r]))return!1;for(var s in n)if({}.hasOwnProperty.call(n,s)&&!{}.hasOwnProperty.call(t,s))return!1;return!0}function N1(t){"@babel/helpers - typeof";return N1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},N1(t)}var Nne=["viewBox","children"],Sne=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],yT=["points","pathLength"],O0={svg:Nne,polygon:yT,polyline:yT},JC=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Yx=function(n,r){if(!n||typeof n=="function"||typeof n=="boolean")return null;var s=n;if(v.isValidElement(n)&&(s=n.props),!Bu(s))return null;var a={};return Object.keys(s).forEach(function(i){JC.includes(i)&&(a[i]=r||function(o){return s[i](s,o)})}),a},Cne=function(n,r,s){return function(a){return n(r,s,a),null}},Ac=function(n,r,s){if(!Bu(n)||N1(n)!=="object")return null;var a=null;return Object.keys(n).forEach(function(i){var o=n[i];JC.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=Cne(o,r,s))}),a},kne=["children"],Pne=["children"];function jT(t,n){if(t==null)return{};var r=Ane(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Ane(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}var bT={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},fo=function(n){return typeof n=="string"?n:n?n.displayName||n.name||"Component":""},wT=null,T0=null,ek=function t(n){if(n===wT&&Array.isArray(T0))return T0;var r=[];return v.Children.forEach(n,function(s){hn(s)||(pne.isFragment(s)?r=r.concat(t(s.props.children)):r.push(s))}),T0=r,wT=n,r};function qa(t,n){var r=[],s=[];return Array.isArray(n)?s=n.map(function(a){return fo(a)}):s=[fo(n)],ek(t).forEach(function(a){var i=ya(a,"type.displayName")||ya(a,"type.name");s.indexOf(i)!==-1&&r.push(a)}),r}function ma(t,n){var r=qa(t,n);return r&&r[0]}var _T=function(n){if(!n||!n.props)return!1;var r=n.props,s=r.width,a=r.height;return!(!it(s)||s<=0||!it(a)||a<=0)},Ene=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],One=function(n){return n&&n.type&&Pc(n.type)&&Ene.indexOf(n.type)>=0},Tne=function(n,r,s,a){var i,o=(i=O0?.[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Yt(n)&&(a&&o.includes(r)||Sne.includes(r))||s&&JC.includes(r)},Wt=function(n,r,s){if(!n||typeof n=="function"||typeof n=="boolean")return null;var a=n;if(v.isValidElement(n)&&(a=n.props),!Bu(a))return null;var i={};return Object.keys(a).forEach(function(o){var c;Tne((c=a)===null||c===void 0?void 0:c[o],o,r,s)&&(i[o]=a[o])}),i},S1=function t(n,r){if(n===r)return!0;var s=v.Children.count(n);if(s!==v.Children.count(r))return!1;if(s===0)return!0;if(s===1)return NT(Array.isArray(n)?n[0]:n,Array.isArray(r)?r[0]:r);for(var a=0;a<s;a++){var i=n[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!t(i,o))return!1}else if(!NT(i,o))return!1}return!0},NT=function(n,r){if(hn(n)&&hn(r))return!0;if(!hn(n)&&!hn(r)){var s=n.props||{},a=s.children,i=jT(s,kne),o=r.props||{},c=o.children,u=jT(o,Pne);return a&&c?zd(i,u)&&S1(a,c):!a&&!c?zd(i,u):!1}return!1},ST=function(n,r){var s=[],a={};return ek(n).forEach(function(i,o){if(One(i))s.push(i);else if(i){var c=fo(i.type),u=r[c]||{},m=u.handler,h=u.once;if(m&&(!h||!a[c])){var f=m(i,c,o);s.push(f),a[c]=!0}}}),s},Mne=function(n){var r=n&&n.type;return r&&bT[r]?bT[r]:null},Rne=function(n,r){return ek(r).indexOf(n)},Dne=["children","width","height","viewBox","className","style","title","desc"];function C1(){return C1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},C1.apply(this,arguments)}function $ne(t,n){if(t==null)return{};var r=Fne(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Fne(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function k1(t){var n=t.children,r=t.width,s=t.height,a=t.viewBox,i=t.className,o=t.style,c=t.title,u=t.desc,m=$ne(t,Dne),h=a||{width:r,height:s,x:0,y:0},f=rn("recharts-surface",i);return le.createElement("svg",C1({},Wt(m,!0,"svg"),{className:f,width:r,height:s,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height)}),le.createElement("title",null,c),le.createElement("desc",null,u),n)}var Lne=["children","className"];function P1(){return P1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},P1.apply(this,arguments)}function Ine(t,n){if(t==null)return{};var r=qne(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function qne(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}var An=le.forwardRef(function(t,n){var r=t.children,s=t.className,a=Ine(t,Lne),i=rn("recharts-layer",s);return le.createElement("g",P1({className:i},Wt(a,!0),{ref:n}),r)}),fi=function(n,r){for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i]},M0,CT;function Bne(){if(CT)return M0;CT=1;function t(n,r,s){var a=-1,i=n.length;r<0&&(r=-r>i?0:i+r),s=s>i?i:s,s<0&&(s+=i),i=r>s?0:s-r>>>0,r>>>=0;for(var o=Array(i);++a<i;)o[a]=n[a+r];return o}return M0=t,M0}var R0,kT;function zne(){if(kT)return R0;kT=1;var t=Bne();function n(r,s,a){var i=r.length;return a=a===void 0?i:a,!s&&a>=i?r:t(r,s,a)}return R0=n,R0}var D0,PT;function q6(){if(PT)return D0;PT=1;var t="\\ud800-\\udfff",n="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",s="\\u20d0-\\u20ff",a=n+r+s,i="\\ufe0e\\ufe0f",o="\\u200d",c=RegExp("["+o+t+a+i+"]");function u(m){return c.test(m)}return D0=u,D0}var $0,AT;function Vne(){if(AT)return $0;AT=1;function t(n){return n.split("")}return $0=t,$0}var F0,ET;function Une(){if(ET)return F0;ET=1;var t="\\ud800-\\udfff",n="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",s="\\u20d0-\\u20ff",a=n+r+s,i="\\ufe0e\\ufe0f",o="["+t+"]",c="["+a+"]",u="\\ud83c[\\udffb-\\udfff]",m="(?:"+c+"|"+u+")",h="[^"+t+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",x="[\\ud800-\\udbff][\\udc00-\\udfff]",j="\\u200d",b=m+"?",g="["+i+"]?",y="(?:"+j+"(?:"+[h,f,x].join("|")+")"+g+b+")*",C=g+b+y,k="(?:"+[h+c+"?",c,f,x,o].join("|")+")",N=RegExp(u+"(?="+u+")|"+k+C,"g");function P(w){return w.match(N)||[]}return F0=P,F0}var L0,OT;function Kne(){if(OT)return L0;OT=1;var t=Vne(),n=q6(),r=Une();function s(a){return n(a)?r(a):t(a)}return L0=s,L0}var I0,TT;function Wne(){if(TT)return I0;TT=1;var t=zne(),n=q6(),r=Kne(),s=$6();function a(i){return function(o){o=s(o);var c=n(o)?r(o):void 0,u=c?c[0]:o.charAt(0),m=c?t(c,1).join(""):o.slice(1);return u[i]()+m}}return I0=a,I0}var q0,MT;function Hne(){if(MT)return q0;MT=1;var t=Wne(),n=t("toUpperCase");return q0=n,q0}var Gne=Hne();const Rv=kn(Gne);function zn(t){return function(){return t}}const B6=Math.cos,Qx=Math.sin,ji=Math.sqrt,Xx=Math.PI,Dv=2*Xx,A1=Math.PI,E1=2*A1,nc=1e-6,Yne=E1-nc;function z6(t){this._+=t[0];for(let n=1,r=t.length;n<r;++n)this._+=arguments[n]+t[n]}function Qne(t){let n=Math.floor(t);if(!(n>=0))throw new Error(`invalid digits: ${t}`);if(n>15)return z6;const r=10**n;return function(s){this._+=s[0];for(let a=1,i=s.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+s[a]}}class Xne{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?z6:Qne(n)}moveTo(n,r){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,r){this._append`L${this._x1=+n},${this._y1=+r}`}quadraticCurveTo(n,r,s,a){this._append`Q${+n},${+r},${this._x1=+s},${this._y1=+a}`}bezierCurveTo(n,r,s,a,i,o){this._append`C${+n},${+r},${+s},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(n,r,s,a,i){if(n=+n,r=+r,s=+s,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,c=this._y1,u=s-n,m=a-r,h=o-n,f=c-r,x=h*h+f*f;if(this._x1===null)this._append`M${this._x1=n},${this._y1=r}`;else if(x>nc)if(!(Math.abs(f*u-m*h)>nc)||!i)this._append`L${this._x1=n},${this._y1=r}`;else{let j=s-o,b=a-c,g=u*u+m*m,y=j*j+b*b,C=Math.sqrt(g),k=Math.sqrt(x),N=i*Math.tan((A1-Math.acos((g+x-y)/(2*C*k)))/2),P=N/k,w=N/C;Math.abs(P-1)>nc&&this._append`L${n+P*h},${r+P*f}`,this._append`A${i},${i},0,0,${+(f*j>h*b)},${this._x1=n+w*u},${this._y1=r+w*m}`}}arc(n,r,s,a,i,o){if(n=+n,r=+r,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(a),u=s*Math.sin(a),m=n+c,h=r+u,f=1^o,x=o?a-i:i-a;this._x1===null?this._append`M${m},${h}`:(Math.abs(this._x1-m)>nc||Math.abs(this._y1-h)>nc)&&this._append`L${m},${h}`,s&&(x<0&&(x=x%E1+E1),x>Yne?this._append`A${s},${s},0,1,${f},${n-c},${r-u}A${s},${s},0,1,${f},${this._x1=m},${this._y1=h}`:x>nc&&this._append`A${s},${s},0,${+(x>=A1)},${f},${this._x1=n+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(n,r,s,a){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+r}h${s=+s}v${+a}h${-s}Z`}toString(){return this._}}function tk(t){let n=3;return t.digits=function(r){if(!arguments.length)return n;if(r==null)n=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);n=s}return t},()=>new Xne(n)}function nk(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function V6(t){this._context=t}V6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n);break}}};function $v(t){return new V6(t)}function U6(t){return t[0]}function K6(t){return t[1]}function W6(t,n){var r=zn(!0),s=null,a=$v,i=null,o=tk(c);t=typeof t=="function"?t:t===void 0?U6:zn(t),n=typeof n=="function"?n:n===void 0?K6:zn(n);function c(u){var m,h=(u=nk(u)).length,f,x=!1,j;for(s==null&&(i=a(j=o())),m=0;m<=h;++m)!(m<h&&r(f=u[m],m,u))===x&&((x=!x)?i.lineStart():i.lineEnd()),x&&i.point(+t(f,m,u),+n(f,m,u));if(j)return i=null,j+""||null}return c.x=function(u){return arguments.length?(t=typeof u=="function"?u:zn(+u),c):t},c.y=function(u){return arguments.length?(n=typeof u=="function"?u:zn(+u),c):n},c.defined=function(u){return arguments.length?(r=typeof u=="function"?u:zn(!!u),c):r},c.curve=function(u){return arguments.length?(a=u,s!=null&&(i=a(s)),c):a},c.context=function(u){return arguments.length?(u==null?s=i=null:i=a(s=u),c):s},c}function ex(t,n,r){var s=null,a=zn(!0),i=null,o=$v,c=null,u=tk(m);t=typeof t=="function"?t:t===void 0?U6:zn(+t),n=typeof n=="function"?n:zn(n===void 0?0:+n),r=typeof r=="function"?r:r===void 0?K6:zn(+r);function m(f){var x,j,b,g=(f=nk(f)).length,y,C=!1,k,N=new Array(g),P=new Array(g);for(i==null&&(c=o(k=u())),x=0;x<=g;++x){if(!(x<g&&a(y=f[x],x,f))===C)if(C=!C)j=x,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),b=x-1;b>=j;--b)c.point(N[b],P[b]);c.lineEnd(),c.areaEnd()}C&&(N[x]=+t(y,x,f),P[x]=+n(y,x,f),c.point(s?+s(y,x,f):N[x],r?+r(y,x,f):P[x]))}if(k)return c=null,k+""||null}function h(){return W6().defined(a).curve(o).context(i)}return m.x=function(f){return arguments.length?(t=typeof f=="function"?f:zn(+f),s=null,m):t},m.x0=function(f){return arguments.length?(t=typeof f=="function"?f:zn(+f),m):t},m.x1=function(f){return arguments.length?(s=f==null?null:typeof f=="function"?f:zn(+f),m):s},m.y=function(f){return arguments.length?(n=typeof f=="function"?f:zn(+f),r=null,m):n},m.y0=function(f){return arguments.length?(n=typeof f=="function"?f:zn(+f),m):n},m.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:zn(+f),m):r},m.lineX0=m.lineY0=function(){return h().x(t).y(n)},m.lineY1=function(){return h().x(t).y(r)},m.lineX1=function(){return h().x(s).y(n)},m.defined=function(f){return arguments.length?(a=typeof f=="function"?f:zn(!!f),m):a},m.curve=function(f){return arguments.length?(o=f,i!=null&&(c=o(i)),m):o},m.context=function(f){return arguments.length?(f==null?i=c=null:c=o(i=f),m):i},m}class H6{constructor(n,r){this._context=n,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,r){switch(n=+n,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,r,n,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,n,this._y0,n,r);break}}this._x0=n,this._y0=r}}function Zne(t){return new H6(t,!0)}function Jne(t){return new H6(t,!1)}const rk={draw(t,n){const r=ji(n/Xx);t.moveTo(r,0),t.arc(0,0,r,0,Dv)}},ere={draw(t,n){const r=ji(n/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},G6=ji(1/3),tre=G6*2,nre={draw(t,n){const r=ji(n/tre),s=r*G6;t.moveTo(0,-r),t.lineTo(s,0),t.lineTo(0,r),t.lineTo(-s,0),t.closePath()}},rre={draw(t,n){const r=ji(n),s=-r/2;t.rect(s,s,r,r)}},sre=.8908130915292852,Y6=Qx(Xx/10)/Qx(7*Xx/10),are=Qx(Dv/10)*Y6,ire=-B6(Dv/10)*Y6,ore={draw(t,n){const r=ji(n*sre),s=are*r,a=ire*r;t.moveTo(0,-r),t.lineTo(s,a);for(let i=1;i<5;++i){const o=Dv*i/5,c=B6(o),u=Qx(o);t.lineTo(u*r,-c*r),t.lineTo(c*s-u*a,u*s+c*a)}t.closePath()}},B0=ji(3),lre={draw(t,n){const r=-ji(n/(B0*3));t.moveTo(0,r*2),t.lineTo(-B0*r,-r),t.lineTo(B0*r,-r),t.closePath()}},Oa=-.5,Ta=ji(3)/2,O1=1/ji(12),cre=(O1/2+1)*3,dre={draw(t,n){const r=ji(n/cre),s=r/2,a=r*O1,i=s,o=r*O1+r,c=-i,u=o;t.moveTo(s,a),t.lineTo(i,o),t.lineTo(c,u),t.lineTo(Oa*s-Ta*a,Ta*s+Oa*a),t.lineTo(Oa*i-Ta*o,Ta*i+Oa*o),t.lineTo(Oa*c-Ta*u,Ta*c+Oa*u),t.lineTo(Oa*s+Ta*a,Oa*a-Ta*s),t.lineTo(Oa*i+Ta*o,Oa*o-Ta*i),t.lineTo(Oa*c+Ta*u,Oa*u-Ta*c),t.closePath()}};function ure(t,n){let r=null,s=tk(a);t=typeof t=="function"?t:zn(t||rk),n=typeof n=="function"?n:zn(n===void 0?64:+n);function a(){let i;if(r||(r=i=s()),t.apply(this,arguments).draw(r,+n.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(t=typeof i=="function"?i:zn(i),a):t},a.size=function(i){return arguments.length?(n=typeof i=="function"?i:zn(+i),a):n},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Zx(){}function Jx(t,n,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+r)/6)}function Q6(t){this._context=t}Q6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Jx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Jx(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function mre(t){return new Q6(t)}function X6(t){this._context=t}X6.prototype={areaStart:Zx,areaEnd:Zx,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:Jx(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function hre(t){return new X6(t)}function Z6(t){this._context=t}Z6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,s=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:Jx(this,t,n);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};function fre(t){return new Z6(t)}function J6(t){this._context=t}J6.prototype={areaStart:Zx,areaEnd:Zx,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}};function pre(t){return new J6(t)}function RT(t){return t<0?-1:1}function DT(t,n,r){var s=t._x1-t._x0,a=n-t._x1,i=(t._y1-t._y0)/(s||a<0&&-0),o=(r-t._y1)/(a||s<0&&-0),c=(i*a+o*s)/(s+a);return(RT(i)+RT(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(c))||0}function $T(t,n){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-n)/2:n}function z0(t,n,r){var s=t._x0,a=t._y0,i=t._x1,o=t._y1,c=(i-s)/3;t._context.bezierCurveTo(s+c,a+c*n,i-c,o-c*r,i,o)}function eg(t){this._context=t}eg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:z0(this,this._t0,$T(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var r=NaN;if(t=+t,n=+n,!(t===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,z0(this,$T(this,r=DT(this,t,n)),r);break;default:z0(this,this._t0,r=DT(this,t,n));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=r}}};function eB(t){this._context=new tB(t)}(eB.prototype=Object.create(eg.prototype)).point=function(t,n){eg.prototype.point.call(this,n,t)};function tB(t){this._context=t}tB.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,r,s,a,i){this._context.bezierCurveTo(n,t,s,r,i,a)}};function xre(t){return new eg(t)}function gre(t){return new eB(t)}function nB(t){this._context=t}nB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),r===2)this._context.lineTo(t[1],n[1]);else for(var s=FT(t),a=FT(n),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(s[0][i],a[0][i],s[1][i],a[1][i],t[o],n[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}};function FT(t){var n,r=t.length-1,s,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=t[0]+2*t[1],n=1;n<r-1;++n)a[n]=1,i[n]=4,o[n]=4*t[n]+2*t[n+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)s=a[n]/i[n-1],i[n]-=s,o[n]-=s*o[n-1];for(a[r-1]=o[r-1]/i[r-1],n=r-2;n>=0;--n)a[n]=(o[n]-a[n+1])/i[n];for(i[r-1]=(t[r]+a[r-1])/2,n=0;n<r-1;++n)i[n]=2*t[n+1]-a[n+1];return[a,i]}function vre(t){return new nB(t)}function Fv(t,n){this._context=t,this._t=n}Fv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,n)}break}}this._x=t,this._y=n}};function yre(t){return new Fv(t,.5)}function jre(t){return new Fv(t,0)}function bre(t){return new Fv(t,1)}function au(t,n){if((o=t.length)>1)for(var r=1,s,a,i=t[n[0]],o,c=i.length;r<o;++r)for(a=i,i=t[n[r]],s=0;s<c;++s)i[s][1]+=i[s][0]=isNaN(a[s][1])?a[s][0]:a[s][1]}function T1(t){for(var n=t.length,r=new Array(n);--n>=0;)r[n]=n;return r}function wre(t,n){return t[n]}function _re(t){const n=[];return n.key=t,n}function Nre(){var t=zn([]),n=T1,r=au,s=wre;function a(i){var o=Array.from(t.apply(this,arguments),_re),c,u=o.length,m=-1,h;for(const f of i)for(c=0,++m;c<u;++c)(o[c][m]=[0,+s(f,o[c].key,m,i)]).data=f;for(c=0,h=nk(n(o));c<u;++c)o[h[c]].index=c;return r(o,h),o}return a.keys=function(i){return arguments.length?(t=typeof i=="function"?i:zn(Array.from(i)),a):t},a.value=function(i){return arguments.length?(s=typeof i=="function"?i:zn(+i),a):s},a.order=function(i){return arguments.length?(n=i==null?T1:typeof i=="function"?i:zn(Array.from(i)),a):n},a.offset=function(i){return arguments.length?(r=i??au,a):r},a}function Sre(t,n){if((s=t.length)>0){for(var r,s,a=0,i=t[0].length,o;a<i;++a){for(o=r=0;r<s;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<s;++r)t[r][a][1]/=o}au(t,n)}}function Cre(t,n){if((a=t.length)>0){for(var r=0,s=t[n[0]],a,i=s.length;r<i;++r){for(var o=0,c=0;o<a;++o)c+=t[o][r][1]||0;s[r][1]+=s[r][0]=-c/2}au(t,n)}}function kre(t,n){if(!(!((o=t.length)>0)||!((i=(a=t[n[0]]).length)>0))){for(var r=0,s=1,a,i,o;s<i;++s){for(var c=0,u=0,m=0;c<o;++c){for(var h=t[n[c]],f=h[s][1]||0,x=h[s-1][1]||0,j=(f-x)/2,b=0;b<c;++b){var g=t[n[b]],y=g[s][1]||0,C=g[s-1][1]||0;j+=y-C}u+=f,m+=j*f}a[s-1][1]+=a[s-1][0]=r,u&&(r-=m/u)}a[s-1][1]+=a[s-1][0]=r,au(t,n)}}function Th(t){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Th(t)}var Pre=["type","size","sizeType"];function M1(){return M1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},M1.apply(this,arguments)}function LT(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function IT(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?LT(Object(r),!0).forEach(function(s){Are(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LT(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Are(t,n,r){return n=Ere(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Ere(t){var n=Ore(t,"string");return Th(n)=="symbol"?n:n+""}function Ore(t,n){if(Th(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Th(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Tre(t,n){if(t==null)return{};var r=Mre(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Mre(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}var rB={symbolCircle:rk,symbolCross:ere,symbolDiamond:nre,symbolSquare:rre,symbolStar:ore,symbolTriangle:lre,symbolWye:dre},Rre=Math.PI/180,Dre=function(n){var r="symbol".concat(Rv(n));return rB[r]||rk},$re=function(n,r,s){if(r==="area")return n;switch(s){case"cross":return 5*n*n/9;case"diamond":return .5*n*n/Math.sqrt(3);case"square":return n*n;case"star":{var a=18*Rre;return 1.25*n*n*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*n*n/4;case"wye":return(21-10*Math.sqrt(3))*n*n/8;default:return Math.PI*n*n/4}},Fre=function(n,r){rB["symbol".concat(Rv(n))]=r},sk=function(n){var r=n.type,s=r===void 0?"circle":r,a=n.size,i=a===void 0?64:a,o=n.sizeType,c=o===void 0?"area":o,u=Tre(n,Pre),m=IT(IT({},u),{},{type:s,size:i,sizeType:c}),h=function(){var y=Dre(s),C=ure().type(y).size($re(i,c,s));return C()},f=m.className,x=m.cx,j=m.cy,b=Wt(m,!0);return x===+x&&j===+j&&i===+i?le.createElement("path",M1({},b,{className:rn("recharts-symbols",f),transform:"translate(".concat(x,", ").concat(j,")"),d:h()})):null};sk.registerSymbol=Fre;function iu(t){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},iu(t)}function R1(){return R1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},R1.apply(this,arguments)}function qT(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Lre(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?qT(Object(r),!0).forEach(function(s){Mh(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qT(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ire(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function qre(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,aB(s.key),s)}}function Bre(t,n,r){return n&&qre(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zre(t,n,r){return n=tg(n),Vre(t,sB()?Reflect.construct(n,r||[],tg(t).constructor):n.apply(t,r))}function Vre(t,n){if(n&&(iu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ure(t)}function Ure(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sB=function(){return!!t})()}function tg(t){return tg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tg(t)}function Kre(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&D1(t,n)}function D1(t,n){return D1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},D1(t,n)}function Mh(t,n,r){return n=aB(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function aB(t){var n=Wre(t,"string");return iu(n)=="symbol"?n:n+""}function Wre(t,n){if(iu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(iu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ma=32,ak=(function(t){function n(){return Ire(this,n),zre(this,n,arguments)}return Kre(n,t),Bre(n,[{key:"renderIcon",value:function(s){var a=this.props.inactiveColor,i=Ma/2,o=Ma/6,c=Ma/3,u=s.inactive?a:s.color;if(s.type==="plainline")return le.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:s.payload.strokeDasharray,x1:0,y1:i,x2:Ma,y2:i,className:"recharts-legend-icon"});if(s.type==="line")return le.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(i,"h").concat(c,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*c,",").concat(i,`
            H`).concat(Ma,"M").concat(2*c,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(c,",").concat(i),className:"recharts-legend-icon"});if(s.type==="rect")return le.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(Ma/8,"h").concat(Ma,"v").concat(Ma*3/4,"h").concat(-Ma,"z"),className:"recharts-legend-icon"});if(le.isValidElement(s.legendIcon)){var m=Lre({},s);return delete m.legendIcon,le.cloneElement(s.legendIcon,m)}return le.createElement(sk,{fill:u,cx:i,cy:i,size:Ma,sizeType:"diameter",type:s.type})}},{key:"renderItems",value:function(){var s=this,a=this.props,i=a.payload,o=a.iconSize,c=a.layout,u=a.formatter,m=a.inactiveColor,h={x:0,y:0,width:Ma,height:Ma},f={display:c==="horizontal"?"inline-block":"block",marginRight:10},x={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(j,b){var g=j.formatter||u,y=rn(Mh(Mh({"recharts-legend-item":!0},"legend-item-".concat(b),!0),"inactive",j.inactive));if(j.type==="none")return null;var C=Yt(j.value)?null:j.value;fi(!Yt(j.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var k=j.inactive?m:j.color;return le.createElement("li",R1({className:y,style:f,key:"legend-item-".concat(b)},Ac(s.props,j,b)),le.createElement(k1,{width:o,height:o,viewBox:h,style:x},s.renderIcon(j)),le.createElement("span",{className:"recharts-legend-item-text",style:{color:k}},g?g(C,j,b):C))})}},{key:"render",value:function(){var s=this.props,a=s.payload,i=s.layout,o=s.align;if(!a||!a.length)return null;var c={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return le.createElement("ul",{className:"recharts-default-legend",style:c},this.renderItems())}}])})(v.PureComponent);Mh(ak,"displayName","Legend");Mh(ak,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var V0,BT;function Hre(){if(BT)return V0;BT=1;var t=Ov();function n(){this.__data__=new t,this.size=0}return V0=n,V0}var U0,zT;function Gre(){if(zT)return U0;zT=1;function t(n){var r=this.__data__,s=r.delete(n);return this.size=r.size,s}return U0=t,U0}var K0,VT;function Yre(){if(VT)return K0;VT=1;function t(n){return this.__data__.get(n)}return K0=t,K0}var W0,UT;function Qre(){if(UT)return W0;UT=1;function t(n){return this.__data__.has(n)}return W0=t,W0}var H0,KT;function Xre(){if(KT)return H0;KT=1;var t=Ov(),n=YC(),r=QC(),s=200;function a(i,o){var c=this.__data__;if(c instanceof t){var u=c.__data__;if(!n||u.length<s-1)return u.push([i,o]),this.size=++c.size,this;c=this.__data__=new r(u)}return c.set(i,o),this.size=c.size,this}return H0=a,H0}var G0,WT;function iB(){if(WT)return G0;WT=1;var t=Ov(),n=Hre(),r=Gre(),s=Yre(),a=Qre(),i=Xre();function o(c){var u=this.__data__=new t(c);this.size=u.size}return o.prototype.clear=n,o.prototype.delete=r,o.prototype.get=s,o.prototype.has=a,o.prototype.set=i,G0=o,G0}var Y0,HT;function Zre(){if(HT)return Y0;HT=1;var t="__lodash_hash_undefined__";function n(r){return this.__data__.set(r,t),this}return Y0=n,Y0}var Q0,GT;function Jre(){if(GT)return Q0;GT=1;function t(n){return this.__data__.has(n)}return Q0=t,Q0}var X0,YT;function oB(){if(YT)return X0;YT=1;var t=QC(),n=Zre(),r=Jre();function s(a){var i=-1,o=a==null?0:a.length;for(this.__data__=new t;++i<o;)this.add(a[i])}return s.prototype.add=s.prototype.push=n,s.prototype.has=r,X0=s,X0}var Z0,QT;function lB(){if(QT)return Z0;QT=1;function t(n,r){for(var s=-1,a=n==null?0:n.length;++s<a;)if(r(n[s],s,n))return!0;return!1}return Z0=t,Z0}var J0,XT;function cB(){if(XT)return J0;XT=1;function t(n,r){return n.has(r)}return J0=t,J0}var ew,ZT;function dB(){if(ZT)return ew;ZT=1;var t=oB(),n=lB(),r=cB(),s=1,a=2;function i(o,c,u,m,h,f){var x=u&s,j=o.length,b=c.length;if(j!=b&&!(x&&b>j))return!1;var g=f.get(o),y=f.get(c);if(g&&y)return g==c&&y==o;var C=-1,k=!0,N=u&a?new t:void 0;for(f.set(o,c),f.set(c,o);++C<j;){var P=o[C],w=c[C];if(m)var S=x?m(w,P,C,c,o,f):m(P,w,C,o,c,f);if(S!==void 0){if(S)continue;k=!1;break}if(N){if(!n(c,function(E,R){if(!r(N,R)&&(P===E||h(P,E,u,m,f)))return N.push(R)})){k=!1;break}}else if(!(P===w||h(P,w,u,m,f))){k=!1;break}}return f.delete(o),f.delete(c),k}return ew=i,ew}var tw,JT;function ese(){if(JT)return tw;JT=1;var t=Ui(),n=t.Uint8Array;return tw=n,tw}var nw,eM;function tse(){if(eM)return nw;eM=1;function t(n){var r=-1,s=Array(n.size);return n.forEach(function(a,i){s[++r]=[i,a]}),s}return nw=t,nw}var rw,tM;function ik(){if(tM)return rw;tM=1;function t(n){var r=-1,s=Array(n.size);return n.forEach(function(a){s[++r]=a}),s}return rw=t,rw}var sw,nM;function nse(){if(nM)return sw;nM=1;var t=Tf(),n=ese(),r=GC(),s=dB(),a=tse(),i=ik(),o=1,c=2,u="[object Boolean]",m="[object Date]",h="[object Error]",f="[object Map]",x="[object Number]",j="[object RegExp]",b="[object Set]",g="[object String]",y="[object Symbol]",C="[object ArrayBuffer]",k="[object DataView]",N=t?t.prototype:void 0,P=N?N.valueOf:void 0;function w(S,E,R,T,U,M,L){switch(R){case k:if(S.byteLength!=E.byteLength||S.byteOffset!=E.byteOffset)return!1;S=S.buffer,E=E.buffer;case C:return!(S.byteLength!=E.byteLength||!M(new n(S),new n(E)));case u:case m:case x:return r(+S,+E);case h:return S.name==E.name&&S.message==E.message;case j:case g:return S==E+"";case f:var q=a;case b:var $=T&o;if(q||(q=i),S.size!=E.size&&!$)return!1;var D=L.get(S);if(D)return D==E;T|=c,L.set(S,E);var z=s(q(S),q(E),T,U,M,L);return L.delete(S),z;case y:if(P)return P.call(S)==P.call(E)}return!1}return sw=w,sw}var aw,rM;function uB(){if(rM)return aw;rM=1;function t(n,r){for(var s=-1,a=r.length,i=n.length;++s<a;)n[i+s]=r[s];return n}return aw=t,aw}var iw,sM;function rse(){if(sM)return iw;sM=1;var t=uB(),n=ea();function r(s,a,i){var o=a(s);return n(s)?o:t(o,i(s))}return iw=r,iw}var ow,aM;function sse(){if(aM)return ow;aM=1;function t(n,r){for(var s=-1,a=n==null?0:n.length,i=0,o=[];++s<a;){var c=n[s];r(c,s,n)&&(o[i++]=c)}return o}return ow=t,ow}var lw,iM;function ase(){if(iM)return lw;iM=1;function t(){return[]}return lw=t,lw}var cw,oM;function ise(){if(oM)return cw;oM=1;var t=sse(),n=ase(),r=Object.prototype,s=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(o){return o==null?[]:(o=Object(o),t(a(o),function(c){return s.call(o,c)}))}:n;return cw=i,cw}var dw,lM;function ose(){if(lM)return dw;lM=1;function t(n,r){for(var s=-1,a=Array(n);++s<n;)a[s]=r(s);return a}return dw=t,dw}var uw,cM;function lse(){if(cM)return uw;cM=1;var t=Co(),n=ko(),r="[object Arguments]";function s(a){return n(a)&&t(a)==r}return uw=s,uw}var mw,dM;function ok(){if(dM)return mw;dM=1;var t=lse(),n=ko(),r=Object.prototype,s=r.hasOwnProperty,a=r.propertyIsEnumerable,i=t((function(){return arguments})())?t:function(o){return n(o)&&s.call(o,"callee")&&!a.call(o,"callee")};return mw=i,mw}var Ym={exports:{}},hw,uM;function cse(){if(uM)return hw;uM=1;function t(){return!1}return hw=t,hw}Ym.exports;var mM;function mB(){return mM||(mM=1,(function(t,n){var r=Ui(),s=cse(),a=n&&!n.nodeType&&n,i=a&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===a,c=o?r.Buffer:void 0,u=c?c.isBuffer:void 0,m=u||s;t.exports=m})(Ym,Ym.exports)),Ym.exports}var fw,hM;function lk(){if(hM)return fw;hM=1;var t=9007199254740991,n=/^(?:0|[1-9]\d*)$/;function r(s,a){var i=typeof s;return a=a??t,!!a&&(i=="number"||i!="symbol"&&n.test(s))&&s>-1&&s%1==0&&s<a}return fw=r,fw}var pw,fM;function ck(){if(fM)return pw;fM=1;var t=9007199254740991;function n(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=t}return pw=n,pw}var xw,pM;function dse(){if(pM)return xw;pM=1;var t=Co(),n=ck(),r=ko(),s="[object Arguments]",a="[object Array]",i="[object Boolean]",o="[object Date]",c="[object Error]",u="[object Function]",m="[object Map]",h="[object Number]",f="[object Object]",x="[object RegExp]",j="[object Set]",b="[object String]",g="[object WeakMap]",y="[object ArrayBuffer]",C="[object DataView]",k="[object Float32Array]",N="[object Float64Array]",P="[object Int8Array]",w="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",R="[object Uint8ClampedArray]",T="[object Uint16Array]",U="[object Uint32Array]",M={};M[k]=M[N]=M[P]=M[w]=M[S]=M[E]=M[R]=M[T]=M[U]=!0,M[s]=M[a]=M[y]=M[i]=M[C]=M[o]=M[c]=M[u]=M[m]=M[h]=M[f]=M[x]=M[j]=M[b]=M[g]=!1;function L(q){return r(q)&&n(q.length)&&!!M[t(q)]}return xw=L,xw}var gw,xM;function hB(){if(xM)return gw;xM=1;function t(n){return function(r){return n(r)}}return gw=t,gw}var Qm={exports:{}};Qm.exports;var gM;function use(){return gM||(gM=1,(function(t,n){var r=M6(),s=n&&!n.nodeType&&n,a=s&&!0&&t&&!t.nodeType&&t,i=a&&a.exports===s,o=i&&r.process,c=(function(){try{var u=a&&a.require&&a.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}})();t.exports=c})(Qm,Qm.exports)),Qm.exports}var vw,vM;function fB(){if(vM)return vw;vM=1;var t=dse(),n=hB(),r=use(),s=r&&r.isTypedArray,a=s?n(s):t;return vw=a,vw}var yw,yM;function mse(){if(yM)return yw;yM=1;var t=ose(),n=ok(),r=ea(),s=mB(),a=lk(),i=fB(),o=Object.prototype,c=o.hasOwnProperty;function u(m,h){var f=r(m),x=!f&&n(m),j=!f&&!x&&s(m),b=!f&&!x&&!j&&i(m),g=f||x||j||b,y=g?t(m.length,String):[],C=y.length;for(var k in m)(h||c.call(m,k))&&!(g&&(k=="length"||j&&(k=="offset"||k=="parent")||b&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||a(k,C)))&&y.push(k);return y}return yw=u,yw}var jw,jM;function hse(){if(jM)return jw;jM=1;var t=Object.prototype;function n(r){var s=r&&r.constructor,a=typeof s=="function"&&s.prototype||t;return r===a}return jw=n,jw}var bw,bM;function pB(){if(bM)return bw;bM=1;function t(n,r){return function(s){return n(r(s))}}return bw=t,bw}var ww,wM;function fse(){if(wM)return ww;wM=1;var t=pB(),n=t(Object.keys,Object);return ww=n,ww}var _w,_M;function pse(){if(_M)return _w;_M=1;var t=hse(),n=fse(),r=Object.prototype,s=r.hasOwnProperty;function a(i){if(!t(i))return n(i);var o=[];for(var c in Object(i))s.call(i,c)&&c!="constructor"&&o.push(c);return o}return _w=a,_w}var Nw,NM;function Df(){if(NM)return Nw;NM=1;var t=HC(),n=ck();function r(s){return s!=null&&n(s.length)&&!t(s)}return Nw=r,Nw}var Sw,SM;function Lv(){if(SM)return Sw;SM=1;var t=mse(),n=pse(),r=Df();function s(a){return r(a)?t(a):n(a)}return Sw=s,Sw}var Cw,CM;function xse(){if(CM)return Cw;CM=1;var t=rse(),n=ise(),r=Lv();function s(a){return t(a,r,n)}return Cw=s,Cw}var kw,kM;function gse(){if(kM)return kw;kM=1;var t=xse(),n=1,r=Object.prototype,s=r.hasOwnProperty;function a(i,o,c,u,m,h){var f=c&n,x=t(i),j=x.length,b=t(o),g=b.length;if(j!=g&&!f)return!1;for(var y=j;y--;){var C=x[y];if(!(f?C in o:s.call(o,C)))return!1}var k=h.get(i),N=h.get(o);if(k&&N)return k==o&&N==i;var P=!0;h.set(i,o),h.set(o,i);for(var w=f;++y<j;){C=x[y];var S=i[C],E=o[C];if(u)var R=f?u(E,S,C,o,i,h):u(S,E,C,i,o,h);if(!(R===void 0?S===E||m(S,E,c,u,h):R)){P=!1;break}w||(w=C=="constructor")}if(P&&!w){var T=i.constructor,U=o.constructor;T!=U&&"constructor"in i&&"constructor"in o&&!(typeof T=="function"&&T instanceof T&&typeof U=="function"&&U instanceof U)&&(P=!1)}return h.delete(i),h.delete(o),P}return kw=a,kw}var Pw,PM;function vse(){if(PM)return Pw;PM=1;var t=Ic(),n=Ui(),r=t(n,"DataView");return Pw=r,Pw}var Aw,AM;function yse(){if(AM)return Aw;AM=1;var t=Ic(),n=Ui(),r=t(n,"Promise");return Aw=r,Aw}var Ew,EM;function xB(){if(EM)return Ew;EM=1;var t=Ic(),n=Ui(),r=t(n,"Set");return Ew=r,Ew}var Ow,OM;function jse(){if(OM)return Ow;OM=1;var t=Ic(),n=Ui(),r=t(n,"WeakMap");return Ow=r,Ow}var Tw,TM;function bse(){if(TM)return Tw;TM=1;var t=vse(),n=YC(),r=yse(),s=xB(),a=jse(),i=Co(),o=R6(),c="[object Map]",u="[object Object]",m="[object Promise]",h="[object Set]",f="[object WeakMap]",x="[object DataView]",j=o(t),b=o(n),g=o(r),y=o(s),C=o(a),k=i;return(t&&k(new t(new ArrayBuffer(1)))!=x||n&&k(new n)!=c||r&&k(r.resolve())!=m||s&&k(new s)!=h||a&&k(new a)!=f)&&(k=function(N){var P=i(N),w=P==u?N.constructor:void 0,S=w?o(w):"";if(S)switch(S){case j:return x;case b:return c;case g:return m;case y:return h;case C:return f}return P}),Tw=k,Tw}var Mw,MM;function wse(){if(MM)return Mw;MM=1;var t=iB(),n=dB(),r=nse(),s=gse(),a=bse(),i=ea(),o=mB(),c=fB(),u=1,m="[object Arguments]",h="[object Array]",f="[object Object]",x=Object.prototype,j=x.hasOwnProperty;function b(g,y,C,k,N,P){var w=i(g),S=i(y),E=w?h:a(g),R=S?h:a(y);E=E==m?f:E,R=R==m?f:R;var T=E==f,U=R==f,M=E==R;if(M&&o(g)){if(!o(y))return!1;w=!0,T=!1}if(M&&!T)return P||(P=new t),w||c(g)?n(g,y,C,k,N,P):r(g,y,E,C,k,N,P);if(!(C&u)){var L=T&&j.call(g,"__wrapped__"),q=U&&j.call(y,"__wrapped__");if(L||q){var $=L?g.value():g,D=q?y.value():y;return P||(P=new t),N($,D,C,k,P)}}return M?(P||(P=new t),s(g,y,C,k,N,P)):!1}return Mw=b,Mw}var Rw,RM;function dk(){if(RM)return Rw;RM=1;var t=wse(),n=ko();function r(s,a,i,o,c){return s===a?!0:s==null||a==null||!n(s)&&!n(a)?s!==s&&a!==a:t(s,a,i,o,r,c)}return Rw=r,Rw}var Dw,DM;function _se(){if(DM)return Dw;DM=1;var t=iB(),n=dk(),r=1,s=2;function a(i,o,c,u){var m=c.length,h=m,f=!u;if(i==null)return!h;for(i=Object(i);m--;){var x=c[m];if(f&&x[2]?x[1]!==i[x[0]]:!(x[0]in i))return!1}for(;++m<h;){x=c[m];var j=x[0],b=i[j],g=x[1];if(f&&x[2]){if(b===void 0&&!(j in i))return!1}else{var y=new t;if(u)var C=u(b,g,j,i,o,y);if(!(C===void 0?n(g,b,r|s,u,y):C))return!1}}return!0}return Dw=a,Dw}var $w,$M;function gB(){if($M)return $w;$M=1;var t=Dl();function n(r){return r===r&&!t(r)}return $w=n,$w}var Fw,FM;function Nse(){if(FM)return Fw;FM=1;var t=gB(),n=Lv();function r(s){for(var a=n(s),i=a.length;i--;){var o=a[i],c=s[o];a[i]=[o,c,t(c)]}return a}return Fw=r,Fw}var Lw,LM;function vB(){if(LM)return Lw;LM=1;function t(n,r){return function(s){return s==null?!1:s[n]===r&&(r!==void 0||n in Object(s))}}return Lw=t,Lw}var Iw,IM;function Sse(){if(IM)return Iw;IM=1;var t=_se(),n=Nse(),r=vB();function s(a){var i=n(a);return i.length==1&&i[0][2]?r(i[0][0],i[0][1]):function(o){return o===a||t(o,a,i)}}return Iw=s,Iw}var qw,qM;function Cse(){if(qM)return qw;qM=1;function t(n,r){return n!=null&&r in Object(n)}return qw=t,qw}var Bw,BM;function kse(){if(BM)return Bw;BM=1;var t=F6(),n=ok(),r=ea(),s=lk(),a=ck(),i=Mv();function o(c,u,m){u=t(u,c);for(var h=-1,f=u.length,x=!1;++h<f;){var j=i(u[h]);if(!(x=c!=null&&m(c,j)))break;c=c[j]}return x||++h!=f?x:(f=c==null?0:c.length,!!f&&a(f)&&s(j,f)&&(r(c)||n(c)))}return Bw=o,Bw}var zw,zM;function Pse(){if(zM)return zw;zM=1;var t=Cse(),n=kse();function r(s,a){return s!=null&&n(s,a,t)}return zw=r,zw}var Vw,VM;function Ase(){if(VM)return Vw;VM=1;var t=dk(),n=L6(),r=Pse(),s=WC(),a=gB(),i=vB(),o=Mv(),c=1,u=2;function m(h,f){return s(h)&&a(f)?i(o(h),f):function(x){var j=n(x,h);return j===void 0&&j===f?r(x,h):t(f,j,c|u)}}return Vw=m,Vw}var Uw,UM;function zu(){if(UM)return Uw;UM=1;function t(n){return n}return Uw=t,Uw}var Kw,KM;function Ese(){if(KM)return Kw;KM=1;function t(n){return function(r){return r?.[n]}}return Kw=t,Kw}var Ww,WM;function Ose(){if(WM)return Ww;WM=1;var t=ZC();function n(r){return function(s){return t(s,r)}}return Ww=n,Ww}var Hw,HM;function Tse(){if(HM)return Hw;HM=1;var t=Ese(),n=Ose(),r=WC(),s=Mv();function a(i){return r(i)?t(s(i)):n(i)}return Hw=a,Hw}var Gw,GM;function Ki(){if(GM)return Gw;GM=1;var t=Sse(),n=Ase(),r=zu(),s=ea(),a=Tse();function i(o){return typeof o=="function"?o:o==null?r:typeof o=="object"?s(o)?n(o[0],o[1]):t(o):a(o)}return Gw=i,Gw}var Yw,YM;function yB(){if(YM)return Yw;YM=1;function t(n,r,s,a){for(var i=n.length,o=s+(a?1:-1);a?o--:++o<i;)if(r(n[o],o,n))return o;return-1}return Yw=t,Yw}var Qw,QM;function Mse(){if(QM)return Qw;QM=1;function t(n){return n!==n}return Qw=t,Qw}var Xw,XM;function Rse(){if(XM)return Xw;XM=1;function t(n,r,s){for(var a=s-1,i=n.length;++a<i;)if(n[a]===r)return a;return-1}return Xw=t,Xw}var Zw,ZM;function Dse(){if(ZM)return Zw;ZM=1;var t=yB(),n=Mse(),r=Rse();function s(a,i,o){return i===i?r(a,i,o):t(a,n,o)}return Zw=s,Zw}var Jw,JM;function $se(){if(JM)return Jw;JM=1;var t=Dse();function n(r,s){var a=r==null?0:r.length;return!!a&&t(r,s,0)>-1}return Jw=n,Jw}var e_,eR;function Fse(){if(eR)return e_;eR=1;function t(n,r,s){for(var a=-1,i=n==null?0:n.length;++a<i;)if(s(r,n[a]))return!0;return!1}return e_=t,e_}var t_,tR;function Lse(){if(tR)return t_;tR=1;function t(){}return t_=t,t_}var n_,nR;function Ise(){if(nR)return n_;nR=1;var t=xB(),n=Lse(),r=ik(),s=1/0,a=t&&1/r(new t([,-0]))[1]==s?function(i){return new t(i)}:n;return n_=a,n_}var r_,rR;function qse(){if(rR)return r_;rR=1;var t=oB(),n=$se(),r=Fse(),s=cB(),a=Ise(),i=ik(),o=200;function c(u,m,h){var f=-1,x=n,j=u.length,b=!0,g=[],y=g;if(h)b=!1,x=r;else if(j>=o){var C=m?null:a(u);if(C)return i(C);b=!1,x=s,y=new t}else y=m?[]:g;e:for(;++f<j;){var k=u[f],N=m?m(k):k;if(k=h||k!==0?k:0,b&&N===N){for(var P=y.length;P--;)if(y[P]===N)continue e;m&&y.push(N),g.push(k)}else x(y,N,h)||(y!==g&&y.push(N),g.push(k))}return g}return r_=c,r_}var s_,sR;function Bse(){if(sR)return s_;sR=1;var t=Ki(),n=qse();function r(s,a){return s&&s.length?n(s,t(a,2)):[]}return s_=r,s_}var zse=Bse();const aR=kn(zse);function jB(t,n,r){return n===!0?aR(t,r):Yt(n)?aR(t,n):t}function ou(t){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ou(t)}var Vse=["ref"];function iR(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function ro(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?iR(Object(r),!0).forEach(function(s){Iv(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Use(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function oR(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,wB(s.key),s)}}function Kse(t,n,r){return n&&oR(t.prototype,n),r&&oR(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wse(t,n,r){return n=ng(n),Hse(t,bB()?Reflect.construct(n,r||[],ng(t).constructor):n.apply(t,r))}function Hse(t,n){if(n&&(ou(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gse(t)}function Gse(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bB=function(){return!!t})()}function ng(t){return ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ng(t)}function Yse(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&$1(t,n)}function $1(t,n){return $1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},$1(t,n)}function Iv(t,n,r){return n=wB(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function wB(t){var n=Qse(t,"string");return ou(n)=="symbol"?n:n+""}function Qse(t,n){if(ou(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(ou(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Xse(t,n){if(t==null)return{};var r=Zse(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Zse(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function Jse(t){return t.value}function eae(t,n){if(le.isValidElement(t))return le.cloneElement(t,n);if(typeof t=="function")return le.createElement(t,n);n.ref;var r=Xse(n,Vse);return le.createElement(ak,r)}var lR=1,pc=(function(t){function n(){var r;Use(this,n);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=Wse(this,n,[].concat(a)),Iv(r,"lastBoundingBox",{width:-1,height:-1}),r}return Yse(n,t),Kse(n,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();return s.height=this.wrapperNode.offsetHeight,s.width=this.wrapperNode.offsetWidth,s}return null}},{key:"updateBBox",value:function(){var s=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>lR||Math.abs(a.height-this.lastBoundingBox.height)>lR)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,s&&s(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,s&&s(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ro({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(s){var a=this.props,i=a.layout,o=a.align,c=a.verticalAlign,u=a.margin,m=a.chartWidth,h=a.chartHeight,f,x;if(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))if(o==="center"&&i==="vertical"){var j=this.getBBoxSnapshot();f={left:((m||0)-j.width)/2}}else f=o==="right"?{right:u&&u.right||0}:{left:u&&u.left||0};if(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))if(c==="middle"){var b=this.getBBoxSnapshot();x={top:((h||0)-b.height)/2}}else x=c==="bottom"?{bottom:u&&u.bottom||0}:{top:u&&u.top||0};return ro(ro({},f),x)}},{key:"render",value:function(){var s=this,a=this.props,i=a.content,o=a.width,c=a.height,u=a.wrapperStyle,m=a.payloadUniqBy,h=a.payload,f=ro(ro({position:"absolute",width:o||"auto",height:c||"auto"},this.getDefaultPosition(u)),u);return le.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(j){s.wrapperNode=j}},eae(i,ro(ro({},this.props),{},{payload:jB(h,m,Jse)})))}}],[{key:"getWithHeight",value:function(s,a){var i=ro(ro({},this.defaultProps),s.props),o=i.layout;return o==="vertical"&&it(s.props.height)?{height:s.props.height}:o==="horizontal"?{width:s.props.width||a}:null}}])})(v.PureComponent);Iv(pc,"displayName","Legend");Iv(pc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var a_,cR;function tae(){if(cR)return a_;cR=1;var t=Tf(),n=ok(),r=ea(),s=t?t.isConcatSpreadable:void 0;function a(i){return r(i)||n(i)||!!(s&&i&&i[s])}return a_=a,a_}var i_,dR;function _B(){if(dR)return i_;dR=1;var t=uB(),n=tae();function r(s,a,i,o,c){var u=-1,m=s.length;for(i||(i=n),c||(c=[]);++u<m;){var h=s[u];a>0&&i(h)?a>1?r(h,a-1,i,o,c):t(c,h):o||(c[c.length]=h)}return c}return i_=r,i_}var o_,uR;function nae(){if(uR)return o_;uR=1;function t(n){return function(r,s,a){for(var i=-1,o=Object(r),c=a(r),u=c.length;u--;){var m=c[n?u:++i];if(s(o[m],m,o)===!1)break}return r}}return o_=t,o_}var l_,mR;function rae(){if(mR)return l_;mR=1;var t=nae(),n=t();return l_=n,l_}var c_,hR;function NB(){if(hR)return c_;hR=1;var t=rae(),n=Lv();function r(s,a){return s&&t(s,a,n)}return c_=r,c_}var d_,fR;function sae(){if(fR)return d_;fR=1;var t=Df();function n(r,s){return function(a,i){if(a==null)return a;if(!t(a))return r(a,i);for(var o=a.length,c=s?o:-1,u=Object(a);(s?c--:++c<o)&&i(u[c],c,u)!==!1;);return a}}return d_=n,d_}var u_,pR;function uk(){if(pR)return u_;pR=1;var t=NB(),n=sae(),r=n(t);return u_=r,u_}var m_,xR;function SB(){if(xR)return m_;xR=1;var t=uk(),n=Df();function r(s,a){var i=-1,o=n(s)?Array(s.length):[];return t(s,function(c,u,m){o[++i]=a(c,u,m)}),o}return m_=r,m_}var h_,gR;function aae(){if(gR)return h_;gR=1;function t(n,r){var s=n.length;for(n.sort(r);s--;)n[s]=n[s].value;return n}return h_=t,h_}var f_,vR;function iae(){if(vR)return f_;vR=1;var t=qu();function n(r,s){if(r!==s){var a=r!==void 0,i=r===null,o=r===r,c=t(r),u=s!==void 0,m=s===null,h=s===s,f=t(s);if(!m&&!f&&!c&&r>s||c&&u&&h&&!m&&!f||i&&u&&h||!a&&h||!o)return 1;if(!i&&!c&&!f&&r<s||f&&a&&o&&!i&&!c||m&&a&&o||!u&&o||!h)return-1}return 0}return f_=n,f_}var p_,yR;function oae(){if(yR)return p_;yR=1;var t=iae();function n(r,s,a){for(var i=-1,o=r.criteria,c=s.criteria,u=o.length,m=a.length;++i<u;){var h=t(o[i],c[i]);if(h){if(i>=m)return h;var f=a[i];return h*(f=="desc"?-1:1)}}return r.index-s.index}return p_=n,p_}var x_,jR;function lae(){if(jR)return x_;jR=1;var t=XC(),n=ZC(),r=Ki(),s=SB(),a=aae(),i=hB(),o=oae(),c=zu(),u=ea();function m(h,f,x){f.length?f=t(f,function(g){return u(g)?function(y){return n(y,g.length===1?g[0]:g)}:g}):f=[c];var j=-1;f=t(f,i(r));var b=s(h,function(g,y,C){var k=t(f,function(N){return N(g)});return{criteria:k,index:++j,value:g}});return a(b,function(g,y){return o(g,y,x)})}return x_=m,x_}var g_,bR;function cae(){if(bR)return g_;bR=1;function t(n,r,s){switch(s.length){case 0:return n.call(r);case 1:return n.call(r,s[0]);case 2:return n.call(r,s[0],s[1]);case 3:return n.call(r,s[0],s[1],s[2])}return n.apply(r,s)}return g_=t,g_}var v_,wR;function dae(){if(wR)return v_;wR=1;var t=cae(),n=Math.max;function r(s,a,i){return a=n(a===void 0?s.length-1:a,0),function(){for(var o=arguments,c=-1,u=n(o.length-a,0),m=Array(u);++c<u;)m[c]=o[a+c];c=-1;for(var h=Array(a+1);++c<a;)h[c]=o[c];return h[a]=i(m),t(s,this,h)}}return v_=r,v_}var y_,_R;function uae(){if(_R)return y_;_R=1;function t(n){return function(){return n}}return y_=t,y_}var j_,NR;function CB(){if(NR)return j_;NR=1;var t=Ic(),n=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return j_=n,j_}var b_,SR;function mae(){if(SR)return b_;SR=1;var t=uae(),n=CB(),r=zu(),s=n?function(a,i){return n(a,"toString",{configurable:!0,enumerable:!1,value:t(i),writable:!0})}:r;return b_=s,b_}var w_,CR;function hae(){if(CR)return w_;CR=1;var t=800,n=16,r=Date.now;function s(a){var i=0,o=0;return function(){var c=r(),u=n-(c-o);if(o=c,u>0){if(++i>=t)return arguments[0]}else i=0;return a.apply(void 0,arguments)}}return w_=s,w_}var __,kR;function fae(){if(kR)return __;kR=1;var t=mae(),n=hae(),r=n(t);return __=r,__}var N_,PR;function pae(){if(PR)return N_;PR=1;var t=zu(),n=dae(),r=fae();function s(a,i){return r(n(a,i,t),a+"")}return N_=s,N_}var S_,AR;function qv(){if(AR)return S_;AR=1;var t=GC(),n=Df(),r=lk(),s=Dl();function a(i,o,c){if(!s(c))return!1;var u=typeof o;return(u=="number"?n(c)&&r(o,c.length):u=="string"&&o in c)?t(c[o],i):!1}return S_=a,S_}var C_,ER;function xae(){if(ER)return C_;ER=1;var t=_B(),n=lae(),r=pae(),s=qv(),a=r(function(i,o){if(i==null)return[];var c=o.length;return c>1&&s(i,o[0],o[1])?o=[]:c>2&&s(o[0],o[1],o[2])&&(o=[o[0]]),n(i,t(o,1),[])});return C_=a,C_}var gae=xae();const mk=kn(gae);function Rh(t){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Rh(t)}function F1(){return F1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},F1.apply(this,arguments)}function vae(t,n){return wae(t)||bae(t,n)||jae(t,n)||yae()}function yae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jae(t,n){if(t){if(typeof t=="string")return OR(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OR(t,n)}}function OR(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function bae(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function wae(t){if(Array.isArray(t))return t}function TR(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function k_(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?TR(Object(r),!0).forEach(function(s){_ae(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function _ae(t,n,r){return n=Nae(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Nae(t){var n=Sae(t,"string");return Rh(n)=="symbol"?n:n+""}function Sae(t,n){if(Rh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Rh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Cae(t){return Array.isArray(t)&&Dr(t[0])&&Dr(t[1])?t.join(" ~ "):t}var kae=function(n){var r=n.separator,s=r===void 0?" : ":r,a=n.contentStyle,i=a===void 0?{}:a,o=n.itemStyle,c=o===void 0?{}:o,u=n.labelStyle,m=u===void 0?{}:u,h=n.payload,f=n.formatter,x=n.itemSorter,j=n.wrapperClassName,b=n.labelClassName,g=n.label,y=n.labelFormatter,C=n.accessibilityLayer,k=C===void 0?!1:C,N=function(){if(h&&h.length){var L={padding:0,margin:0},q=(x?mk(h,x):h).map(function($,D){if($.type==="none")return null;var z=k_({display:"block",paddingTop:4,paddingBottom:4,color:$.color||"#000"},c),J=$.formatter||f||Cae,I=$.value,X=$.name,ne=I,W=X;if(J&&ne!=null&&W!=null){var H=J(I,X,$,D,h);if(Array.isArray(H)){var fe=vae(H,2);ne=fe[0],W=fe[1]}else ne=H}return le.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:z},Dr(W)?le.createElement("span",{className:"recharts-tooltip-item-name"},W):null,Dr(W)?le.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,le.createElement("span",{className:"recharts-tooltip-item-value"},ne),le.createElement("span",{className:"recharts-tooltip-item-unit"},$.unit||""))});return le.createElement("ul",{className:"recharts-tooltip-item-list",style:L},q)}return null},P=k_({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),w=k_({margin:0},m),S=!hn(g),E=S?g:"",R=rn("recharts-default-tooltip",j),T=rn("recharts-tooltip-label",b);S&&y&&h!==void 0&&h!==null&&(E=y(g,h));var U=k?{role:"status","aria-live":"assertive"}:{};return le.createElement("div",F1({className:R,style:P},U),le.createElement("p",{className:T,style:w},le.isValidElement(E)?E:"".concat(E)),N())};function Dh(t){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Dh(t)}function tx(t,n,r){return n=Pae(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Pae(t){var n=Aae(t,"string");return Dh(n)=="symbol"?n:n+""}function Aae(t,n){if(Dh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Dh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var Mm="recharts-tooltip-wrapper",Eae={visibility:"hidden"};function Oae(t){var n=t.coordinate,r=t.translateX,s=t.translateY;return rn(Mm,tx(tx(tx(tx({},"".concat(Mm,"-right"),it(r)&&n&&it(n.x)&&r>=n.x),"".concat(Mm,"-left"),it(r)&&n&&it(n.x)&&r<n.x),"".concat(Mm,"-bottom"),it(s)&&n&&it(n.y)&&s>=n.y),"".concat(Mm,"-top"),it(s)&&n&&it(n.y)&&s<n.y))}function MR(t){var n=t.allowEscapeViewBox,r=t.coordinate,s=t.key,a=t.offsetTopLeft,i=t.position,o=t.reverseDirection,c=t.tooltipDimension,u=t.viewBox,m=t.viewBoxDimension;if(i&&it(i[s]))return i[s];var h=r[s]-c-a,f=r[s]+a;if(n[s])return o[s]?h:f;if(o[s]){var x=h,j=u[s];return x<j?Math.max(f,u[s]):Math.max(h,u[s])}var b=f+c,g=u[s]+m;return b>g?Math.max(h,u[s]):Math.max(f,u[s])}function Tae(t){var n=t.translateX,r=t.translateY,s=t.useTranslate3d;return{transform:s?"translate3d(".concat(n,"px, ").concat(r,"px, 0)"):"translate(".concat(n,"px, ").concat(r,"px)")}}function Mae(t){var n=t.allowEscapeViewBox,r=t.coordinate,s=t.offsetTopLeft,a=t.position,i=t.reverseDirection,o=t.tooltipBox,c=t.useTranslate3d,u=t.viewBox,m,h,f;return o.height>0&&o.width>0&&r?(h=MR({allowEscapeViewBox:n,coordinate:r,key:"x",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:u,viewBoxDimension:u.width}),f=MR({allowEscapeViewBox:n,coordinate:r,key:"y",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:u,viewBoxDimension:u.height}),m=Tae({translateX:h,translateY:f,useTranslate3d:c})):m=Eae,{cssProperties:m,cssClasses:Oae({translateX:h,translateY:f,coordinate:r})}}function lu(t){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},lu(t)}function RR(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function DR(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?RR(Object(r),!0).forEach(function(s){I1(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Rae(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Dae(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,PB(s.key),s)}}function $ae(t,n,r){return n&&Dae(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fae(t,n,r){return n=rg(n),Lae(t,kB()?Reflect.construct(n,r||[],rg(t).constructor):n.apply(t,r))}function Lae(t,n){if(n&&(lu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iae(t)}function Iae(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kB=function(){return!!t})()}function rg(t){return rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rg(t)}function qae(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&L1(t,n)}function L1(t,n){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},L1(t,n)}function I1(t,n,r){return n=PB(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function PB(t){var n=Bae(t,"string");return lu(n)=="symbol"?n:n+""}function Bae(t,n){if(lu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(lu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var $R=1,zae=(function(t){function n(){var r;Rae(this,n);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=Fae(this,n,[].concat(a)),I1(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),I1(r,"handleKeyDown",function(o){if(o.key==="Escape"){var c,u,m,h;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(c=(u=r.props.coordinate)===null||u===void 0?void 0:u.x)!==null&&c!==void 0?c:0,y:(m=(h=r.props.coordinate)===null||h===void 0?void 0:h.y)!==null&&m!==void 0?m:0}})}}),r}return qae(n,t),$ae(n,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();(Math.abs(s.width-this.state.lastBoundingBox.width)>$R||Math.abs(s.height-this.state.lastBoundingBox.height)>$R)&&this.setState({lastBoundingBox:{width:s.width,height:s.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var s,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var s=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,c=a.animationDuration,u=a.animationEasing,m=a.children,h=a.coordinate,f=a.hasPayload,x=a.isAnimationActive,j=a.offset,b=a.position,g=a.reverseDirection,y=a.useTranslate3d,C=a.viewBox,k=a.wrapperStyle,N=Mae({allowEscapeViewBox:o,coordinate:h,offsetTopLeft:j,position:b,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:C}),P=N.cssClasses,w=N.cssProperties,S=DR(DR({transition:x&&i?"transform ".concat(c,"ms ").concat(u):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},k);return le.createElement("div",{tabIndex:-1,className:P,style:S,ref:function(R){s.wrapperNode=R}},m)}}])})(v.PureComponent),Vae=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Vu={isSsr:Vae()};function cu(t){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},cu(t)}function FR(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function LR(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?FR(Object(r),!0).forEach(function(s){hk(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Uae(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Kae(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,EB(s.key),s)}}function Wae(t,n,r){return n&&Kae(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hae(t,n,r){return n=sg(n),Gae(t,AB()?Reflect.construct(n,r||[],sg(t).constructor):n.apply(t,r))}function Gae(t,n){if(n&&(cu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yae(t)}function Yae(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AB=function(){return!!t})()}function sg(t){return sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sg(t)}function Qae(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&q1(t,n)}function q1(t,n){return q1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},q1(t,n)}function hk(t,n,r){return n=EB(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function EB(t){var n=Xae(t,"string");return cu(n)=="symbol"?n:n+""}function Xae(t,n){if(cu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(cu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Zae(t){return t.dataKey}function Jae(t,n){return le.isValidElement(t)?le.cloneElement(t,n):typeof t=="function"?le.createElement(t,n):le.createElement(kae,n)}var ri=(function(t){function n(){return Uae(this,n),Hae(this,n,arguments)}return Qae(n,t),Wae(n,[{key:"render",value:function(){var s=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,c=a.animationDuration,u=a.animationEasing,m=a.content,h=a.coordinate,f=a.filterNull,x=a.isAnimationActive,j=a.offset,b=a.payload,g=a.payloadUniqBy,y=a.position,C=a.reverseDirection,k=a.useTranslate3d,N=a.viewBox,P=a.wrapperStyle,w=b??[];f&&w.length&&(w=jB(b.filter(function(E){return E.value!=null&&(E.hide!==!0||s.props.includeHidden)}),g,Zae));var S=w.length>0;return le.createElement(zae,{allowEscapeViewBox:o,animationDuration:c,animationEasing:u,isAnimationActive:x,active:i,coordinate:h,hasPayload:S,offset:j,position:y,reverseDirection:C,useTranslate3d:k,viewBox:N,wrapperStyle:P},Jae(m,LR(LR({},this.props),{},{payload:w})))}}])})(v.PureComponent);hk(ri,"displayName","Tooltip");hk(ri,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Vu.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var P_,IR;function eie(){if(IR)return P_;IR=1;var t=Ui(),n=function(){return t.Date.now()};return P_=n,P_}var A_,qR;function tie(){if(qR)return A_;qR=1;var t=/\s/;function n(r){for(var s=r.length;s--&&t.test(r.charAt(s)););return s}return A_=n,A_}var E_,BR;function nie(){if(BR)return E_;BR=1;var t=tie(),n=/^\s+/;function r(s){return s&&s.slice(0,t(s)+1).replace(n,"")}return E_=r,E_}var O_,zR;function OB(){if(zR)return O_;zR=1;var t=nie(),n=Dl(),r=qu(),s=NaN,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,c=parseInt;function u(m){if(typeof m=="number")return m;if(r(m))return s;if(n(m)){var h=typeof m.valueOf=="function"?m.valueOf():m;m=n(h)?h+"":h}if(typeof m!="string")return m===0?m:+m;m=t(m);var f=i.test(m);return f||o.test(m)?c(m.slice(2),f?2:8):a.test(m)?s:+m}return O_=u,O_}var T_,VR;function rie(){if(VR)return T_;VR=1;var t=Dl(),n=eie(),r=OB(),s="Expected a function",a=Math.max,i=Math.min;function o(c,u,m){var h,f,x,j,b,g,y=0,C=!1,k=!1,N=!0;if(typeof c!="function")throw new TypeError(s);u=r(u)||0,t(m)&&(C=!!m.leading,k="maxWait"in m,x=k?a(r(m.maxWait)||0,u):x,N="trailing"in m?!!m.trailing:N);function P(q){var $=h,D=f;return h=f=void 0,y=q,j=c.apply(D,$),j}function w(q){return y=q,b=setTimeout(R,u),C?P(q):j}function S(q){var $=q-g,D=q-y,z=u-$;return k?i(z,x-D):z}function E(q){var $=q-g,D=q-y;return g===void 0||$>=u||$<0||k&&D>=x}function R(){var q=n();if(E(q))return T(q);b=setTimeout(R,S(q))}function T(q){return b=void 0,N&&h?P(q):(h=f=void 0,j)}function U(){b!==void 0&&clearTimeout(b),y=0,h=g=f=b=void 0}function M(){return b===void 0?j:T(n())}function L(){var q=n(),$=E(q);if(h=arguments,f=this,g=q,$){if(b===void 0)return w(g);if(k)return clearTimeout(b),b=setTimeout(R,u),P(g)}return b===void 0&&(b=setTimeout(R,u)),j}return L.cancel=U,L.flush=M,L}return T_=o,T_}var M_,UR;function sie(){if(UR)return M_;UR=1;var t=rie(),n=Dl(),r="Expected a function";function s(a,i,o){var c=!0,u=!0;if(typeof a!="function")throw new TypeError(r);return n(o)&&(c="leading"in o?!!o.leading:c,u="trailing"in o?!!o.trailing:u),t(a,i,{leading:c,maxWait:i,trailing:u})}return M_=s,M_}var aie=sie();const TB=kn(aie);function $h(t){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$h(t)}function KR(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function nx(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?KR(Object(r),!0).forEach(function(s){iie(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function iie(t,n,r){return n=oie(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function oie(t){var n=lie(t,"string");return $h(n)=="symbol"?n:n+""}function lie(t,n){if($h(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if($h(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function cie(t,n){return hie(t)||mie(t,n)||uie(t,n)||die()}function die(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uie(t,n){if(t){if(typeof t=="string")return WR(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WR(t,n)}}function WR(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function mie(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function hie(t){if(Array.isArray(t))return t}var HR=v.forwardRef(function(t,n){var r=t.aspect,s=t.initialDimension,a=s===void 0?{width:-1,height:-1}:s,i=t.width,o=i===void 0?"100%":i,c=t.height,u=c===void 0?"100%":c,m=t.minWidth,h=m===void 0?0:m,f=t.minHeight,x=t.maxHeight,j=t.children,b=t.debounce,g=b===void 0?0:b,y=t.id,C=t.className,k=t.onResize,N=t.style,P=N===void 0?{}:N,w=v.useRef(null),S=v.useRef();S.current=k,v.useImperativeHandle(n,function(){return Object.defineProperty(w.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),w.current},configurable:!0})});var E=v.useState({containerWidth:a.width,containerHeight:a.height}),R=cie(E,2),T=R[0],U=R[1],M=v.useCallback(function(q,$){U(function(D){var z=Math.round(q),J=Math.round($);return D.containerWidth===z&&D.containerHeight===J?D:{containerWidth:z,containerHeight:J}})},[]);v.useEffect(function(){var q=function(X){var ne,W=X[0].contentRect,H=W.width,fe=W.height;M(H,fe),(ne=S.current)===null||ne===void 0||ne.call(S,H,fe)};g>0&&(q=TB(q,g,{trailing:!0,leading:!1}));var $=new ResizeObserver(q),D=w.current.getBoundingClientRect(),z=D.width,J=D.height;return M(z,J),$.observe(w.current),function(){$.disconnect()}},[M,g]);var L=v.useMemo(function(){var q=T.containerWidth,$=T.containerHeight;if(q<0||$<0)return null;fi(lc(o)||lc(u),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,u),fi(!r||r>0,"The aspect(%s) must be greater than zero.",r);var D=lc(o)?q:o,z=lc(u)?$:u;r&&r>0&&(D?z=D/r:z&&(D=z*r),x&&z>x&&(z=x)),fi(D>0||z>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,D,z,o,u,h,f,r);var J=!Array.isArray(j)&&fo(j.type).endsWith("Chart");return le.Children.map(j,function(I){return le.isValidElement(I)?v.cloneElement(I,nx({width:D,height:z},J?{style:nx({height:"100%",width:"100%",maxHeight:z,maxWidth:D},I.props.style)}:{})):I})},[r,j,u,x,f,h,T,o]);return le.createElement("div",{id:y?"".concat(y):void 0,className:rn("recharts-responsive-container",C),style:nx(nx({},P),{},{width:o,height:u,minWidth:h,minHeight:f,maxHeight:x}),ref:w},L)}),Bv=function(n){return null};Bv.displayName="Cell";function Fh(t){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Fh(t)}function GR(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function B1(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?GR(Object(r),!0).forEach(function(s){fie(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function fie(t,n,r){return n=pie(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function pie(t){var n=xie(t,"string");return Fh(n)=="symbol"?n:n+""}function xie(t,n){if(Fh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Fh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var yd={widthCache:{},cacheCount:0},gie=2e3,vie={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},YR="recharts_measurement_span";function yie(t){var n=B1({},t);return Object.keys(n).forEach(function(r){n[r]||delete n[r]}),n}var rh=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n==null||Vu.isSsr)return{width:0,height:0};var s=yie(r),a=JSON.stringify({text:n,copyStyle:s});if(yd.widthCache[a])return yd.widthCache[a];try{var i=document.getElementById(YR);i||(i=document.createElement("span"),i.setAttribute("id",YR),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=B1(B1({},vie),s);Object.assign(i.style,o),i.textContent="".concat(n);var c=i.getBoundingClientRect(),u={width:c.width,height:c.height};return yd.widthCache[a]=u,++yd.cacheCount>gie&&(yd.cacheCount=0,yd.widthCache={}),u}catch{return{width:0,height:0}}},jie=function(n){return{top:n.top+window.scrollY-document.documentElement.clientTop,left:n.left+window.scrollX-document.documentElement.clientLeft}};function Lh(t){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Lh(t)}function ag(t,n){return Nie(t)||_ie(t,n)||wie(t,n)||bie()}function bie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wie(t,n){if(t){if(typeof t=="string")return QR(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QR(t,n)}}function QR(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function _ie(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function Nie(t){if(Array.isArray(t))return t}function Sie(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function XR(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,kie(s.key),s)}}function Cie(t,n,r){return n&&XR(t.prototype,n),r&&XR(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kie(t){var n=Pie(t,"string");return Lh(n)=="symbol"?n:n+""}function Pie(t,n){if(Lh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Lh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ZR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,JR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Aie=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Eie=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,MB={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Oie=Object.keys(MB),Pd="NaN";function Tie(t,n){return t*MB[n]}var rx=(function(){function t(n,r){Sie(this,t),this.num=n,this.unit=r,this.num=n,this.unit=r,Number.isNaN(n)&&(this.unit=""),r!==""&&!Aie.test(r)&&(this.num=NaN,this.unit=""),Oie.includes(r)&&(this.num=Tie(n,r),this.unit="px")}return Cie(t,[{key:"add",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var s,a=(s=Eie.exec(r))!==null&&s!==void 0?s:[],i=ag(a,3),o=i[1],c=i[2];return new t(parseFloat(o),c??"")}}])})();function RB(t){if(t.includes(Pd))return Pd;for(var n=t;n.includes("*")||n.includes("/");){var r,s=(r=ZR.exec(n))!==null&&r!==void 0?r:[],a=ag(s,4),i=a[1],o=a[2],c=a[3],u=rx.parse(i??""),m=rx.parse(c??""),h=o==="*"?u.multiply(m):u.divide(m);if(h.isNaN())return Pd;n=n.replace(ZR,h.toString())}for(;n.includes("+")||/.-\d+(?:\.\d+)?/.test(n);){var f,x=(f=JR.exec(n))!==null&&f!==void 0?f:[],j=ag(x,4),b=j[1],g=j[2],y=j[3],C=rx.parse(b??""),k=rx.parse(y??""),N=g==="+"?C.add(k):C.subtract(k);if(N.isNaN())return Pd;n=n.replace(JR,N.toString())}return n}var e4=/\(([^()]*)\)/;function Mie(t){for(var n=t;n.includes("(");){var r=e4.exec(n),s=ag(r,2),a=s[1];n=n.replace(e4,RB(a))}return n}function Rie(t){var n=t.replace(/\s+/g,"");return n=Mie(n),n=RB(n),n}function Die(t){try{return Rie(t)}catch{return Pd}}function R_(t){var n=Die(t.slice(5,-1));return n===Pd?"":n}var $ie=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Fie=["dx","dy","angle","className","breakAll"];function z1(){return z1=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},z1.apply(this,arguments)}function t4(t,n){if(t==null)return{};var r=Lie(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Lie(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function n4(t,n){return zie(t)||Bie(t,n)||qie(t,n)||Iie()}function Iie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qie(t,n){if(t){if(typeof t=="string")return r4(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r4(t,n)}}function r4(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function Bie(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function zie(t){if(Array.isArray(t))return t}var DB=/[ \f\n\r\t\v\u2028\u2029]+/,$B=function(n){var r=n.children,s=n.breakAll,a=n.style;try{var i=[];hn(r)||(s?i=r.toString().split(""):i=r.toString().split(DB));var o=i.map(function(u){return{word:u,width:rh(u,a).width}}),c=s?0:rh("",a).width;return{wordsWithComputedWidth:o,spaceWidth:c}}catch{return null}},Vie=function(n,r,s,a,i){var o=n.maxLines,c=n.children,u=n.style,m=n.breakAll,h=it(o),f=c,x=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D.reduce(function(z,J){var I=J.word,X=J.width,ne=z[z.length-1];if(ne&&(a==null||i||ne.width+X+s<Number(a)))ne.words.push(I),ne.width+=X+s;else{var W={words:[I],width:X};z.push(W)}return z},[])},j=x(r),b=function(D){return D.reduce(function(z,J){return z.width>J.width?z:J})};if(!h)return j;for(var g="",y=function(D){var z=f.slice(0,D),J=$B({breakAll:m,style:u,children:z+g}).wordsWithComputedWidth,I=x(J),X=I.length>o||b(I).width>Number(a);return[X,I]},C=0,k=f.length-1,N=0,P;C<=k&&N<=f.length-1;){var w=Math.floor((C+k)/2),S=w-1,E=y(S),R=n4(E,2),T=R[0],U=R[1],M=y(w),L=n4(M,1),q=L[0];if(!T&&!q&&(C=w+1),T&&q&&(k=w-1),!T&&q){P=U;break}N++}return P||j},s4=function(n){var r=hn(n)?[]:n.toString().split(DB);return[{words:r}]},Uie=function(n){var r=n.width,s=n.scaleToFit,a=n.children,i=n.style,o=n.breakAll,c=n.maxLines;if((r||s)&&!Vu.isSsr){var u,m,h=$B({breakAll:o,children:a,style:i});if(h){var f=h.wordsWithComputedWidth,x=h.spaceWidth;u=f,m=x}else return s4(a);return Vie({breakAll:o,children:a,maxLines:c,style:i},u,m,r,s)}return s4(a)},a4="#808080",Ec=function(n){var r=n.x,s=r===void 0?0:r,a=n.y,i=a===void 0?0:a,o=n.lineHeight,c=o===void 0?"1em":o,u=n.capHeight,m=u===void 0?"0.71em":u,h=n.scaleToFit,f=h===void 0?!1:h,x=n.textAnchor,j=x===void 0?"start":x,b=n.verticalAnchor,g=b===void 0?"end":b,y=n.fill,C=y===void 0?a4:y,k=t4(n,$ie),N=v.useMemo(function(){return Uie({breakAll:k.breakAll,children:k.children,maxLines:k.maxLines,scaleToFit:f,style:k.style,width:k.width})},[k.breakAll,k.children,k.maxLines,f,k.style,k.width]),P=k.dx,w=k.dy,S=k.angle,E=k.className,R=k.breakAll,T=t4(k,Fie);if(!Dr(s)||!Dr(i))return null;var U=s+(it(P)?P:0),M=i+(it(w)?w:0),L;switch(g){case"start":L=R_("calc(".concat(m,")"));break;case"middle":L=R_("calc(".concat((N.length-1)/2," * -").concat(c," + (").concat(m," / 2))"));break;default:L=R_("calc(".concat(N.length-1," * -").concat(c,")"));break}var q=[];if(f){var $=N[0].width,D=k.width;q.push("scale(".concat((it(D)?D/$:1)/$,")"))}return S&&q.push("rotate(".concat(S,", ").concat(U,", ").concat(M,")")),q.length&&(T.transform=q.join(" ")),le.createElement("text",z1({},Wt(T,!0),{x:U,y:M,className:rn("recharts-text",E),textAnchor:j,fill:C.includes("url")?a4:C}),N.map(function(z,J){var I=z.words.join(R?"":" ");return le.createElement("tspan",{x:U,dy:J===0?L:c,key:"".concat(I,"-").concat(J)},I)}))};function gl(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Kie(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function fk(t){let n,r,s;t.length!==2?(n=gl,r=(c,u)=>gl(t(c),u),s=(c,u)=>t(c)-u):(n=t===gl||t===Kie?t:Wie,r=t,s=t);function a(c,u,m=0,h=c.length){if(m<h){if(n(u,u)!==0)return h;do{const f=m+h>>>1;r(c[f],u)<0?m=f+1:h=f}while(m<h)}return m}function i(c,u,m=0,h=c.length){if(m<h){if(n(u,u)!==0)return h;do{const f=m+h>>>1;r(c[f],u)<=0?m=f+1:h=f}while(m<h)}return m}function o(c,u,m=0,h=c.length){const f=a(c,u,m,h-1);return f>m&&s(c[f-1],u)>-s(c[f],u)?f-1:f}return{left:a,center:o,right:i}}function Wie(){return 0}function FB(t){return t===null?NaN:+t}function*Hie(t,n){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const Gie=fk(gl),$f=Gie.right;fk(FB).center;class i4 extends Map{constructor(n,r=Xie){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[s,a]of n)this.set(s,a)}get(n){return super.get(o4(this,n))}has(n){return super.has(o4(this,n))}set(n,r){return super.set(Yie(this,n),r)}delete(n){return super.delete(Qie(this,n))}}function o4({_intern:t,_key:n},r){const s=n(r);return t.has(s)?t.get(s):r}function Yie({_intern:t,_key:n},r){const s=n(r);return t.has(s)?t.get(s):(t.set(s,r),r)}function Qie({_intern:t,_key:n},r){const s=n(r);return t.has(s)&&(r=t.get(s),t.delete(s)),r}function Xie(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Zie(t=gl){if(t===gl)return LB;if(typeof t!="function")throw new TypeError("compare is not a function");return(n,r)=>{const s=t(n,r);return s||s===0?s:(t(r,r)===0)-(t(n,n)===0)}}function LB(t,n){return(t==null||!(t>=t))-(n==null||!(n>=n))||(t<n?-1:t>n?1:0)}const Jie=Math.sqrt(50),eoe=Math.sqrt(10),toe=Math.sqrt(2);function ig(t,n,r){const s=(n-t)/Math.max(0,r),a=Math.floor(Math.log10(s)),i=s/Math.pow(10,a),o=i>=Jie?10:i>=eoe?5:i>=toe?2:1;let c,u,m;return a<0?(m=Math.pow(10,-a)/o,c=Math.round(t*m),u=Math.round(n*m),c/m<t&&++c,u/m>n&&--u,m=-m):(m=Math.pow(10,a)*o,c=Math.round(t/m),u=Math.round(n/m),c*m<t&&++c,u*m>n&&--u),u<c&&.5<=r&&r<2?ig(t,n,r*2):[c,u,m]}function V1(t,n,r){if(n=+n,t=+t,r=+r,!(r>0))return[];if(t===n)return[t];const s=n<t,[a,i,o]=s?ig(n,t,r):ig(t,n,r);if(!(i>=a))return[];const c=i-a+1,u=new Array(c);if(s)if(o<0)for(let m=0;m<c;++m)u[m]=(i-m)/-o;else for(let m=0;m<c;++m)u[m]=(i-m)*o;else if(o<0)for(let m=0;m<c;++m)u[m]=(a+m)/-o;else for(let m=0;m<c;++m)u[m]=(a+m)*o;return u}function U1(t,n,r){return n=+n,t=+t,r=+r,ig(t,n,r)[2]}function K1(t,n,r){n=+n,t=+t,r=+r;const s=n<t,a=s?U1(n,t,r):U1(t,n,r);return(s?-1:1)*(a<0?1/-a:a)}function l4(t,n){let r;for(const s of t)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function c4(t,n){let r;for(const s of t)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function IB(t,n,r=0,s=1/0,a){if(n=Math.floor(n),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(t.length-1,s)),!(r<=n&&n<=s))return t;for(a=a===void 0?LB:Zie(a);s>r;){if(s-r>600){const u=s-r+1,m=n-r+1,h=Math.log(u),f=.5*Math.exp(2*h/3),x=.5*Math.sqrt(h*f*(u-f)/u)*(m-u/2<0?-1:1),j=Math.max(r,Math.floor(n-m*f/u+x)),b=Math.min(s,Math.floor(n+(u-m)*f/u+x));IB(t,n,j,b,a)}const i=t[n];let o=r,c=s;for(Rm(t,r,n),a(t[s],i)>0&&Rm(t,r,s);o<c;){for(Rm(t,o,c),++o,--c;a(t[o],i)<0;)++o;for(;a(t[c],i)>0;)--c}a(t[r],i)===0?Rm(t,r,c):(++c,Rm(t,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}return t}function Rm(t,n,r){const s=t[n];t[n]=t[r],t[r]=s}function noe(t,n,r){if(t=Float64Array.from(Hie(t)),!(!(s=t.length)||isNaN(n=+n))){if(n<=0||s<2)return c4(t);if(n>=1)return l4(t);var s,a=(s-1)*n,i=Math.floor(a),o=l4(IB(t,i).subarray(0,i+1)),c=c4(t.subarray(i+1));return o+(c-o)*(a-i)}}function roe(t,n,r=FB){if(!(!(s=t.length)||isNaN(n=+n))){if(n<=0||s<2)return+r(t[0],0,t);if(n>=1)return+r(t[s-1],s-1,t);var s,a=(s-1)*n,i=Math.floor(a),o=+r(t[i],i,t),c=+r(t[i+1],i+1,t);return o+(c-o)*(a-i)}}function soe(t,n,r){t=+t,n=+n,r=(a=arguments.length)<2?(n=t,t=0,1):a<3?1:+r;for(var s=-1,a=Math.max(0,Math.ceil((n-t)/r))|0,i=new Array(a);++s<a;)i[s]=t+s*r;return i}function Ua(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function Po(t,n){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const W1=Symbol("implicit");function pk(){var t=new i4,n=[],r=[],s=W1;function a(i){let o=t.get(i);if(o===void 0){if(s!==W1)return s;t.set(i,o=n.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return n.slice();n=[],t=new i4;for(const o of i)t.has(o)||t.set(o,n.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return pk(n,r).unknown(s)},Ua.apply(a,arguments),a}function Ih(){var t=pk().unknown(void 0),n=t.domain,r=t.range,s=0,a=1,i,o,c=!1,u=0,m=0,h=.5;delete t.unknown;function f(){var x=n().length,j=a<s,b=j?a:s,g=j?s:a;i=(g-b)/Math.max(1,x-u+m*2),c&&(i=Math.floor(i)),b+=(g-b-i*(x-u))*h,o=i*(1-u),c&&(b=Math.round(b),o=Math.round(o));var y=soe(x).map(function(C){return b+i*C});return r(j?y.reverse():y)}return t.domain=function(x){return arguments.length?(n(x),f()):n()},t.range=function(x){return arguments.length?([s,a]=x,s=+s,a=+a,f()):[s,a]},t.rangeRound=function(x){return[s,a]=x,s=+s,a=+a,c=!0,f()},t.bandwidth=function(){return o},t.step=function(){return i},t.round=function(x){return arguments.length?(c=!!x,f()):c},t.padding=function(x){return arguments.length?(u=Math.min(1,m=+x),f()):u},t.paddingInner=function(x){return arguments.length?(u=Math.min(1,x),f()):u},t.paddingOuter=function(x){return arguments.length?(m=+x,f()):m},t.align=function(x){return arguments.length?(h=Math.max(0,Math.min(1,x)),f()):h},t.copy=function(){return Ih(n(),[s,a]).round(c).paddingInner(u).paddingOuter(m).align(h)},Ua.apply(f(),arguments)}function qB(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return qB(n())},t}function sh(){return qB(Ih.apply(null,arguments).paddingInner(1))}function xk(t,n,r){t.prototype=n.prototype=r,r.constructor=t}function BB(t,n){var r=Object.create(t.prototype);for(var s in n)r[s]=n[s];return r}function Ff(){}var qh=.7,og=1/qh,Vd="\\s*([+-]?\\d+)\\s*",Bh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",aoe=/^#([0-9a-f]{3,8})$/,ioe=new RegExp(`^rgb\\(${Vd},${Vd},${Vd}\\)$`),ooe=new RegExp(`^rgb\\(${Fi},${Fi},${Fi}\\)$`),loe=new RegExp(`^rgba\\(${Vd},${Vd},${Vd},${Bh}\\)$`),coe=new RegExp(`^rgba\\(${Fi},${Fi},${Fi},${Bh}\\)$`),doe=new RegExp(`^hsl\\(${Bh},${Fi},${Fi}\\)$`),uoe=new RegExp(`^hsla\\(${Bh},${Fi},${Fi},${Bh}\\)$`),d4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xk(Ff,zh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:u4,formatHex:u4,formatHex8:moe,formatHsl:hoe,formatRgb:m4,toString:m4});function u4(){return this.rgb().formatHex()}function moe(){return this.rgb().formatHex8()}function hoe(){return zB(this).formatHsl()}function m4(){return this.rgb().formatRgb()}function zh(t){var n,r;return t=(t+"").trim().toLowerCase(),(n=aoe.exec(t))?(r=n[1].length,n=parseInt(n[1],16),r===6?h4(n):r===3?new Qs(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?sx(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?sx(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=ioe.exec(t))?new Qs(n[1],n[2],n[3],1):(n=ooe.exec(t))?new Qs(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=loe.exec(t))?sx(n[1],n[2],n[3],n[4]):(n=coe.exec(t))?sx(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=doe.exec(t))?x4(n[1],n[2]/100,n[3]/100,1):(n=uoe.exec(t))?x4(n[1],n[2]/100,n[3]/100,n[4]):d4.hasOwnProperty(t)?h4(d4[t]):t==="transparent"?new Qs(NaN,NaN,NaN,0):null}function h4(t){return new Qs(t>>16&255,t>>8&255,t&255,1)}function sx(t,n,r,s){return s<=0&&(t=n=r=NaN),new Qs(t,n,r,s)}function foe(t){return t instanceof Ff||(t=zh(t)),t?(t=t.rgb(),new Qs(t.r,t.g,t.b,t.opacity)):new Qs}function H1(t,n,r,s){return arguments.length===1?foe(t):new Qs(t,n,r,s??1)}function Qs(t,n,r,s){this.r=+t,this.g=+n,this.b=+r,this.opacity=+s}xk(Qs,H1,BB(Ff,{brighter(t){return t=t==null?og:Math.pow(og,t),new Qs(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?qh:Math.pow(qh,t),new Qs(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Qs(xc(this.r),xc(this.g),xc(this.b),lg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:f4,formatHex:f4,formatHex8:poe,formatRgb:p4,toString:p4}));function f4(){return`#${cc(this.r)}${cc(this.g)}${cc(this.b)}`}function poe(){return`#${cc(this.r)}${cc(this.g)}${cc(this.b)}${cc((isNaN(this.opacity)?1:this.opacity)*255)}`}function p4(){const t=lg(this.opacity);return`${t===1?"rgb(":"rgba("}${xc(this.r)}, ${xc(this.g)}, ${xc(this.b)}${t===1?")":`, ${t})`}`}function lg(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function xc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function cc(t){return t=xc(t),(t<16?"0":"")+t.toString(16)}function x4(t,n,r,s){return s<=0?t=n=r=NaN:r<=0||r>=1?t=n=NaN:n<=0&&(t=NaN),new li(t,n,r,s)}function zB(t){if(t instanceof li)return new li(t.h,t.s,t.l,t.opacity);if(t instanceof Ff||(t=zh(t)),!t)return new li;if(t instanceof li)return t;t=t.rgb();var n=t.r/255,r=t.g/255,s=t.b/255,a=Math.min(n,r,s),i=Math.max(n,r,s),o=NaN,c=i-a,u=(i+a)/2;return c?(n===i?o=(r-s)/c+(r<s)*6:r===i?o=(s-n)/c+2:o=(n-r)/c+4,c/=u<.5?i+a:2-i-a,o*=60):c=u>0&&u<1?0:o,new li(o,c,u,t.opacity)}function xoe(t,n,r,s){return arguments.length===1?zB(t):new li(t,n,r,s??1)}function li(t,n,r,s){this.h=+t,this.s=+n,this.l=+r,this.opacity=+s}xk(li,xoe,BB(Ff,{brighter(t){return t=t==null?og:Math.pow(og,t),new li(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?qh:Math.pow(qh,t),new li(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*n,a=2*r-s;return new Qs(D_(t>=240?t-240:t+120,a,s),D_(t,a,s),D_(t<120?t+240:t-120,a,s),this.opacity)},clamp(){return new li(g4(this.h),ax(this.s),ax(this.l),lg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=lg(this.opacity);return`${t===1?"hsl(":"hsla("}${g4(this.h)}, ${ax(this.s)*100}%, ${ax(this.l)*100}%${t===1?")":`, ${t})`}`}}));function g4(t){return t=(t||0)%360,t<0?t+360:t}function ax(t){return Math.max(0,Math.min(1,t||0))}function D_(t,n,r){return(t<60?n+(r-n)*t/60:t<180?r:t<240?n+(r-n)*(240-t)/60:n)*255}const gk=t=>()=>t;function goe(t,n){return function(r){return t+r*n}}function voe(t,n,r){return t=Math.pow(t,r),n=Math.pow(n,r)-t,r=1/r,function(s){return Math.pow(t+s*n,r)}}function yoe(t){return(t=+t)==1?VB:function(n,r){return r-n?voe(n,r,t):gk(isNaN(n)?r:n)}}function VB(t,n){var r=n-t;return r?goe(t,r):gk(isNaN(t)?n:t)}const v4=(function t(n){var r=yoe(n);function s(a,i){var o=r((a=H1(a)).r,(i=H1(i)).r),c=r(a.g,i.g),u=r(a.b,i.b),m=VB(a.opacity,i.opacity);return function(h){return a.r=o(h),a.g=c(h),a.b=u(h),a.opacity=m(h),a+""}}return s.gamma=t,s})(1);function joe(t,n){n||(n=[]);var r=t?Math.min(n.length,t.length):0,s=n.slice(),a;return function(i){for(a=0;a<r;++a)s[a]=t[a]*(1-i)+n[a]*i;return s}}function boe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function woe(t,n){var r=n?n.length:0,s=t?Math.min(r,t.length):0,a=new Array(s),i=new Array(r),o;for(o=0;o<s;++o)a[o]=Uu(t[o],n[o]);for(;o<r;++o)i[o]=n[o];return function(c){for(o=0;o<s;++o)i[o]=a[o](c);return i}}function _oe(t,n){var r=new Date;return t=+t,n=+n,function(s){return r.setTime(t*(1-s)+n*s),r}}function cg(t,n){return t=+t,n=+n,function(r){return t*(1-r)+n*r}}function Noe(t,n){var r={},s={},a;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(a in n)a in t?r[a]=Uu(t[a],n[a]):s[a]=n[a];return function(i){for(a in r)s[a]=r[a](i);return s}}var G1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$_=new RegExp(G1.source,"g");function Soe(t){return function(){return t}}function Coe(t){return function(n){return t(n)+""}}function koe(t,n){var r=G1.lastIndex=$_.lastIndex=0,s,a,i,o=-1,c=[],u=[];for(t=t+"",n=n+"";(s=G1.exec(t))&&(a=$_.exec(n));)(i=a.index)>r&&(i=n.slice(r,i),c[o]?c[o]+=i:c[++o]=i),(s=s[0])===(a=a[0])?c[o]?c[o]+=a:c[++o]=a:(c[++o]=null,u.push({i:o,x:cg(s,a)})),r=$_.lastIndex;return r<n.length&&(i=n.slice(r),c[o]?c[o]+=i:c[++o]=i),c.length<2?u[0]?Coe(u[0].x):Soe(n):(n=u.length,function(m){for(var h=0,f;h<n;++h)c[(f=u[h]).i]=f.x(m);return c.join("")})}function Uu(t,n){var r=typeof n,s;return n==null||r==="boolean"?gk(n):(r==="number"?cg:r==="string"?(s=zh(n))?(n=s,v4):koe:n instanceof zh?v4:n instanceof Date?_oe:boe(n)?joe:Array.isArray(n)?woe:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?Noe:cg)(t,n)}function vk(t,n){return t=+t,n=+n,function(r){return Math.round(t*(1-r)+n*r)}}function Poe(t,n){n===void 0&&(n=t,t=Uu);for(var r=0,s=n.length-1,a=n[0],i=new Array(s<0?0:s);r<s;)i[r]=t(a,a=n[++r]);return function(o){var c=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[c](o-c)}}function Aoe(t){return function(){return t}}function dg(t){return+t}var y4=[0,1];function As(t){return t}function Y1(t,n){return(n-=t=+t)?function(r){return(r-t)/n}:Aoe(isNaN(n)?NaN:.5)}function Eoe(t,n){var r;return t>n&&(r=t,t=n,n=r),function(s){return Math.max(t,Math.min(n,s))}}function Ooe(t,n,r){var s=t[0],a=t[1],i=n[0],o=n[1];return a<s?(s=Y1(a,s),i=r(o,i)):(s=Y1(s,a),i=r(i,o)),function(c){return i(s(c))}}function Toe(t,n,r){var s=Math.min(t.length,n.length)-1,a=new Array(s),i=new Array(s),o=-1;for(t[s]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++o<s;)a[o]=Y1(t[o],t[o+1]),i[o]=r(n[o],n[o+1]);return function(c){var u=$f(t,c,1,s)-1;return i[u](a[u](c))}}function Lf(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function zv(){var t=y4,n=y4,r=Uu,s,a,i,o=As,c,u,m;function h(){var x=Math.min(t.length,n.length);return o!==As&&(o=Eoe(t[0],t[x-1])),c=x>2?Toe:Ooe,u=m=null,f}function f(x){return x==null||isNaN(x=+x)?i:(u||(u=c(t.map(s),n,r)))(s(o(x)))}return f.invert=function(x){return o(a((m||(m=c(n,t.map(s),cg)))(x)))},f.domain=function(x){return arguments.length?(t=Array.from(x,dg),h()):t.slice()},f.range=function(x){return arguments.length?(n=Array.from(x),h()):n.slice()},f.rangeRound=function(x){return n=Array.from(x),r=vk,h()},f.clamp=function(x){return arguments.length?(o=x?!0:As,h()):o!==As},f.interpolate=function(x){return arguments.length?(r=x,h()):r},f.unknown=function(x){return arguments.length?(i=x,f):i},function(x,j){return s=x,a=j,h()}}function yk(){return zv()(As,As)}function Moe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ug(t,n){if((r=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var r,s=t.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+t.slice(r+1)]}function du(t){return t=ug(Math.abs(t)),t?t[1]:NaN}function Roe(t,n){return function(r,s){for(var a=r.length,i=[],o=0,c=t[0],u=0;a>0&&c>0&&(u+c+1>s&&(c=Math.max(1,s-u)),i.push(r.substring(a-=c,a+c)),!((u+=c+1)>s));)c=t[o=(o+1)%t.length];return i.reverse().join(n)}}function Doe(t){return function(n){return n.replace(/[0-9]/g,function(r){return t[+r]})}}var $oe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vh(t){if(!(n=$oe.exec(t)))throw new Error("invalid format: "+t);var n;return new jk({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Vh.prototype=jk.prototype;function jk(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}jk.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Foe(t){e:for(var n=t.length,r=1,s=-1,a;r<n;++r)switch(t[r]){case".":s=a=r;break;case"0":s===0&&(s=r),a=r;break;default:if(!+t[r])break e;s>0&&(s=0);break}return s>0?t.slice(0,s)+t.slice(a+1):t}var UB;function Loe(t,n){var r=ug(t,n);if(!r)return t+"";var s=r[0],a=r[1],i=a-(UB=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+ug(t,Math.max(0,n+i-1))[0]}function j4(t,n){var r=ug(t,n);if(!r)return t+"";var s=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+s:s.length>a+1?s.slice(0,a+1)+"."+s.slice(a+1):s+new Array(a-s.length+2).join("0")}const b4={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Moe,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>j4(t*100,n),r:j4,s:Loe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function w4(t){return t}var _4=Array.prototype.map,N4=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Ioe(t){var n=t.grouping===void 0||t.thousands===void 0?w4:Roe(_4.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",s=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?w4:Doe(_4.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",c=t.minus===void 0?"":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function m(f){f=Vh(f);var x=f.fill,j=f.align,b=f.sign,g=f.symbol,y=f.zero,C=f.width,k=f.comma,N=f.precision,P=f.trim,w=f.type;w==="n"?(k=!0,w="g"):b4[w]||(N===void 0&&(N=12),P=!0,w="g"),(y||x==="0"&&j==="=")&&(y=!0,x="0",j="=");var S=g==="$"?r:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E=g==="$"?s:/[%p]/.test(w)?o:"",R=b4[w],T=/[defgprs%]/.test(w);N=N===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function U(M){var L=S,q=E,$,D,z;if(w==="c")q=R(M)+q,M="";else{M=+M;var J=M<0||1/M<0;if(M=isNaN(M)?u:R(Math.abs(M),N),P&&(M=Foe(M)),J&&+M==0&&b!=="+"&&(J=!1),L=(J?b==="("?b:c:b==="-"||b==="("?"":b)+L,q=(w==="s"?N4[8+UB/3]:"")+q+(J&&b==="("?")":""),T){for($=-1,D=M.length;++$<D;)if(z=M.charCodeAt($),48>z||z>57){q=(z===46?a+M.slice($+1):M.slice($))+q,M=M.slice(0,$);break}}}k&&!y&&(M=n(M,1/0));var I=L.length+M.length+q.length,X=I<C?new Array(C-I+1).join(x):"";switch(k&&y&&(M=n(X+M,X.length?C-q.length:1/0),X=""),j){case"<":M=L+M+q+X;break;case"=":M=L+X+M+q;break;case"^":M=X.slice(0,I=X.length>>1)+L+M+q+X.slice(I);break;default:M=X+L+M+q;break}return i(M)}return U.toString=function(){return f+""},U}function h(f,x){var j=m((f=Vh(f),f.type="f",f)),b=Math.max(-8,Math.min(8,Math.floor(du(x)/3)))*3,g=Math.pow(10,-b),y=N4[8+b/3];return function(C){return j(g*C)+y}}return{format:m,formatPrefix:h}}var ix,bk,KB;qoe({thousands:",",grouping:[3],currency:["$",""]});function qoe(t){return ix=Ioe(t),bk=ix.format,KB=ix.formatPrefix,ix}function Boe(t){return Math.max(0,-du(Math.abs(t)))}function zoe(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(du(n)/3)))*3-du(Math.abs(t)))}function Voe(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,du(n)-du(t))+1}function WB(t,n,r,s){var a=K1(t,n,r),i;switch(s=Vh(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(n));return s.precision==null&&!isNaN(i=zoe(a,o))&&(s.precision=i),KB(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=Voe(a,Math.max(Math.abs(t),Math.abs(n))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=Boe(a))&&(s.precision=i-(s.type==="%")*2);break}}return bk(s)}function $l(t){var n=t.domain;return t.ticks=function(r){var s=n();return V1(s[0],s[s.length-1],r??10)},t.tickFormat=function(r,s){var a=n();return WB(a[0],a[a.length-1],r??10,s)},t.nice=function(r){r==null&&(r=10);var s=n(),a=0,i=s.length-1,o=s[a],c=s[i],u,m,h=10;for(c<o&&(m=o,o=c,c=m,m=a,a=i,i=m);h-- >0;){if(m=U1(o,c,r),m===u)return s[a]=o,s[i]=c,n(s);if(m>0)o=Math.floor(o/m)*m,c=Math.ceil(c/m)*m;else if(m<0)o=Math.ceil(o*m)/m,c=Math.floor(c*m)/m;else break;u=m}return t},t}function mg(){var t=yk();return t.copy=function(){return Lf(t,mg())},Ua.apply(t,arguments),$l(t)}function HB(t){var n;function r(s){return s==null||isNaN(s=+s)?n:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(t=Array.from(s,dg),r):t.slice()},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return HB(t).unknown(n)},t=arguments.length?Array.from(t,dg):[0,1],$l(r)}function GB(t,n){t=t.slice();var r=0,s=t.length-1,a=t[r],i=t[s],o;return i<a&&(o=r,r=s,s=o,o=a,a=i,i=o),t[r]=n.floor(a),t[s]=n.ceil(i),t}function S4(t){return Math.log(t)}function C4(t){return Math.exp(t)}function Uoe(t){return-Math.log(-t)}function Koe(t){return-Math.exp(-t)}function Woe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Hoe(t){return t===10?Woe:t===Math.E?Math.exp:n=>Math.pow(t,n)}function Goe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),n=>Math.log(n)/t)}function k4(t){return(n,r)=>-t(-n,r)}function wk(t){const n=t(S4,C4),r=n.domain;let s=10,a,i;function o(){return a=Goe(s),i=Hoe(s),r()[0]<0?(a=k4(a),i=k4(i),t(Uoe,Koe)):t(S4,C4),n}return n.base=function(c){return arguments.length?(s=+c,o()):s},n.domain=function(c){return arguments.length?(r(c),o()):r()},n.ticks=c=>{const u=r();let m=u[0],h=u[u.length-1];const f=h<m;f&&([m,h]=[h,m]);let x=a(m),j=a(h),b,g;const y=c==null?10:+c;let C=[];if(!(s%1)&&j-x<y){if(x=Math.floor(x),j=Math.ceil(j),m>0){for(;x<=j;++x)for(b=1;b<s;++b)if(g=x<0?b/i(-x):b*i(x),!(g<m)){if(g>h)break;C.push(g)}}else for(;x<=j;++x)for(b=s-1;b>=1;--b)if(g=x>0?b/i(-x):b*i(x),!(g<m)){if(g>h)break;C.push(g)}C.length*2<y&&(C=V1(m,h,y))}else C=V1(x,j,Math.min(j-x,y)).map(i);return f?C.reverse():C},n.tickFormat=(c,u)=>{if(c==null&&(c=10),u==null&&(u=s===10?"s":","),typeof u!="function"&&(!(s%1)&&(u=Vh(u)).precision==null&&(u.trim=!0),u=bk(u)),c===1/0)return u;const m=Math.max(1,s*c/n.ticks().length);return h=>{let f=h/i(Math.round(a(h)));return f*s<s-.5&&(f*=s),f<=m?u(h):""}},n.nice=()=>r(GB(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),n}function YB(){const t=wk(zv()).domain([1,10]);return t.copy=()=>Lf(t,YB()).base(t.base()),Ua.apply(t,arguments),t}function P4(t){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/t))}}function A4(t){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*t}}function _k(t){var n=1,r=t(P4(n),A4(n));return r.constant=function(s){return arguments.length?t(P4(n=+s),A4(n)):n},$l(r)}function QB(){var t=_k(zv());return t.copy=function(){return Lf(t,QB()).constant(t.constant())},Ua.apply(t,arguments)}function E4(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function Yoe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Qoe(t){return t<0?-t*t:t*t}function Nk(t){var n=t(As,As),r=1;function s(){return r===1?t(As,As):r===.5?t(Yoe,Qoe):t(E4(r),E4(1/r))}return n.exponent=function(a){return arguments.length?(r=+a,s()):r},$l(n)}function Sk(){var t=Nk(zv());return t.copy=function(){return Lf(t,Sk()).exponent(t.exponent())},Ua.apply(t,arguments),t}function Xoe(){return Sk.apply(null,arguments).exponent(.5)}function O4(t){return Math.sign(t)*t*t}function Zoe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function XB(){var t=yk(),n=[0,1],r=!1,s;function a(i){var o=Zoe(t(i));return isNaN(o)?s:r?Math.round(o):o}return a.invert=function(i){return t.invert(O4(i))},a.domain=function(i){return arguments.length?(t.domain(i),a):t.domain()},a.range=function(i){return arguments.length?(t.range((n=Array.from(i,dg)).map(O4)),a):n.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(t.clamp(i),a):t.clamp()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return XB(t.domain(),n).round(r).clamp(t.clamp()).unknown(s)},Ua.apply(a,arguments),$l(a)}function ZB(){var t=[],n=[],r=[],s;function a(){var o=0,c=Math.max(1,n.length);for(r=new Array(c-1);++o<c;)r[o-1]=roe(t,o/c);return i}function i(o){return o==null||isNaN(o=+o)?s:n[$f(r,o)]}return i.invertExtent=function(o){var c=n.indexOf(o);return c<0?[NaN,NaN]:[c>0?r[c-1]:t[0],c<r.length?r[c]:t[t.length-1]]},i.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let c of o)c!=null&&!isNaN(c=+c)&&t.push(c);return t.sort(gl),a()},i.range=function(o){return arguments.length?(n=Array.from(o),a()):n.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return ZB().domain(t).range(n).unknown(s)},Ua.apply(i,arguments)}function JB(){var t=0,n=1,r=1,s=[.5],a=[0,1],i;function o(u){return u!=null&&u<=u?a[$f(s,u,0,r)]:i}function c(){var u=-1;for(s=new Array(r);++u<r;)s[u]=((u+1)*n-(u-r)*t)/(r+1);return o}return o.domain=function(u){return arguments.length?([t,n]=u,t=+t,n=+n,c()):[t,n]},o.range=function(u){return arguments.length?(r=(a=Array.from(u)).length-1,c()):a.slice()},o.invertExtent=function(u){var m=a.indexOf(u);return m<0?[NaN,NaN]:m<1?[t,s[0]]:m>=r?[s[r-1],n]:[s[m-1],s[m]]},o.unknown=function(u){return arguments.length&&(i=u),o},o.thresholds=function(){return s.slice()},o.copy=function(){return JB().domain([t,n]).range(a).unknown(i)},Ua.apply($l(o),arguments)}function ez(){var t=[.5],n=[0,1],r,s=1;function a(i){return i!=null&&i<=i?n[$f(t,i,0,s)]:r}return a.domain=function(i){return arguments.length?(t=Array.from(i),s=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(i){return arguments.length?(n=Array.from(i),s=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(i){var o=n.indexOf(i);return[t[o-1],t[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return ez().domain(t).range(n).unknown(r)},Ua.apply(a,arguments)}const F_=new Date,L_=new Date;function Fr(t,n,r,s){function a(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(t(i=new Date(+i)),i),a.ceil=i=>(t(i=new Date(i-1)),n(i,1),t(i),i),a.round=i=>{const o=a(i),c=a.ceil(i);return i-o<c-i?o:c},a.offset=(i,o)=>(n(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,c)=>{const u=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<o)||!(c>0))return u;let m;do u.push(m=new Date(+i)),n(i,c),t(i);while(m<i&&i<o);return u},a.filter=i=>Fr(o=>{if(o>=o)for(;t(o),!i(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;n(o,-1),!i(o););else for(;--c>=0;)for(;n(o,1),!i(o););}),r&&(a.count=(i,o)=>(F_.setTime(+i),L_.setTime(+o),t(F_),t(L_),Math.floor(r(F_,L_))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(s?o=>s(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const hg=Fr(()=>{},(t,n)=>{t.setTime(+t+n)},(t,n)=>n-t);hg.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Fr(n=>{n.setTime(Math.floor(n/t)*t)},(n,r)=>{n.setTime(+n+r*t)},(n,r)=>(r-n)/t):hg);hg.range;const co=1e3,Fa=co*60,uo=Fa*60,jo=uo*24,Ck=jo*7,T4=jo*30,I_=jo*365,dc=Fr(t=>{t.setTime(t-t.getMilliseconds())},(t,n)=>{t.setTime(+t+n*co)},(t,n)=>(n-t)/co,t=>t.getUTCSeconds());dc.range;const kk=Fr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*co)},(t,n)=>{t.setTime(+t+n*Fa)},(t,n)=>(n-t)/Fa,t=>t.getMinutes());kk.range;const Pk=Fr(t=>{t.setUTCSeconds(0,0)},(t,n)=>{t.setTime(+t+n*Fa)},(t,n)=>(n-t)/Fa,t=>t.getUTCMinutes());Pk.range;const Ak=Fr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*co-t.getMinutes()*Fa)},(t,n)=>{t.setTime(+t+n*uo)},(t,n)=>(n-t)/uo,t=>t.getHours());Ak.range;const Ek=Fr(t=>{t.setUTCMinutes(0,0,0)},(t,n)=>{t.setTime(+t+n*uo)},(t,n)=>(n-t)/uo,t=>t.getUTCHours());Ek.range;const If=Fr(t=>t.setHours(0,0,0,0),(t,n)=>t.setDate(t.getDate()+n),(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fa)/jo,t=>t.getDate()-1);If.range;const Vv=Fr(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/jo,t=>t.getUTCDate()-1);Vv.range;const tz=Fr(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/jo,t=>Math.floor(t/jo));tz.range;function qc(t){return Fr(n=>{n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},(n,r)=>{n.setDate(n.getDate()+r*7)},(n,r)=>(r-n-(r.getTimezoneOffset()-n.getTimezoneOffset())*Fa)/Ck)}const Uv=qc(0),fg=qc(1),Joe=qc(2),ele=qc(3),uu=qc(4),tle=qc(5),nle=qc(6);Uv.range;fg.range;Joe.range;ele.range;uu.range;tle.range;nle.range;function Bc(t){return Fr(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCDate(n.getUTCDate()+r*7)},(n,r)=>(r-n)/Ck)}const Kv=Bc(0),pg=Bc(1),rle=Bc(2),sle=Bc(3),mu=Bc(4),ale=Bc(5),ile=Bc(6);Kv.range;pg.range;rle.range;sle.range;mu.range;ale.range;ile.range;const Ok=Fr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,n)=>{t.setMonth(t.getMonth()+n)},(t,n)=>n.getMonth()-t.getMonth()+(n.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Ok.range;const Tk=Fr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCMonth(t.getUTCMonth()+n)},(t,n)=>n.getUTCMonth()-t.getUTCMonth()+(n.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Tk.range;const bo=Fr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n)},(t,n)=>n.getFullYear()-t.getFullYear(),t=>t.getFullYear());bo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Fr(n=>{n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,r)=>{n.setFullYear(n.getFullYear()+r*t)});bo.range;const wo=Fr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n)},(t,n)=>n.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());wo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Fr(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCFullYear(n.getUTCFullYear()+r*t)});wo.range;function nz(t,n,r,s,a,i){const o=[[dc,1,co],[dc,5,5*co],[dc,15,15*co],[dc,30,30*co],[i,1,Fa],[i,5,5*Fa],[i,15,15*Fa],[i,30,30*Fa],[a,1,uo],[a,3,3*uo],[a,6,6*uo],[a,12,12*uo],[s,1,jo],[s,2,2*jo],[r,1,Ck],[n,1,T4],[n,3,3*T4],[t,1,I_]];function c(m,h,f){const x=h<m;x&&([m,h]=[h,m]);const j=f&&typeof f.range=="function"?f:u(m,h,f),b=j?j.range(m,+h+1):[];return x?b.reverse():b}function u(m,h,f){const x=Math.abs(h-m)/f,j=fk(([,,y])=>y).right(o,x);if(j===o.length)return t.every(K1(m/I_,h/I_,f));if(j===0)return hg.every(Math.max(K1(m,h,f),1));const[b,g]=o[x/o[j-1][2]<o[j][2]/x?j-1:j];return b.every(g)}return[c,u]}const[ole,lle]=nz(wo,Tk,Kv,tz,Ek,Pk),[cle,dle]=nz(bo,Ok,Uv,If,Ak,kk);function q_(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function B_(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Dm(t,n,r){return{y:t,m:n,d:r,H:0,M:0,S:0,L:0}}function ule(t){var n=t.dateTime,r=t.date,s=t.time,a=t.periods,i=t.days,o=t.shortDays,c=t.months,u=t.shortMonths,m=$m(a),h=Fm(a),f=$m(i),x=Fm(i),j=$m(o),b=Fm(o),g=$m(c),y=Fm(c),C=$m(u),k=Fm(u),N={a:J,A:I,b:X,B:ne,c:null,d:L4,e:L4,f:Rle,g:Ule,G:Wle,H:Ole,I:Tle,j:Mle,L:rz,m:Dle,M:$le,p:W,q:H,Q:B4,s:z4,S:Fle,u:Lle,U:Ile,V:qle,w:Ble,W:zle,x:null,X:null,y:Vle,Y:Kle,Z:Hle,"%":q4},P={a:fe,A:Pe,b:Re,B:Ie,c:null,d:I4,e:I4,f:Xle,g:oce,G:cce,H:Gle,I:Yle,j:Qle,L:az,m:Zle,M:Jle,p:Ce,q:Y,Q:B4,s:z4,S:ece,u:tce,U:nce,V:rce,w:sce,W:ace,x:null,X:null,y:ice,Y:lce,Z:dce,"%":q4},w={a:U,A:M,b:L,B:q,c:$,d:$4,e:$4,f:kle,g:D4,G:R4,H:F4,I:F4,j:_le,L:Cle,m:wle,M:Nle,p:T,q:ble,Q:Ale,s:Ele,S:Sle,u:xle,U:gle,V:vle,w:ple,W:yle,x:D,X:z,y:D4,Y:R4,Z:jle,"%":Ple};N.x=S(r,N),N.X=S(s,N),N.c=S(n,N),P.x=S(r,P),P.X=S(s,P),P.c=S(n,P);function S(ie,Ee){return function(Ke){var Te=[],ct=-1,ut=0,Dt=ie.length,be,pt,te;for(Ke instanceof Date||(Ke=new Date(+Ke));++ct<Dt;)ie.charCodeAt(ct)===37&&(Te.push(ie.slice(ut,ct)),(pt=M4[be=ie.charAt(++ct)])!=null?be=ie.charAt(++ct):pt=be==="e"?" ":"0",(te=Ee[be])&&(be=te(Ke,pt)),Te.push(be),ut=ct+1);return Te.push(ie.slice(ut,ct)),Te.join("")}}function E(ie,Ee){return function(Ke){var Te=Dm(1900,void 0,1),ct=R(Te,ie,Ke+="",0),ut,Dt;if(ct!=Ke.length)return null;if("Q"in Te)return new Date(Te.Q);if("s"in Te)return new Date(Te.s*1e3+("L"in Te?Te.L:0));if(Ee&&!("Z"in Te)&&(Te.Z=0),"p"in Te&&(Te.H=Te.H%12+Te.p*12),Te.m===void 0&&(Te.m="q"in Te?Te.q:0),"V"in Te){if(Te.V<1||Te.V>53)return null;"w"in Te||(Te.w=1),"Z"in Te?(ut=B_(Dm(Te.y,0,1)),Dt=ut.getUTCDay(),ut=Dt>4||Dt===0?pg.ceil(ut):pg(ut),ut=Vv.offset(ut,(Te.V-1)*7),Te.y=ut.getUTCFullYear(),Te.m=ut.getUTCMonth(),Te.d=ut.getUTCDate()+(Te.w+6)%7):(ut=q_(Dm(Te.y,0,1)),Dt=ut.getDay(),ut=Dt>4||Dt===0?fg.ceil(ut):fg(ut),ut=If.offset(ut,(Te.V-1)*7),Te.y=ut.getFullYear(),Te.m=ut.getMonth(),Te.d=ut.getDate()+(Te.w+6)%7)}else("W"in Te||"U"in Te)&&("w"in Te||(Te.w="u"in Te?Te.u%7:"W"in Te?1:0),Dt="Z"in Te?B_(Dm(Te.y,0,1)).getUTCDay():q_(Dm(Te.y,0,1)).getDay(),Te.m=0,Te.d="W"in Te?(Te.w+6)%7+Te.W*7-(Dt+5)%7:Te.w+Te.U*7-(Dt+6)%7);return"Z"in Te?(Te.H+=Te.Z/100|0,Te.M+=Te.Z%100,B_(Te)):q_(Te)}}function R(ie,Ee,Ke,Te){for(var ct=0,ut=Ee.length,Dt=Ke.length,be,pt;ct<ut;){if(Te>=Dt)return-1;if(be=Ee.charCodeAt(ct++),be===37){if(be=Ee.charAt(ct++),pt=w[be in M4?Ee.charAt(ct++):be],!pt||(Te=pt(ie,Ke,Te))<0)return-1}else if(be!=Ke.charCodeAt(Te++))return-1}return Te}function T(ie,Ee,Ke){var Te=m.exec(Ee.slice(Ke));return Te?(ie.p=h.get(Te[0].toLowerCase()),Ke+Te[0].length):-1}function U(ie,Ee,Ke){var Te=j.exec(Ee.slice(Ke));return Te?(ie.w=b.get(Te[0].toLowerCase()),Ke+Te[0].length):-1}function M(ie,Ee,Ke){var Te=f.exec(Ee.slice(Ke));return Te?(ie.w=x.get(Te[0].toLowerCase()),Ke+Te[0].length):-1}function L(ie,Ee,Ke){var Te=C.exec(Ee.slice(Ke));return Te?(ie.m=k.get(Te[0].toLowerCase()),Ke+Te[0].length):-1}function q(ie,Ee,Ke){var Te=g.exec(Ee.slice(Ke));return Te?(ie.m=y.get(Te[0].toLowerCase()),Ke+Te[0].length):-1}function $(ie,Ee,Ke){return R(ie,n,Ee,Ke)}function D(ie,Ee,Ke){return R(ie,r,Ee,Ke)}function z(ie,Ee,Ke){return R(ie,s,Ee,Ke)}function J(ie){return o[ie.getDay()]}function I(ie){return i[ie.getDay()]}function X(ie){return u[ie.getMonth()]}function ne(ie){return c[ie.getMonth()]}function W(ie){return a[+(ie.getHours()>=12)]}function H(ie){return 1+~~(ie.getMonth()/3)}function fe(ie){return o[ie.getUTCDay()]}function Pe(ie){return i[ie.getUTCDay()]}function Re(ie){return u[ie.getUTCMonth()]}function Ie(ie){return c[ie.getUTCMonth()]}function Ce(ie){return a[+(ie.getUTCHours()>=12)]}function Y(ie){return 1+~~(ie.getUTCMonth()/3)}return{format:function(ie){var Ee=S(ie+="",N);return Ee.toString=function(){return ie},Ee},parse:function(ie){var Ee=E(ie+="",!1);return Ee.toString=function(){return ie},Ee},utcFormat:function(ie){var Ee=S(ie+="",P);return Ee.toString=function(){return ie},Ee},utcParse:function(ie){var Ee=E(ie+="",!0);return Ee.toString=function(){return ie},Ee}}}var M4={"-":"",_:" ",0:"0"},Wr=/^\s*\d+/,mle=/^%/,hle=/[\\^$*+?|[\]().{}]/g;function wn(t,n,r){var s=t<0?"-":"",a=(s?-t:t)+"",i=a.length;return s+(i<r?new Array(r-i+1).join(n)+a:a)}function fle(t){return t.replace(hle,"\\$&")}function $m(t){return new RegExp("^(?:"+t.map(fle).join("|")+")","i")}function Fm(t){return new Map(t.map((n,r)=>[n.toLowerCase(),r]))}function ple(t,n,r){var s=Wr.exec(n.slice(r,r+1));return s?(t.w=+s[0],r+s[0].length):-1}function xle(t,n,r){var s=Wr.exec(n.slice(r,r+1));return s?(t.u=+s[0],r+s[0].length):-1}function gle(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.U=+s[0],r+s[0].length):-1}function vle(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.V=+s[0],r+s[0].length):-1}function yle(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.W=+s[0],r+s[0].length):-1}function R4(t,n,r){var s=Wr.exec(n.slice(r,r+4));return s?(t.y=+s[0],r+s[0].length):-1}function D4(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function jle(t,n,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(r,r+6));return s?(t.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function ble(t,n,r){var s=Wr.exec(n.slice(r,r+1));return s?(t.q=s[0]*3-3,r+s[0].length):-1}function wle(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.m=s[0]-1,r+s[0].length):-1}function $4(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.d=+s[0],r+s[0].length):-1}function _le(t,n,r){var s=Wr.exec(n.slice(r,r+3));return s?(t.m=0,t.d=+s[0],r+s[0].length):-1}function F4(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.H=+s[0],r+s[0].length):-1}function Nle(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.M=+s[0],r+s[0].length):-1}function Sle(t,n,r){var s=Wr.exec(n.slice(r,r+2));return s?(t.S=+s[0],r+s[0].length):-1}function Cle(t,n,r){var s=Wr.exec(n.slice(r,r+3));return s?(t.L=+s[0],r+s[0].length):-1}function kle(t,n,r){var s=Wr.exec(n.slice(r,r+6));return s?(t.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function Ple(t,n,r){var s=mle.exec(n.slice(r,r+1));return s?r+s[0].length:-1}function Ale(t,n,r){var s=Wr.exec(n.slice(r));return s?(t.Q=+s[0],r+s[0].length):-1}function Ele(t,n,r){var s=Wr.exec(n.slice(r));return s?(t.s=+s[0],r+s[0].length):-1}function L4(t,n){return wn(t.getDate(),n,2)}function Ole(t,n){return wn(t.getHours(),n,2)}function Tle(t,n){return wn(t.getHours()%12||12,n,2)}function Mle(t,n){return wn(1+If.count(bo(t),t),n,3)}function rz(t,n){return wn(t.getMilliseconds(),n,3)}function Rle(t,n){return rz(t,n)+"000"}function Dle(t,n){return wn(t.getMonth()+1,n,2)}function $le(t,n){return wn(t.getMinutes(),n,2)}function Fle(t,n){return wn(t.getSeconds(),n,2)}function Lle(t){var n=t.getDay();return n===0?7:n}function Ile(t,n){return wn(Uv.count(bo(t)-1,t),n,2)}function sz(t){var n=t.getDay();return n>=4||n===0?uu(t):uu.ceil(t)}function qle(t,n){return t=sz(t),wn(uu.count(bo(t),t)+(bo(t).getDay()===4),n,2)}function Ble(t){return t.getDay()}function zle(t,n){return wn(fg.count(bo(t)-1,t),n,2)}function Vle(t,n){return wn(t.getFullYear()%100,n,2)}function Ule(t,n){return t=sz(t),wn(t.getFullYear()%100,n,2)}function Kle(t,n){return wn(t.getFullYear()%1e4,n,4)}function Wle(t,n){var r=t.getDay();return t=r>=4||r===0?uu(t):uu.ceil(t),wn(t.getFullYear()%1e4,n,4)}function Hle(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+wn(n/60|0,"0",2)+wn(n%60,"0",2)}function I4(t,n){return wn(t.getUTCDate(),n,2)}function Gle(t,n){return wn(t.getUTCHours(),n,2)}function Yle(t,n){return wn(t.getUTCHours()%12||12,n,2)}function Qle(t,n){return wn(1+Vv.count(wo(t),t),n,3)}function az(t,n){return wn(t.getUTCMilliseconds(),n,3)}function Xle(t,n){return az(t,n)+"000"}function Zle(t,n){return wn(t.getUTCMonth()+1,n,2)}function Jle(t,n){return wn(t.getUTCMinutes(),n,2)}function ece(t,n){return wn(t.getUTCSeconds(),n,2)}function tce(t){var n=t.getUTCDay();return n===0?7:n}function nce(t,n){return wn(Kv.count(wo(t)-1,t),n,2)}function iz(t){var n=t.getUTCDay();return n>=4||n===0?mu(t):mu.ceil(t)}function rce(t,n){return t=iz(t),wn(mu.count(wo(t),t)+(wo(t).getUTCDay()===4),n,2)}function sce(t){return t.getUTCDay()}function ace(t,n){return wn(pg.count(wo(t)-1,t),n,2)}function ice(t,n){return wn(t.getUTCFullYear()%100,n,2)}function oce(t,n){return t=iz(t),wn(t.getUTCFullYear()%100,n,2)}function lce(t,n){return wn(t.getUTCFullYear()%1e4,n,4)}function cce(t,n){var r=t.getUTCDay();return t=r>=4||r===0?mu(t):mu.ceil(t),wn(t.getUTCFullYear()%1e4,n,4)}function dce(){return"+0000"}function q4(){return"%"}function B4(t){return+t}function z4(t){return Math.floor(+t/1e3)}var jd,oz,lz;uce({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function uce(t){return jd=ule(t),oz=jd.format,jd.parse,lz=jd.utcFormat,jd.utcParse,jd}function mce(t){return new Date(t)}function hce(t){return t instanceof Date?+t:+new Date(+t)}function Mk(t,n,r,s,a,i,o,c,u,m){var h=yk(),f=h.invert,x=h.domain,j=m(".%L"),b=m(":%S"),g=m("%I:%M"),y=m("%I %p"),C=m("%a %d"),k=m("%b %d"),N=m("%B"),P=m("%Y");function w(S){return(u(S)<S?j:c(S)<S?b:o(S)<S?g:i(S)<S?y:s(S)<S?a(S)<S?C:k:r(S)<S?N:P)(S)}return h.invert=function(S){return new Date(f(S))},h.domain=function(S){return arguments.length?x(Array.from(S,hce)):x().map(mce)},h.ticks=function(S){var E=x();return t(E[0],E[E.length-1],S??10)},h.tickFormat=function(S,E){return E==null?w:m(E)},h.nice=function(S){var E=x();return(!S||typeof S.range!="function")&&(S=n(E[0],E[E.length-1],S??10)),S?x(GB(E,S)):h},h.copy=function(){return Lf(h,Mk(t,n,r,s,a,i,o,c,u,m))},h}function fce(){return Ua.apply(Mk(cle,dle,bo,Ok,Uv,If,Ak,kk,dc,oz).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function pce(){return Ua.apply(Mk(ole,lle,wo,Tk,Kv,Vv,Ek,Pk,dc,lz).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Wv(){var t=0,n=1,r,s,a,i,o=As,c=!1,u;function m(f){return f==null||isNaN(f=+f)?u:o(a===0?.5:(f=(i(f)-r)*a,c?Math.max(0,Math.min(1,f)):f))}m.domain=function(f){return arguments.length?([t,n]=f,r=i(t=+t),s=i(n=+n),a=r===s?0:1/(s-r),m):[t,n]},m.clamp=function(f){return arguments.length?(c=!!f,m):c},m.interpolator=function(f){return arguments.length?(o=f,m):o};function h(f){return function(x){var j,b;return arguments.length?([j,b]=x,o=f(j,b),m):[o(0),o(1)]}}return m.range=h(Uu),m.rangeRound=h(vk),m.unknown=function(f){return arguments.length?(u=f,m):u},function(f){return i=f,r=f(t),s=f(n),a=r===s?0:1/(s-r),m}}function Fl(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function cz(){var t=$l(Wv()(As));return t.copy=function(){return Fl(t,cz())},Po.apply(t,arguments)}function dz(){var t=wk(Wv()).domain([1,10]);return t.copy=function(){return Fl(t,dz()).base(t.base())},Po.apply(t,arguments)}function uz(){var t=_k(Wv());return t.copy=function(){return Fl(t,uz()).constant(t.constant())},Po.apply(t,arguments)}function Rk(){var t=Nk(Wv());return t.copy=function(){return Fl(t,Rk()).exponent(t.exponent())},Po.apply(t,arguments)}function xce(){return Rk.apply(null,arguments).exponent(.5)}function mz(){var t=[],n=As;function r(s){if(s!=null&&!isNaN(s=+s))return n(($f(t,s,1)-1)/(t.length-1))}return r.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let a of s)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(gl),r},r.interpolator=function(s){return arguments.length?(n=s,r):n},r.range=function(){return t.map((s,a)=>n(a/(t.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(a,i)=>noe(t,i/s))},r.copy=function(){return mz(n).domain(t)},Po.apply(r,arguments)}function Hv(){var t=0,n=.5,r=1,s=1,a,i,o,c,u,m=As,h,f=!1,x;function j(g){return isNaN(g=+g)?x:(g=.5+((g=+h(g))-i)*(s*g<s*i?c:u),m(f?Math.max(0,Math.min(1,g)):g))}j.domain=function(g){return arguments.length?([t,n,r]=g,a=h(t=+t),i=h(n=+n),o=h(r=+r),c=a===i?0:.5/(i-a),u=i===o?0:.5/(o-i),s=i<a?-1:1,j):[t,n,r]},j.clamp=function(g){return arguments.length?(f=!!g,j):f},j.interpolator=function(g){return arguments.length?(m=g,j):m};function b(g){return function(y){var C,k,N;return arguments.length?([C,k,N]=y,m=Poe(g,[C,k,N]),j):[m(0),m(.5),m(1)]}}return j.range=b(Uu),j.rangeRound=b(vk),j.unknown=function(g){return arguments.length?(x=g,j):x},function(g){return h=g,a=g(t),i=g(n),o=g(r),c=a===i?0:.5/(i-a),u=i===o?0:.5/(o-i),s=i<a?-1:1,j}}function hz(){var t=$l(Hv()(As));return t.copy=function(){return Fl(t,hz())},Po.apply(t,arguments)}function fz(){var t=wk(Hv()).domain([.1,1,10]);return t.copy=function(){return Fl(t,fz()).base(t.base())},Po.apply(t,arguments)}function pz(){var t=_k(Hv());return t.copy=function(){return Fl(t,pz()).constant(t.constant())},Po.apply(t,arguments)}function Dk(){var t=Nk(Hv());return t.copy=function(){return Fl(t,Dk()).exponent(t.exponent())},Po.apply(t,arguments)}function gce(){return Dk.apply(null,arguments).exponent(.5)}const V4=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ih,scaleDiverging:hz,scaleDivergingLog:fz,scaleDivergingPow:Dk,scaleDivergingSqrt:gce,scaleDivergingSymlog:pz,scaleIdentity:HB,scaleImplicit:W1,scaleLinear:mg,scaleLog:YB,scaleOrdinal:pk,scalePoint:sh,scalePow:Sk,scaleQuantile:ZB,scaleQuantize:JB,scaleRadial:XB,scaleSequential:cz,scaleSequentialLog:dz,scaleSequentialPow:Rk,scaleSequentialQuantile:mz,scaleSequentialSqrt:xce,scaleSequentialSymlog:uz,scaleSqrt:Xoe,scaleSymlog:QB,scaleThreshold:ez,scaleTime:fce,scaleUtc:pce,tickFormat:WB},Symbol.toStringTag,{value:"Module"}));var z_,U4;function Gv(){if(U4)return z_;U4=1;var t=qu();function n(r,s,a){for(var i=-1,o=r.length;++i<o;){var c=r[i],u=s(c);if(u!=null&&(m===void 0?u===u&&!t(u):a(u,m)))var m=u,h=c}return h}return z_=n,z_}var V_,K4;function xz(){if(K4)return V_;K4=1;function t(n,r){return n>r}return V_=t,V_}var U_,W4;function vce(){if(W4)return U_;W4=1;var t=Gv(),n=xz(),r=zu();function s(a){return a&&a.length?t(a,r,n):void 0}return U_=s,U_}var yce=vce();const Yv=kn(yce);var K_,H4;function gz(){if(H4)return K_;H4=1;function t(n,r){return n<r}return K_=t,K_}var W_,G4;function jce(){if(G4)return W_;G4=1;var t=Gv(),n=gz(),r=zu();function s(a){return a&&a.length?t(a,r,n):void 0}return W_=s,W_}var bce=jce();const Qv=kn(bce);var H_,Y4;function wce(){if(Y4)return H_;Y4=1;var t=XC(),n=Ki(),r=SB(),s=ea();function a(i,o){var c=s(i)?t:r;return c(i,n(o,3))}return H_=a,H_}var G_,Q4;function _ce(){if(Q4)return G_;Q4=1;var t=_B(),n=wce();function r(s,a){return t(n(s,a),1)}return G_=r,G_}var Nce=_ce();const Sce=kn(Nce);var Y_,X4;function Cce(){if(X4)return Y_;X4=1;var t=dk();function n(r,s){return t(r,s)}return Y_=n,Y_}var kce=Cce();const Xv=kn(kce);var Ku=1e9,Pce={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Fk,er=!0,Va="[DecimalError] ",gc=Va+"Invalid argument: ",$k=Va+"Exponent out of range: ",Wu=Math.floor,rc=Math.pow,Ace=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,pa,zr=1e7,Gn=7,vz=9007199254740991,xg=Wu(vz/Gn),jt={};jt.absoluteValue=jt.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};jt.comparedTo=jt.cmp=function(t){var n,r,s,a,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(s=i.d.length,a=t.d.length,n=0,r=s<a?s:a;n<r;++n)if(i.d[n]!==t.d[n])return i.d[n]>t.d[n]^i.s<0?1:-1;return s===a?0:s>a^i.s<0?1:-1};jt.decimalPlaces=jt.dp=function(){var t=this,n=t.d.length-1,r=(n-t.e)*Gn;if(n=t.d[n],n)for(;n%10==0;n/=10)r--;return r<0?0:r};jt.dividedBy=jt.div=function(t){return po(this,new this.constructor(t))};jt.dividedToIntegerBy=jt.idiv=function(t){var n=this,r=n.constructor;return Dn(po(n,new r(t),0,1),r.precision)};jt.equals=jt.eq=function(t){return!this.cmp(t)};jt.exponent=function(){return br(this)};jt.greaterThan=jt.gt=function(t){return this.cmp(t)>0};jt.greaterThanOrEqualTo=jt.gte=function(t){return this.cmp(t)>=0};jt.isInteger=jt.isint=function(){return this.e>this.d.length-2};jt.isNegative=jt.isneg=function(){return this.s<0};jt.isPositive=jt.ispos=function(){return this.s>0};jt.isZero=function(){return this.s===0};jt.lessThan=jt.lt=function(t){return this.cmp(t)<0};jt.lessThanOrEqualTo=jt.lte=function(t){return this.cmp(t)<1};jt.logarithm=jt.log=function(t){var n,r=this,s=r.constructor,a=s.precision,i=a+5;if(t===void 0)t=new s(10);else if(t=new s(t),t.s<1||t.eq(pa))throw Error(Va+"NaN");if(r.s<1)throw Error(Va+(r.s?"NaN":"-Infinity"));return r.eq(pa)?new s(0):(er=!1,n=po(Uh(r,i),Uh(t,i),i),er=!0,Dn(n,a))};jt.minus=jt.sub=function(t){var n=this;return t=new n.constructor(t),n.s==t.s?bz(n,t):yz(n,(t.s=-t.s,t))};jt.modulo=jt.mod=function(t){var n,r=this,s=r.constructor,a=s.precision;if(t=new s(t),!t.s)throw Error(Va+"NaN");return r.s?(er=!1,n=po(r,t,0,1).times(t),er=!0,r.minus(n)):Dn(new s(r),a)};jt.naturalExponential=jt.exp=function(){return jz(this)};jt.naturalLogarithm=jt.ln=function(){return Uh(this)};jt.negated=jt.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};jt.plus=jt.add=function(t){var n=this;return t=new n.constructor(t),n.s==t.s?yz(n,t):bz(n,(t.s=-t.s,t))};jt.precision=jt.sd=function(t){var n,r,s,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(gc+t);if(n=br(a)+1,s=a.d.length-1,r=s*Gn+1,s=a.d[s],s){for(;s%10==0;s/=10)r--;for(s=a.d[0];s>=10;s/=10)r++}return t&&n>r?n:r};jt.squareRoot=jt.sqrt=function(){var t,n,r,s,a,i,o,c=this,u=c.constructor;if(c.s<1){if(!c.s)return new u(0);throw Error(Va+"NaN")}for(t=br(c),er=!1,a=Math.sqrt(+c),a==0||a==1/0?(n=Mi(c.d),(n.length+t)%2==0&&(n+="0"),a=Math.sqrt(n),t=Wu((t+1)/2)-(t<0||t%2),a==1/0?n="5e"+t:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),s=new u(n)):s=new u(a.toString()),r=u.precision,a=o=r+3;;)if(i=s,s=i.plus(po(c,i,o+2)).times(.5),Mi(i.d).slice(0,o)===(n=Mi(s.d)).slice(0,o)){if(n=n.slice(o-3,o+1),a==o&&n=="4999"){if(Dn(i,r+1,0),i.times(i).eq(c)){s=i;break}}else if(n!="9999")break;o+=4}return er=!0,Dn(s,r)};jt.times=jt.mul=function(t){var n,r,s,a,i,o,c,u,m,h=this,f=h.constructor,x=h.d,j=(t=new f(t)).d;if(!h.s||!t.s)return new f(0);for(t.s*=h.s,r=h.e+t.e,u=x.length,m=j.length,u<m&&(i=x,x=j,j=i,o=u,u=m,m=o),i=[],o=u+m,s=o;s--;)i.push(0);for(s=m;--s>=0;){for(n=0,a=u+s;a>s;)c=i[a]+j[s]*x[a-s-1]+n,i[a--]=c%zr|0,n=c/zr|0;i[a]=(i[a]+n)%zr|0}for(;!i[--o];)i.pop();return n?++r:i.shift(),t.d=i,t.e=r,er?Dn(t,f.precision):t};jt.toDecimalPlaces=jt.todp=function(t,n){var r=this,s=r.constructor;return r=new s(r),t===void 0?r:(zi(t,0,Ku),n===void 0?n=s.rounding:zi(n,0,8),Dn(r,t+br(r)+1,n))};jt.toExponential=function(t,n){var r,s=this,a=s.constructor;return t===void 0?r=Oc(s,!0):(zi(t,0,Ku),n===void 0?n=a.rounding:zi(n,0,8),s=Dn(new a(s),t+1,n),r=Oc(s,!0,t+1)),r};jt.toFixed=function(t,n){var r,s,a=this,i=a.constructor;return t===void 0?Oc(a):(zi(t,0,Ku),n===void 0?n=i.rounding:zi(n,0,8),s=Dn(new i(a),t+br(a)+1,n),r=Oc(s.abs(),!1,t+br(s)+1),a.isneg()&&!a.isZero()?"-"+r:r)};jt.toInteger=jt.toint=function(){var t=this,n=t.constructor;return Dn(new n(t),br(t)+1,n.rounding)};jt.toNumber=function(){return+this};jt.toPower=jt.pow=function(t){var n,r,s,a,i,o,c=this,u=c.constructor,m=12,h=+(t=new u(t));if(!t.s)return new u(pa);if(c=new u(c),!c.s){if(t.s<1)throw Error(Va+"Infinity");return c}if(c.eq(pa))return c;if(s=u.precision,t.eq(pa))return Dn(c,s);if(n=t.e,r=t.d.length-1,o=n>=r,i=c.s,o){if((r=h<0?-h:h)<=vz){for(a=new u(pa),n=Math.ceil(s/Gn+4),er=!1;r%2&&(a=a.times(c),J4(a.d,n)),r=Wu(r/2),r!==0;)c=c.times(c),J4(c.d,n);return er=!0,t.s<0?new u(pa).div(a):Dn(a,s)}}else if(i<0)throw Error(Va+"NaN");return i=i<0&&t.d[Math.max(n,r)]&1?-1:1,c.s=1,er=!1,a=t.times(Uh(c,s+m)),er=!0,a=jz(a),a.s=i,a};jt.toPrecision=function(t,n){var r,s,a=this,i=a.constructor;return t===void 0?(r=br(a),s=Oc(a,r<=i.toExpNeg||r>=i.toExpPos)):(zi(t,1,Ku),n===void 0?n=i.rounding:zi(n,0,8),a=Dn(new i(a),t,n),r=br(a),s=Oc(a,t<=r||r<=i.toExpNeg,t)),s};jt.toSignificantDigits=jt.tosd=function(t,n){var r=this,s=r.constructor;return t===void 0?(t=s.precision,n=s.rounding):(zi(t,1,Ku),n===void 0?n=s.rounding:zi(n,0,8)),Dn(new s(r),t,n)};jt.toString=jt.valueOf=jt.val=jt.toJSON=jt[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,n=br(t),r=t.constructor;return Oc(t,n<=r.toExpNeg||n>=r.toExpPos)};function yz(t,n){var r,s,a,i,o,c,u,m,h=t.constructor,f=h.precision;if(!t.s||!n.s)return n.s||(n=new h(t)),er?Dn(n,f):n;if(u=t.d,m=n.d,o=t.e,a=n.e,u=u.slice(),i=o-a,i){for(i<0?(s=u,i=-i,c=m.length):(s=m,a=o,c=u.length),o=Math.ceil(f/Gn),c=o>c?o+1:c+1,i>c&&(i=c,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(c=u.length,i=m.length,c-i<0&&(i=c,s=m,m=u,u=s),r=0;i;)r=(u[--i]=u[i]+m[i]+r)/zr|0,u[i]%=zr;for(r&&(u.unshift(r),++a),c=u.length;u[--c]==0;)u.pop();return n.d=u,n.e=a,er?Dn(n,f):n}function zi(t,n,r){if(t!==~~t||t<n||t>r)throw Error(gc+t)}function Mi(t){var n,r,s,a=t.length-1,i="",o=t[0];if(a>0){for(i+=o,n=1;n<a;n++)s=t[n]+"",r=Gn-s.length,r&&(i+=ll(r)),i+=s;o=t[n],s=o+"",r=Gn-s.length,r&&(i+=ll(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var po=(function(){function t(s,a){var i,o=0,c=s.length;for(s=s.slice();c--;)i=s[c]*a+o,s[c]=i%zr|0,o=i/zr|0;return o&&s.unshift(o),s}function n(s,a,i,o){var c,u;if(i!=o)u=i>o?1:-1;else for(c=u=0;c<i;c++)if(s[c]!=a[c]){u=s[c]>a[c]?1:-1;break}return u}function r(s,a,i){for(var o=0;i--;)s[i]-=o,o=s[i]<a[i]?1:0,s[i]=o*zr+s[i]-a[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,a,i,o){var c,u,m,h,f,x,j,b,g,y,C,k,N,P,w,S,E,R,T=s.constructor,U=s.s==a.s?1:-1,M=s.d,L=a.d;if(!s.s)return new T(s);if(!a.s)throw Error(Va+"Division by zero");for(u=s.e-a.e,E=L.length,w=M.length,j=new T(U),b=j.d=[],m=0;L[m]==(M[m]||0);)++m;if(L[m]>(M[m]||0)&&--u,i==null?k=i=T.precision:o?k=i+(br(s)-br(a))+1:k=i,k<0)return new T(0);if(k=k/Gn+2|0,m=0,E==1)for(h=0,L=L[0],k++;(m<w||h)&&k--;m++)N=h*zr+(M[m]||0),b[m]=N/L|0,h=N%L|0;else{for(h=zr/(L[0]+1)|0,h>1&&(L=t(L,h),M=t(M,h),E=L.length,w=M.length),P=E,g=M.slice(0,E),y=g.length;y<E;)g[y++]=0;R=L.slice(),R.unshift(0),S=L[0],L[1]>=zr/2&&++S;do h=0,c=n(L,g,E,y),c<0?(C=g[0],E!=y&&(C=C*zr+(g[1]||0)),h=C/S|0,h>1?(h>=zr&&(h=zr-1),f=t(L,h),x=f.length,y=g.length,c=n(f,g,x,y),c==1&&(h--,r(f,E<x?R:L,x))):(h==0&&(c=h=1),f=L.slice()),x=f.length,x<y&&f.unshift(0),r(g,f,y),c==-1&&(y=g.length,c=n(L,g,E,y),c<1&&(h++,r(g,E<y?R:L,y))),y=g.length):c===0&&(h++,g=[0]),b[m++]=h,c&&g[0]?g[y++]=M[P]||0:(g=[M[P]],y=1);while((P++<w||g[0]!==void 0)&&k--)}return b[0]||b.shift(),j.e=u,Dn(j,o?i+br(j)+1:i)}})();function jz(t,n){var r,s,a,i,o,c,u=0,m=0,h=t.constructor,f=h.precision;if(br(t)>16)throw Error($k+br(t));if(!t.s)return new h(pa);for(er=!1,c=f,o=new h(.03125);t.abs().gte(.1);)t=t.times(o),m+=5;for(s=Math.log(rc(2,m))/Math.LN10*2+5|0,c+=s,r=a=i=new h(pa),h.precision=c;;){if(a=Dn(a.times(t),c),r=r.times(++u),o=i.plus(po(a,r,c)),Mi(o.d).slice(0,c)===Mi(i.d).slice(0,c)){for(;m--;)i=Dn(i.times(i),c);return h.precision=f,n==null?(er=!0,Dn(i,f)):i}i=o}}function br(t){for(var n=t.e*Gn,r=t.d[0];r>=10;r/=10)n++;return n}function Q_(t,n,r){if(n>t.LN10.sd())throw er=!0,r&&(t.precision=r),Error(Va+"LN10 precision limit exceeded");return Dn(new t(t.LN10),n)}function ll(t){for(var n="";t--;)n+="0";return n}function Uh(t,n){var r,s,a,i,o,c,u,m,h,f=1,x=10,j=t,b=j.d,g=j.constructor,y=g.precision;if(j.s<1)throw Error(Va+(j.s?"NaN":"-Infinity"));if(j.eq(pa))return new g(0);if(n==null?(er=!1,m=y):m=n,j.eq(10))return n==null&&(er=!0),Q_(g,m);if(m+=x,g.precision=m,r=Mi(b),s=r.charAt(0),i=br(j),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)j=j.times(t),r=Mi(j.d),s=r.charAt(0),f++;i=br(j),s>1?(j=new g("0."+r),i++):j=new g(s+"."+r.slice(1))}else return u=Q_(g,m+2,y).times(i+""),j=Uh(new g(s+"."+r.slice(1)),m-x).plus(u),g.precision=y,n==null?(er=!0,Dn(j,y)):j;for(c=o=j=po(j.minus(pa),j.plus(pa),m),h=Dn(j.times(j),m),a=3;;){if(o=Dn(o.times(h),m),u=c.plus(po(o,new g(a),m)),Mi(u.d).slice(0,m)===Mi(c.d).slice(0,m))return c=c.times(2),i!==0&&(c=c.plus(Q_(g,m+2,y).times(i+""))),c=po(c,new g(f),m),g.precision=y,n==null?(er=!0,Dn(c,y)):c;c=u,a+=2}}function Z4(t,n){var r,s,a;for((r=n.indexOf("."))>-1&&(n=n.replace(".","")),(s=n.search(/e/i))>0?(r<0&&(r=s),r+=+n.slice(s+1),n=n.substring(0,s)):r<0&&(r=n.length),s=0;n.charCodeAt(s)===48;)++s;for(a=n.length;n.charCodeAt(a-1)===48;)--a;if(n=n.slice(s,a),n){if(a-=s,r=r-s-1,t.e=Wu(r/Gn),t.d=[],s=(r+1)%Gn,r<0&&(s+=Gn),s<a){for(s&&t.d.push(+n.slice(0,s)),a-=Gn;s<a;)t.d.push(+n.slice(s,s+=Gn));n=n.slice(s),s=Gn-n.length}else s-=a;for(;s--;)n+="0";if(t.d.push(+n),er&&(t.e>xg||t.e<-xg))throw Error($k+r)}else t.s=0,t.e=0,t.d=[0];return t}function Dn(t,n,r){var s,a,i,o,c,u,m,h,f=t.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(s=n-o,s<0)s+=Gn,a=n,m=f[h=0];else{if(h=Math.ceil((s+1)/Gn),i=f.length,h>=i)return t;for(m=i=f[h],o=1;i>=10;i/=10)o++;s%=Gn,a=s-Gn+o}if(r!==void 0&&(i=rc(10,o-a-1),c=m/i%10|0,u=n<0||f[h+1]!==void 0||m%i,u=r<4?(c||u)&&(r==0||r==(t.s<0?3:2)):c>5||c==5&&(r==4||u||r==6&&(s>0?a>0?m/rc(10,o-a):0:f[h-1])%10&1||r==(t.s<0?8:7))),n<1||!f[0])return u?(i=br(t),f.length=1,n=n-i-1,f[0]=rc(10,(Gn-n%Gn)%Gn),t.e=Wu(-n/Gn)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(s==0?(f.length=h,i=1,h--):(f.length=h+1,i=rc(10,Gn-s),f[h]=a>0?(m/rc(10,o-a)%rc(10,a)|0)*i:0),u)for(;;)if(h==0){(f[0]+=i)==zr&&(f[0]=1,++t.e);break}else{if(f[h]+=i,f[h]!=zr)break;f[h--]=0,i=1}for(s=f.length;f[--s]===0;)f.pop();if(er&&(t.e>xg||t.e<-xg))throw Error($k+br(t));return t}function bz(t,n){var r,s,a,i,o,c,u,m,h,f,x=t.constructor,j=x.precision;if(!t.s||!n.s)return n.s?n.s=-n.s:n=new x(t),er?Dn(n,j):n;if(u=t.d,f=n.d,s=n.e,m=t.e,u=u.slice(),o=m-s,o){for(h=o<0,h?(r=u,o=-o,c=f.length):(r=f,s=m,c=u.length),a=Math.max(Math.ceil(j/Gn),c)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=u.length,c=f.length,h=a<c,h&&(c=a),a=0;a<c;a++)if(u[a]!=f[a]){h=u[a]<f[a];break}o=0}for(h&&(r=u,u=f,f=r,n.s=-n.s),c=u.length,a=f.length-c;a>0;--a)u[c++]=0;for(a=f.length;a>o;){if(u[--a]<f[a]){for(i=a;i&&u[--i]===0;)u[i]=zr-1;--u[i],u[a]+=zr}u[a]-=f[a]}for(;u[--c]===0;)u.pop();for(;u[0]===0;u.shift())--s;return u[0]?(n.d=u,n.e=s,er?Dn(n,j):n):new x(0)}function Oc(t,n,r){var s,a=br(t),i=Mi(t.d),o=i.length;return n?(r&&(s=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+ll(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ll(-a-1)+i,r&&(s=r-o)>0&&(i+=ll(s))):a>=o?(i+=ll(a+1-o),r&&(s=r-a-1)>0&&(i=i+"."+ll(s))):((s=a+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-o)>0&&(a+1===o&&(i+="."),i+=ll(s))),t.s<0?"-"+i:i}function J4(t,n){if(t.length>n)return t.length=n,!0}function wz(t){var n,r,s;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(gc+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return Z4(o,i.toString())}else if(typeof i!="string")throw Error(gc+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,Ace.test(i))Z4(o,i);else throw Error(gc+i)}if(a.prototype=jt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=wz,a.config=a.set=Ece,t===void 0&&(t={}),t)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<s.length;)t.hasOwnProperty(r=s[n++])||(t[r]=this[r]);return a.config(t),a}function Ece(t){if(!t||typeof t!="object")throw Error(Va+"Object expected");var n,r,s,a=["precision",1,Ku,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(n=0;n<a.length;n+=3)if((s=t[r=a[n]])!==void 0)if(Wu(s)===s&&s>=a[n+1]&&s<=a[n+2])this[r]=s;else throw Error(gc+r+": "+s);if((s=t[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(gc+r+": "+s);return this}var Fk=wz(Pce);pa=new Fk(1);const On=Fk;function Oce(t){return Dce(t)||Rce(t)||Mce(t)||Tce()}function Tce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mce(t,n){if(t){if(typeof t=="string")return Q1(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q1(t,n)}}function Rce(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Dce(t){if(Array.isArray(t))return Q1(t)}function Q1(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}var $ce=function(n){return n},_z={},Nz=function(n){return n===_z},eD=function(n){return function r(){return arguments.length===0||arguments.length===1&&Nz(arguments.length<=0?void 0:arguments[0])?r:n.apply(void 0,arguments)}},Fce=function t(n,r){return n===1?r:eD(function(){for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];var o=a.filter(function(c){return c!==_z}).length;return o>=n?r.apply(void 0,a):t(n-o,eD(function(){for(var c=arguments.length,u=new Array(c),m=0;m<c;m++)u[m]=arguments[m];var h=a.map(function(f){return Nz(f)?u.shift():f});return r.apply(void 0,Oce(h).concat(u))}))})},Zv=function(n){return Fce(n.length,n)},X1=function(n,r){for(var s=[],a=n;a<r;++a)s[a-n]=a;return s},Lce=Zv(function(t,n){return Array.isArray(n)?n.map(t):Object.keys(n).map(function(r){return n[r]}).map(t)}),Ice=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];if(!r.length)return $ce;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(c,u){return u(c)},i.apply(void 0,arguments))}},Z1=function(n){return Array.isArray(n)?n.reverse():n.split("").reverse.join("")},Sz=function(n){var r=null,s=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(c,u){return c===r[u]})||(r=i,s=n.apply(void 0,i)),s}};function qce(t){var n;return t===0?n=1:n=Math.floor(new On(t).abs().log(10).toNumber())+1,n}function Bce(t,n,r){for(var s=new On(t),a=0,i=[];s.lt(n)&&a<1e5;)i.push(s.toNumber()),s=s.add(r),a++;return i}var zce=Zv(function(t,n,r){var s=+t,a=+n;return s+r*(a-s)}),Vce=Zv(function(t,n,r){var s=n-+t;return s=s||1/0,(r-t)/s}),Uce=Zv(function(t,n,r){var s=n-+t;return s=s||1/0,Math.max(0,Math.min(1,(r-t)/s))});const Jv={rangeStep:Bce,getDigitCount:qce,interpolateNumber:zce,uninterpolateNumber:Vce,uninterpolateTruncation:Uce};function J1(t){return Hce(t)||Wce(t)||Cz(t)||Kce()}function Kce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wce(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Hce(t){if(Array.isArray(t))return eS(t)}function Kh(t,n){return Qce(t)||Yce(t,n)||Cz(t,n)||Gce()}function Gce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cz(t,n){if(t){if(typeof t=="string")return eS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eS(t,n)}}function eS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function Yce(t,n){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],s=!0,a=!1,i=void 0;try{for(var o=t[Symbol.iterator](),c;!(s=(c=o.next()).done)&&(r.push(c.value),!(n&&r.length===n));s=!0);}catch(u){a=!0,i=u}finally{try{!s&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function Qce(t){if(Array.isArray(t))return t}function kz(t){var n=Kh(t,2),r=n[0],s=n[1],a=r,i=s;return r>s&&(a=s,i=r),[a,i]}function Pz(t,n,r){if(t.lte(0))return new On(0);var s=Jv.getDigitCount(t.toNumber()),a=new On(10).pow(s),i=t.div(a),o=s!==1?.05:.1,c=new On(Math.ceil(i.div(o).toNumber())).add(r).mul(o),u=c.mul(a);return n?u:new On(Math.ceil(u))}function Xce(t,n,r){var s=1,a=new On(t);if(!a.isint()&&r){var i=Math.abs(t);i<1?(s=new On(10).pow(Jv.getDigitCount(t)-1),a=new On(Math.floor(a.div(s).toNumber())).mul(s)):i>1&&(a=new On(Math.floor(t)))}else t===0?a=new On(Math.floor((n-1)/2)):r||(a=new On(Math.floor(t)));var o=Math.floor((n-1)/2),c=Ice(Lce(function(u){return a.add(new On(u-o).mul(s)).toNumber()}),X1);return c(0,n)}function Az(t,n,r,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(r-1)))return{step:new On(0),tickMin:new On(0),tickMax:new On(0)};var i=Pz(new On(n).sub(t).div(r-1),s,a),o;t<=0&&n>=0?o=new On(0):(o=new On(t).add(n).div(2),o=o.sub(new On(o).mod(i)));var c=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new On(n).sub(o).div(i).toNumber()),m=c+u+1;return m>r?Az(t,n,r,s,a+1):(m<r&&(u=n>0?u+(r-m):u,c=n>0?c:c+(r-m)),{step:i,tickMin:o.sub(new On(c).mul(i)),tickMax:o.add(new On(u).mul(i))})}function Zce(t){var n=Kh(t,2),r=n[0],s=n[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),c=kz([r,s]),u=Kh(c,2),m=u[0],h=u[1];if(m===-1/0||h===1/0){var f=h===1/0?[m].concat(J1(X1(0,a-1).map(function(){return 1/0}))):[].concat(J1(X1(0,a-1).map(function(){return-1/0})),[h]);return r>s?Z1(f):f}if(m===h)return Xce(m,a,i);var x=Az(m,h,o,i),j=x.step,b=x.tickMin,g=x.tickMax,y=Jv.rangeStep(b,g.add(new On(.1).mul(j)),j);return r>s?Z1(y):y}function Jce(t,n){var r=Kh(t,2),s=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=kz([s,a]),c=Kh(o,2),u=c[0],m=c[1];if(u===-1/0||m===1/0)return[s,a];if(u===m)return[u];var h=Math.max(n,2),f=Pz(new On(m).sub(u).div(h-1),i,0),x=[].concat(J1(Jv.rangeStep(new On(u),new On(m).sub(new On(.99).mul(f)),f)),[m]);return s>a?Z1(x):x}var ede=Sz(Zce),tde=Sz(Jce),nde="Invariant failed";function Tc(t,n){throw new Error(nde)}var rde=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function hu(t){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},hu(t)}function gg(){return gg=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},gg.apply(this,arguments)}function sde(t,n){return lde(t)||ode(t,n)||ide(t,n)||ade()}function ade(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ide(t,n){if(t){if(typeof t=="string")return tD(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tD(t,n)}}function tD(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function ode(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function lde(t){if(Array.isArray(t))return t}function cde(t,n){if(t==null)return{};var r=dde(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function dde(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function ude(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function mde(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,Tz(s.key),s)}}function hde(t,n,r){return n&&mde(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function fde(t,n,r){return n=vg(n),pde(t,Ez()?Reflect.construct(n,r||[],vg(t).constructor):n.apply(t,r))}function pde(t,n){if(n&&(hu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xde(t)}function xde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ez(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ez=function(){return!!t})()}function vg(t){return vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vg(t)}function gde(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&tS(t,n)}function tS(t,n){return tS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},tS(t,n)}function Oz(t,n,r){return n=Tz(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Tz(t){var n=vde(t,"string");return hu(n)=="symbol"?n:n+""}function vde(t,n){if(hu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(hu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ey=(function(t){function n(){return ude(this,n),fde(this,n,arguments)}return gde(n,t),hde(n,[{key:"render",value:function(){var s=this.props,a=s.offset,i=s.layout,o=s.width,c=s.dataKey,u=s.data,m=s.dataPointFormatter,h=s.xAxis,f=s.yAxis,x=cde(s,rde),j=Wt(x,!1);this.props.direction==="x"&&h.type!=="number"&&Tc();var b=u.map(function(g){var y=m(g,c),C=y.x,k=y.y,N=y.value,P=y.errorVal;if(!P)return null;var w=[],S,E;if(Array.isArray(P)){var R=sde(P,2);S=R[0],E=R[1]}else S=E=P;if(i==="vertical"){var T=h.scale,U=k+a,M=U+o,L=U-o,q=T(N-S),$=T(N+E);w.push({x1:$,y1:M,x2:$,y2:L}),w.push({x1:q,y1:U,x2:$,y2:U}),w.push({x1:q,y1:M,x2:q,y2:L})}else if(i==="horizontal"){var D=f.scale,z=C+a,J=z-o,I=z+o,X=D(N-S),ne=D(N+E);w.push({x1:J,y1:ne,x2:I,y2:ne}),w.push({x1:z,y1:X,x2:z,y2:ne}),w.push({x1:J,y1:X,x2:I,y2:X})}return le.createElement(An,gg({className:"recharts-errorBar",key:"bar-".concat(w.map(function(W){return"".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2)}))},j),w.map(function(W){return le.createElement("line",gg({},W,{key:"line-".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2)}))}))});return le.createElement(An,{className:"recharts-errorBars"},b)}}])})(le.Component);Oz(ey,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Oz(ey,"displayName","ErrorBar");function Wh(t){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Wh(t)}function nD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Zl(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?nD(Object(r),!0).forEach(function(s){yde(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function yde(t,n,r){return n=jde(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function jde(t){var n=bde(t,"string");return Wh(n)=="symbol"?n:n+""}function bde(t,n){if(Wh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Wh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var Mz=function(n){var r=n.children,s=n.formattedGraphicalItems,a=n.legendWidth,i=n.legendContent,o=ma(r,pc);if(!o)return null;var c=pc.defaultProps,u=c!==void 0?Zl(Zl({},c),o.props):{},m;return o.props&&o.props.payload?m=o.props&&o.props.payload:i==="children"?m=(s||[]).reduce(function(h,f){var x=f.item,j=f.props,b=j.sectors||j.data||[];return h.concat(b.map(function(g){return{type:o.props.iconType||x.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):m=(s||[]).map(function(h){var f=h.item,x=f.type.defaultProps,j=x!==void 0?Zl(Zl({},x),f.props):{},b=j.dataKey,g=j.name,y=j.legendType,C=j.hide;return{inactive:C,dataKey:b,type:u.iconType||y||"square",color:Lk(f),value:g||b,payload:j}}),Zl(Zl(Zl({},u),pc.getWithHeight(o,a)),{},{payload:m,item:o})};function Hh(t){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Hh(t)}function rD(t){return Sde(t)||Nde(t)||_de(t)||wde()}function wde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _de(t,n){if(t){if(typeof t=="string")return nS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nS(t,n)}}function Nde(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Sde(t){if(Array.isArray(t))return nS(t)}function nS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function sD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function cr(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?sD(Object(r),!0).forEach(function(s){Ud(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ud(t,n,r){return n=Cde(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Cde(t){var n=kde(t,"string");return Hh(n)=="symbol"?n:n+""}function kde(t,n){if(Hh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Hh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function hs(t,n,r){return hn(t)||hn(n)?r:Dr(n)?ya(t,n,r):Yt(n)?n(t):r}function ah(t,n,r,s){var a=Sce(t,function(c){return hs(c,n)});if(r==="number"){var i=a.filter(function(c){return it(c)||parseFloat(c)});return i.length?[Qv(i),Yv(i)]:[1/0,-1/0]}var o=s?a.filter(function(c){return!hn(c)}):a;return o.map(function(c){return Dr(c)||c instanceof Date?c:""})}var Pde=function(n){var r,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,c=(r=s?.length)!==null&&r!==void 0?r:0;if(c<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var u=i.range,m=0;m<c;m++){var h=m>0?a[m-1].coordinate:a[c-1].coordinate,f=a[m].coordinate,x=m>=c-1?a[0].coordinate:a[m+1].coordinate,j=void 0;if(ks(f-h)!==ks(x-f)){var b=[];if(ks(x-f)===ks(u[1]-u[0])){j=x;var g=f+u[1]-u[0];b[0]=Math.min(g,(g+h)/2),b[1]=Math.max(g,(g+h)/2)}else{j=h;var y=x+u[1]-u[0];b[0]=Math.min(f,(y+f)/2),b[1]=Math.max(f,(y+f)/2)}var C=[Math.min(f,(j+f)/2),Math.max(f,(j+f)/2)];if(n>C[0]&&n<=C[1]||n>=b[0]&&n<=b[1]){o=a[m].index;break}}else{var k=Math.min(h,x),N=Math.max(h,x);if(n>(k+f)/2&&n<=(N+f)/2){o=a[m].index;break}}}else for(var P=0;P<c;P++)if(P===0&&n<=(s[P].coordinate+s[P+1].coordinate)/2||P>0&&P<c-1&&n>(s[P].coordinate+s[P-1].coordinate)/2&&n<=(s[P].coordinate+s[P+1].coordinate)/2||P===c-1&&n>(s[P].coordinate+s[P-1].coordinate)/2){o=s[P].index;break}return o},Lk=function(n){var r,s=n,a=s.type.displayName,i=(r=n.type)!==null&&r!==void 0&&r.defaultProps?cr(cr({},n.type.defaultProps),n.props):n.props,o=i.stroke,c=i.fill,u;switch(a){case"Line":u=o;break;case"Area":case"Radar":u=o&&o!=="none"?o:c;break;default:u=c;break}return u},Ade=function(n){var r=n.barSize,s=n.totalSize,a=n.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},c=Object.keys(i),u=0,m=c.length;u<m;u++)for(var h=i[c[u]].stackGroups,f=Object.keys(h),x=0,j=f.length;x<j;x++){var b=h[f[x]],g=b.items,y=b.cateAxisId,C=g.filter(function(E){return fo(E.type).indexOf("Bar")>=0});if(C&&C.length){var k=C[0].type.defaultProps,N=k!==void 0?cr(cr({},k),C[0].props):C[0].props,P=N.barSize,w=N[y];o[w]||(o[w]=[]);var S=hn(P)?r:P;o[w].push({item:C[0],stackList:C.slice(1),barSize:hn(S)?void 0:Ps(S,s,0)})}}return o},Ede=function(n){var r=n.barGap,s=n.barCategoryGap,a=n.bandSize,i=n.sizeList,o=i===void 0?[]:i,c=n.maxBarSize,u=o.length;if(u<1)return null;var m=Ps(r,a,0,!0),h,f=[];if(o[0].barSize===+o[0].barSize){var x=!1,j=a/u,b=o.reduce(function(P,w){return P+w.barSize||0},0);b+=(u-1)*m,b>=a&&(b-=(u-1)*m,m=0),b>=a&&j>0&&(x=!0,j*=.9,b=u*j);var g=(a-b)/2>>0,y={offset:g-m,size:0};h=o.reduce(function(P,w){var S={item:w.item,position:{offset:y.offset+y.size+m,size:x?j:w.barSize}},E=[].concat(rD(P),[S]);return y=E[E.length-1].position,w.stackList&&w.stackList.length&&w.stackList.forEach(function(R){E.push({item:R,position:y})}),E},f)}else{var C=Ps(s,a,0,!0);a-2*C-(u-1)*m<=0&&(m=0);var k=(a-2*C-(u-1)*m)/u;k>1&&(k>>=0);var N=c===+c?Math.min(k,c):k;h=o.reduce(function(P,w,S){var E=[].concat(rD(P),[{item:w.item,position:{offset:C+(k+m)*S+(k-N)/2,size:N}}]);return w.stackList&&w.stackList.length&&w.stackList.forEach(function(R){E.push({item:R,position:E[E.length-1].position})}),E},f)}return h},Ode=function(n,r,s,a){var i=s.children,o=s.width,c=s.margin,u=o-(c.left||0)-(c.right||0),m=Mz({children:i,legendWidth:u});if(m){var h=a||{},f=h.width,x=h.height,j=m.align,b=m.verticalAlign,g=m.layout;if((g==="vertical"||g==="horizontal"&&b==="middle")&&j!=="center"&&it(n[j]))return cr(cr({},n),{},Ud({},j,n[j]+(f||0)));if((g==="horizontal"||g==="vertical"&&j==="center")&&b!=="middle"&&it(n[b]))return cr(cr({},n),{},Ud({},b,n[b]+(x||0)))}return n},Tde=function(n,r,s){return hn(r)?!0:n==="horizontal"?r==="yAxis":n==="vertical"||s==="x"?r==="xAxis":s==="y"?r==="yAxis":!0},Rz=function(n,r,s,a,i){var o=r.props.children,c=qa(o,ey).filter(function(m){return Tde(a,i,m.props.direction)});if(c&&c.length){var u=c.map(function(m){return m.props.dataKey});return n.reduce(function(m,h){var f=hs(h,s);if(hn(f))return m;var x=Array.isArray(f)?[Qv(f),Yv(f)]:[f,f],j=u.reduce(function(b,g){var y=hs(h,g,0),C=x[0]-Math.abs(Array.isArray(y)?y[0]:y),k=x[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(C,b[0]),Math.max(k,b[1])]},[1/0,-1/0]);return[Math.min(j[0],m[0]),Math.max(j[1],m[1])]},[1/0,-1/0])}return null},Mde=function(n,r,s,a,i){var o=r.map(function(c){return Rz(n,c,s,i,a)}).filter(function(c){return!hn(c)});return o&&o.length?o.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]):null},Dz=function(n,r,s,a,i){var o=r.map(function(u){var m=u.props.dataKey;return s==="number"&&m&&Rz(n,u,m,a)||ah(n,m,s,i)});if(s==="number")return o.reduce(function(u,m){return[Math.min(u[0],m[0]),Math.max(u[1],m[1])]},[1/0,-1/0]);var c={};return o.reduce(function(u,m){for(var h=0,f=m.length;h<f;h++)c[m[h]]||(c[m[h]]=!0,u.push(m[h]));return u},[])},$z=function(n,r){return n==="horizontal"&&r==="xAxis"||n==="vertical"&&r==="yAxis"||n==="centric"&&r==="angleAxis"||n==="radial"&&r==="radiusAxis"},Fz=function(n,r,s,a){if(a)return n.map(function(u){return u.coordinate});var i,o,c=n.map(function(u){return u.coordinate===r&&(i=!0),u.coordinate===s&&(o=!0),u.coordinate});return i||c.push(r),o||c.push(s),c},mo=function(n,r,s){if(!n)return null;var a=n.scale,i=n.duplicateDomain,o=n.type,c=n.range,u=n.realScaleType==="scaleBand"?a.bandwidth()/2:2,m=(r||s)&&o==="category"&&a.bandwidth?a.bandwidth()/u:0;if(m=n.axisType==="angleAxis"&&c?.length>=2?ks(c[0]-c[1])*2*m:m,r&&(n.ticks||n.niceTicks)){var h=(n.ticks||n.niceTicks).map(function(f){var x=i?i.indexOf(f):f;return{coordinate:a(x)+m,value:f,offset:m}});return h.filter(function(f){return!Mf(f.coordinate)})}return n.isCategorical&&n.categoricalDomain?n.categoricalDomain.map(function(f,x){return{coordinate:a(f)+m,value:f,index:x,offset:m}}):a.ticks&&!s?a.ticks(n.tickCount).map(function(f){return{coordinate:a(f)+m,value:f,offset:m}}):a.domain().map(function(f,x){return{coordinate:a(f)+m,value:i?i[f]:f,index:x,offset:m}})},X_=new WeakMap,ox=function(n,r){if(typeof r!="function")return n;X_.has(n)||X_.set(n,new WeakMap);var s=X_.get(n);if(s.has(r))return s.get(r);var a=function(){n.apply(void 0,arguments),r.apply(void 0,arguments)};return s.set(r,a),a},Lz=function(n,r,s){var a=n.scale,i=n.type,o=n.layout,c=n.axisType;if(a==="auto")return o==="radial"&&c==="radiusAxis"?{scale:Ih(),realScaleType:"band"}:o==="radial"&&c==="angleAxis"?{scale:mg(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!s)?{scale:sh(),realScaleType:"point"}:i==="category"?{scale:Ih(),realScaleType:"band"}:{scale:mg(),realScaleType:"linear"};if(Pc(a)){var u="scale".concat(Rv(a));return{scale:(V4[u]||sh)(),realScaleType:V4[u]?u:"point"}}return Yt(a)?{scale:a}:{scale:sh(),realScaleType:"point"}},aD=1e-4,Iz=function(n){var r=n.domain();if(!(!r||r.length<=2)){var s=r.length,a=n.range(),i=Math.min(a[0],a[1])-aD,o=Math.max(a[0],a[1])+aD,c=n(r[0]),u=n(r[s-1]);(c<i||c>o||u<i||u>o)&&n.domain([r[0],r[s-1]])}},Rde=function(n,r){if(!n)return null;for(var s=0,a=n.length;s<a;s++)if(n[s].item===r)return n[s].position;return null},Dde=function(n,r){if(!r||r.length!==2||!it(r[0])||!it(r[1]))return n;var s=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[n[0],n[1]];return(!it(n[0])||n[0]<s)&&(i[0]=s),(!it(n[1])||n[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<s&&(i[1]=s),i},$de=function(n){var r=n.length;if(!(r<=0))for(var s=0,a=n[0].length;s<a;++s)for(var i=0,o=0,c=0;c<r;++c){var u=Mf(n[c][s][1])?n[c][s][0]:n[c][s][1];u>=0?(n[c][s][0]=i,n[c][s][1]=i+u,i=n[c][s][1]):(n[c][s][0]=o,n[c][s][1]=o+u,o=n[c][s][1])}},Fde=function(n){var r=n.length;if(!(r<=0))for(var s=0,a=n[0].length;s<a;++s)for(var i=0,o=0;o<r;++o){var c=Mf(n[o][s][1])?n[o][s][0]:n[o][s][1];c>=0?(n[o][s][0]=i,n[o][s][1]=i+c,i=n[o][s][1]):(n[o][s][0]=0,n[o][s][1]=0)}},Lde={sign:$de,expand:Sre,none:au,silhouette:Cre,wiggle:kre,positive:Fde},Ide=function(n,r,s){var a=r.map(function(c){return c.props.dataKey}),i=Lde[s],o=Nre().keys(a).value(function(c,u){return+hs(c,u,0)}).order(T1).offset(i);return o(n)},qde=function(n,r,s,a,i,o){if(!n)return null;var c=o?r.reverse():r,u={},m=c.reduce(function(f,x){var j,b=(j=x.type)!==null&&j!==void 0&&j.defaultProps?cr(cr({},x.type.defaultProps),x.props):x.props,g=b.stackId,y=b.hide;if(y)return f;var C=b[s],k=f[C]||{hasStack:!1,stackGroups:{}};if(Dr(g)){var N=k.stackGroups[g]||{numericAxisId:s,cateAxisId:a,items:[]};N.items.push(x),k.hasStack=!0,k.stackGroups[g]=N}else k.stackGroups[Rf("_stackId_")]={numericAxisId:s,cateAxisId:a,items:[x]};return cr(cr({},f),{},Ud({},C,k))},u),h={};return Object.keys(m).reduce(function(f,x){var j=m[x];if(j.hasStack){var b={};j.stackGroups=Object.keys(j.stackGroups).reduce(function(g,y){var C=j.stackGroups[y];return cr(cr({},g),{},Ud({},y,{numericAxisId:s,cateAxisId:a,items:C.items,stackedData:Ide(n,C.items,i)}))},b)}return cr(cr({},f),{},Ud({},x,j))},h)},qz=function(n,r){var s=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,c=r.allowDecimals,u=s||r.scale;if(u!=="auto"&&u!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var m=n.domain();if(!m.length)return null;var h=ede(m,i,c);return n.domain([Qv(h),Yv(h)]),{niceTicks:h}}if(i&&a==="number"){var f=n.domain(),x=tde(f,i,c);return{niceTicks:x}}return null},iD=function(n){var r=n.axis,s=n.ticks,a=n.offset,i=n.bandSize,o=n.entry,c=n.index;if(r.type==="category")return s[c]?s[c].coordinate+a:null;var u=hs(o,r.dataKey,r.domain[c]);return hn(u)?null:r.scale(u)-i/2+a},Bde=function(n){var r=n.numericAxis,s=r.scale.domain();if(r.type==="number"){var a=Math.min(s[0],s[1]),i=Math.max(s[0],s[1]);return a<=0&&i>=0?0:i<0?i:a}return s[0]},zde=function(n,r){var s,a=(s=n.type)!==null&&s!==void 0&&s.defaultProps?cr(cr({},n.type.defaultProps),n.props):n.props,i=a.stackId;if(Dr(i)){var o=r[i];if(o){var c=o.items.indexOf(n);return c>=0?o.stackedData[c]:null}}return null},Vde=function(n){return n.reduce(function(r,s){return[Qv(s.concat([r[0]]).filter(it)),Yv(s.concat([r[1]]).filter(it))]},[1/0,-1/0])},Bz=function(n,r,s){return Object.keys(n).reduce(function(a,i){var o=n[i],c=o.stackedData,u=c.reduce(function(m,h){var f=Vde(h.slice(r,s+1));return[Math.min(m[0],f[0]),Math.max(m[1],f[1])]},[1/0,-1/0]);return[Math.min(u[0],a[0]),Math.max(u[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},oD=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,lD=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,rS=function(n,r,s){if(Yt(n))return n(r,s);if(!Array.isArray(n))return r;var a=[];if(it(n[0]))a[0]=s?n[0]:Math.min(n[0],r[0]);else if(oD.test(n[0])){var i=+oD.exec(n[0])[1];a[0]=r[0]-i}else Yt(n[0])?a[0]=n[0](r[0]):a[0]=r[0];if(it(n[1]))a[1]=s?n[1]:Math.max(n[1],r[1]);else if(lD.test(n[1])){var o=+lD.exec(n[1])[1];a[1]=r[1]+o}else Yt(n[1])?a[1]=n[1](r[1]):a[1]=r[1];return a},yg=function(n,r,s){if(n&&n.scale&&n.scale.bandwidth){var a=n.scale.bandwidth();if(!s||a>0)return a}if(n&&r&&r.length>=2){for(var i=mk(r,function(f){return f.coordinate}),o=1/0,c=1,u=i.length;c<u;c++){var m=i[c],h=i[c-1];o=Math.min((m.coordinate||0)-(h.coordinate||0),o)}return o===1/0?0:o}return s?void 0:0},cD=function(n,r,s){return!n||!n.length||Xv(n,ya(s,"type.defaultProps.domain"))?r:n},zz=function(n,r){var s=n.type.defaultProps?cr(cr({},n.type.defaultProps),n.props):n.props,a=s.dataKey,i=s.name,o=s.unit,c=s.formatter,u=s.tooltipType,m=s.chartType,h=s.hide;return cr(cr({},Wt(n,!1)),{},{dataKey:a,unit:o,formatter:c,name:i||a,color:Lk(n),value:hs(r,a),type:u,payload:r,chartType:m,hide:h})};function Gh(t){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gh(t)}function dD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function ao(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?dD(Object(r),!0).forEach(function(s){Vz(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Vz(t,n,r){return n=Ude(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Ude(t){var n=Kde(t,"string");return Gh(n)=="symbol"?n:n+""}function Kde(t,n){if(Gh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Gh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Wde(t,n){return Qde(t)||Yde(t,n)||Gde(t,n)||Hde()}function Hde(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gde(t,n){if(t){if(typeof t=="string")return uD(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uD(t,n)}}function uD(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function Yde(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function Qde(t){if(Array.isArray(t))return t}var jg=Math.PI/180,Xde=function(n){return n*180/Math.PI},Un=function(n,r,s,a){return{x:n+Math.cos(-jg*a)*s,y:r+Math.sin(-jg*a)*s}},Uz=function(n,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(n-(s.left||0)-(s.right||0)),Math.abs(r-(s.top||0)-(s.bottom||0)))/2},Zde=function(n,r,s,a,i){var o=n.width,c=n.height,u=n.startAngle,m=n.endAngle,h=Ps(n.cx,o,o/2),f=Ps(n.cy,c,c/2),x=Uz(o,c,s),j=Ps(n.innerRadius,x,0),b=Ps(n.outerRadius,x,x*.8),g=Object.keys(r);return g.reduce(function(y,C){var k=r[C],N=k.domain,P=k.reversed,w;if(hn(k.range))a==="angleAxis"?w=[u,m]:a==="radiusAxis"&&(w=[j,b]),P&&(w=[w[1],w[0]]);else{w=k.range;var S=w,E=Wde(S,2);u=E[0],m=E[1]}var R=Lz(k,i),T=R.realScaleType,U=R.scale;U.domain(N).range(w),Iz(U);var M=qz(U,ao(ao({},k),{},{realScaleType:T})),L=ao(ao(ao({},k),M),{},{range:w,radius:b,realScaleType:T,scale:U,cx:h,cy:f,innerRadius:j,outerRadius:b,startAngle:u,endAngle:m});return ao(ao({},y),{},Vz({},C,L))},{})},Jde=function(n,r){var s=n.x,a=n.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(s-i,2)+Math.pow(a-o,2))},eue=function(n,r){var s=n.x,a=n.y,i=r.cx,o=r.cy,c=Jde({x:s,y:a},{x:i,y:o});if(c<=0)return{radius:c};var u=(s-i)/c,m=Math.acos(u);return a>o&&(m=2*Math.PI-m),{radius:c,angle:Xde(m),angleInRadian:m}},tue=function(n){var r=n.startAngle,s=n.endAngle,a=Math.floor(r/360),i=Math.floor(s/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:s-o*360}},nue=function(n,r){var s=r.startAngle,a=r.endAngle,i=Math.floor(s/360),o=Math.floor(a/360),c=Math.min(i,o);return n+c*360},mD=function(n,r){var s=n.x,a=n.y,i=eue({x:s,y:a},r),o=i.radius,c=i.angle,u=r.innerRadius,m=r.outerRadius;if(o<u||o>m)return!1;if(o===0)return!0;var h=tue(r),f=h.startAngle,x=h.endAngle,j=c,b;if(f<=x){for(;j>x;)j-=360;for(;j<f;)j+=360;b=j>=f&&j<=x}else{for(;j>f;)j-=360;for(;j<x;)j+=360;b=j>=x&&j<=f}return b?ao(ao({},r),{},{radius:o,angle:nue(j,r)}):null},Kz=function(n){return!v.isValidElement(n)&&!Yt(n)&&typeof n!="boolean"?n.className:""};function Yh(t){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Yh(t)}var rue=["offset"];function sue(t){return lue(t)||oue(t)||iue(t)||aue()}function aue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iue(t,n){if(t){if(typeof t=="string")return sS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sS(t,n)}}function oue(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lue(t){if(Array.isArray(t))return sS(t)}function sS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function cue(t,n){if(t==null)return{};var r=due(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function due(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function hD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Tr(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?hD(Object(r),!0).forEach(function(s){uue(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function uue(t,n,r){return n=mue(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function mue(t){var n=hue(t,"string");return Yh(n)=="symbol"?n:n+""}function hue(t,n){if(Yh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Yh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Qh(){return Qh=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Qh.apply(this,arguments)}var fue=function(n){var r=n.value,s=n.formatter,a=hn(n.children)?r:n.children;return Yt(s)?s(a):a},pue=function(n,r){var s=ks(r-n),a=Math.min(Math.abs(r-n),360);return s*a},xue=function(n,r,s){var a=n.position,i=n.viewBox,o=n.offset,c=n.className,u=i,m=u.cx,h=u.cy,f=u.innerRadius,x=u.outerRadius,j=u.startAngle,b=u.endAngle,g=u.clockWise,y=(f+x)/2,C=pue(j,b),k=C>=0?1:-1,N,P;a==="insideStart"?(N=j+k*o,P=g):a==="insideEnd"?(N=b-k*o,P=!g):a==="end"&&(N=b+k*o,P=g),P=C<=0?P:!P;var w=Un(m,h,y,N),S=Un(m,h,y,N+(P?1:-1)*359),E="M".concat(w.x,",").concat(w.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(P?0:1,`,
    `).concat(S.x,",").concat(S.y),R=hn(n.id)?Rf("recharts-radial-line-"):n.id;return le.createElement("text",Qh({},s,{dominantBaseline:"central",className:rn("recharts-radial-bar-label",c)}),le.createElement("defs",null,le.createElement("path",{id:R,d:E})),le.createElement("textPath",{xlinkHref:"#".concat(R)},r))},gue=function(n){var r=n.viewBox,s=n.offset,a=n.position,i=r,o=i.cx,c=i.cy,u=i.innerRadius,m=i.outerRadius,h=i.startAngle,f=i.endAngle,x=(h+f)/2;if(a==="outside"){var j=Un(o,c,m+s,x),b=j.x,g=j.y;return{x:b,y:g,textAnchor:b>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"end"};var y=(u+m)/2,C=Un(o,c,y,x),k=C.x,N=C.y;return{x:k,y:N,textAnchor:"middle",verticalAnchor:"middle"}},vue=function(n){var r=n.viewBox,s=n.parentViewBox,a=n.offset,i=n.position,o=r,c=o.x,u=o.y,m=o.width,h=o.height,f=h>=0?1:-1,x=f*a,j=f>0?"end":"start",b=f>0?"start":"end",g=m>=0?1:-1,y=g*a,C=g>0?"end":"start",k=g>0?"start":"end";if(i==="top"){var N={x:c+m/2,y:u-f*a,textAnchor:"middle",verticalAnchor:j};return Tr(Tr({},N),s?{height:Math.max(u-s.y,0),width:m}:{})}if(i==="bottom"){var P={x:c+m/2,y:u+h+x,textAnchor:"middle",verticalAnchor:b};return Tr(Tr({},P),s?{height:Math.max(s.y+s.height-(u+h),0),width:m}:{})}if(i==="left"){var w={x:c-y,y:u+h/2,textAnchor:C,verticalAnchor:"middle"};return Tr(Tr({},w),s?{width:Math.max(w.x-s.x,0),height:h}:{})}if(i==="right"){var S={x:c+m+y,y:u+h/2,textAnchor:k,verticalAnchor:"middle"};return Tr(Tr({},S),s?{width:Math.max(s.x+s.width-S.x,0),height:h}:{})}var E=s?{width:m,height:h}:{};return i==="insideLeft"?Tr({x:c+y,y:u+h/2,textAnchor:k,verticalAnchor:"middle"},E):i==="insideRight"?Tr({x:c+m-y,y:u+h/2,textAnchor:C,verticalAnchor:"middle"},E):i==="insideTop"?Tr({x:c+m/2,y:u+x,textAnchor:"middle",verticalAnchor:b},E):i==="insideBottom"?Tr({x:c+m/2,y:u+h-x,textAnchor:"middle",verticalAnchor:j},E):i==="insideTopLeft"?Tr({x:c+y,y:u+x,textAnchor:k,verticalAnchor:b},E):i==="insideTopRight"?Tr({x:c+m-y,y:u+x,textAnchor:C,verticalAnchor:b},E):i==="insideBottomLeft"?Tr({x:c+y,y:u+h-x,textAnchor:k,verticalAnchor:j},E):i==="insideBottomRight"?Tr({x:c+m-y,y:u+h-x,textAnchor:C,verticalAnchor:j},E):Bu(i)&&(it(i.x)||lc(i.x))&&(it(i.y)||lc(i.y))?Tr({x:c+Ps(i.x,m),y:u+Ps(i.y,h),textAnchor:"end",verticalAnchor:"end"},E):Tr({x:c+m/2,y:u+h/2,textAnchor:"middle",verticalAnchor:"middle"},E)},yue=function(n){return"cx"in n&&it(n.cx)};function Vr(t){var n=t.offset,r=n===void 0?5:n,s=cue(t,rue),a=Tr({offset:r},s),i=a.viewBox,o=a.position,c=a.value,u=a.children,m=a.content,h=a.className,f=h===void 0?"":h,x=a.textBreakAll;if(!i||hn(c)&&hn(u)&&!v.isValidElement(m)&&!Yt(m))return null;if(v.isValidElement(m))return v.cloneElement(m,a);var j;if(Yt(m)){if(j=v.createElement(m,a),v.isValidElement(j))return j}else j=fue(a);var b=yue(i),g=Wt(a,!0);if(b&&(o==="insideStart"||o==="insideEnd"||o==="end"))return xue(a,j,g);var y=b?gue(a):vue(a);return le.createElement(Ec,Qh({className:rn("recharts-label",f)},g,y,{breakAll:x}),j)}Vr.displayName="Label";var Wz=function(n){var r=n.cx,s=n.cy,a=n.angle,i=n.startAngle,o=n.endAngle,c=n.r,u=n.radius,m=n.innerRadius,h=n.outerRadius,f=n.x,x=n.y,j=n.top,b=n.left,g=n.width,y=n.height,C=n.clockWise,k=n.labelViewBox;if(k)return k;if(it(g)&&it(y)){if(it(f)&&it(x))return{x:f,y:x,width:g,height:y};if(it(j)&&it(b))return{x:j,y:b,width:g,height:y}}return it(f)&&it(x)?{x:f,y:x,width:0,height:0}:it(r)&&it(s)?{cx:r,cy:s,startAngle:i||a||0,endAngle:o||a||0,innerRadius:m||0,outerRadius:h||u||c||0,clockWise:C}:n.viewBox?n.viewBox:{}},jue=function(n,r){return n?n===!0?le.createElement(Vr,{key:"label-implicit",viewBox:r}):Dr(n)?le.createElement(Vr,{key:"label-implicit",viewBox:r,value:n}):v.isValidElement(n)?n.type===Vr?v.cloneElement(n,{key:"label-implicit",viewBox:r}):le.createElement(Vr,{key:"label-implicit",content:n,viewBox:r}):Yt(n)?le.createElement(Vr,{key:"label-implicit",content:n,viewBox:r}):Bu(n)?le.createElement(Vr,Qh({viewBox:r},n,{key:"label-implicit"})):null:null},bue=function(n,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!n||!n.children&&s&&!n.label)return null;var a=n.children,i=Wz(n),o=qa(a,Vr).map(function(u,m){return v.cloneElement(u,{viewBox:r||i,key:"label-".concat(m)})});if(!s)return o;var c=jue(n.label,r||i);return[c].concat(sue(o))};Vr.parseViewBox=Wz;Vr.renderCallByParent=bue;var Z_,fD;function wue(){if(fD)return Z_;fD=1;function t(n){var r=n==null?0:n.length;return r?n[r-1]:void 0}return Z_=t,Z_}var _ue=wue();const Nue=kn(_ue);function Xh(t){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Xh(t)}var Sue=["valueAccessor"],Cue=["data","dataKey","clockWise","id","textBreakAll"];function kue(t){return Oue(t)||Eue(t)||Aue(t)||Pue()}function Pue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aue(t,n){if(t){if(typeof t=="string")return aS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aS(t,n)}}function Eue(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Oue(t){if(Array.isArray(t))return aS(t)}function aS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function bg(){return bg=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},bg.apply(this,arguments)}function pD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function xD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?pD(Object(r),!0).forEach(function(s){Tue(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Tue(t,n,r){return n=Mue(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Mue(t){var n=Rue(t,"string");return Xh(n)=="symbol"?n:n+""}function Rue(t,n){if(Xh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Xh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function gD(t,n){if(t==null)return{};var r=Due(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Due(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}var $ue=function(n){return Array.isArray(n.value)?Nue(n.value):n.value};function vl(t){var n=t.valueAccessor,r=n===void 0?$ue:n,s=gD(t,Sue),a=s.data,i=s.dataKey,o=s.clockWise,c=s.id,u=s.textBreakAll,m=gD(s,Cue);return!a||!a.length?null:le.createElement(An,{className:"recharts-label-list"},a.map(function(h,f){var x=hn(i)?r(h,f):hs(h&&h.payload,i),j=hn(c)?{}:{id:"".concat(c,"-").concat(f)};return le.createElement(Vr,bg({},Wt(h,!0),m,j,{parentViewBox:h.parentViewBox,value:x,textBreakAll:u,viewBox:Vr.parseViewBox(hn(o)?h:xD(xD({},h),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}vl.displayName="LabelList";function Fue(t,n){return t?t===!0?le.createElement(vl,{key:"labelList-implicit",data:n}):le.isValidElement(t)||Yt(t)?le.createElement(vl,{key:"labelList-implicit",data:n,content:t}):Bu(t)?le.createElement(vl,bg({data:n},t,{key:"labelList-implicit"})):null:null}function Lue(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var s=t.children,a=qa(s,vl).map(function(o,c){return v.cloneElement(o,{data:n,key:"labelList-".concat(c)})});if(!r)return a;var i=Fue(t.label,n);return[i].concat(kue(a))}vl.renderCallByParent=Lue;function Zh(t){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Zh(t)}function iS(){return iS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},iS.apply(this,arguments)}function vD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function yD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?vD(Object(r),!0).forEach(function(s){Iue(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Iue(t,n,r){return n=que(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function que(t){var n=Bue(t,"string");return Zh(n)=="symbol"?n:n+""}function Bue(t,n){if(Zh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Zh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var zue=function(n,r){var s=ks(r-n),a=Math.min(Math.abs(r-n),359.999);return s*a},lx=function(n){var r=n.cx,s=n.cy,a=n.radius,i=n.angle,o=n.sign,c=n.isExternal,u=n.cornerRadius,m=n.cornerIsExternal,h=u*(c?1:-1)+a,f=Math.asin(u/h)/jg,x=m?i:i+o*f,j=Un(r,s,h,x),b=Un(r,s,a,x),g=m?i-o*f:i,y=Un(r,s,h*Math.cos(f*jg),g);return{center:j,circleTangency:b,lineTangency:y,theta:f}},Hz=function(n){var r=n.cx,s=n.cy,a=n.innerRadius,i=n.outerRadius,o=n.startAngle,c=n.endAngle,u=zue(o,c),m=o+u,h=Un(r,s,i,o),f=Un(r,s,i,m),x="M ".concat(h.x,",").concat(h.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(o>m),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var j=Un(r,s,a,o),b=Un(r,s,a,m);x+="L ".concat(b.x,",").concat(b.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(o<=m),`,
            `).concat(j.x,",").concat(j.y," Z")}else x+="L ".concat(r,",").concat(s," Z");return x},Vue=function(n){var r=n.cx,s=n.cy,a=n.innerRadius,i=n.outerRadius,o=n.cornerRadius,c=n.forceCornerRadius,u=n.cornerIsExternal,m=n.startAngle,h=n.endAngle,f=ks(h-m),x=lx({cx:r,cy:s,radius:i,angle:m,sign:f,cornerRadius:o,cornerIsExternal:u}),j=x.circleTangency,b=x.lineTangency,g=x.theta,y=lx({cx:r,cy:s,radius:i,angle:h,sign:-f,cornerRadius:o,cornerIsExternal:u}),C=y.circleTangency,k=y.lineTangency,N=y.theta,P=u?Math.abs(m-h):Math.abs(m-h)-g-N;if(P<0)return c?"M ".concat(b.x,",").concat(b.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):Hz({cx:r,cy:s,innerRadius:a,outerRadius:i,startAngle:m,endAngle:h});var w="M ".concat(b.x,",").concat(b.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(j.x,",").concat(j.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(P>180),",").concat(+(f<0),",").concat(C.x,",").concat(C.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(k.x,",").concat(k.y,`
  `);if(a>0){var S=lx({cx:r,cy:s,radius:a,angle:m,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:u}),E=S.circleTangency,R=S.lineTangency,T=S.theta,U=lx({cx:r,cy:s,radius:a,angle:h,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:u}),M=U.circleTangency,L=U.lineTangency,q=U.theta,$=u?Math.abs(m-h):Math.abs(m-h)-T-q;if($<0&&o===0)return"".concat(w,"L").concat(r,",").concat(s,"Z");w+="L".concat(L.x,",").concat(L.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(M.x,",").concat(M.y,`
      A`).concat(a,",").concat(a,",0,").concat(+($>180),",").concat(+(f>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(R.x,",").concat(R.y,"Z")}else w+="L".concat(r,",").concat(s,"Z");return w},Uue={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Gz=function(n){var r=yD(yD({},Uue),n),s=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,c=r.cornerRadius,u=r.forceCornerRadius,m=r.cornerIsExternal,h=r.startAngle,f=r.endAngle,x=r.className;if(o<i||h===f)return null;var j=rn("recharts-sector",x),b=o-i,g=Ps(c,b,0,!0),y;return g>0&&Math.abs(h-f)<360?y=Vue({cx:s,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,b/2),forceCornerRadius:u,cornerIsExternal:m,startAngle:h,endAngle:f}):y=Hz({cx:s,cy:a,innerRadius:i,outerRadius:o,startAngle:h,endAngle:f}),le.createElement("path",iS({},Wt(r,!0),{className:j,d:y,role:"img"}))};function Jh(t){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Jh(t)}function oS(){return oS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},oS.apply(this,arguments)}function jD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function bD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?jD(Object(r),!0).forEach(function(s){Kue(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Kue(t,n,r){return n=Wue(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Wue(t){var n=Hue(t,"string");return Jh(n)=="symbol"?n:n+""}function Hue(t,n){if(Jh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Jh(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var wD={curveBasisClosed:hre,curveBasisOpen:fre,curveBasis:mre,curveBumpX:Zne,curveBumpY:Jne,curveLinearClosed:pre,curveLinear:$v,curveMonotoneX:xre,curveMonotoneY:gre,curveNatural:vre,curveStep:yre,curveStepAfter:bre,curveStepBefore:jre},cx=function(n){return n.x===+n.x&&n.y===+n.y},Lm=function(n){return n.x},Im=function(n){return n.y},Gue=function(n,r){if(Yt(n))return n;var s="curve".concat(Rv(n));return(s==="curveMonotone"||s==="curveBump")&&r?wD["".concat(s).concat(r==="vertical"?"Y":"X")]:wD[s]||$v},Yue=function(n){var r=n.type,s=r===void 0?"linear":r,a=n.points,i=a===void 0?[]:a,o=n.baseLine,c=n.layout,u=n.connectNulls,m=u===void 0?!1:u,h=Gue(s,c),f=m?i.filter(function(g){return cx(g)}):i,x;if(Array.isArray(o)){var j=m?o.filter(function(g){return cx(g)}):o,b=f.map(function(g,y){return bD(bD({},g),{},{base:j[y]})});return c==="vertical"?x=ex().y(Im).x1(Lm).x0(function(g){return g.base.x}):x=ex().x(Lm).y1(Im).y0(function(g){return g.base.y}),x.defined(cx).curve(h),x(b)}return c==="vertical"&&it(o)?x=ex().y(Im).x1(Lm).x0(o):it(o)?x=ex().x(Lm).y1(Im).y0(o):x=W6().x(Lm).y(Im),x.defined(cx).curve(h),x(f)},lS=function(n){var r=n.className,s=n.points,a=n.path,i=n.pathRef;if((!s||!s.length)&&!a)return null;var o=s&&s.length?Yue(n):a;return v.createElement("path",oS({},Wt(n,!1),Yx(n),{className:rn("recharts-curve",r),d:o,ref:i}))},J_={exports:{}},eN,_D;function Que(){if(_D)return eN;_D=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return eN=t,eN}var tN,ND;function Xue(){if(ND)return tN;ND=1;var t=Que();function n(){}function r(){}return r.resetWarningCache=n,tN=function(){function s(o,c,u,m,h,f){if(f!==t){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}s.isRequired=s;function a(){return s}var i={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:a,element:s,elementType:s,instanceOf:a,node:s,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:n};return i.PropTypes=i,i},tN}var SD;function Zue(){return SD||(SD=1,J_.exports=Xue()()),J_.exports}var Jue=Zue();const Sn=kn(Jue);var eme=Object.getOwnPropertyNames,tme=Object.getOwnPropertySymbols,nme=Object.prototype.hasOwnProperty;function CD(t,n){return function(s,a,i){return t(s,a,i)&&n(s,a,i)}}function dx(t){return function(r,s,a){if(!r||!s||typeof r!="object"||typeof s!="object")return t(r,s,a);var i=a.cache,o=i.get(r),c=i.get(s);if(o&&c)return o===s&&c===r;i.set(r,s),i.set(s,r);var u=t(r,s,a);return i.delete(r),i.delete(s),u}}function kD(t){return eme(t).concat(tme(t))}var rme=Object.hasOwn||(function(t,n){return nme.call(t,n)});function zc(t,n){return t===n||!t&&!n&&t!==t&&n!==n}var sme="__v",ame="__o",ime="_owner",PD=Object.getOwnPropertyDescriptor,AD=Object.keys;function ome(t,n,r){var s=t.length;if(n.length!==s)return!1;for(;s-- >0;)if(!r.equals(t[s],n[s],s,s,t,n,r))return!1;return!0}function lme(t,n){return zc(t.getTime(),n.getTime())}function cme(t,n){return t.name===n.name&&t.message===n.message&&t.cause===n.cause&&t.stack===n.stack}function dme(t,n){return t===n}function ED(t,n,r){var s=t.size;if(s!==n.size)return!1;if(!s)return!0;for(var a=new Array(s),i=t.entries(),o,c,u=0;(o=i.next())&&!o.done;){for(var m=n.entries(),h=!1,f=0;(c=m.next())&&!c.done;){if(a[f]){f++;continue}var x=o.value,j=c.value;if(r.equals(x[0],j[0],u,f,t,n,r)&&r.equals(x[1],j[1],x[0],j[0],t,n,r)){h=a[f]=!0;break}f++}if(!h)return!1;u++}return!0}var ume=zc;function mme(t,n,r){var s=AD(t),a=s.length;if(AD(n).length!==a)return!1;for(;a-- >0;)if(!Yz(t,n,r,s[a]))return!1;return!0}function qm(t,n,r){var s=kD(t),a=s.length;if(kD(n).length!==a)return!1;for(var i,o,c;a-- >0;)if(i=s[a],!Yz(t,n,r,i)||(o=PD(t,i),c=PD(n,i),(o||c)&&(!o||!c||o.configurable!==c.configurable||o.enumerable!==c.enumerable||o.writable!==c.writable)))return!1;return!0}function hme(t,n){return zc(t.valueOf(),n.valueOf())}function fme(t,n){return t.source===n.source&&t.flags===n.flags}function OD(t,n,r){var s=t.size;if(s!==n.size)return!1;if(!s)return!0;for(var a=new Array(s),i=t.values(),o,c;(o=i.next())&&!o.done;){for(var u=n.values(),m=!1,h=0;(c=u.next())&&!c.done;){if(!a[h]&&r.equals(o.value,c.value,o.value,c.value,t,n,r)){m=a[h]=!0;break}h++}if(!m)return!1}return!0}function pme(t,n){var r=t.length;if(n.length!==r)return!1;for(;r-- >0;)if(t[r]!==n[r])return!1;return!0}function xme(t,n){return t.hostname===n.hostname&&t.pathname===n.pathname&&t.protocol===n.protocol&&t.port===n.port&&t.hash===n.hash&&t.username===n.username&&t.password===n.password}function Yz(t,n,r,s){return(s===ime||s===ame||s===sme)&&(t.$$typeof||n.$$typeof)?!0:rme(n,s)&&r.equals(t[s],n[s],s,s,t,n,r)}var gme="[object Arguments]",vme="[object Boolean]",yme="[object Date]",jme="[object Error]",bme="[object Map]",wme="[object Number]",_me="[object Object]",Nme="[object RegExp]",Sme="[object Set]",Cme="[object String]",kme="[object URL]",Pme=Array.isArray,TD=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,MD=Object.assign,Ame=Object.prototype.toString.call.bind(Object.prototype.toString);function Eme(t){var n=t.areArraysEqual,r=t.areDatesEqual,s=t.areErrorsEqual,a=t.areFunctionsEqual,i=t.areMapsEqual,o=t.areNumbersEqual,c=t.areObjectsEqual,u=t.arePrimitiveWrappersEqual,m=t.areRegExpsEqual,h=t.areSetsEqual,f=t.areTypedArraysEqual,x=t.areUrlsEqual;return function(b,g,y){if(b===g)return!0;if(b==null||g==null)return!1;var C=typeof b;if(C!==typeof g)return!1;if(C!=="object")return C==="number"?o(b,g,y):C==="function"?a(b,g,y):!1;var k=b.constructor;if(k!==g.constructor)return!1;if(k===Object)return c(b,g,y);if(Pme(b))return n(b,g,y);if(TD!=null&&TD(b))return f(b,g,y);if(k===Date)return r(b,g,y);if(k===RegExp)return m(b,g,y);if(k===Map)return i(b,g,y);if(k===Set)return h(b,g,y);var N=Ame(b);return N===yme?r(b,g,y):N===Nme?m(b,g,y):N===bme?i(b,g,y):N===Sme?h(b,g,y):N===_me?typeof b.then!="function"&&typeof g.then!="function"&&c(b,g,y):N===kme?x(b,g,y):N===jme?s(b,g,y):N===gme?c(b,g,y):N===vme||N===wme||N===Cme?u(b,g,y):!1}}function Ome(t){var n=t.circular,r=t.createCustomConfig,s=t.strict,a={areArraysEqual:s?qm:ome,areDatesEqual:lme,areErrorsEqual:cme,areFunctionsEqual:dme,areMapsEqual:s?CD(ED,qm):ED,areNumbersEqual:ume,areObjectsEqual:s?qm:mme,arePrimitiveWrappersEqual:hme,areRegExpsEqual:fme,areSetsEqual:s?CD(OD,qm):OD,areTypedArraysEqual:s?qm:pme,areUrlsEqual:xme};if(r&&(a=MD({},a,r(a))),n){var i=dx(a.areArraysEqual),o=dx(a.areMapsEqual),c=dx(a.areObjectsEqual),u=dx(a.areSetsEqual);a=MD({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:c,areSetsEqual:u})}return a}function Tme(t){return function(n,r,s,a,i,o,c){return t(n,r,c)}}function Mme(t){var n=t.circular,r=t.comparator,s=t.createState,a=t.equals,i=t.strict;if(s)return function(u,m){var h=s(),f=h.cache,x=f===void 0?n?new WeakMap:void 0:f,j=h.meta;return r(u,m,{cache:x,equals:a,meta:j,strict:i})};if(n)return function(u,m){return r(u,m,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(u,m){return r(u,m,o)}}var Rme=Ll();Ll({strict:!0});Ll({circular:!0});Ll({circular:!0,strict:!0});Ll({createInternalComparator:function(){return zc}});Ll({strict:!0,createInternalComparator:function(){return zc}});Ll({circular:!0,createInternalComparator:function(){return zc}});Ll({circular:!0,createInternalComparator:function(){return zc},strict:!0});function Ll(t){t===void 0&&(t={});var n=t.circular,r=n===void 0?!1:n,s=t.createInternalComparator,a=t.createState,i=t.strict,o=i===void 0?!1:i,c=Ome(t),u=Eme(c),m=s?s(u):Tme(u);return Mme({circular:r,comparator:u,createState:a,equals:m,strict:o})}function Dme(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function RD(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,s=function a(i){r<0&&(r=i),i-r>n?(t(i),r=-1):Dme(a)};requestAnimationFrame(s)}function cS(t){"@babel/helpers - typeof";return cS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},cS(t)}function $me(t){return qme(t)||Ime(t)||Lme(t)||Fme()}function Fme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lme(t,n){if(t){if(typeof t=="string")return DD(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DD(t,n)}}function DD(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function Ime(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qme(t){if(Array.isArray(t))return t}function Bme(){var t={},n=function(){return null},r=!1,s=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,c=$me(o),u=c[0],m=c.slice(1);if(typeof u=="number"){RD(a.bind(null,m),u);return}a(u),RD(a.bind(null,m));return}cS(i)==="object"&&(t=i,n(t)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,s(i)},subscribe:function(i){return n=i,function(){n=function(){return null}}}}}function ef(t){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ef(t)}function $D(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function FD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?$D(Object(r),!0).forEach(function(s){Qz(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$D(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Qz(t,n,r){return n=zme(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function zme(t){var n=Vme(t,"string");return ef(n)==="symbol"?n:String(n)}function Vme(t,n){if(ef(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(ef(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var Ume=function(n,r){return[Object.keys(n),Object.keys(r)].reduce(function(s,a){return s.filter(function(i){return a.includes(i)})})},Kme=function(n){return n},Wme=function(n){return n.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},ih=function(n,r){return Object.keys(r).reduce(function(s,a){return FD(FD({},s),{},Qz({},a,n(a,r[a])))},{})},LD=function(n,r,s){return n.map(function(a){return"".concat(Wme(a)," ").concat(r,"ms ").concat(s)}).join(",")};function Hme(t,n){return Qme(t)||Yme(t,n)||Xz(t,n)||Gme()}function Gme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yme(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function Qme(t){if(Array.isArray(t))return t}function Xme(t){return ehe(t)||Jme(t)||Xz(t)||Zme()}function Zme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xz(t,n){if(t){if(typeof t=="string")return dS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dS(t,n)}}function Jme(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ehe(t){if(Array.isArray(t))return dS(t)}function dS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}var wg=1e-4,Zz=function(n,r){return[0,3*n,3*r-6*n,3*n-3*r+1]},Jz=function(n,r){return n.map(function(s,a){return s*Math.pow(r,a)}).reduce(function(s,a){return s+a})},ID=function(n,r){return function(s){var a=Zz(n,r);return Jz(a,s)}},the=function(n,r){return function(s){var a=Zz(n,r),i=[].concat(Xme(a.map(function(o,c){return o*c}).slice(1)),[0]);return Jz(i,s)}},qD=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];var a=r[0],i=r[1],o=r[2],c=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,c=1;break;case"ease":a=.25,i=.1,o=.25,c=1;break;case"ease-in":a=.42,i=0,o=1,c=1;break;case"ease-out":a=.42,i=0,o=.58,c=1;break;case"ease-in-out":a=0,i=0,o=.58,c=1;break;default:{var u=r[0].split("(");if(u[0]==="cubic-bezier"&&u[1].split(")")[0].split(",").length===4){var m=u[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),h=Hme(m,4);a=h[0],i=h[1],o=h[2],c=h[3]}}}var f=ID(a,o),x=ID(i,c),j=the(a,o),b=function(C){return C>1?1:C<0?0:C},g=function(C){for(var k=C>1?1:C,N=k,P=0;P<8;++P){var w=f(N)-k,S=j(N);if(Math.abs(w-k)<wg||S<wg)return x(N);N=b(N-w/S)}return x(N)};return g.isStepper=!1,g},nhe=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.stiff,s=r===void 0?100:r,a=n.damping,i=a===void 0?8:a,o=n.dt,c=o===void 0?17:o,u=function(h,f,x){var j=-(h-f)*s,b=x*i,g=x+(j-b)*c/1e3,y=x*c/1e3+h;return Math.abs(y-f)<wg&&Math.abs(g)<wg?[f,0]:[y,g]};return u.isStepper=!0,u.dt=c,u},rhe=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return qD(a);case"spring":return nhe();default:if(a.split("(")[0]==="cubic-bezier")return qD(a)}return typeof a=="function"?a:null};function tf(t){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},tf(t)}function BD(t){return ihe(t)||ahe(t)||e8(t)||she()}function she(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ahe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ihe(t){if(Array.isArray(t))return mS(t)}function zD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function es(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?zD(Object(r),!0).forEach(function(s){uS(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function uS(t,n,r){return n=ohe(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function ohe(t){var n=lhe(t,"string");return tf(n)==="symbol"?n:String(n)}function lhe(t,n){if(tf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(tf(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function che(t,n){return mhe(t)||uhe(t,n)||e8(t,n)||dhe()}function dhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e8(t,n){if(t){if(typeof t=="string")return mS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mS(t,n)}}function mS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function uhe(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function mhe(t){if(Array.isArray(t))return t}var _g=function(n,r,s){return n+(r-n)*s},hS=function(n){var r=n.from,s=n.to;return r!==s},hhe=function t(n,r,s){var a=ih(function(i,o){if(hS(o)){var c=n(o.from,o.to,o.velocity),u=che(c,2),m=u[0],h=u[1];return es(es({},o),{},{from:m,velocity:h})}return o},r);return s<1?ih(function(i,o){return hS(o)?es(es({},o),{},{velocity:_g(o.velocity,a[i].velocity,s),from:_g(o.from,a[i].from,s)}):o},r):t(n,a,s-1)};const fhe=(function(t,n,r,s,a){var i=Ume(t,n),o=i.reduce(function(y,C){return es(es({},y),{},uS({},C,[t[C],n[C]]))},{}),c=i.reduce(function(y,C){return es(es({},y),{},uS({},C,{from:t[C],velocity:0,to:n[C]}))},{}),u=-1,m,h,f=function(){return null},x=function(){return ih(function(C,k){return k.from},c)},j=function(){return!Object.values(c).filter(hS).length},b=function(C){m||(m=C);var k=C-m,N=k/r.dt;c=hhe(r,c,N),a(es(es(es({},t),n),x())),m=C,j()||(u=requestAnimationFrame(f))},g=function(C){h||(h=C);var k=(C-h)/s,N=ih(function(w,S){return _g.apply(void 0,BD(S).concat([r(k)]))},o);if(a(es(es(es({},t),n),N)),k<1)u=requestAnimationFrame(f);else{var P=ih(function(w,S){return _g.apply(void 0,BD(S).concat([r(1)]))},o);a(es(es(es({},t),n),P))}};return f=r.isStepper?b:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(u)}}});function fu(t){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},fu(t)}var phe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function xhe(t,n){if(t==null)return{};var r=ghe(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function ghe(t,n){if(t==null)return{};var r={},s=Object.keys(t),a,i;for(i=0;i<s.length;i++)a=s[i],!(n.indexOf(a)>=0)&&(r[a]=t[a]);return r}function nN(t){return bhe(t)||jhe(t)||yhe(t)||vhe()}function vhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yhe(t,n){if(t){if(typeof t=="string")return fS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fS(t,n)}}function jhe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bhe(t){if(Array.isArray(t))return fS(t)}function fS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function VD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function ti(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?VD(Object(r),!0).forEach(function(s){Xm(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Xm(t,n,r){return n=t8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function whe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _he(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,t8(s.key),s)}}function Nhe(t,n,r){return n&&_he(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function t8(t){var n=She(t,"string");return fu(n)==="symbol"?n:String(n)}function She(t,n){if(fu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(fu(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Che(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&pS(t,n)}function pS(t,n){return pS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},pS(t,n)}function khe(t){var n=Phe();return function(){var s=Ng(t),a;if(n){var i=Ng(this).constructor;a=Reflect.construct(s,arguments,i)}else a=s.apply(this,arguments);return xS(this,a)}}function xS(t,n){if(n&&(fu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gS(t)}function gS(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Phe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ng(t){return Ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ng(t)}var _o=(function(t){Che(r,t);var n=khe(r);function r(s,a){var i;whe(this,r),i=n.call(this,s,a);var o=i.props,c=o.isActive,u=o.attributeName,m=o.from,h=o.to,f=o.steps,x=o.children,j=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(gS(i)),i.changeStyle=i.changeStyle.bind(gS(i)),!c||j<=0)return i.state={style:{}},typeof x=="function"&&(i.state={style:h}),xS(i);if(f&&f.length)i.state={style:f[0].style};else if(m){if(typeof x=="function")return i.state={style:m},xS(i);i.state={style:u?Xm({},u,m):m}}else i.state={style:{}};return i}return Nhe(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,c=i.canBegin,u=i.attributeName,m=i.shouldReAnimate,h=i.to,f=i.from,x=this.state.style;if(c){if(!o){var j={style:u?Xm({},u,h):h};this.state&&x&&(u&&x[u]!==h||!u&&x!==h)&&this.setState(j);return}if(!(Rme(a.to,h)&&a.canBegin&&a.isActive)){var b=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=b||m?f:a.to;if(this.state&&x){var y={style:u?Xm({},u,g):g};(u&&x[u]!==g||!u&&x!==g)&&this.setState(y)}this.runAnimation(ti(ti({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,c=a.to,u=a.duration,m=a.easing,h=a.begin,f=a.onAnimationEnd,x=a.onAnimationStart,j=fhe(o,c,rhe(m),u,this.changeStyle),b=function(){i.stopJSAnimation=j()};this.manager.start([x,h,b,u,f])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,c=a.begin,u=a.onAnimationStart,m=o[0],h=m.style,f=m.duration,x=f===void 0?0:f,j=function(g,y,C){if(C===0)return g;var k=y.duration,N=y.easing,P=N===void 0?"ease":N,w=y.style,S=y.properties,E=y.onAnimationEnd,R=C>0?o[C-1]:y,T=S||Object.keys(w);if(typeof P=="function"||P==="spring")return[].concat(nN(g),[i.runJSAnimation.bind(i,{from:R.style,to:w,duration:k,easing:P}),k]);var U=LD(T,k,P),M=ti(ti(ti({},R.style),w),{},{transition:U});return[].concat(nN(g),[M,k,E]).filter(Kme)};return this.manager.start([u].concat(nN(o.reduce(j,[h,Math.max(x,c)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=Bme());var i=a.begin,o=a.duration,c=a.attributeName,u=a.to,m=a.easing,h=a.onAnimationStart,f=a.onAnimationEnd,x=a.steps,j=a.children,b=this.manager;if(this.unSubscribe=b.subscribe(this.handleStyleChange),typeof m=="function"||typeof j=="function"||m==="spring"){this.runJSAnimation(a);return}if(x.length>1){this.runStepAnimation(a);return}var g=c?Xm({},c,u):u,y=LD(Object.keys(g),o,m);b.start([h,i,ti(ti({},g),{},{transition:y}),o,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var c=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var u=xhe(a,phe),m=v.Children.count(i),h=this.state.style;if(typeof i=="function")return i(h);if(!c||m===0||o<=0)return i;var f=function(j){var b=j.props,g=b.style,y=g===void 0?{}:g,C=b.className,k=v.cloneElement(j,ti(ti({},u),{},{style:ti(ti({},y),h),className:C}));return k};return m===1?f(v.Children.only(i)):le.createElement("div",null,v.Children.map(i,function(x){return f(x)}))}}]),r})(v.PureComponent);_o.displayName="Animate";_o.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};_o.propTypes={from:Sn.oneOfType([Sn.object,Sn.string]),to:Sn.oneOfType([Sn.object,Sn.string]),attributeName:Sn.string,duration:Sn.number,begin:Sn.number,easing:Sn.oneOfType([Sn.string,Sn.func]),steps:Sn.arrayOf(Sn.shape({duration:Sn.number.isRequired,style:Sn.object.isRequired,easing:Sn.oneOfType([Sn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Sn.func]),properties:Sn.arrayOf("string"),onAnimationEnd:Sn.func})),children:Sn.oneOfType([Sn.node,Sn.func]),isActive:Sn.bool,canBegin:Sn.bool,onAnimationEnd:Sn.func,shouldReAnimate:Sn.bool,onAnimationStart:Sn.func,onAnimationReStart:Sn.func};function nf(t){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},nf(t)}function Sg(){return Sg=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Sg.apply(this,arguments)}function Ahe(t,n){return Mhe(t)||The(t,n)||Ohe(t,n)||Ehe()}function Ehe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ohe(t,n){if(t){if(typeof t=="string")return UD(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UD(t,n)}}function UD(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function The(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function Mhe(t){if(Array.isArray(t))return t}function KD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function WD(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?KD(Object(r),!0).forEach(function(s){Rhe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Rhe(t,n,r){return n=Dhe(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Dhe(t){var n=$he(t,"string");return nf(n)=="symbol"?n:n+""}function $he(t,n){if(nf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(nf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var HD=function(n,r,s,a,i){var o=Math.min(Math.abs(s)/2,Math.abs(a)/2),c=a>=0?1:-1,u=s>=0?1:-1,m=a>=0&&s>=0||a<0&&s<0?1:0,h;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],x=0,j=4;x<j;x++)f[x]=i[x]>o?o:i[x];h="M".concat(n,",").concat(r+c*f[0]),f[0]>0&&(h+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(m,",").concat(n+u*f[0],",").concat(r)),h+="L ".concat(n+s-u*f[1],",").concat(r),f[1]>0&&(h+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(m,`,
        `).concat(n+s,",").concat(r+c*f[1])),h+="L ".concat(n+s,",").concat(r+a-c*f[2]),f[2]>0&&(h+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(m,`,
        `).concat(n+s-u*f[2],",").concat(r+a)),h+="L ".concat(n+u*f[3],",").concat(r+a),f[3]>0&&(h+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(m,`,
        `).concat(n,",").concat(r+a-c*f[3])),h+="Z"}else if(o>0&&i===+i&&i>0){var b=Math.min(o,i);h="M ".concat(n,",").concat(r+c*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(m,",").concat(n+u*b,",").concat(r,`
            L `).concat(n+s-u*b,",").concat(r,`
            A `).concat(b,",").concat(b,",0,0,").concat(m,",").concat(n+s,",").concat(r+c*b,`
            L `).concat(n+s,",").concat(r+a-c*b,`
            A `).concat(b,",").concat(b,",0,0,").concat(m,",").concat(n+s-u*b,",").concat(r+a,`
            L `).concat(n+u*b,",").concat(r+a,`
            A `).concat(b,",").concat(b,",0,0,").concat(m,",").concat(n,",").concat(r+a-c*b," Z")}else h="M ".concat(n,",").concat(r," h ").concat(s," v ").concat(a," h ").concat(-s," Z");return h},Fhe=function(n,r){if(!n||!r)return!1;var s=n.x,a=n.y,i=r.x,o=r.y,c=r.width,u=r.height;if(Math.abs(c)>0&&Math.abs(u)>0){var m=Math.min(i,i+c),h=Math.max(i,i+c),f=Math.min(o,o+u),x=Math.max(o,o+u);return s>=m&&s<=h&&a>=f&&a<=x}return!1},Lhe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ik=function(n){var r=WD(WD({},Lhe),n),s=v.useRef(),a=v.useState(-1),i=Ahe(a,2),o=i[0],c=i[1];v.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var P=s.current.getTotalLength();P&&c(P)}catch{}},[]);var u=r.x,m=r.y,h=r.width,f=r.height,x=r.radius,j=r.className,b=r.animationEasing,g=r.animationDuration,y=r.animationBegin,C=r.isAnimationActive,k=r.isUpdateAnimationActive;if(u!==+u||m!==+m||h!==+h||f!==+f||h===0||f===0)return null;var N=rn("recharts-rectangle",j);return k?le.createElement(_o,{canBegin:o>0,from:{width:h,height:f,x:u,y:m},to:{width:h,height:f,x:u,y:m},duration:g,animationEasing:b,isActive:k},function(P){var w=P.width,S=P.height,E=P.x,R=P.y;return le.createElement(_o,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,isActive:C,easing:b},le.createElement("path",Sg({},Wt(r,!0),{className:N,d:HD(E,R,w,S,x),ref:s})))}):le.createElement("path",Sg({},Wt(r,!0),{className:N,d:HD(u,m,h,f,x)}))},Ihe=["points","className","baseLinePoints","connectNulls"];function Ad(){return Ad=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ad.apply(this,arguments)}function qhe(t,n){if(t==null)return{};var r=Bhe(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Bhe(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function GD(t){return Khe(t)||Uhe(t)||Vhe(t)||zhe()}function zhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vhe(t,n){if(t){if(typeof t=="string")return vS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vS(t,n)}}function Uhe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Khe(t){if(Array.isArray(t))return vS(t)}function vS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}var YD=function(n){return n&&n.x===+n.x&&n.y===+n.y},Whe=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return n.forEach(function(s){YD(s)?r[r.length-1].push(s):r[r.length-1].length>0&&r.push([])}),YD(n[0])&&r[r.length-1].push(n[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},oh=function(n,r){var s=Whe(n);r&&(s=[s.reduce(function(i,o){return[].concat(GD(i),GD(o))},[])]);var a=s.map(function(i){return i.reduce(function(o,c,u){return"".concat(o).concat(u===0?"M":"L").concat(c.x,",").concat(c.y)},"")}).join("");return s.length===1?"".concat(a,"Z"):a},Hhe=function(n,r,s){var a=oh(n,s);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(oh(r.reverse(),s).slice(1))},Ghe=function(n){var r=n.points,s=n.className,a=n.baseLinePoints,i=n.connectNulls,o=qhe(n,Ihe);if(!r||!r.length)return null;var c=rn("recharts-polygon",s);if(a&&a.length){var u=o.stroke&&o.stroke!=="none",m=Hhe(r,a,i);return le.createElement("g",{className:c},le.createElement("path",Ad({},Wt(o,!0),{fill:m.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:m})),u?le.createElement("path",Ad({},Wt(o,!0),{fill:"none",d:oh(r,i)})):null,u?le.createElement("path",Ad({},Wt(o,!0),{fill:"none",d:oh(a,i)})):null)}var h=oh(r,i);return le.createElement("path",Ad({},Wt(o,!0),{fill:h.slice(-1)==="Z"?o.fill:"none",className:c,d:h}))};function yS(){return yS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},yS.apply(this,arguments)}var qk=function(n){var r=n.cx,s=n.cy,a=n.r,i=n.className,o=rn("recharts-dot",i);return r===+r&&s===+s&&a===+a?v.createElement("circle",yS({},Wt(n,!1),Yx(n),{className:o,cx:r,cy:s,r:a})):null};function rf(t){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},rf(t)}var Yhe=["x","y","top","left","width","height","className"];function jS(){return jS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},jS.apply(this,arguments)}function QD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Qhe(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?QD(Object(r),!0).forEach(function(s){Xhe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Xhe(t,n,r){return n=Zhe(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Zhe(t){var n=Jhe(t,"string");return rf(n)=="symbol"?n:n+""}function Jhe(t,n){if(rf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(rf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function efe(t,n){if(t==null)return{};var r=tfe(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function tfe(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}var nfe=function(n,r,s,a,i,o){return"M".concat(n,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(s)},rfe=function(n){var r=n.x,s=r===void 0?0:r,a=n.y,i=a===void 0?0:a,o=n.top,c=o===void 0?0:o,u=n.left,m=u===void 0?0:u,h=n.width,f=h===void 0?0:h,x=n.height,j=x===void 0?0:x,b=n.className,g=efe(n,Yhe),y=Qhe({x:s,y:i,top:c,left:m,width:f,height:j},g);return!it(s)||!it(i)||!it(f)||!it(j)||!it(c)||!it(m)?null:le.createElement("path",jS({},Wt(y,!0),{className:rn("recharts-cross",b),d:nfe(s,i,f,j,c,m)}))},rN,XD;function sfe(){if(XD)return rN;XD=1;var t=Gv(),n=xz(),r=Ki();function s(a,i){return a&&a.length?t(a,r(i,2),n):void 0}return rN=s,rN}var afe=sfe();const ife=kn(afe);var sN,ZD;function ofe(){if(ZD)return sN;ZD=1;var t=Gv(),n=Ki(),r=gz();function s(a,i){return a&&a.length?t(a,n(i,2),r):void 0}return sN=s,sN}var lfe=ofe();const cfe=kn(lfe);var dfe=["cx","cy","angle","ticks","axisLine"],ufe=["ticks","tick","angle","tickFormatter","stroke"];function pu(t){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},pu(t)}function lh(){return lh=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},lh.apply(this,arguments)}function JD(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Jl(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?JD(Object(r),!0).forEach(function(s){ty(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function e$(t,n){if(t==null)return{};var r=mfe(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function mfe(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function hfe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function t$(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,r8(s.key),s)}}function ffe(t,n,r){return n&&t$(t.prototype,n),r&&t$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pfe(t,n,r){return n=Cg(n),xfe(t,n8()?Reflect.construct(n,r||[],Cg(t).constructor):n.apply(t,r))}function xfe(t,n){if(n&&(pu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gfe(t)}function gfe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n8=function(){return!!t})()}function Cg(t){return Cg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cg(t)}function vfe(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&bS(t,n)}function bS(t,n){return bS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},bS(t,n)}function ty(t,n,r){return n=r8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function r8(t){var n=yfe(t,"string");return pu(n)=="symbol"?n:n+""}function yfe(t,n){if(pu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(pu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ny=(function(t){function n(){return hfe(this,n),pfe(this,n,arguments)}return vfe(n,t),ffe(n,[{key:"getTickValueCoord",value:function(s){var a=s.coordinate,i=this.props,o=i.angle,c=i.cx,u=i.cy;return Un(c,u,a,o)}},{key:"getTickTextAnchor",value:function(){var s=this.props.orientation,a;switch(s){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var s=this.props,a=s.cx,i=s.cy,o=s.angle,c=s.ticks,u=ife(c,function(h){return h.coordinate||0}),m=cfe(c,function(h){return h.coordinate||0});return{cx:a,cy:i,startAngle:o,endAngle:o,innerRadius:m.coordinate||0,outerRadius:u.coordinate||0}}},{key:"renderAxisLine",value:function(){var s=this.props,a=s.cx,i=s.cy,o=s.angle,c=s.ticks,u=s.axisLine,m=e$(s,dfe),h=c.reduce(function(b,g){return[Math.min(b[0],g.coordinate),Math.max(b[1],g.coordinate)]},[1/0,-1/0]),f=Un(a,i,h[0],o),x=Un(a,i,h[1],o),j=Jl(Jl(Jl({},Wt(m,!1)),{},{fill:"none"},Wt(u,!1)),{},{x1:f.x,y1:f.y,x2:x.x,y2:x.y});return le.createElement("line",lh({className:"recharts-polar-radius-axis-line"},j))}},{key:"renderTicks",value:function(){var s=this,a=this.props,i=a.ticks,o=a.tick,c=a.angle,u=a.tickFormatter,m=a.stroke,h=e$(a,ufe),f=this.getTickTextAnchor(),x=Wt(h,!1),j=Wt(o,!1),b=i.map(function(g,y){var C=s.getTickValueCoord(g),k=Jl(Jl(Jl(Jl({textAnchor:f,transform:"rotate(".concat(90-c,", ").concat(C.x,", ").concat(C.y,")")},x),{},{stroke:"none",fill:m},j),{},{index:y},C),{},{payload:g});return le.createElement(An,lh({className:rn("recharts-polar-radius-axis-tick",Kz(o)),key:"tick-".concat(g.coordinate)},Ac(s.props,g,y)),n.renderTickItem(o,k,u?u(g.value,y):g.value))});return le.createElement(An,{className:"recharts-polar-radius-axis-ticks"},b)}},{key:"render",value:function(){var s=this.props,a=s.ticks,i=s.axisLine,o=s.tick;return!a||!a.length?null:le.createElement(An,{className:rn("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),Vr.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(s,a,i){var o;return le.isValidElement(s)?o=le.cloneElement(s,a):Yt(s)?o=s(a):o=le.createElement(Ec,lh({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])})(v.PureComponent);ty(ny,"displayName","PolarRadiusAxis");ty(ny,"axisType","radiusAxis");ty(ny,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function xu(t){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},xu(t)}function ac(){return ac=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ac.apply(this,arguments)}function n$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function ec(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?n$(Object(r),!0).forEach(function(s){ry(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function jfe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r$(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,a8(s.key),s)}}function bfe(t,n,r){return n&&r$(t.prototype,n),r&&r$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wfe(t,n,r){return n=kg(n),_fe(t,s8()?Reflect.construct(n,r||[],kg(t).constructor):n.apply(t,r))}function _fe(t,n){if(n&&(xu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nfe(t)}function Nfe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s8=function(){return!!t})()}function kg(t){return kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kg(t)}function Sfe(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&wS(t,n)}function wS(t,n){return wS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},wS(t,n)}function ry(t,n,r){return n=a8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function a8(t){var n=Cfe(t,"string");return xu(n)=="symbol"?n:n+""}function Cfe(t,n){if(xu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(xu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var kfe=Math.PI/180,s$=1e-5,sy=(function(t){function n(){return jfe(this,n),wfe(this,n,arguments)}return Sfe(n,t),bfe(n,[{key:"getTickLineCoord",value:function(s){var a=this.props,i=a.cx,o=a.cy,c=a.radius,u=a.orientation,m=a.tickSize,h=m||8,f=Un(i,o,c,s.coordinate),x=Un(i,o,c+(u==="inner"?-1:1)*h,s.coordinate);return{x1:f.x,y1:f.y,x2:x.x,y2:x.y}}},{key:"getTickTextAnchor",value:function(s){var a=this.props.orientation,i=Math.cos(-s.coordinate*kfe),o;return i>s$?o=a==="outer"?"start":"end":i<-s$?o=a==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var s=this.props,a=s.cx,i=s.cy,o=s.radius,c=s.axisLine,u=s.axisLineType,m=ec(ec({},Wt(this.props,!1)),{},{fill:"none"},Wt(c,!1));if(u==="circle")return le.createElement(qk,ac({className:"recharts-polar-angle-axis-line"},m,{cx:a,cy:i,r:o}));var h=this.props.ticks,f=h.map(function(x){return Un(a,i,o,x.coordinate)});return le.createElement(Ghe,ac({className:"recharts-polar-angle-axis-line"},m,{points:f}))}},{key:"renderTicks",value:function(){var s=this,a=this.props,i=a.ticks,o=a.tick,c=a.tickLine,u=a.tickFormatter,m=a.stroke,h=Wt(this.props,!1),f=Wt(o,!1),x=ec(ec({},h),{},{fill:"none"},Wt(c,!1)),j=i.map(function(b,g){var y=s.getTickLineCoord(b),C=s.getTickTextAnchor(b),k=ec(ec(ec({textAnchor:C},h),{},{stroke:"none",fill:m},f),{},{index:g,payload:b,x:y.x2,y:y.y2});return le.createElement(An,ac({className:rn("recharts-polar-angle-axis-tick",Kz(o)),key:"tick-".concat(b.coordinate)},Ac(s.props,b,g)),c&&le.createElement("line",ac({className:"recharts-polar-angle-axis-tick-line"},x,y)),o&&n.renderTickItem(o,k,u?u(b.value,g):b.value))});return le.createElement(An,{className:"recharts-polar-angle-axis-ticks"},j)}},{key:"render",value:function(){var s=this.props,a=s.ticks,i=s.radius,o=s.axisLine;return i<=0||!a||!a.length?null:le.createElement(An,{className:rn("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(s,a,i){var o;return le.isValidElement(s)?o=le.cloneElement(s,a):Yt(s)?o=s(a):o=le.createElement(Ec,ac({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])})(v.PureComponent);ry(sy,"displayName","PolarAngleAxis");ry(sy,"axisType","angleAxis");ry(sy,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var aN,a$;function Pfe(){if(a$)return aN;a$=1;var t=pB(),n=t(Object.getPrototypeOf,Object);return aN=n,aN}var iN,i$;function Afe(){if(i$)return iN;i$=1;var t=Co(),n=Pfe(),r=ko(),s="[object Object]",a=Function.prototype,i=Object.prototype,o=a.toString,c=i.hasOwnProperty,u=o.call(Object);function m(h){if(!r(h)||t(h)!=s)return!1;var f=n(h);if(f===null)return!0;var x=c.call(f,"constructor")&&f.constructor;return typeof x=="function"&&x instanceof x&&o.call(x)==u}return iN=m,iN}var Efe=Afe();const Ofe=kn(Efe);var oN,o$;function Tfe(){if(o$)return oN;o$=1;var t=Co(),n=ko(),r="[object Boolean]";function s(a){return a===!0||a===!1||n(a)&&t(a)==r}return oN=s,oN}var Mfe=Tfe();const Rfe=kn(Mfe);function sf(t){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},sf(t)}function Pg(){return Pg=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Pg.apply(this,arguments)}function Dfe(t,n){return Ife(t)||Lfe(t,n)||Ffe(t,n)||$fe()}function $fe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ffe(t,n){if(t){if(typeof t=="string")return l$(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l$(t,n)}}function l$(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function Lfe(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function Ife(t){if(Array.isArray(t))return t}function c$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function d$(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?c$(Object(r),!0).forEach(function(s){qfe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function qfe(t,n,r){return n=Bfe(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Bfe(t){var n=zfe(t,"string");return sf(n)=="symbol"?n:n+""}function zfe(t,n){if(sf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(sf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var u$=function(n,r,s,a,i){var o=s-a,c;return c="M ".concat(n,",").concat(r),c+="L ".concat(n+s,",").concat(r),c+="L ".concat(n+s-o/2,",").concat(r+i),c+="L ".concat(n+s-o/2-a,",").concat(r+i),c+="L ".concat(n,",").concat(r," Z"),c},Vfe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ufe=function(n){var r=d$(d$({},Vfe),n),s=v.useRef(),a=v.useState(-1),i=Dfe(a,2),o=i[0],c=i[1];v.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var N=s.current.getTotalLength();N&&c(N)}catch{}},[]);var u=r.x,m=r.y,h=r.upperWidth,f=r.lowerWidth,x=r.height,j=r.className,b=r.animationEasing,g=r.animationDuration,y=r.animationBegin,C=r.isUpdateAnimationActive;if(u!==+u||m!==+m||h!==+h||f!==+f||x!==+x||h===0&&f===0||x===0)return null;var k=rn("recharts-trapezoid",j);return C?le.createElement(_o,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:x,x:u,y:m},to:{upperWidth:h,lowerWidth:f,height:x,x:u,y:m},duration:g,animationEasing:b,isActive:C},function(N){var P=N.upperWidth,w=N.lowerWidth,S=N.height,E=N.x,R=N.y;return le.createElement(_o,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,easing:b},le.createElement("path",Pg({},Wt(r,!0),{className:k,d:u$(E,R,P,w,S),ref:s})))}):le.createElement("g",null,le.createElement("path",Pg({},Wt(r,!0),{className:k,d:u$(u,m,h,f,x)})))},Kfe=["option","shapeType","propTransformer","activeClassName","isActive"];function af(t){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},af(t)}function Wfe(t,n){if(t==null)return{};var r=Hfe(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Hfe(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function m$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Ag(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?m$(Object(r),!0).forEach(function(s){Gfe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Gfe(t,n,r){return n=Yfe(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Yfe(t){var n=Qfe(t,"string");return af(n)=="symbol"?n:n+""}function Qfe(t,n){if(af(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(af(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Xfe(t,n){return Ag(Ag({},n),t)}function Zfe(t,n){return t==="symbols"}function h$(t){var n=t.shapeType,r=t.elementProps;switch(n){case"rectangle":return le.createElement(Ik,r);case"trapezoid":return le.createElement(Ufe,r);case"sector":return le.createElement(Gz,r);case"symbols":if(Zfe(n))return le.createElement(sk,r);break;default:return null}}function Jfe(t){return v.isValidElement(t)?t.props:t}function i8(t){var n=t.option,r=t.shapeType,s=t.propTransformer,a=s===void 0?Xfe:s,i=t.activeClassName,o=i===void 0?"recharts-active-shape":i,c=t.isActive,u=Wfe(t,Kfe),m;if(v.isValidElement(n))m=v.cloneElement(n,Ag(Ag({},u),Jfe(n)));else if(Yt(n))m=n(u);else if(Ofe(n)&&!Rfe(n)){var h=a(n,u);m=le.createElement(h$,{shapeType:r,elementProps:h})}else{var f=u;m=le.createElement(h$,{shapeType:r,elementProps:f})}return c?le.createElement(An,{className:o},m):m}function ay(t,n){return n!=null&&"trapezoids"in t.props}function iy(t,n){return n!=null&&"sectors"in t.props}function of(t,n){return n!=null&&"points"in t.props}function epe(t,n){var r,s,a=t.x===(n==null||(r=n.labelViewBox)===null||r===void 0?void 0:r.x)||t.x===n.x,i=t.y===(n==null||(s=n.labelViewBox)===null||s===void 0?void 0:s.y)||t.y===n.y;return a&&i}function tpe(t,n){var r=t.endAngle===n.endAngle,s=t.startAngle===n.startAngle;return r&&s}function npe(t,n){var r=t.x===n.x,s=t.y===n.y,a=t.z===n.z;return r&&s&&a}function rpe(t,n){var r;return ay(t,n)?r=epe:iy(t,n)?r=tpe:of(t,n)&&(r=npe),r}function spe(t,n){var r;return ay(t,n)?r="trapezoids":iy(t,n)?r="sectors":of(t,n)&&(r="points"),r}function ape(t,n){if(ay(t,n)){var r;return(r=n.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(iy(t,n)){var s;return(s=n.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}return of(t,n)?n.payload:{}}function ipe(t){var n=t.activeTooltipItem,r=t.graphicalItem,s=t.itemData,a=spe(r,n),i=ape(r,n),o=s.filter(function(u,m){var h=Xv(i,u),f=r.props[a].filter(function(b){var g=rpe(r,n);return g(b,n)}),x=r.props[a].indexOf(f[f.length-1]),j=m===x;return h&&j}),c=s.indexOf(o[o.length-1]);return c}var bx;function gu(t){"@babel/helpers - typeof";return gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},gu(t)}function Ed(){return Ed=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ed.apply(this,arguments)}function f$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Bn(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?f$(Object(r),!0).forEach(function(s){Da(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ope(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function p$(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,l8(s.key),s)}}function lpe(t,n,r){return n&&p$(t.prototype,n),r&&p$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cpe(t,n,r){return n=Eg(n),dpe(t,o8()?Reflect.construct(n,r||[],Eg(t).constructor):n.apply(t,r))}function dpe(t,n){if(n&&(gu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return upe(t)}function upe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(o8=function(){return!!t})()}function Eg(t){return Eg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eg(t)}function mpe(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&_S(t,n)}function _S(t,n){return _S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},_S(t,n)}function Da(t,n,r){return n=l8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function l8(t){var n=hpe(t,"string");return gu(n)=="symbol"?n:n+""}function hpe(t,n){if(gu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(gu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ao=(function(t){function n(r){var s;return ope(this,n),s=cpe(this,n,[r]),Da(s,"pieRef",null),Da(s,"sectorRefs",[]),Da(s,"id",Rf("recharts-pie-")),Da(s,"handleAnimationEnd",function(){var a=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Yt(a)&&a()}),Da(s,"handleAnimationStart",function(){var a=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Yt(a)&&a()}),s.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},s}return mpe(n,t),lpe(n,[{key:"isActiveIndex",value:function(s){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(s)!==-1:s===a}},{key:"hasActiveIndex",value:function(){var s=this.props.activeIndex;return Array.isArray(s)?s.length!==0:s||s===0}},{key:"renderLabels",value:function(s){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,c=i.labelLine,u=i.dataKey,m=i.valueKey,h=Wt(this.props,!1),f=Wt(o,!1),x=Wt(c,!1),j=o&&o.offsetRadius||20,b=s.map(function(g,y){var C=(g.startAngle+g.endAngle)/2,k=Un(g.cx,g.cy,g.outerRadius+j,C),N=Bn(Bn(Bn(Bn({},h),g),{},{stroke:"none"},f),{},{index:y,textAnchor:n.getTextAnchor(k.x,g.cx)},k),P=Bn(Bn(Bn(Bn({},h),g),{},{fill:"none",stroke:g.fill},x),{},{index:y,points:[Un(g.cx,g.cy,g.outerRadius,C),k]}),w=u;return hn(u)&&hn(m)?w="value":hn(u)&&(w=m),le.createElement(An,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},c&&n.renderLabelLineItem(c,P,"line"),n.renderLabelItem(o,N,hs(g,w)))});return le.createElement(An,{className:"recharts-pie-labels"},b)}},{key:"renderSectorsStatically",value:function(s){var a=this,i=this.props,o=i.activeShape,c=i.blendStroke,u=i.inactiveShape;return s.map(function(m,h){if(m?.startAngle===0&&m?.endAngle===0&&s.length!==1)return null;var f=a.isActiveIndex(h),x=u&&a.hasActiveIndex()?u:null,j=f?o:x,b=Bn(Bn({},m),{},{stroke:c?m.fill:m.stroke,tabIndex:-1});return le.createElement(An,Ed({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},Ac(a.props,m,h),{key:"sector-".concat(m?.startAngle,"-").concat(m?.endAngle,"-").concat(m.midAngle,"-").concat(h)}),le.createElement(i8,Ed({option:j,isActive:f,shapeType:"sector"},b)))})}},{key:"renderSectorsWithAnimation",value:function(){var s=this,a=this.props,i=a.sectors,o=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,m=a.animationEasing,h=a.animationId,f=this.state,x=f.prevSectors,j=f.prevIsAnimationActive;return le.createElement(_o,{begin:c,duration:u,isActive:o,easing:m,from:{t:0},to:{t:1},key:"pie-".concat(h,"-").concat(j),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(b){var g=b.t,y=[],C=i&&i[0],k=C.startAngle;return i.forEach(function(N,P){var w=x&&x[P],S=P>0?ya(N,"paddingAngle",0):0;if(w){var E=ol(w.endAngle-w.startAngle,N.endAngle-N.startAngle),R=Bn(Bn({},N),{},{startAngle:k+S,endAngle:k+E(g)+S});y.push(R),k=R.endAngle}else{var T=N.endAngle,U=N.startAngle,M=ol(0,T-U),L=M(g),q=Bn(Bn({},N),{},{startAngle:k+S,endAngle:k+L+S});y.push(q),k=q.endAngle}}),le.createElement(An,null,s.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(s){var a=this;s.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"ArrowRight":{var c=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[c].focus(),a.setState({sectorToFocus:c});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var s=this.props,a=s.sectors,i=s.isAnimationActive,o=this.state.prevSectors;return i&&a&&a.length&&(!o||!Xv(o,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var s=this,a=this.props,i=a.hide,o=a.sectors,c=a.className,u=a.label,m=a.cx,h=a.cy,f=a.innerRadius,x=a.outerRadius,j=a.isAnimationActive,b=this.state.isAnimationFinished;if(i||!o||!o.length||!it(m)||!it(h)||!it(f)||!it(x))return null;var g=rn("recharts-pie",c);return le.createElement(An,{tabIndex:this.props.rootTabIndex,className:g,ref:function(C){s.pieRef=C}},this.renderSectors(),u&&this.renderLabels(o),Vr.renderCallByParent(this.props,null,!1),(!j||b)&&vl.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return a.prevIsAnimationActive!==s.isAnimationActive?{prevIsAnimationActive:s.isAnimationActive,prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:[],isAnimationFinished:!0}:s.isAnimationActive&&s.animationId!==a.prevAnimationId?{prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:s.sectors!==a.curSectors?{curSectors:s.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(s,a){return s>a?"start":s<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(s,a,i){if(le.isValidElement(s))return le.cloneElement(s,a);if(Yt(s))return s(a);var o=rn("recharts-pie-label-line",typeof s!="boolean"?s.className:"");return le.createElement(lS,Ed({},a,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(s,a,i){if(le.isValidElement(s))return le.cloneElement(s,a);var o=i;if(Yt(s)&&(o=s(a),le.isValidElement(o)))return o;var c=rn("recharts-pie-label-text",typeof s!="boolean"&&!Yt(s)?s.className:"");return le.createElement(Ec,Ed({},a,{alignmentBaseline:"middle",className:c}),o)}}])})(v.PureComponent);bx=Ao;Da(Ao,"displayName","Pie");Da(Ao,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Vu.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Da(Ao,"parseDeltaAngle",function(t,n){var r=ks(n-t),s=Math.min(Math.abs(n-t),360);return r*s});Da(Ao,"getRealPieData",function(t){var n=t.data,r=t.children,s=Wt(t,!1),a=qa(r,Bv);return n&&n.length?n.map(function(i,o){return Bn(Bn(Bn({payload:i},s),i),a&&a[o]&&a[o].props)}):a&&a.length?a.map(function(i){return Bn(Bn({},s),i.props)}):[]});Da(Ao,"parseCoordinateOfPie",function(t,n){var r=n.top,s=n.left,a=n.width,i=n.height,o=Uz(a,i),c=s+Ps(t.cx,a,a/2),u=r+Ps(t.cy,i,i/2),m=Ps(t.innerRadius,o,0),h=Ps(t.outerRadius,o,o*.8),f=t.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:c,cy:u,innerRadius:m,outerRadius:h,maxRadius:f}});Da(Ao,"getComposedData",function(t){var n=t.item,r=t.offset,s=n.type.defaultProps!==void 0?Bn(Bn({},n.type.defaultProps),n.props):n.props,a=bx.getRealPieData(s);if(!a||!a.length)return null;var i=s.cornerRadius,o=s.startAngle,c=s.endAngle,u=s.paddingAngle,m=s.dataKey,h=s.nameKey,f=s.valueKey,x=s.tooltipType,j=Math.abs(s.minAngle),b=bx.parseCoordinateOfPie(s,r),g=bx.parseDeltaAngle(o,c),y=Math.abs(g),C=m;hn(m)&&hn(f)?(fi(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),C="value"):hn(m)&&(fi(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),C=f);var k=a.filter(function(R){return hs(R,C,0)!==0}).length,N=(y>=360?k:k-1)*u,P=y-k*j-N,w=a.reduce(function(R,T){var U=hs(T,C,0);return R+(it(U)?U:0)},0),S;if(w>0){var E;S=a.map(function(R,T){var U=hs(R,C,0),M=hs(R,h,T),L=(it(U)?U:0)/w,q;T?q=E.endAngle+ks(g)*u*(U!==0?1:0):q=o;var $=q+ks(g)*((U!==0?j:0)+L*P),D=(q+$)/2,z=(b.innerRadius+b.outerRadius)/2,J=[{name:M,value:U,payload:R,dataKey:C,type:x}],I=Un(b.cx,b.cy,z,D);return E=Bn(Bn(Bn({percent:L,cornerRadius:i,name:M,tooltipPayload:J,midAngle:D,middleRadius:z,tooltipPosition:I},R),b),{},{value:hs(R,C),startAngle:q,endAngle:$,payload:R,paddingAngle:ks(g)*u}),E})}return Bn(Bn({},b),{},{sectors:S,data:a})});var lN,x$;function fpe(){if(x$)return lN;x$=1;var t=Math.ceil,n=Math.max;function r(s,a,i,o){for(var c=-1,u=n(t((a-s)/(i||1)),0),m=Array(u);u--;)m[o?u:++c]=s,s+=i;return m}return lN=r,lN}var cN,g$;function c8(){if(g$)return cN;g$=1;var t=OB(),n=1/0,r=17976931348623157e292;function s(a){if(!a)return a===0?a:0;if(a=t(a),a===n||a===-n){var i=a<0?-1:1;return i*r}return a===a?a:0}return cN=s,cN}var dN,v$;function ppe(){if(v$)return dN;v$=1;var t=fpe(),n=qv(),r=c8();function s(a){return function(i,o,c){return c&&typeof c!="number"&&n(i,o,c)&&(o=c=void 0),i=r(i),o===void 0?(o=i,i=0):o=r(o),c=c===void 0?i<o?1:-1:r(c),t(i,o,c,a)}}return dN=s,dN}var uN,y$;function xpe(){if(y$)return uN;y$=1;var t=ppe(),n=t();return uN=n,uN}var gpe=xpe();const Og=kn(gpe);function lf(t){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},lf(t)}function j$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function b$(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?j$(Object(r),!0).forEach(function(s){d8(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function d8(t,n,r){return n=vpe(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function vpe(t){var n=ype(t,"string");return lf(n)=="symbol"?n:n+""}function ype(t,n){if(lf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(lf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var jpe=["Webkit","Moz","O","ms"],bpe=function(n,r){var s=n.replace(/(\w)/,function(i){return i.toUpperCase()}),a=jpe.reduce(function(i,o){return b$(b$({},i),{},d8({},o+s,r))},{});return a[n]=r,a};function vu(t){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},vu(t)}function Tg(){return Tg=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Tg.apply(this,arguments)}function w$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function mN(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?w$(Object(r),!0).forEach(function(s){ua(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):w$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function wpe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _$(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,m8(s.key),s)}}function _pe(t,n,r){return n&&_$(t.prototype,n),r&&_$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Npe(t,n,r){return n=Mg(n),Spe(t,u8()?Reflect.construct(n,r||[],Mg(t).constructor):n.apply(t,r))}function Spe(t,n){if(n&&(vu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cpe(t)}function Cpe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(u8=function(){return!!t})()}function Mg(t){return Mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mg(t)}function kpe(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&NS(t,n)}function NS(t,n){return NS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},NS(t,n)}function ua(t,n,r){return n=m8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function m8(t){var n=Ppe(t,"string");return vu(n)=="symbol"?n:n+""}function Ppe(t,n){if(vu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(vu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ape=function(n){var r=n.data,s=n.startIndex,a=n.endIndex,i=n.x,o=n.width,c=n.travellerWidth;if(!r||!r.length)return{};var u=r.length,m=sh().domain(Og(0,u)).range([i,i+o-c]),h=m.domain().map(function(f){return m(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:m(s),endX:m(a),scale:m,scaleValues:h}},N$=function(n){return n.changedTouches&&!!n.changedTouches.length},yu=(function(t){function n(r){var s;return wpe(this,n),s=Npe(this,n,[r]),ua(s,"handleDrag",function(a){s.leaveTimer&&(clearTimeout(s.leaveTimer),s.leaveTimer=null),s.state.isTravellerMoving?s.handleTravellerMove(a):s.state.isSlideMoving&&s.handleSlideDrag(a)}),ua(s,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&s.handleDrag(a.changedTouches[0])}),ua(s,"handleDragEnd",function(){s.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=s.props,i=a.endIndex,o=a.onDragEnd,c=a.startIndex;o?.({endIndex:i,startIndex:c})}),s.detachDragEndListener()}),ua(s,"handleLeaveWrapper",function(){(s.state.isTravellerMoving||s.state.isSlideMoving)&&(s.leaveTimer=window.setTimeout(s.handleDragEnd,s.props.leaveTimeOut))}),ua(s,"handleEnterSlideOrTraveller",function(){s.setState({isTextActive:!0})}),ua(s,"handleLeaveSlideOrTraveller",function(){s.setState({isTextActive:!1})}),ua(s,"handleSlideDragStart",function(a){var i=N$(a)?a.changedTouches[0]:a;s.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),s.attachDragEndListener()}),s.travellerDragStartHandlers={startX:s.handleTravellerDragStart.bind(s,"startX"),endX:s.handleTravellerDragStart.bind(s,"endX")},s.state={},s}return kpe(n,t),_pe(n,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(s){var a=s.startX,i=s.endX,o=this.state.scaleValues,c=this.props,u=c.gap,m=c.data,h=m.length-1,f=Math.min(a,i),x=Math.max(a,i),j=n.getIndexInRange(o,f),b=n.getIndexInRange(o,x);return{startIndex:j-j%u,endIndex:b===h?h:b-b%u}}},{key:"getTextOfTick",value:function(s){var a=this.props,i=a.data,o=a.tickFormatter,c=a.dataKey,u=hs(i[s],c,s);return Yt(o)?o(u,s):u}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(s){var a=this.state,i=a.slideMoveStartX,o=a.startX,c=a.endX,u=this.props,m=u.x,h=u.width,f=u.travellerWidth,x=u.startIndex,j=u.endIndex,b=u.onChange,g=s.pageX-i;g>0?g=Math.min(g,m+h-f-c,m+h-f-o):g<0&&(g=Math.max(g,m-o,m-c));var y=this.getIndex({startX:o+g,endX:c+g});(y.startIndex!==x||y.endIndex!==j)&&b&&b(y),this.setState({startX:o+g,endX:c+g,slideMoveStartX:s.pageX})}},{key:"handleTravellerDragStart",value:function(s,a){var i=N$(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:s,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(s){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,c=a.endX,u=a.startX,m=this.state[o],h=this.props,f=h.x,x=h.width,j=h.travellerWidth,b=h.onChange,g=h.gap,y=h.data,C={startX:this.state.startX,endX:this.state.endX},k=s.pageX-i;k>0?k=Math.min(k,f+x-j-m):k<0&&(k=Math.max(k,f-m)),C[o]=m+k;var N=this.getIndex(C),P=N.startIndex,w=N.endIndex,S=function(){var R=y.length-1;return o==="startX"&&(c>u?P%g===0:w%g===0)||c<u&&w===R||o==="endX"&&(c>u?w%g===0:P%g===0)||c>u&&w===R};this.setState(ua(ua({},o,m+k),"brushMoveStartX",s.pageX),function(){b&&S()&&b(N)})}},{key:"handleTravellerMoveKeyboard",value:function(s,a){var i=this,o=this.state,c=o.scaleValues,u=o.startX,m=o.endX,h=this.state[a],f=c.indexOf(h);if(f!==-1){var x=f+s;if(!(x===-1||x>=c.length)){var j=c[x];a==="startX"&&j>=m||a==="endX"&&j<=u||this.setState(ua({},a,j),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,c=s.height,u=s.fill,m=s.stroke;return le.createElement("rect",{stroke:m,fill:u,x:a,y:i,width:o,height:c})}},{key:"renderPanorama",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,c=s.height,u=s.data,m=s.children,h=s.padding,f=v.Children.only(m);return f?le.cloneElement(f,{x:a,y:i,width:o,height:c,margin:h,compact:!0,data:u}):null}},{key:"renderTravellerLayer",value:function(s,a){var i,o,c=this,u=this.props,m=u.y,h=u.travellerWidth,f=u.height,x=u.traveller,j=u.ariaLabel,b=u.data,g=u.startIndex,y=u.endIndex,C=Math.max(s,this.props.x),k=mN(mN({},Wt(this.props,!1)),{},{x:C,y:m,width:h,height:f}),N=j||"Min value: ".concat((i=b[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=b[y])===null||o===void 0?void 0:o.name);return le.createElement(An,{tabIndex:0,role:"slider","aria-label":N,"aria-valuenow":s,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(w){["ArrowLeft","ArrowRight"].includes(w.key)&&(w.preventDefault(),w.stopPropagation(),c.handleTravellerMoveKeyboard(w.key==="ArrowRight"?1:-1,a))},onFocus:function(){c.setState({isTravellerFocused:!0})},onBlur:function(){c.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},n.renderTraveller(x,k))}},{key:"renderSlide",value:function(s,a){var i=this.props,o=i.y,c=i.height,u=i.stroke,m=i.travellerWidth,h=Math.min(s,a)+m,f=Math.max(Math.abs(a-s)-m,0);return le.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:u,fillOpacity:.2,x:h,y:o,width:f,height:c})}},{key:"renderText",value:function(){var s=this.props,a=s.startIndex,i=s.endIndex,o=s.y,c=s.height,u=s.travellerWidth,m=s.stroke,h=this.state,f=h.startX,x=h.endX,j=5,b={pointerEvents:"none",fill:m};return le.createElement(An,{className:"recharts-brush-texts"},le.createElement(Ec,Tg({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,x)-j,y:o+c/2},b),this.getTextOfTick(a)),le.createElement(Ec,Tg({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,x)+u+j,y:o+c/2},b),this.getTextOfTick(i)))}},{key:"render",value:function(){var s=this.props,a=s.data,i=s.className,o=s.children,c=s.x,u=s.y,m=s.width,h=s.height,f=s.alwaysShowText,x=this.state,j=x.startX,b=x.endX,g=x.isTextActive,y=x.isSlideMoving,C=x.isTravellerMoving,k=x.isTravellerFocused;if(!a||!a.length||!it(c)||!it(u)||!it(m)||!it(h)||m<=0||h<=0)return null;var N=rn("recharts-brush",i),P=le.Children.count(o)===1,w=bpe("userSelect","none");return le.createElement(An,{className:N,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:w},this.renderBackground(),P&&this.renderPanorama(),this.renderSlide(j,b),this.renderTravellerLayer(j,"startX"),this.renderTravellerLayer(b,"endX"),(g||y||C||k||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(s){var a=s.x,i=s.y,o=s.width,c=s.height,u=s.stroke,m=Math.floor(i+c/2)-1;return le.createElement(le.Fragment,null,le.createElement("rect",{x:a,y:i,width:o,height:c,fill:u,stroke:"none"}),le.createElement("line",{x1:a+1,y1:m,x2:a+o-1,y2:m,fill:"none",stroke:"#fff"}),le.createElement("line",{x1:a+1,y1:m+2,x2:a+o-1,y2:m+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(s,a){var i;return le.isValidElement(s)?i=le.cloneElement(s,a):Yt(s)?i=s(a):i=n.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(s,a){var i=s.data,o=s.width,c=s.x,u=s.travellerWidth,m=s.updateId,h=s.startIndex,f=s.endIndex;if(i!==a.prevData||m!==a.prevUpdateId)return mN({prevData:i,prevTravellerWidth:u,prevUpdateId:m,prevX:c,prevWidth:o},i&&i.length?Ape({data:i,width:o,x:c,travellerWidth:u,startIndex:h,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||c!==a.prevX||u!==a.prevTravellerWidth)){a.scale.range([c,c+o-u]);var x=a.scale.domain().map(function(j){return a.scale(j)});return{prevData:i,prevTravellerWidth:u,prevUpdateId:m,prevX:c,prevWidth:o,startX:a.scale(s.startIndex),endX:a.scale(s.endIndex),scaleValues:x}}return null}},{key:"getIndexInRange",value:function(s,a){for(var i=s.length,o=0,c=i-1;c-o>1;){var u=Math.floor((o+c)/2);s[u]>a?c=u:o=u}return a>=s[c]?c:o}}])})(v.PureComponent);ua(yu,"displayName","Brush");ua(yu,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var hN,S$;function Epe(){if(S$)return hN;S$=1;var t=uk();function n(r,s){var a;return t(r,function(i,o,c){return a=s(i,o,c),!a}),!!a}return hN=n,hN}var fN,C$;function Ope(){if(C$)return fN;C$=1;var t=lB(),n=Ki(),r=Epe(),s=ea(),a=qv();function i(o,c,u){var m=s(o)?t:r;return u&&a(o,c,u)&&(c=void 0),m(o,n(c,3))}return fN=i,fN}var Tpe=Ope();const Mpe=kn(Tpe);var Li=function(n,r){var s=n.alwaysShow,a=n.ifOverflow;return s&&(a="extendDomain"),a===r},pN,k$;function Rpe(){if(k$)return pN;k$=1;var t=CB();function n(r,s,a){s=="__proto__"&&t?t(r,s,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[s]=a}return pN=n,pN}var xN,P$;function Dpe(){if(P$)return xN;P$=1;var t=Rpe(),n=NB(),r=Ki();function s(a,i){var o={};return i=r(i,3),n(a,function(c,u,m){t(o,u,i(c,u,m))}),o}return xN=s,xN}var $pe=Dpe();const Fpe=kn($pe);var gN,A$;function Lpe(){if(A$)return gN;A$=1;function t(n,r){for(var s=-1,a=n==null?0:n.length;++s<a;)if(!r(n[s],s,n))return!1;return!0}return gN=t,gN}var vN,E$;function Ipe(){if(E$)return vN;E$=1;var t=uk();function n(r,s){var a=!0;return t(r,function(i,o,c){return a=!!s(i,o,c),a}),a}return vN=n,vN}var yN,O$;function qpe(){if(O$)return yN;O$=1;var t=Lpe(),n=Ipe(),r=Ki(),s=ea(),a=qv();function i(o,c,u){var m=s(o)?t:n;return u&&a(o,c,u)&&(c=void 0),m(o,r(c,3))}return yN=i,yN}var Bpe=qpe();const h8=kn(Bpe);var zpe=["x","y"];function cf(t){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},cf(t)}function SS(){return SS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},SS.apply(this,arguments)}function T$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Bm(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?T$(Object(r),!0).forEach(function(s){Vpe(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Vpe(t,n,r){return n=Upe(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Upe(t){var n=Kpe(t,"string");return cf(n)=="symbol"?n:n+""}function Kpe(t,n){if(cf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(cf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Wpe(t,n){if(t==null)return{};var r=Hpe(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Hpe(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function Gpe(t,n){var r=t.x,s=t.y,a=Wpe(t,zpe),i="".concat(r),o=parseInt(i,10),c="".concat(s),u=parseInt(c,10),m="".concat(n.height||a.height),h=parseInt(m,10),f="".concat(n.width||a.width),x=parseInt(f,10);return Bm(Bm(Bm(Bm(Bm({},n),a),o?{x:o}:{}),u?{y:u}:{}),{},{height:h,width:x,name:n.name,radius:n.radius})}function M$(t){return le.createElement(i8,SS({shapeType:"rectangle",propTransformer:Gpe,activeClassName:"recharts-active-bar"},t))}var Ype=function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(s,a){if(typeof n=="number")return n;var i=it(s)||jne(s);return i?n(s,a):(i||Tc(),r)}},Qpe=["value","background"],f8;function ju(t){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ju(t)}function Xpe(t,n){if(t==null)return{};var r=Zpe(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Zpe(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function Rg(){return Rg=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Rg.apply(this,arguments)}function R$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function gr(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?R$(Object(r),!0).forEach(function(s){fl(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Jpe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function D$(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,x8(s.key),s)}}function exe(t,n,r){return n&&D$(t.prototype,n),r&&D$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function txe(t,n,r){return n=Dg(n),nxe(t,p8()?Reflect.construct(n,r||[],Dg(t).constructor):n.apply(t,r))}function nxe(t,n){if(n&&(ju(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rxe(t)}function rxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p8=function(){return!!t})()}function Dg(t){return Dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dg(t)}function sxe(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&CS(t,n)}function CS(t,n){return CS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},CS(t,n)}function fl(t,n,r){return n=x8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function x8(t){var n=axe(t,"string");return ju(n)=="symbol"?n:n+""}function axe(t,n){if(ju(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(ju(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Pl=(function(t){function n(){var r;Jpe(this,n);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=txe(this,n,[].concat(a)),fl(r,"state",{isAnimationFinished:!1}),fl(r,"id",Rf("recharts-bar-")),fl(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),fl(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return sxe(n,t),exe(n,[{key:"renderRectanglesStatically",value:function(s){var a=this,i=this.props,o=i.shape,c=i.dataKey,u=i.activeIndex,m=i.activeBar,h=Wt(this.props,!1);return s&&s.map(function(f,x){var j=x===u,b=j?m:o,g=gr(gr(gr({},h),f),{},{isActive:j,option:b,index:x,dataKey:c,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return le.createElement(An,Rg({className:"recharts-bar-rectangle"},Ac(a.props,f,x),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(x)}),le.createElement(M$,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var s=this,a=this.props,i=a.data,o=a.layout,c=a.isAnimationActive,u=a.animationBegin,m=a.animationDuration,h=a.animationEasing,f=a.animationId,x=this.state.prevData;return le.createElement(_o,{begin:u,duration:m,isActive:c,easing:h,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var b=j.t,g=i.map(function(y,C){var k=x&&x[C];if(k){var N=ol(k.x,y.x),P=ol(k.y,y.y),w=ol(k.width,y.width),S=ol(k.height,y.height);return gr(gr({},y),{},{x:N(b),y:P(b),width:w(b),height:S(b)})}if(o==="horizontal"){var E=ol(0,y.height),R=E(b);return gr(gr({},y),{},{y:y.y+y.height-R,height:R})}var T=ol(0,y.width),U=T(b);return gr(gr({},y),{},{width:U})});return le.createElement(An,null,s.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var s=this.props,a=s.data,i=s.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!Xv(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var s=this,a=this.props,i=a.data,o=a.dataKey,c=a.activeIndex,u=Wt(this.props.background,!1);return i.map(function(m,h){m.value;var f=m.background,x=Xpe(m,Qpe);if(!f)return null;var j=gr(gr(gr(gr(gr({},x),{},{fill:"#eee"},f),u),Ac(s.props,m,h)),{},{onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd,dataKey:o,index:h,className:"recharts-bar-background-rectangle"});return le.createElement(M$,Rg({key:"background-bar-".concat(h),option:s.props.background,isActive:h===c},j))})}},{key:"renderErrorBar",value:function(s,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,c=i.xAxis,u=i.yAxis,m=i.layout,h=i.children,f=qa(h,ey);if(!f)return null;var x=m==="vertical"?o[0].height/2:o[0].width/2,j=function(y,C){var k=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:k,errorVal:hs(y,C)}},b={clipPath:s?"url(#clipPath-".concat(a,")"):null};return le.createElement(An,b,f.map(function(g){return le.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:o,xAxis:c,yAxis:u,layout:m,offset:x,dataPointFormatter:j})}))}},{key:"render",value:function(){var s=this.props,a=s.hide,i=s.data,o=s.className,c=s.xAxis,u=s.yAxis,m=s.left,h=s.top,f=s.width,x=s.height,j=s.isAnimationActive,b=s.background,g=s.id;if(a||!i||!i.length)return null;var y=this.state.isAnimationFinished,C=rn("recharts-bar",o),k=c&&c.allowDataOverflow,N=u&&u.allowDataOverflow,P=k||N,w=hn(g)?this.id:g;return le.createElement(An,{className:C},k||N?le.createElement("defs",null,le.createElement("clipPath",{id:"clipPath-".concat(w)},le.createElement("rect",{x:k?m:m-f/2,y:N?h:h-x/2,width:k?f:f*2,height:N?x:x*2}))):null,le.createElement(An,{className:"recharts-bar-rectangles",clipPath:P?"url(#clipPath-".concat(w,")"):null},b?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(P,w),(!j||y)&&vl.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return s.animationId!==a.prevAnimationId?{prevAnimationId:s.animationId,curData:s.data,prevData:a.curData}:s.data!==a.curData?{curData:s.data}:null}}])})(v.PureComponent);f8=Pl;fl(Pl,"displayName","Bar");fl(Pl,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Vu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});fl(Pl,"getComposedData",function(t){var n=t.props,r=t.item,s=t.barPosition,a=t.bandSize,i=t.xAxis,o=t.yAxis,c=t.xAxisTicks,u=t.yAxisTicks,m=t.stackedData,h=t.dataStartIndex,f=t.displayedData,x=t.offset,j=Rde(s,r);if(!j)return null;var b=n.layout,g=r.type.defaultProps,y=g!==void 0?gr(gr({},g),r.props):r.props,C=y.dataKey,k=y.children,N=y.minPointSize,P=b==="horizontal"?o:i,w=m?P.scale.domain():null,S=Bde({numericAxis:P}),E=qa(k,Bv),R=f.map(function(T,U){var M,L,q,$,D,z;m?M=Dde(m[h+U],w):(M=hs(T,C),Array.isArray(M)||(M=[S,M]));var J=Ype(N,f8.defaultProps.minPointSize)(M[1],U);if(b==="horizontal"){var I,X=[o.scale(M[0]),o.scale(M[1])],ne=X[0],W=X[1];L=iD({axis:i,ticks:c,bandSize:a,offset:j.offset,entry:T,index:U}),q=(I=W??ne)!==null&&I!==void 0?I:void 0,$=j.size;var H=ne-W;if(D=Number.isNaN(H)?0:H,z={x:L,y:o.y,width:$,height:o.height},Math.abs(J)>0&&Math.abs(D)<Math.abs(J)){var fe=ks(D||J)*(Math.abs(J)-Math.abs(D));q-=fe,D+=fe}}else{var Pe=[i.scale(M[0]),i.scale(M[1])],Re=Pe[0],Ie=Pe[1];if(L=Re,q=iD({axis:o,ticks:u,bandSize:a,offset:j.offset,entry:T,index:U}),$=Ie-Re,D=j.size,z={x:i.x,y:q,width:i.width,height:D},Math.abs(J)>0&&Math.abs($)<Math.abs(J)){var Ce=ks($||J)*(Math.abs(J)-Math.abs($));$+=Ce}}return gr(gr(gr({},T),{},{x:L,y:q,width:$,height:D,value:m?M:M[1],payload:T,background:z},E&&E[U]&&E[U].props),{},{tooltipPayload:[zz(r,T)],tooltipPosition:{x:L+$/2,y:q+D/2}})});return gr({data:R,layout:b},x)});function df(t){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},df(t)}function ixe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function $$(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,g8(s.key),s)}}function oxe(t,n,r){return n&&$$(t.prototype,n),r&&$$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function F$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function si(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?F$(Object(r),!0).forEach(function(s){oy(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function oy(t,n,r){return n=g8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function g8(t){var n=lxe(t,"string");return df(n)=="symbol"?n:n+""}function lxe(t,n){if(df(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(df(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var cxe=function(n,r,s,a,i){var o=n.width,c=n.height,u=n.layout,m=n.children,h=Object.keys(r),f={left:s.left,leftMirror:s.left,right:o-s.right,rightMirror:o-s.right,top:s.top,topMirror:s.top,bottom:c-s.bottom,bottomMirror:c-s.bottom},x=!!ma(m,Pl);return h.reduce(function(j,b){var g=r[b],y=g.orientation,C=g.domain,k=g.padding,N=k===void 0?{}:k,P=g.mirror,w=g.reversed,S="".concat(y).concat(P?"Mirror":""),E,R,T,U,M;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var L=C[1]-C[0],q=1/0,$=g.categoricalDomain.sort(_ne);if($.forEach(function(Pe,Re){Re>0&&(q=Math.min((Pe||0)-($[Re-1]||0),q))}),Number.isFinite(q)){var D=q/L,z=g.layout==="vertical"?s.height:s.width;if(g.padding==="gap"&&(E=D*z/2),g.padding==="no-gap"){var J=Ps(n.barCategoryGap,D*z),I=D*z/2;E=I-J-(I-J)/z*J}}}a==="xAxis"?R=[s.left+(N.left||0)+(E||0),s.left+s.width-(N.right||0)-(E||0)]:a==="yAxis"?R=u==="horizontal"?[s.top+s.height-(N.bottom||0),s.top+(N.top||0)]:[s.top+(N.top||0)+(E||0),s.top+s.height-(N.bottom||0)-(E||0)]:R=g.range,w&&(R=[R[1],R[0]]);var X=Lz(g,i,x),ne=X.scale,W=X.realScaleType;ne.domain(C).range(R),Iz(ne);var H=qz(ne,si(si({},g),{},{realScaleType:W}));a==="xAxis"?(M=y==="top"&&!P||y==="bottom"&&P,T=s.left,U=f[S]-M*g.height):a==="yAxis"&&(M=y==="left"&&!P||y==="right"&&P,T=f[S]-M*g.width,U=s.top);var fe=si(si(si({},g),H),{},{realScaleType:W,x:T,y:U,scale:ne,width:a==="xAxis"?s.width:g.width,height:a==="yAxis"?s.height:g.height});return fe.bandSize=yg(fe,H),!g.hide&&a==="xAxis"?f[S]+=(M?-1:1)*fe.height:g.hide||(f[S]+=(M?-1:1)*fe.width),si(si({},j),{},oy({},b,fe))},{})},v8=function(n,r){var s=n.x,a=n.y,i=r.x,o=r.y;return{x:Math.min(s,i),y:Math.min(a,o),width:Math.abs(i-s),height:Math.abs(o-a)}},dxe=function(n){var r=n.x1,s=n.y1,a=n.x2,i=n.y2;return v8({x:r,y:s},{x:a,y:i})},y8=(function(){function t(n){ixe(this,t),this.scale=n}return oxe(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.bandAware,i=s.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var c=this.bandwidth?this.bandwidth():0;return this.scale(r)+c}default:return this.scale(r)}if(a){var u=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+u}return this.scale(r)}}},{key:"isInRange",value:function(r){var s=this.range(),a=s[0],i=s[s.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new t(r)}}])})();oy(y8,"EPS",1e-4);var Bk=function(n){var r=Object.keys(n).reduce(function(s,a){return si(si({},s),{},oy({},a,y8.create(n[a])))},{});return si(si({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,c=i.position;return Fpe(a,function(u,m){return r[m].apply(u,{bandAware:o,position:c})})},isInRange:function(a){return h8(a,function(i,o){return r[o].isInRange(i)})}})};function uxe(t){return(t%180+180)%180}var mxe=function(n){var r=n.width,s=n.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=uxe(a),o=i*Math.PI/180,c=Math.atan(s/r),u=o>c&&o<Math.PI-c?s/Math.sin(o):r/Math.cos(o);return Math.abs(u)},jN,L$;function hxe(){if(L$)return jN;L$=1;var t=Ki(),n=Df(),r=Lv();function s(a){return function(i,o,c){var u=Object(i);if(!n(i)){var m=t(o,3);i=r(i),o=function(f){return m(u[f],f,u)}}var h=a(i,o,c);return h>-1?u[m?i[h]:h]:void 0}}return jN=s,jN}var bN,I$;function fxe(){if(I$)return bN;I$=1;var t=c8();function n(r){var s=t(r),a=s%1;return s===s?a?s-a:s:0}return bN=n,bN}var wN,q$;function pxe(){if(q$)return wN;q$=1;var t=yB(),n=Ki(),r=fxe(),s=Math.max;function a(i,o,c){var u=i==null?0:i.length;if(!u)return-1;var m=c==null?0:r(c);return m<0&&(m=s(u+m,0)),t(i,n(o,3),m)}return wN=a,wN}var _N,B$;function xxe(){if(B$)return _N;B$=1;var t=hxe(),n=pxe(),r=t(n);return _N=r,_N}var gxe=xxe();const vxe=kn(gxe);var yxe=D6();const jxe=kn(yxe);var bxe=jxe(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),zk=v.createContext(void 0),Vk=v.createContext(void 0),j8=v.createContext(void 0),b8=v.createContext({}),w8=v.createContext(void 0),_8=v.createContext(0),N8=v.createContext(0),z$=function(n){var r=n.state,s=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=n.clipPathId,c=n.children,u=n.width,m=n.height,h=bxe(i);return le.createElement(zk.Provider,{value:s},le.createElement(Vk.Provider,{value:a},le.createElement(b8.Provider,{value:i},le.createElement(j8.Provider,{value:h},le.createElement(w8.Provider,{value:o},le.createElement(_8.Provider,{value:m},le.createElement(N8.Provider,{value:u},c)))))))},wxe=function(){return v.useContext(w8)},S8=function(n){var r=v.useContext(zk);r==null&&Tc();var s=r[n];return s==null&&Tc(),s},_xe=function(){var n=v.useContext(zk);return ul(n)},Nxe=function(){var n=v.useContext(Vk),r=vxe(n,function(s){return h8(s.domain,Number.isFinite)});return r||ul(n)},C8=function(n){var r=v.useContext(Vk);r==null&&Tc();var s=r[n];return s==null&&Tc(),s},Sxe=function(){var n=v.useContext(j8);return n},Cxe=function(){return v.useContext(b8)},Uk=function(){return v.useContext(N8)},Kk=function(){return v.useContext(_8)};function bu(t){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},bu(t)}function kxe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Pxe(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,P8(s.key),s)}}function Axe(t,n,r){return n&&Pxe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Exe(t,n,r){return n=$g(n),Oxe(t,k8()?Reflect.construct(n,r||[],$g(t).constructor):n.apply(t,r))}function Oxe(t,n){if(n&&(bu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Txe(t)}function Txe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k8=function(){return!!t})()}function $g(t){return $g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$g(t)}function Mxe(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&kS(t,n)}function kS(t,n){return kS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},kS(t,n)}function V$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function U$(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?V$(Object(r),!0).forEach(function(s){Wk(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):V$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Wk(t,n,r){return n=P8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function P8(t){var n=Rxe(t,"string");return bu(n)=="symbol"?n:n+""}function Rxe(t,n){if(bu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(bu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Dxe(t,n){return Ixe(t)||Lxe(t,n)||Fxe(t,n)||$xe()}function $xe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fxe(t,n){if(t){if(typeof t=="string")return K$(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K$(t,n)}}function K$(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function Lxe(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function Ixe(t){if(Array.isArray(t))return t}function PS(){return PS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},PS.apply(this,arguments)}var qxe=function(n,r){var s;return le.isValidElement(n)?s=le.cloneElement(n,r):Yt(n)?s=n(r):s=le.createElement("line",PS({},r,{className:"recharts-reference-line-line"})),s},Bxe=function(n,r,s,a,i,o,c,u,m){var h=i.x,f=i.y,x=i.width,j=i.height;if(s){var b=m.y,g=n.y.apply(b,{position:o});if(Li(m,"discard")&&!n.y.isInRange(g))return null;var y=[{x:h+x,y:g},{x:h,y:g}];return u==="left"?y.reverse():y}if(r){var C=m.x,k=n.x.apply(C,{position:o});if(Li(m,"discard")&&!n.x.isInRange(k))return null;var N=[{x:k,y:f+j},{x:k,y:f}];return c==="top"?N.reverse():N}if(a){var P=m.segment,w=P.map(function(S){return n.apply(S,{position:o})});return Li(m,"discard")&&Mpe(w,function(S){return!n.isInRange(S)})?null:w}return null};function zxe(t){var n=t.x,r=t.y,s=t.segment,a=t.xAxisId,i=t.yAxisId,o=t.shape,c=t.className,u=t.alwaysShow,m=wxe(),h=S8(a),f=C8(i),x=Sxe();if(!m||!x)return null;fi(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var j=Bk({x:h.scale,y:f.scale}),b=Dr(n),g=Dr(r),y=s&&s.length===2,C=Bxe(j,b,g,y,x,t.position,h.orientation,f.orientation,t);if(!C)return null;var k=Dxe(C,2),N=k[0],P=N.x,w=N.y,S=k[1],E=S.x,R=S.y,T=Li(t,"hidden")?"url(#".concat(m,")"):void 0,U=U$(U$({clipPath:T},Wt(t,!0)),{},{x1:P,y1:w,x2:E,y2:R});return le.createElement(An,{className:rn("recharts-reference-line",c)},qxe(o,U),Vr.renderCallByParent(t,dxe({x1:P,y1:w,x2:E,y2:R})))}var Hk=(function(t){function n(){return kxe(this,n),Exe(this,n,arguments)}return Mxe(n,t),Axe(n,[{key:"render",value:function(){return le.createElement(zxe,this.props)}}])})(le.Component);Wk(Hk,"displayName","ReferenceLine");Wk(Hk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function AS(){return AS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},AS.apply(this,arguments)}function wu(t){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},wu(t)}function W$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function H$(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?W$(Object(r),!0).forEach(function(s){ly(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Vxe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Uxe(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,E8(s.key),s)}}function Kxe(t,n,r){return n&&Uxe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wxe(t,n,r){return n=Fg(n),Hxe(t,A8()?Reflect.construct(n,r||[],Fg(t).constructor):n.apply(t,r))}function Hxe(t,n){if(n&&(wu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gxe(t)}function Gxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(A8=function(){return!!t})()}function Fg(t){return Fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fg(t)}function Yxe(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&ES(t,n)}function ES(t,n){return ES=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},ES(t,n)}function ly(t,n,r){return n=E8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function E8(t){var n=Qxe(t,"string");return wu(n)=="symbol"?n:n+""}function Qxe(t,n){if(wu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(wu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Xxe=function(n){var r=n.x,s=n.y,a=n.xAxis,i=n.yAxis,o=Bk({x:a.scale,y:i.scale}),c=o.apply({x:r,y:s},{bandAware:!0});return Li(n,"discard")&&!o.isInRange(c)?null:c},cy=(function(t){function n(){return Vxe(this,n),Wxe(this,n,arguments)}return Yxe(n,t),Kxe(n,[{key:"render",value:function(){var s=this.props,a=s.x,i=s.y,o=s.r,c=s.alwaysShow,u=s.clipPathId,m=Dr(a),h=Dr(i);if(fi(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!m||!h)return null;var f=Xxe(this.props);if(!f)return null;var x=f.x,j=f.y,b=this.props,g=b.shape,y=b.className,C=Li(this.props,"hidden")?"url(#".concat(u,")"):void 0,k=H$(H$({clipPath:C},Wt(this.props,!0)),{},{cx:x,cy:j});return le.createElement(An,{className:rn("recharts-reference-dot",y)},n.renderDot(g,k),Vr.renderCallByParent(this.props,{x:x-o,y:j-o,width:2*o,height:2*o}))}}])})(le.Component);ly(cy,"displayName","ReferenceDot");ly(cy,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});ly(cy,"renderDot",function(t,n){var r;return le.isValidElement(t)?r=le.cloneElement(t,n):Yt(t)?r=t(n):r=le.createElement(qk,AS({},n,{cx:n.cx,cy:n.cy,className:"recharts-reference-dot-dot"})),r});function OS(){return OS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},OS.apply(this,arguments)}function _u(t){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_u(t)}function G$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Y$(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?G$(Object(r),!0).forEach(function(s){dy(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Zxe(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Jxe(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,T8(s.key),s)}}function ege(t,n,r){return n&&Jxe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tge(t,n,r){return n=Lg(n),nge(t,O8()?Reflect.construct(n,r||[],Lg(t).constructor):n.apply(t,r))}function nge(t,n){if(n&&(_u(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rge(t)}function rge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(O8=function(){return!!t})()}function Lg(t){return Lg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lg(t)}function sge(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&TS(t,n)}function TS(t,n){return TS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},TS(t,n)}function dy(t,n,r){return n=T8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function T8(t){var n=age(t,"string");return _u(n)=="symbol"?n:n+""}function age(t,n){if(_u(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(_u(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ige=function(n,r,s,a,i){var o=i.x1,c=i.x2,u=i.y1,m=i.y2,h=i.xAxis,f=i.yAxis;if(!h||!f)return null;var x=Bk({x:h.scale,y:f.scale}),j={x:n?x.x.apply(o,{position:"start"}):x.x.rangeMin,y:s?x.y.apply(u,{position:"start"}):x.y.rangeMin},b={x:r?x.x.apply(c,{position:"end"}):x.x.rangeMax,y:a?x.y.apply(m,{position:"end"}):x.y.rangeMax};return Li(i,"discard")&&(!x.isInRange(j)||!x.isInRange(b))?null:v8(j,b)},uy=(function(t){function n(){return Zxe(this,n),tge(this,n,arguments)}return sge(n,t),ege(n,[{key:"render",value:function(){var s=this.props,a=s.x1,i=s.x2,o=s.y1,c=s.y2,u=s.className,m=s.alwaysShow,h=s.clipPathId;fi(m===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Dr(a),x=Dr(i),j=Dr(o),b=Dr(c),g=this.props.shape;if(!f&&!x&&!j&&!b&&!g)return null;var y=ige(f,x,j,b,this.props);if(!y&&!g)return null;var C=Li(this.props,"hidden")?"url(#".concat(h,")"):void 0;return le.createElement(An,{className:rn("recharts-reference-area",u)},n.renderRect(g,Y$(Y$({clipPath:C},Wt(this.props,!0)),y)),Vr.renderCallByParent(this.props,y))}}])})(le.Component);dy(uy,"displayName","ReferenceArea");dy(uy,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});dy(uy,"renderRect",function(t,n){var r;return le.isValidElement(t)?r=le.cloneElement(t,n):Yt(t)?r=t(n):r=le.createElement(Ik,OS({},n,{className:"recharts-reference-area-rect"})),r});function M8(t,n,r){if(n<1)return[];if(n===1&&r===void 0)return t;for(var s=[],a=0;a<t.length;a+=n)s.push(t[a]);return s}function oge(t,n,r){var s={width:t.width+n.width,height:t.height+n.height};return mxe(s,r)}function lge(t,n,r){var s=r==="width",a=t.x,i=t.y,o=t.width,c=t.height;return n===1?{start:s?a:i,end:s?a+o:i+c}:{start:s?a+o:i+c,end:s?a:i}}function Ig(t,n,r,s,a){if(t*n<t*s||t*n>t*a)return!1;var i=r();return t*(n-t*i/2-s)>=0&&t*(n+t*i/2-a)<=0}function cge(t,n){return M8(t,n+1)}function dge(t,n,r,s,a){for(var i=(s||[]).slice(),o=n.start,c=n.end,u=0,m=1,h=o,f=function(){var b=s?.[u];if(b===void 0)return{v:M8(s,m)};var g=u,y,C=function(){return y===void 0&&(y=r(b,g)),y},k=b.coordinate,N=u===0||Ig(t,k,C,h,c);N||(u=0,h=o,m+=1),N&&(h=k+t*(C()/2+a),u+=m)},x;m<=i.length;)if(x=f(),x)return x.v;return[]}function uf(t){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},uf(t)}function Q$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function us(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Q$(Object(r),!0).forEach(function(s){uge(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function uge(t,n,r){return n=mge(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function mge(t){var n=hge(t,"string");return uf(n)=="symbol"?n:n+""}function hge(t,n){if(uf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(uf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function fge(t,n,r,s,a){for(var i=(s||[]).slice(),o=i.length,c=n.start,u=n.end,m=function(x){var j=i[x],b,g=function(){return b===void 0&&(b=r(j,x)),b};if(x===o-1){var y=t*(j.coordinate+t*g()/2-u);i[x]=j=us(us({},j),{},{tickCoord:y>0?j.coordinate-y*t:j.coordinate})}else i[x]=j=us(us({},j),{},{tickCoord:j.coordinate});var C=Ig(t,j.tickCoord,g,c,u);C&&(u=j.tickCoord-t*(g()/2+a),i[x]=us(us({},j),{},{isShow:!0}))},h=o-1;h>=0;h--)m(h);return i}function pge(t,n,r,s,a,i){var o=(s||[]).slice(),c=o.length,u=n.start,m=n.end;if(i){var h=s[c-1],f=r(h,c-1),x=t*(h.coordinate+t*f/2-m);o[c-1]=h=us(us({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate});var j=Ig(t,h.tickCoord,function(){return f},u,m);j&&(m=h.tickCoord-t*(f/2+a),o[c-1]=us(us({},h),{},{isShow:!0}))}for(var b=i?c-1:c,g=function(k){var N=o[k],P,w=function(){return P===void 0&&(P=r(N,k)),P};if(k===0){var S=t*(N.coordinate-t*w()/2-u);o[k]=N=us(us({},N),{},{tickCoord:S<0?N.coordinate-S*t:N.coordinate})}else o[k]=N=us(us({},N),{},{tickCoord:N.coordinate});var E=Ig(t,N.tickCoord,w,u,m);E&&(u=N.tickCoord+t*(w()/2+a),o[k]=us(us({},N),{},{isShow:!0}))},y=0;y<b;y++)g(y);return o}function Gk(t,n,r){var s=t.tick,a=t.ticks,i=t.viewBox,o=t.minTickGap,c=t.orientation,u=t.interval,m=t.tickFormatter,h=t.unit,f=t.angle;if(!a||!a.length||!s)return[];if(it(u)||Vu.isSsr)return cge(a,typeof u=="number"&&it(u)?u:0);var x=[],j=c==="top"||c==="bottom"?"width":"height",b=h&&j==="width"?rh(h,{fontSize:n,letterSpacing:r}):{width:0,height:0},g=function(N,P){var w=Yt(m)?m(N.value,P):N.value;return j==="width"?oge(rh(w,{fontSize:n,letterSpacing:r}),b,f):rh(w,{fontSize:n,letterSpacing:r})[j]},y=a.length>=2?ks(a[1].coordinate-a[0].coordinate):1,C=lge(i,y,j);return u==="equidistantPreserveStart"?dge(y,C,g,a,o):(u==="preserveStart"||u==="preserveStartEnd"?x=pge(y,C,g,a,o,u==="preserveStartEnd"):x=fge(y,C,g,a,o),x.filter(function(k){return k.isShow}))}var xge=["viewBox"],gge=["viewBox"],vge=["ticks"];function Nu(t){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Nu(t)}function Od(){return Od=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Od.apply(this,arguments)}function X$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Or(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?X$(Object(r),!0).forEach(function(s){Yk(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):X$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function NN(t,n){if(t==null)return{};var r=yge(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function yge(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function jge(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Z$(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,D8(s.key),s)}}function bge(t,n,r){return n&&Z$(t.prototype,n),r&&Z$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wge(t,n,r){return n=qg(n),_ge(t,R8()?Reflect.construct(n,r||[],qg(t).constructor):n.apply(t,r))}function _ge(t,n){if(n&&(Nu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nge(t)}function Nge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(R8=function(){return!!t})()}function qg(t){return qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qg(t)}function Sge(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&MS(t,n)}function MS(t,n){return MS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},MS(t,n)}function Yk(t,n,r){return n=D8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function D8(t){var n=Cge(t,"string");return Nu(n)=="symbol"?n:n+""}function Cge(t,n){if(Nu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Nu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Hu=(function(t){function n(r){var s;return jge(this,n),s=wge(this,n,[r]),s.state={fontSize:"",letterSpacing:""},s}return Sge(n,t),bge(n,[{key:"shouldComponentUpdate",value:function(s,a){var i=s.viewBox,o=NN(s,xge),c=this.props,u=c.viewBox,m=NN(c,gge);return!zd(i,u)||!zd(o,m)||!zd(a,this.state)}},{key:"componentDidMount",value:function(){var s=this.layerReference;if(s){var a=s.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(s){var a=this.props,i=a.x,o=a.y,c=a.width,u=a.height,m=a.orientation,h=a.tickSize,f=a.mirror,x=a.tickMargin,j,b,g,y,C,k,N=f?-1:1,P=s.tickSize||h,w=it(s.tickCoord)?s.tickCoord:s.coordinate;switch(m){case"top":j=b=s.coordinate,y=o+ +!f*u,g=y-N*P,k=g-N*x,C=w;break;case"left":g=y=s.coordinate,b=i+ +!f*c,j=b-N*P,C=j-N*x,k=w;break;case"right":g=y=s.coordinate,b=i+ +f*c,j=b+N*P,C=j+N*x,k=w;break;default:j=b=s.coordinate,y=o+ +f*u,g=y+N*P,k=g+N*x,C=w;break}return{line:{x1:j,y1:g,x2:b,y2:y},tick:{x:C,y:k}}}},{key:"getTickTextAnchor",value:function(){var s=this.props,a=s.orientation,i=s.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var s=this.props,a=s.orientation,i=s.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,c=s.height,u=s.orientation,m=s.mirror,h=s.axisLine,f=Or(Or(Or({},Wt(this.props,!1)),Wt(h,!1)),{},{fill:"none"});if(u==="top"||u==="bottom"){var x=+(u==="top"&&!m||u==="bottom"&&m);f=Or(Or({},f),{},{x1:a,y1:i+x*c,x2:a+o,y2:i+x*c})}else{var j=+(u==="left"&&!m||u==="right"&&m);f=Or(Or({},f),{},{x1:a+j*o,y1:i,x2:a+j*o,y2:i+c})}return le.createElement("line",Od({},f,{className:rn("recharts-cartesian-axis-line",ya(h,"className"))}))}},{key:"renderTicks",value:function(s,a,i){var o=this,c=this.props,u=c.tickLine,m=c.stroke,h=c.tick,f=c.tickFormatter,x=c.unit,j=Gk(Or(Or({},this.props),{},{ticks:s}),a,i),b=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=Wt(this.props,!1),C=Wt(h,!1),k=Or(Or({},y),{},{fill:"none"},Wt(u,!1)),N=j.map(function(P,w){var S=o.getTickLineCoord(P),E=S.line,R=S.tick,T=Or(Or(Or(Or({textAnchor:b,verticalAnchor:g},y),{},{stroke:"none",fill:m},C),R),{},{index:w,payload:P,visibleTicksCount:j.length,tickFormatter:f});return le.createElement(An,Od({className:"recharts-cartesian-axis-tick",key:"tick-".concat(P.value,"-").concat(P.coordinate,"-").concat(P.tickCoord)},Ac(o.props,P,w)),u&&le.createElement("line",Od({},k,E,{className:rn("recharts-cartesian-axis-tick-line",ya(u,"className"))})),h&&n.renderTickItem(h,T,"".concat(Yt(f)?f(P.value,w):P.value).concat(x||"")))});return le.createElement("g",{className:"recharts-cartesian-axis-ticks"},N)}},{key:"render",value:function(){var s=this,a=this.props,i=a.axisLine,o=a.width,c=a.height,u=a.ticksGenerator,m=a.className,h=a.hide;if(h)return null;var f=this.props,x=f.ticks,j=NN(f,vge),b=x;return Yt(u)&&(b=x&&x.length>0?u(this.props):u(j)),o<=0||c<=0||!b||!b.length?null:le.createElement(An,{className:rn("recharts-cartesian-axis",m),ref:function(y){s.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(b,this.state.fontSize,this.state.letterSpacing),Vr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(s,a,i){var o,c=rn(a.className,"recharts-cartesian-axis-tick-value");return le.isValidElement(s)?o=le.cloneElement(s,Or(Or({},a),{},{className:c})):Yt(s)?o=s(Or(Or({},a),{},{className:c})):o=le.createElement(Ec,Od({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])})(v.Component);Yk(Hu,"displayName","CartesianAxis");Yk(Hu,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var kge=["x1","y1","x2","y2","key"],Pge=["offset"];function Mc(t){"@babel/helpers - typeof";return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Mc(t)}function J$(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function ms(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?J$(Object(r),!0).forEach(function(s){Age(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Age(t,n,r){return n=Ege(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Ege(t){var n=Oge(t,"string");return Mc(n)=="symbol"?n:n+""}function Oge(t,n){if(Mc(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Mc(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function uc(){return uc=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},uc.apply(this,arguments)}function eF(t,n){if(t==null)return{};var r=Tge(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Tge(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}var Mge=function(n){var r=n.fill;if(!r||r==="none")return null;var s=n.fillOpacity,a=n.x,i=n.y,o=n.width,c=n.height,u=n.ry;return le.createElement("rect",{x:a,y:i,ry:u,width:o,height:c,stroke:"none",fill:r,fillOpacity:s,className:"recharts-cartesian-grid-bg"})};function $8(t,n){var r;if(le.isValidElement(t))r=le.cloneElement(t,n);else if(Yt(t))r=t(n);else{var s=n.x1,a=n.y1,i=n.x2,o=n.y2,c=n.key,u=eF(n,kge),m=Wt(u,!1);m.offset;var h=eF(m,Pge);r=le.createElement("line",uc({},h,{x1:s,y1:a,x2:i,y2:o,fill:"none",key:c}))}return r}function Rge(t){var n=t.x,r=t.width,s=t.horizontal,a=s===void 0?!0:s,i=t.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(c,u){var m=ms(ms({},t),{},{x1:n,y1:c,x2:n+r,y2:c,key:"line-".concat(u),index:u});return $8(a,m)});return le.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function Dge(t){var n=t.y,r=t.height,s=t.vertical,a=s===void 0?!0:s,i=t.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(c,u){var m=ms(ms({},t),{},{x1:c,y1:n,x2:c,y2:n+r,key:"line-".concat(u),index:u});return $8(a,m)});return le.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function $ge(t){var n=t.horizontalFill,r=t.fillOpacity,s=t.x,a=t.y,i=t.width,o=t.height,c=t.horizontalPoints,u=t.horizontal,m=u===void 0?!0:u;if(!m||!n||!n.length)return null;var h=c.map(function(x){return Math.round(x+a-a)}).sort(function(x,j){return x-j});a!==h[0]&&h.unshift(0);var f=h.map(function(x,j){var b=!h[j+1],g=b?a+o-x:h[j+1]-x;if(g<=0)return null;var y=j%n.length;return le.createElement("rect",{key:"react-".concat(j),y:x,x:s,height:g,width:i,stroke:"none",fill:n[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return le.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function Fge(t){var n=t.vertical,r=n===void 0?!0:n,s=t.verticalFill,a=t.fillOpacity,i=t.x,o=t.y,c=t.width,u=t.height,m=t.verticalPoints;if(!r||!s||!s.length)return null;var h=m.map(function(x){return Math.round(x+i-i)}).sort(function(x,j){return x-j});i!==h[0]&&h.unshift(0);var f=h.map(function(x,j){var b=!h[j+1],g=b?i+c-x:h[j+1]-x;if(g<=0)return null;var y=j%s.length;return le.createElement("rect",{key:"react-".concat(j),x,y:o,width:g,height:u,stroke:"none",fill:s[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return le.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var Lge=function(n,r){var s=n.xAxis,a=n.width,i=n.height,o=n.offset;return Fz(Gk(ms(ms(ms({},Hu.defaultProps),s),{},{ticks:mo(s,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},Ige=function(n,r){var s=n.yAxis,a=n.width,i=n.height,o=n.offset;return Fz(Gk(ms(ms(ms({},Hu.defaultProps),s),{},{ticks:mo(s,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},bd={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function F8(t){var n,r,s,a,i,o,c=Uk(),u=Kk(),m=Cxe(),h=ms(ms({},t),{},{stroke:(n=t.stroke)!==null&&n!==void 0?n:bd.stroke,fill:(r=t.fill)!==null&&r!==void 0?r:bd.fill,horizontal:(s=t.horizontal)!==null&&s!==void 0?s:bd.horizontal,horizontalFill:(a=t.horizontalFill)!==null&&a!==void 0?a:bd.horizontalFill,vertical:(i=t.vertical)!==null&&i!==void 0?i:bd.vertical,verticalFill:(o=t.verticalFill)!==null&&o!==void 0?o:bd.verticalFill,x:it(t.x)?t.x:m.left,y:it(t.y)?t.y:m.top,width:it(t.width)?t.width:m.width,height:it(t.height)?t.height:m.height}),f=h.x,x=h.y,j=h.width,b=h.height,g=h.syncWithTicks,y=h.horizontalValues,C=h.verticalValues,k=_xe(),N=Nxe();if(!it(j)||j<=0||!it(b)||b<=0||!it(f)||f!==+f||!it(x)||x!==+x)return null;var P=h.verticalCoordinatesGenerator||Lge,w=h.horizontalCoordinatesGenerator||Ige,S=h.horizontalPoints,E=h.verticalPoints;if((!S||!S.length)&&Yt(w)){var R=y&&y.length,T=w({yAxis:N?ms(ms({},N),{},{ticks:R?y:N.ticks}):void 0,width:c,height:u,offset:m},R?!0:g);fi(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Mc(T),"]")),Array.isArray(T)&&(S=T)}if((!E||!E.length)&&Yt(P)){var U=C&&C.length,M=P({xAxis:k?ms(ms({},k),{},{ticks:U?C:k.ticks}):void 0,width:c,height:u,offset:m},U?!0:g);fi(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Mc(M),"]")),Array.isArray(M)&&(E=M)}return le.createElement("g",{className:"recharts-cartesian-grid"},le.createElement(Mge,{fill:h.fill,fillOpacity:h.fillOpacity,x:h.x,y:h.y,width:h.width,height:h.height,ry:h.ry}),le.createElement(Rge,uc({},h,{offset:m,horizontalPoints:S,xAxis:k,yAxis:N})),le.createElement(Dge,uc({},h,{offset:m,verticalPoints:E,xAxis:k,yAxis:N})),le.createElement($ge,uc({},h,{horizontalPoints:S})),le.createElement(Fge,uc({},h,{verticalPoints:E})))}F8.displayName="CartesianGrid";function Su(t){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Su(t)}function qge(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Bge(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,q8(s.key),s)}}function zge(t,n,r){return n&&Bge(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vge(t,n,r){return n=Bg(n),Uge(t,L8()?Reflect.construct(n,r||[],Bg(t).constructor):n.apply(t,r))}function Uge(t,n){if(n&&(Su(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kge(t)}function Kge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L8=function(){return!!t})()}function Bg(t){return Bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bg(t)}function Wge(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&RS(t,n)}function RS(t,n){return RS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},RS(t,n)}function I8(t,n,r){return n=q8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function q8(t){var n=Hge(t,"string");return Su(n)=="symbol"?n:n+""}function Hge(t,n){if(Su(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Su(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function DS(){return DS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},DS.apply(this,arguments)}function Gge(t){var n=t.xAxisId,r=Uk(),s=Kk(),a=S8(n);return a==null?null:v.createElement(Hu,DS({},a,{className:rn("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:s},ticksGenerator:function(o){return mo(o,!0)}}))}var my=(function(t){function n(){return qge(this,n),Vge(this,n,arguments)}return Wge(n,t),zge(n,[{key:"render",value:function(){return v.createElement(Gge,this.props)}}])})(v.Component);I8(my,"displayName","XAxis");I8(my,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Cu(t){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Cu(t)}function Yge(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Qge(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,V8(s.key),s)}}function Xge(t,n,r){return n&&Qge(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zge(t,n,r){return n=zg(n),Jge(t,B8()?Reflect.construct(n,r||[],zg(t).constructor):n.apply(t,r))}function Jge(t,n){if(n&&(Cu(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eve(t)}function eve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(B8=function(){return!!t})()}function zg(t){return zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zg(t)}function tve(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&$S(t,n)}function $S(t,n){return $S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},$S(t,n)}function z8(t,n,r){return n=V8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function V8(t){var n=nve(t,"string");return Cu(n)=="symbol"?n:n+""}function nve(t,n){if(Cu(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(Cu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function FS(){return FS=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},FS.apply(this,arguments)}var rve=function(n){var r=n.yAxisId,s=Uk(),a=Kk(),i=C8(r);return i==null?null:v.createElement(Hu,FS({},i,{className:rn("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:s,height:a},ticksGenerator:function(c){return mo(c,!0)}}))},hy=(function(t){function n(){return Yge(this,n),Zge(this,n,arguments)}return tve(n,t),Xge(n,[{key:"render",value:function(){return v.createElement(rve,this.props)}}])})(v.Component);z8(hy,"displayName","YAxis");z8(hy,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function tF(t){return ove(t)||ive(t)||ave(t)||sve()}function sve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ave(t,n){if(t){if(typeof t=="string")return LS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LS(t,n)}}function ive(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ove(t){if(Array.isArray(t))return LS(t)}function LS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}var IS=function(n,r,s,a,i){var o=qa(n,Hk),c=qa(n,cy),u=[].concat(tF(o),tF(c)),m=qa(n,uy),h="".concat(a,"Id"),f=a[0],x=r;if(u.length&&(x=u.reduce(function(g,y){if(y.props[h]===s&&Li(y.props,"extendDomain")&&it(y.props[f])){var C=y.props[f];return[Math.min(g[0],C),Math.max(g[1],C)]}return g},x)),m.length){var j="".concat(f,"1"),b="".concat(f,"2");x=m.reduce(function(g,y){if(y.props[h]===s&&Li(y.props,"extendDomain")&&it(y.props[j])&&it(y.props[b])){var C=y.props[j],k=y.props[b];return[Math.min(g[0],C,k),Math.max(g[1],C,k)]}return g},x)}return i&&i.length&&(x=i.reduce(function(g,y){return it(y)?[Math.min(g[0],y),Math.max(g[1],y)]:g},x)),x},SN={exports:{}},nF;function lve(){return nF||(nF=1,(function(t){var n=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function a(u,m,h){this.fn=u,this.context=m,this.once=h||!1}function i(u,m,h,f,x){if(typeof h!="function")throw new TypeError("The listener must be a function");var j=new a(h,f||u,x),b=r?r+m:m;return u._events[b]?u._events[b].fn?u._events[b]=[u._events[b],j]:u._events[b].push(j):(u._events[b]=j,u._eventsCount++),u}function o(u,m){--u._eventsCount===0?u._events=new s:delete u._events[m]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var m=[],h,f;if(this._eventsCount===0)return m;for(f in h=this._events)n.call(h,f)&&m.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(h)):m},c.prototype.listeners=function(m){var h=r?r+m:m,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var x=0,j=f.length,b=new Array(j);x<j;x++)b[x]=f[x].fn;return b},c.prototype.listenerCount=function(m){var h=r?r+m:m,f=this._events[h];return f?f.fn?1:f.length:0},c.prototype.emit=function(m,h,f,x,j,b){var g=r?r+m:m;if(!this._events[g])return!1;var y=this._events[g],C=arguments.length,k,N;if(y.fn){switch(y.once&&this.removeListener(m,y.fn,void 0,!0),C){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,h),!0;case 3:return y.fn.call(y.context,h,f),!0;case 4:return y.fn.call(y.context,h,f,x),!0;case 5:return y.fn.call(y.context,h,f,x,j),!0;case 6:return y.fn.call(y.context,h,f,x,j,b),!0}for(N=1,k=new Array(C-1);N<C;N++)k[N-1]=arguments[N];y.fn.apply(y.context,k)}else{var P=y.length,w;for(N=0;N<P;N++)switch(y[N].once&&this.removeListener(m,y[N].fn,void 0,!0),C){case 1:y[N].fn.call(y[N].context);break;case 2:y[N].fn.call(y[N].context,h);break;case 3:y[N].fn.call(y[N].context,h,f);break;case 4:y[N].fn.call(y[N].context,h,f,x);break;default:if(!k)for(w=1,k=new Array(C-1);w<C;w++)k[w-1]=arguments[w];y[N].fn.apply(y[N].context,k)}}return!0},c.prototype.on=function(m,h,f){return i(this,m,h,f,!1)},c.prototype.once=function(m,h,f){return i(this,m,h,f,!0)},c.prototype.removeListener=function(m,h,f,x){var j=r?r+m:m;if(!this._events[j])return this;if(!h)return o(this,j),this;var b=this._events[j];if(b.fn)b.fn===h&&(!x||b.once)&&(!f||b.context===f)&&o(this,j);else{for(var g=0,y=[],C=b.length;g<C;g++)(b[g].fn!==h||x&&!b[g].once||f&&b[g].context!==f)&&y.push(b[g]);y.length?this._events[j]=y.length===1?y[0]:y:o(this,j)}return this},c.prototype.removeAllListeners=function(m){var h;return m?(h=r?r+m:m,this._events[h]&&o(this,h)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t.exports=c})(SN)),SN.exports}var cve=lve();const dve=kn(cve);var CN=new dve,kN="recharts.syncMouseEvents";function mf(t){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},mf(t)}function uve(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function mve(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,U8(s.key),s)}}function hve(t,n,r){return n&&mve(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function PN(t,n,r){return n=U8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function U8(t){var n=fve(t,"string");return mf(n)=="symbol"?n:n+""}function fve(t,n){if(mf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(mf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var pve=(function(){function t(){uve(this,t),PN(this,"activeIndex",0),PN(this,"coordinateList",[]),PN(this,"layout","horizontal")}return hve(t,[{key:"setDetails",value:function(r){var s,a=r.coordinateList,i=a===void 0?null:a,o=r.container,c=o===void 0?null:o,u=r.layout,m=u===void 0?null:u,h=r.offset,f=h===void 0?null:h,x=r.mouseHandlerCallback,j=x===void 0?null:x;this.coordinateList=(s=i??this.coordinateList)!==null&&s!==void 0?s:[],this.container=c??this.container,this.layout=m??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=j??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,s;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,c=a.height,u=this.coordinateList[this.activeIndex].coordinate,m=((r=window)===null||r===void 0?void 0:r.scrollX)||0,h=((s=window)===null||s===void 0?void 0:s.scrollY)||0,f=i+u+m,x=o+this.offset.top+c/2+h;this.mouseHandlerCallback({pageX:f,pageY:x})}}}])})();function xve(t,n,r){if(r==="number"&&n===!0&&Array.isArray(t)){var s=t?.[0],a=t?.[1];if(s&&a&&it(s)&&it(a))return!0}return!1}function gve(t,n,r,s){var a=s/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?n.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:n.y-a,width:t==="horizontal"?s:r.width-1,height:t==="horizontal"?r.height-1:s}}function K8(t){var n=t.cx,r=t.cy,s=t.radius,a=t.startAngle,i=t.endAngle,o=Un(n,r,s,a),c=Un(n,r,s,i);return{points:[o,c],cx:n,cy:r,radius:s,startAngle:a,endAngle:i}}function vve(t,n,r){var s,a,i,o;if(t==="horizontal")s=n.x,i=s,a=r.top,o=r.top+r.height;else if(t==="vertical")a=n.y,o=a,s=r.left,i=r.left+r.width;else if(n.cx!=null&&n.cy!=null)if(t==="centric"){var c=n.cx,u=n.cy,m=n.innerRadius,h=n.outerRadius,f=n.angle,x=Un(c,u,m,f),j=Un(c,u,h,f);s=x.x,a=x.y,i=j.x,o=j.y}else return K8(n);return[{x:s,y:a},{x:i,y:o}]}function hf(t){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},hf(t)}function rF(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function ux(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?rF(Object(r),!0).forEach(function(s){yve(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rF(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function yve(t,n,r){return n=jve(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function jve(t){var n=bve(t,"string");return hf(n)=="symbol"?n:n+""}function bve(t,n){if(hf(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(hf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function wve(t){var n,r,s=t.element,a=t.tooltipEventType,i=t.isActive,o=t.activeCoordinate,c=t.activePayload,u=t.offset,m=t.activeTooltipIndex,h=t.tooltipAxisBandSize,f=t.layout,x=t.chartName,j=(n=s.props.cursor)!==null&&n!==void 0?n:(r=s.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!s||!j||!i||!o||x!=="ScatterChart"&&a!=="axis")return null;var b,g=lS;if(x==="ScatterChart")b=o,g=rfe;else if(x==="BarChart")b=gve(f,o,u,h),g=Ik;else if(f==="radial"){var y=K8(o),C=y.cx,k=y.cy,N=y.radius,P=y.startAngle,w=y.endAngle;b={cx:C,cy:k,startAngle:P,endAngle:w,innerRadius:N,outerRadius:N},g=Gz}else b={points:vve(f,o,u)},g=lS;var S=ux(ux(ux(ux({stroke:"#ccc",pointerEvents:"none"},u),b),Wt(j,!1)),{},{payload:c,payloadIndex:m,className:rn("recharts-tooltip-cursor",j.className)});return v.isValidElement(j)?v.cloneElement(j,S):v.createElement(g,S)}var _ve=["item"],Nve=["children","className","width","height","style","compact","title","desc"];function ku(t){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ku(t)}function Td(){return Td=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Td.apply(this,arguments)}function sF(t,n){return kve(t)||Cve(t,n)||H8(t,n)||Sve()}function Sve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cve(t,n){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s,a,i,o,c=[],u=!0,m=!1;try{if(i=(r=r.call(t)).next,n!==0)for(;!(u=(s=i.call(r)).done)&&(c.push(s.value),c.length!==n);u=!0);}catch(h){m=!0,a=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(m)throw a}}return c}}function kve(t){if(Array.isArray(t))return t}function aF(t,n){if(t==null)return{};var r=Pve(t,n),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)s=i[a],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}function Pve(t,n){if(t==null)return{};var r={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(n.indexOf(s)>=0)continue;r[s]=t[s]}return r}function Ave(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Eve(t,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,G8(s.key),s)}}function Ove(t,n,r){return n&&Eve(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tve(t,n,r){return n=Vg(n),Mve(t,W8()?Reflect.construct(n,r||[],Vg(t).constructor):n.apply(t,r))}function Mve(t,n){if(n&&(ku(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rve(t)}function Rve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function W8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W8=function(){return!!t})()}function Vg(t){return Vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vg(t)}function Dve(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&qS(t,n)}function qS(t,n){return qS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},qS(t,n)}function Pu(t){return Lve(t)||Fve(t)||H8(t)||$ve()}function $ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H8(t,n){if(t){if(typeof t=="string")return BS(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BS(t,n)}}function Fve(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Lve(t){if(Array.isArray(t))return BS(t)}function BS(t,n){(n==null||n>t.length)&&(n=t.length);for(var r=0,s=new Array(n);r<n;r++)s[r]=t[r];return s}function iF(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,s)}return r}function Ve(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?iF(Object(r),!0).forEach(function(s){zt(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iF(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function zt(t,n,r){return n=G8(n),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function G8(t){var n=Ive(t,"string");return ku(n)=="symbol"?n:n+""}function Ive(t,n){if(ku(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(ku(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}var qve={xAxis:["bottom","top"],yAxis:["left","right"]},Bve={width:"100%",height:"100%"},Y8={x:0,y:0};function mx(t){return t}var zve=function(n,r){return r==="horizontal"?n.x:r==="vertical"?n.y:r==="centric"?n.angle:n.radius},Vve=function(n,r,s,a){var i=r.find(function(h){return h&&h.index===s});if(i){if(n==="horizontal")return{x:i.coordinate,y:a.y};if(n==="vertical")return{x:a.x,y:i.coordinate};if(n==="centric"){var o=i.coordinate,c=a.radius;return Ve(Ve(Ve({},a),Un(a.cx,a.cy,c,o)),{},{angle:o,radius:c})}var u=i.coordinate,m=a.angle;return Ve(Ve(Ve({},a),Un(a.cx,a.cy,u,m)),{},{angle:m,radius:u})}return Y8},fy=function(n,r){var s=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(s??[]).reduce(function(c,u){var m=u.props.data;return m&&m.length?[].concat(Pu(c),Pu(m)):c},[]);return o.length>0?o:n&&n.length&&it(a)&&it(i)?n.slice(a,i+1):[]};function Q8(t){return t==="number"?[0,"auto"]:void 0}var zS=function(n,r,s,a){var i=n.graphicalItems,o=n.tooltipAxis,c=fy(r,n);return s<0||!i||!i.length||s>=c.length?null:i.reduce(function(u,m){var h,f=(h=m.props.data)!==null&&h!==void 0?h:r;f&&n.dataStartIndex+n.dataEndIndex!==0&&n.dataEndIndex-n.dataStartIndex>=s&&(f=f.slice(n.dataStartIndex,n.dataEndIndex+1));var x;if(o.dataKey&&!o.allowDuplicatedCategory){var j=f===void 0?c:f;x=_1(j,o.dataKey,a)}else x=f&&f[s]||c[s];return x?[].concat(Pu(u),[zz(m,x)]):u},[])},oF=function(n,r,s,a){var i=a||{x:n.chartX,y:n.chartY},o=zve(i,s),c=n.orderedTooltipTicks,u=n.tooltipAxis,m=n.tooltipTicks,h=Pde(o,c,m,u);if(h>=0&&m){var f=m[h]&&m[h].value,x=zS(n,r,h,f),j=Vve(s,c,h,i);return{activeTooltipIndex:h,activeLabel:f,activePayload:x,activeCoordinate:j}}return null},Uve=function(n,r){var s=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,c=r.stackGroups,u=r.dataStartIndex,m=r.dataEndIndex,h=n.layout,f=n.children,x=n.stackOffset,j=$z(h,i);return s.reduce(function(b,g){var y,C=g.type.defaultProps!==void 0?Ve(Ve({},g.type.defaultProps),g.props):g.props,k=C.type,N=C.dataKey,P=C.allowDataOverflow,w=C.allowDuplicatedCategory,S=C.scale,E=C.ticks,R=C.includeHidden,T=C[o];if(b[T])return b;var U=fy(n.data,{graphicalItems:a.filter(function(H){var fe,Pe=o in H.props?H.props[o]:(fe=H.type.defaultProps)===null||fe===void 0?void 0:fe[o];return Pe===T}),dataStartIndex:u,dataEndIndex:m}),M=U.length,L,q,$;xve(C.domain,P,k)&&(L=rS(C.domain,null,P),j&&(k==="number"||S!=="auto")&&($=ah(U,N,"category")));var D=Q8(k);if(!L||L.length===0){var z,J=(z=C.domain)!==null&&z!==void 0?z:D;if(N){if(L=ah(U,N,k),k==="category"&&j){var I=wne(L);w&&I?(q=L,L=Og(0,M)):w||(L=cD(J,L,g).reduce(function(H,fe){return H.indexOf(fe)>=0?H:[].concat(Pu(H),[fe])},[]))}else if(k==="category")w?L=L.filter(function(H){return H!==""&&!hn(H)}):L=cD(J,L,g).reduce(function(H,fe){return H.indexOf(fe)>=0||fe===""||hn(fe)?H:[].concat(Pu(H),[fe])},[]);else if(k==="number"){var X=Mde(U,a.filter(function(H){var fe,Pe,Re=o in H.props?H.props[o]:(fe=H.type.defaultProps)===null||fe===void 0?void 0:fe[o],Ie="hide"in H.props?H.props.hide:(Pe=H.type.defaultProps)===null||Pe===void 0?void 0:Pe.hide;return Re===T&&(R||!Ie)}),N,i,h);X&&(L=X)}j&&(k==="number"||S!=="auto")&&($=ah(U,N,"category"))}else j?L=Og(0,M):c&&c[T]&&c[T].hasStack&&k==="number"?L=x==="expand"?[0,1]:Bz(c[T].stackGroups,u,m):L=Dz(U,a.filter(function(H){var fe=o in H.props?H.props[o]:H.type.defaultProps[o],Pe="hide"in H.props?H.props.hide:H.type.defaultProps.hide;return fe===T&&(R||!Pe)}),k,h,!0);if(k==="number")L=IS(f,L,T,i,E),J&&(L=rS(J,L,P));else if(k==="category"&&J){var ne=J,W=L.every(function(H){return ne.indexOf(H)>=0});W&&(L=ne)}}return Ve(Ve({},b),{},zt({},T,Ve(Ve({},C),{},{axisType:i,domain:L,categoricalDomain:$,duplicateDomain:q,originalDomain:(y=C.domain)!==null&&y!==void 0?y:D,isCategorical:j,layout:h})))},{})},Kve=function(n,r){var s=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,c=r.stackGroups,u=r.dataStartIndex,m=r.dataEndIndex,h=n.layout,f=n.children,x=fy(n.data,{graphicalItems:s,dataStartIndex:u,dataEndIndex:m}),j=x.length,b=$z(h,i),g=-1;return s.reduce(function(y,C){var k=C.type.defaultProps!==void 0?Ve(Ve({},C.type.defaultProps),C.props):C.props,N=k[o],P=Q8("number");if(!y[N]){g++;var w;return b?w=Og(0,j):c&&c[N]&&c[N].hasStack?(w=Bz(c[N].stackGroups,u,m),w=IS(f,w,N,i)):(w=rS(P,Dz(x,s.filter(function(S){var E,R,T=o in S.props?S.props[o]:(E=S.type.defaultProps)===null||E===void 0?void 0:E[o],U="hide"in S.props?S.props.hide:(R=S.type.defaultProps)===null||R===void 0?void 0:R.hide;return T===N&&!U}),"number",h),a.defaultProps.allowDataOverflow),w=IS(f,w,N,i)),Ve(Ve({},y),{},zt({},N,Ve(Ve({axisType:i},a.defaultProps),{},{hide:!0,orientation:ya(qve,"".concat(i,".").concat(g%2),null),domain:w,originalDomain:P,isCategorical:b,layout:h})))}return y},{})},Wve=function(n,r){var s=r.axisType,a=s===void 0?"xAxis":s,i=r.AxisComp,o=r.graphicalItems,c=r.stackGroups,u=r.dataStartIndex,m=r.dataEndIndex,h=n.children,f="".concat(a,"Id"),x=qa(h,i),j={};return x&&x.length?j=Uve(n,{axes:x,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:c,dataStartIndex:u,dataEndIndex:m}):o&&o.length&&(j=Kve(n,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:c,dataStartIndex:u,dataEndIndex:m})),j},Hve=function(n){var r=ul(n),s=mo(r,!1,!0);return{tooltipTicks:s,orderedTooltipTicks:mk(s,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:yg(r,s)}},lF=function(n){var r=n.children,s=n.defaultShowTooltip,a=ma(r,yu),i=0,o=0;return n.data&&n.data.length!==0&&(o=n.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!s}},Gve=function(n){return!n||!n.length?!1:n.some(function(r){var s=fo(r&&r.type);return s&&s.indexOf("Bar")>=0})},cF=function(n){return n==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:n==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:n==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Yve=function(n,r){var s=n.props,a=n.graphicalItems,i=n.xAxisMap,o=i===void 0?{}:i,c=n.yAxisMap,u=c===void 0?{}:c,m=s.width,h=s.height,f=s.children,x=s.margin||{},j=ma(f,yu),b=ma(f,pc),g=Object.keys(u).reduce(function(w,S){var E=u[S],R=E.orientation;return!E.mirror&&!E.hide?Ve(Ve({},w),{},zt({},R,w[R]+E.width)):w},{left:x.left||0,right:x.right||0}),y=Object.keys(o).reduce(function(w,S){var E=o[S],R=E.orientation;return!E.mirror&&!E.hide?Ve(Ve({},w),{},zt({},R,ya(w,"".concat(R))+E.height)):w},{top:x.top||0,bottom:x.bottom||0}),C=Ve(Ve({},y),g),k=C.bottom;j&&(C.bottom+=j.props.height||yu.defaultProps.height),b&&r&&(C=Ode(C,a,s,r));var N=m-C.left-C.right,P=h-C.top-C.bottom;return Ve(Ve({brushBottom:k},C),{},{width:Math.max(N,0),height:Math.max(P,0)})},Qve=function(n,r){if(r==="xAxis")return n[r].width;if(r==="yAxis")return n[r].height},X8=function(n){var r=n.chartName,s=n.GraphicalChild,a=n.defaultTooltipEventType,i=a===void 0?"axis":a,o=n.validateTooltipEventTypes,c=o===void 0?["axis"]:o,u=n.axisComponents,m=n.legendContent,h=n.formatAxisMap,f=n.defaultProps,x=function(C,k){var N=k.graphicalItems,P=k.stackGroups,w=k.offset,S=k.updateId,E=k.dataStartIndex,R=k.dataEndIndex,T=C.barSize,U=C.layout,M=C.barGap,L=C.barCategoryGap,q=C.maxBarSize,$=cF(U),D=$.numericAxisName,z=$.cateAxisName,J=Gve(N),I=[];return N.forEach(function(X,ne){var W=fy(C.data,{graphicalItems:[X],dataStartIndex:E,dataEndIndex:R}),H=X.type.defaultProps!==void 0?Ve(Ve({},X.type.defaultProps),X.props):X.props,fe=H.dataKey,Pe=H.maxBarSize,Re=H["".concat(D,"Id")],Ie=H["".concat(z,"Id")],Ce={},Y=u.reduce(function(Ue,Z){var xe=k["".concat(Z.axisType,"Map")],Ae=H["".concat(Z.axisType,"Id")];xe&&xe[Ae]||Z.axisType==="zAxis"||Tc();var Je=xe[Ae];return Ve(Ve({},Ue),{},zt(zt({},Z.axisType,Je),"".concat(Z.axisType,"Ticks"),mo(Je)))},Ce),ie=Y[z],Ee=Y["".concat(z,"Ticks")],Ke=P&&P[Re]&&P[Re].hasStack&&zde(X,P[Re].stackGroups),Te=fo(X.type).indexOf("Bar")>=0,ct=yg(ie,Ee),ut=[],Dt=J&&Ade({barSize:T,stackGroups:P,totalSize:Qve(Y,z)});if(Te){var be,pt,te=hn(Pe)?q:Pe,G=(be=(pt=yg(ie,Ee,!0))!==null&&pt!==void 0?pt:te)!==null&&be!==void 0?be:0;ut=Ede({barGap:M,barCategoryGap:L,bandSize:G!==ct?G:ct,sizeList:Dt[Ie],maxBarSize:te}),G!==ct&&(ut=ut.map(function(Ue){return Ve(Ve({},Ue),{},{position:Ve(Ve({},Ue.position),{},{offset:Ue.position.offset-G/2})})}))}var F=X&&X.type&&X.type.getComposedData;F&&I.push({props:Ve(Ve({},F(Ve(Ve({},Y),{},{displayedData:W,props:C,dataKey:fe,item:X,bandSize:ct,barPosition:ut,offset:w,stackedData:Ke,layout:U,dataStartIndex:E,dataEndIndex:R}))),{},zt(zt(zt({key:X.key||"item-".concat(ne)},D,Y[D]),z,Y[z]),"animationId",S)),childIndex:Rne(X,C.children),item:X})}),I},j=function(C,k){var N=C.props,P=C.dataStartIndex,w=C.dataEndIndex,S=C.updateId;if(!_T({props:N}))return null;var E=N.children,R=N.layout,T=N.stackOffset,U=N.data,M=N.reverseStackOrder,L=cF(R),q=L.numericAxisName,$=L.cateAxisName,D=qa(E,s),z=qde(U,D,"".concat(q,"Id"),"".concat($,"Id"),T,M),J=u.reduce(function(H,fe){var Pe="".concat(fe.axisType,"Map");return Ve(Ve({},H),{},zt({},Pe,Wve(N,Ve(Ve({},fe),{},{graphicalItems:D,stackGroups:fe.axisType===q&&z,dataStartIndex:P,dataEndIndex:w}))))},{}),I=Yve(Ve(Ve({},J),{},{props:N,graphicalItems:D}),k?.legendBBox);Object.keys(J).forEach(function(H){J[H]=h(N,J[H],I,H.replace("Map",""),r)});var X=J["".concat($,"Map")],ne=Hve(X),W=x(N,Ve(Ve({},J),{},{dataStartIndex:P,dataEndIndex:w,updateId:S,graphicalItems:D,stackGroups:z,offset:I}));return Ve(Ve({formattedGraphicalItems:W,graphicalItems:D,offset:I,stackGroups:z},ne),J)},b=(function(y){function C(k){var N,P,w;return Ave(this,C),w=Tve(this,C,[k]),zt(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),zt(w,"accessibilityManager",new pve),zt(w,"handleLegendBBoxUpdate",function(S){if(S){var E=w.state,R=E.dataStartIndex,T=E.dataEndIndex,U=E.updateId;w.setState(Ve({legendBBox:S},j({props:w.props,dataStartIndex:R,dataEndIndex:T,updateId:U},Ve(Ve({},w.state),{},{legendBBox:S}))))}}),zt(w,"handleReceiveSyncEvent",function(S,E,R){if(w.props.syncId===S){if(R===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(E)}}),zt(w,"handleBrushChange",function(S){var E=S.startIndex,R=S.endIndex;if(E!==w.state.dataStartIndex||R!==w.state.dataEndIndex){var T=w.state.updateId;w.setState(function(){return Ve({dataStartIndex:E,dataEndIndex:R},j({props:w.props,dataStartIndex:E,dataEndIndex:R,updateId:T},w.state))}),w.triggerSyncEvent({dataStartIndex:E,dataEndIndex:R})}}),zt(w,"handleMouseEnter",function(S){var E=w.getMouseInfo(S);if(E){var R=Ve(Ve({},E),{},{isTooltipActive:!0});w.setState(R),w.triggerSyncEvent(R);var T=w.props.onMouseEnter;Yt(T)&&T(R,S)}}),zt(w,"triggeredAfterMouseMove",function(S){var E=w.getMouseInfo(S),R=E?Ve(Ve({},E),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(R),w.triggerSyncEvent(R);var T=w.props.onMouseMove;Yt(T)&&T(R,S)}),zt(w,"handleItemMouseEnter",function(S){w.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),zt(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),zt(w,"handleMouseMove",function(S){S.persist(),w.throttleTriggeredAfterMouseMove(S)}),zt(w,"handleMouseLeave",function(S){w.throttleTriggeredAfterMouseMove.cancel();var E={isTooltipActive:!1};w.setState(E),w.triggerSyncEvent(E);var R=w.props.onMouseLeave;Yt(R)&&R(E,S)}),zt(w,"handleOuterEvent",function(S){var E=Mne(S),R=ya(w.props,"".concat(E));if(E&&Yt(R)){var T,U;/.*touch.*/i.test(E)?U=w.getMouseInfo(S.changedTouches[0]):U=w.getMouseInfo(S),R((T=U)!==null&&T!==void 0?T:{},S)}}),zt(w,"handleClick",function(S){var E=w.getMouseInfo(S);if(E){var R=Ve(Ve({},E),{},{isTooltipActive:!0});w.setState(R),w.triggerSyncEvent(R);var T=w.props.onClick;Yt(T)&&T(R,S)}}),zt(w,"handleMouseDown",function(S){var E=w.props.onMouseDown;if(Yt(E)){var R=w.getMouseInfo(S);E(R,S)}}),zt(w,"handleMouseUp",function(S){var E=w.props.onMouseUp;if(Yt(E)){var R=w.getMouseInfo(S);E(R,S)}}),zt(w,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),zt(w,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.handleMouseDown(S.changedTouches[0])}),zt(w,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.handleMouseUp(S.changedTouches[0])}),zt(w,"handleDoubleClick",function(S){var E=w.props.onDoubleClick;if(Yt(E)){var R=w.getMouseInfo(S);E(R,S)}}),zt(w,"handleContextMenu",function(S){var E=w.props.onContextMenu;if(Yt(E)){var R=w.getMouseInfo(S);E(R,S)}}),zt(w,"triggerSyncEvent",function(S){w.props.syncId!==void 0&&CN.emit(kN,w.props.syncId,S,w.eventEmitterSymbol)}),zt(w,"applySyncEvent",function(S){var E=w.props,R=E.layout,T=E.syncMethod,U=w.state.updateId,M=S.dataStartIndex,L=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)w.setState(Ve({dataStartIndex:M,dataEndIndex:L},j({props:w.props,dataStartIndex:M,dataEndIndex:L,updateId:U},w.state)));else if(S.activeTooltipIndex!==void 0){var q=S.chartX,$=S.chartY,D=S.activeTooltipIndex,z=w.state,J=z.offset,I=z.tooltipTicks;if(!J)return;if(typeof T=="function")D=T(I,S);else if(T==="value"){D=-1;for(var X=0;X<I.length;X++)if(I[X].value===S.activeLabel){D=X;break}}var ne=Ve(Ve({},J),{},{x:J.left,y:J.top}),W=Math.min(q,ne.x+ne.width),H=Math.min($,ne.y+ne.height),fe=I[D]&&I[D].value,Pe=zS(w.state,w.props.data,D),Re=I[D]?{x:R==="horizontal"?I[D].coordinate:W,y:R==="horizontal"?H:I[D].coordinate}:Y8;w.setState(Ve(Ve({},S),{},{activeLabel:fe,activeCoordinate:Re,activePayload:Pe,activeTooltipIndex:D}))}else w.setState(S)}),zt(w,"renderCursor",function(S){var E,R=w.state,T=R.isTooltipActive,U=R.activeCoordinate,M=R.activePayload,L=R.offset,q=R.activeTooltipIndex,$=R.tooltipAxisBandSize,D=w.getTooltipEventType(),z=(E=S.props.active)!==null&&E!==void 0?E:T,J=w.props.layout,I=S.key||"_recharts-cursor";return le.createElement(wve,{key:I,activeCoordinate:U,activePayload:M,activeTooltipIndex:q,chartName:r,element:S,isActive:z,layout:J,offset:L,tooltipAxisBandSize:$,tooltipEventType:D})}),zt(w,"renderPolarAxis",function(S,E,R){var T=ya(S,"type.axisType"),U=ya(w.state,"".concat(T,"Map")),M=S.type.defaultProps,L=M!==void 0?Ve(Ve({},M),S.props):S.props,q=U&&U[L["".concat(T,"Id")]];return v.cloneElement(S,Ve(Ve({},q),{},{className:rn(T,q.className),key:S.key||"".concat(E,"-").concat(R),ticks:mo(q,!0)}))}),zt(w,"renderPolarGrid",function(S){var E=S.props,R=E.radialLines,T=E.polarAngles,U=E.polarRadius,M=w.state,L=M.radiusAxisMap,q=M.angleAxisMap,$=ul(L),D=ul(q),z=D.cx,J=D.cy,I=D.innerRadius,X=D.outerRadius;return v.cloneElement(S,{polarAngles:Array.isArray(T)?T:mo(D,!0).map(function(ne){return ne.coordinate}),polarRadius:Array.isArray(U)?U:mo($,!0).map(function(ne){return ne.coordinate}),cx:z,cy:J,innerRadius:I,outerRadius:X,key:S.key||"polar-grid",radialLines:R})}),zt(w,"renderLegend",function(){var S=w.state.formattedGraphicalItems,E=w.props,R=E.children,T=E.width,U=E.height,M=w.props.margin||{},L=T-(M.left||0)-(M.right||0),q=Mz({children:R,formattedGraphicalItems:S,legendWidth:L,legendContent:m});if(!q)return null;var $=q.item,D=aF(q,_ve);return v.cloneElement($,Ve(Ve({},D),{},{chartWidth:T,chartHeight:U,margin:M,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),zt(w,"renderTooltip",function(){var S,E=w.props,R=E.children,T=E.accessibilityLayer,U=ma(R,ri);if(!U)return null;var M=w.state,L=M.isTooltipActive,q=M.activeCoordinate,$=M.activePayload,D=M.activeLabel,z=M.offset,J=(S=U.props.active)!==null&&S!==void 0?S:L;return v.cloneElement(U,{viewBox:Ve(Ve({},z),{},{x:z.left,y:z.top}),active:J,label:D,payload:J?$:[],coordinate:q,accessibilityLayer:T})}),zt(w,"renderBrush",function(S){var E=w.props,R=E.margin,T=E.data,U=w.state,M=U.offset,L=U.dataStartIndex,q=U.dataEndIndex,$=U.updateId;return v.cloneElement(S,{key:S.key||"_recharts-brush",onChange:ox(w.handleBrushChange,S.props.onChange),data:T,x:it(S.props.x)?S.props.x:M.left,y:it(S.props.y)?S.props.y:M.top+M.height+M.brushBottom-(R.bottom||0),width:it(S.props.width)?S.props.width:M.width,startIndex:L,endIndex:q,updateId:"brush-".concat($)})}),zt(w,"renderReferenceElement",function(S,E,R){if(!S)return null;var T=w,U=T.clipPathId,M=w.state,L=M.xAxisMap,q=M.yAxisMap,$=M.offset,D=S.type.defaultProps||{},z=S.props,J=z.xAxisId,I=J===void 0?D.xAxisId:J,X=z.yAxisId,ne=X===void 0?D.yAxisId:X;return v.cloneElement(S,{key:S.key||"".concat(E,"-").concat(R),xAxis:L[I],yAxis:q[ne],viewBox:{x:$.left,y:$.top,width:$.width,height:$.height},clipPathId:U})}),zt(w,"renderActivePoints",function(S){var E=S.item,R=S.activePoint,T=S.basePoint,U=S.childIndex,M=S.isRange,L=[],q=E.props.key,$=E.item.type.defaultProps!==void 0?Ve(Ve({},E.item.type.defaultProps),E.item.props):E.item.props,D=$.activeDot,z=$.dataKey,J=Ve(Ve({index:U,dataKey:z,cx:R.x,cy:R.y,r:4,fill:Lk(E.item),strokeWidth:2,stroke:"#fff",payload:R.payload,value:R.value},Wt(D,!1)),Yx(D));return L.push(C.renderActiveDot(D,J,"".concat(q,"-activePoint-").concat(U))),T?L.push(C.renderActiveDot(D,Ve(Ve({},J),{},{cx:T.x,cy:T.y}),"".concat(q,"-basePoint-").concat(U))):M&&L.push(null),L}),zt(w,"renderGraphicChild",function(S,E,R){var T=w.filterFormatItem(S,E,R);if(!T)return null;var U=w.getTooltipEventType(),M=w.state,L=M.isTooltipActive,q=M.tooltipAxis,$=M.activeTooltipIndex,D=M.activeLabel,z=w.props.children,J=ma(z,ri),I=T.props,X=I.points,ne=I.isRange,W=I.baseLine,H=T.item.type.defaultProps!==void 0?Ve(Ve({},T.item.type.defaultProps),T.item.props):T.item.props,fe=H.activeDot,Pe=H.hide,Re=H.activeBar,Ie=H.activeShape,Ce=!!(!Pe&&L&&J&&(fe||Re||Ie)),Y={};U!=="axis"&&J&&J.props.trigger==="click"?Y={onClick:ox(w.handleItemMouseEnter,S.props.onClick)}:U!=="axis"&&(Y={onMouseLeave:ox(w.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:ox(w.handleItemMouseEnter,S.props.onMouseEnter)});var ie=v.cloneElement(S,Ve(Ve({},T.props),Y));function Ee(Z){return typeof q.dataKey=="function"?q.dataKey(Z.payload):null}if(Ce)if($>=0){var Ke,Te;if(q.dataKey&&!q.allowDuplicatedCategory){var ct=typeof q.dataKey=="function"?Ee:"payload.".concat(q.dataKey.toString());Ke=_1(X,ct,D),Te=ne&&W&&_1(W,ct,D)}else Ke=X?.[$],Te=ne&&W&&W[$];if(Ie||Re){var ut=S.props.activeIndex!==void 0?S.props.activeIndex:$;return[v.cloneElement(S,Ve(Ve(Ve({},T.props),Y),{},{activeIndex:ut})),null,null]}if(!hn(Ke))return[ie].concat(Pu(w.renderActivePoints({item:T,activePoint:Ke,basePoint:Te,childIndex:$,isRange:ne})))}else{var Dt,be=(Dt=w.getItemByXY(w.state.activeCoordinate))!==null&&Dt!==void 0?Dt:{graphicalItem:ie},pt=be.graphicalItem,te=pt.item,G=te===void 0?S:te,F=pt.childIndex,Ue=Ve(Ve(Ve({},T.props),Y),{},{activeIndex:F});return[v.cloneElement(G,Ue),null,null]}return ne?[ie,null,null]:[ie,null]}),zt(w,"renderCustomized",function(S,E,R){return v.cloneElement(S,Ve(Ve({key:"recharts-customized-".concat(R)},w.props),w.state))}),zt(w,"renderMap",{CartesianGrid:{handler:mx,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:mx},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:mx},YAxis:{handler:mx},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((N=k.id)!==null&&N!==void 0?N:Rf("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=TB(w.triggeredAfterMouseMove,(P=k.throttleDelay)!==null&&P!==void 0?P:1e3/60),w.state={},w}return Dve(C,y),Ove(C,[{key:"componentDidMount",value:function(){var N,P;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(N=this.props.margin.left)!==null&&N!==void 0?N:0,top:(P=this.props.margin.top)!==null&&P!==void 0?P:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var N=this.props,P=N.children,w=N.data,S=N.height,E=N.layout,R=ma(P,ri);if(R){var T=R.props.defaultIndex;if(!(typeof T!="number"||T<0||T>this.state.tooltipTicks.length-1)){var U=this.state.tooltipTicks[T]&&this.state.tooltipTicks[T].value,M=zS(this.state,w,T,U),L=this.state.tooltipTicks[T].coordinate,q=(this.state.offset.top+S)/2,$=E==="horizontal",D=$?{x:L,y:q}:{y:L,x:q},z=this.state.formattedGraphicalItems.find(function(I){var X=I.item;return X.type.name==="Scatter"});z&&(D=Ve(Ve({},D),z.props.points[T].tooltipPosition),M=z.props.points[T].tooltipPayload);var J={activeTooltipIndex:T,isTooltipActive:!0,activeLabel:U,activePayload:M,activeCoordinate:D};this.setState(J),this.renderCursor(R),this.accessibilityManager.setIndex(T)}}}},{key:"getSnapshotBeforeUpdate",value:function(N,P){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==P.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==N.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==N.margin){var w,S;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0}})}return null}},{key:"componentDidUpdate",value:function(N){S1([ma(N.children,ri)],[ma(this.props.children,ri)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var N=ma(this.props.children,ri);if(N&&typeof N.props.shared=="boolean"){var P=N.props.shared?"axis":"item";return c.indexOf(P)>=0?P:i}return i}},{key:"getMouseInfo",value:function(N){if(!this.container)return null;var P=this.container,w=P.getBoundingClientRect(),S=jie(w),E={chartX:Math.round(N.pageX-S.left),chartY:Math.round(N.pageY-S.top)},R=w.width/P.offsetWidth||1,T=this.inRange(E.chartX,E.chartY,R);if(!T)return null;var U=this.state,M=U.xAxisMap,L=U.yAxisMap,q=this.getTooltipEventType(),$=oF(this.state,this.props.data,this.props.layout,T);if(q!=="axis"&&M&&L){var D=ul(M).scale,z=ul(L).scale,J=D&&D.invert?D.invert(E.chartX):null,I=z&&z.invert?z.invert(E.chartY):null;return Ve(Ve({},E),{},{xValue:J,yValue:I},$)}return $?Ve(Ve({},E),$):null}},{key:"inRange",value:function(N,P){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=this.props.layout,E=N/w,R=P/w;if(S==="horizontal"||S==="vertical"){var T=this.state.offset,U=E>=T.left&&E<=T.left+T.width&&R>=T.top&&R<=T.top+T.height;return U?{x:E,y:R}:null}var M=this.state,L=M.angleAxisMap,q=M.radiusAxisMap;if(L&&q){var $=ul(L);return mD({x:E,y:R},$)}return null}},{key:"parseEventsOfWrapper",value:function(){var N=this.props.children,P=this.getTooltipEventType(),w=ma(N,ri),S={};w&&P==="axis"&&(w.props.trigger==="click"?S={onClick:this.handleClick}:S={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var E=Yx(this.props,this.handleOuterEvent);return Ve(Ve({},E),S)}},{key:"addListener",value:function(){CN.on(kN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){CN.removeListener(kN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(N,P,w){for(var S=this.state.formattedGraphicalItems,E=0,R=S.length;E<R;E++){var T=S[E];if(T.item===N||T.props.key===N.key||P===fo(T.item.type)&&w===T.childIndex)return T}return null}},{key:"renderClipPath",value:function(){var N=this.clipPathId,P=this.state.offset,w=P.left,S=P.top,E=P.height,R=P.width;return le.createElement("defs",null,le.createElement("clipPath",{id:N},le.createElement("rect",{x:w,y:S,height:E,width:R})))}},{key:"getXScales",value:function(){var N=this.state.xAxisMap;return N?Object.entries(N).reduce(function(P,w){var S=sF(w,2),E=S[0],R=S[1];return Ve(Ve({},P),{},zt({},E,R.scale))},{}):null}},{key:"getYScales",value:function(){var N=this.state.yAxisMap;return N?Object.entries(N).reduce(function(P,w){var S=sF(w,2),E=S[0],R=S[1];return Ve(Ve({},P),{},zt({},E,R.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(N){var P;return(P=this.state.xAxisMap)===null||P===void 0||(P=P[N])===null||P===void 0?void 0:P.scale}},{key:"getYScaleByAxisId",value:function(N){var P;return(P=this.state.yAxisMap)===null||P===void 0||(P=P[N])===null||P===void 0?void 0:P.scale}},{key:"getItemByXY",value:function(N){var P=this.state,w=P.formattedGraphicalItems,S=P.activeItem;if(w&&w.length)for(var E=0,R=w.length;E<R;E++){var T=w[E],U=T.props,M=T.item,L=M.type.defaultProps!==void 0?Ve(Ve({},M.type.defaultProps),M.props):M.props,q=fo(M.type);if(q==="Bar"){var $=(U.data||[]).find(function(I){return Fhe(N,I)});if($)return{graphicalItem:T,payload:$}}else if(q==="RadialBar"){var D=(U.data||[]).find(function(I){return mD(N,I)});if(D)return{graphicalItem:T,payload:D}}else if(ay(T,S)||iy(T,S)||of(T,S)){var z=ipe({graphicalItem:T,activeTooltipItem:S,itemData:L.data}),J=L.activeIndex===void 0?z:L.activeIndex;return{graphicalItem:Ve(Ve({},T),{},{childIndex:J}),payload:of(T,S)?L.data[z]:T.props.data[z]}}}return null}},{key:"render",value:function(){var N=this;if(!_T(this))return null;var P=this.props,w=P.children,S=P.className,E=P.width,R=P.height,T=P.style,U=P.compact,M=P.title,L=P.desc,q=aF(P,Nve),$=Wt(q,!1);if(U)return le.createElement(z$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},le.createElement(k1,Td({},$,{width:E,height:R,title:M,desc:L}),this.renderClipPath(),ST(w,this.renderMap)));if(this.props.accessibilityLayer){var D,z;$.tabIndex=(D=this.props.tabIndex)!==null&&D!==void 0?D:0,$.role=(z=this.props.role)!==null&&z!==void 0?z:"application",$.onKeyDown=function(I){N.accessibilityManager.keyboardEvent(I)},$.onFocus=function(){N.accessibilityManager.focus()}}var J=this.parseEventsOfWrapper();return le.createElement(z$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},le.createElement("div",Td({className:rn("recharts-wrapper",S),style:Ve({position:"relative",cursor:"default",width:E,height:R},T)},J,{ref:function(X){N.container=X}}),le.createElement(k1,Td({},$,{width:E,height:R,title:M,desc:L,style:Bve}),this.renderClipPath(),ST(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(v.Component);zt(b,"displayName",r),zt(b,"defaultProps",Ve({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),zt(b,"getDerivedStateFromProps",function(y,C){var k=y.dataKey,N=y.data,P=y.children,w=y.width,S=y.height,E=y.layout,R=y.stackOffset,T=y.margin,U=C.dataStartIndex,M=C.dataEndIndex;if(C.updateId===void 0){var L=lF(y);return Ve(Ve(Ve({},L),{},{updateId:0},j(Ve(Ve({props:y},L),{},{updateId:0}),C)),{},{prevDataKey:k,prevData:N,prevWidth:w,prevHeight:S,prevLayout:E,prevStackOffset:R,prevMargin:T,prevChildren:P})}if(k!==C.prevDataKey||N!==C.prevData||w!==C.prevWidth||S!==C.prevHeight||E!==C.prevLayout||R!==C.prevStackOffset||!zd(T,C.prevMargin)){var q=lF(y),$={chartX:C.chartX,chartY:C.chartY,isTooltipActive:C.isTooltipActive},D=Ve(Ve({},oF(C,N,E)),{},{updateId:C.updateId+1}),z=Ve(Ve(Ve({},q),$),D);return Ve(Ve(Ve({},z),j(Ve({props:y},z),C)),{},{prevDataKey:k,prevData:N,prevWidth:w,prevHeight:S,prevLayout:E,prevStackOffset:R,prevMargin:T,prevChildren:P})}if(!S1(P,C.prevChildren)){var J,I,X,ne,W=ma(P,yu),H=W&&(J=(I=W.props)===null||I===void 0?void 0:I.startIndex)!==null&&J!==void 0?J:U,fe=W&&(X=(ne=W.props)===null||ne===void 0?void 0:ne.endIndex)!==null&&X!==void 0?X:M,Pe=H!==U||fe!==M,Re=!hn(N),Ie=Re&&!Pe?C.updateId:C.updateId+1;return Ve(Ve({updateId:Ie},j(Ve(Ve({props:y},C),{},{updateId:Ie,dataStartIndex:H,dataEndIndex:fe}),C)),{},{prevChildren:P,dataStartIndex:H,dataEndIndex:fe})}return null}),zt(b,"renderActiveDot",function(y,C,k){var N;return v.isValidElement(y)?N=v.cloneElement(y,C):Yt(y)?N=y(C):N=le.createElement(qk,C),le.createElement(An,{className:"recharts-active-dot",key:k},N)});var g=v.forwardRef(function(C,k){return le.createElement(b,Td({},C,{ref:k}))});return g.displayName=b.displayName,g},Xve=X8({chartName:"BarChart",GraphicalChild:Pl,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:my},{axisType:"yAxis",AxisComp:hy}],formatAxisMap:cxe}),Zve=X8({chartName:"PieChart",GraphicalChild:Ao,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:sy},{axisType:"radiusAxis",AxisComp:ny}],formatAxisMap:Zde,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function bi(t){const n=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&n==="[object Date]"?new t.constructor(+t):typeof t=="number"||n==="[object Number]"||typeof t=="string"||n==="[object String]"?new Date(t):new Date(NaN)}function Rc(t,n){return t instanceof Date?new t.constructor(n):new Date(n)}const Z8=6048e5,Jve=864e5;let eye={};function py(){return eye}function ff(t,n){const r=py(),s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=bi(t),i=a.getDay(),o=(i<s?7:0)+i-s;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Ug(t){return ff(t,{weekStartsOn:1})}function J8(t){const n=bi(t),r=n.getFullYear(),s=Rc(t,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const a=Ug(s),i=Rc(t,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=Ug(i);return n.getTime()>=a.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function dF(t){const n=bi(t);return n.setHours(0,0,0,0),n}function uF(t){const n=bi(t),r=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return r.setUTCFullYear(n.getFullYear()),+t-+r}function tye(t,n){const r=dF(t),s=dF(n),a=+r-uF(r),i=+s-uF(s);return Math.round((a-i)/Jve)}function nye(t){const n=J8(t),r=Rc(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Ug(r)}function rye(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function sye(t){if(!rye(t)&&typeof t!="number")return!1;const n=bi(t);return!isNaN(Number(n))}function aye(t){const n=bi(t),r=Rc(t,0);return r.setFullYear(n.getFullYear(),0,1),r.setHours(0,0,0,0),r}const iye={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},oye=(t,n,r)=>{let s;const a=iye[t];return typeof a=="string"?s=a:n===1?s=a.one:s=a.other.replace("{{count}}",n.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s};function AN(t){return(n={})=>{const r=n.width?String(n.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const lye={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},cye={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dye={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},uye={date:AN({formats:lye,defaultWidth:"full"}),time:AN({formats:cye,defaultWidth:"full"}),dateTime:AN({formats:dye,defaultWidth:"full"})},mye={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},hye=(t,n,r,s)=>mye[t];function zm(t){return(n,r)=>{const s=r?.context?String(r.context):"standalone";let a;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=r?.width?String(r.width):o;a=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=r?.width?String(r.width):t.defaultWidth;a=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(n):n;return a[i]}}const fye={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},pye={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},xye={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},gye={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},vye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},yye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},jye=(t,n)=>{const r=Number(t),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},bye={ordinalNumber:jye,era:zm({values:fye,defaultWidth:"wide"}),quarter:zm({values:pye,defaultWidth:"wide",argumentCallback:t=>t-1}),month:zm({values:xye,defaultWidth:"wide"}),day:zm({values:gye,defaultWidth:"wide"}),dayPeriod:zm({values:vye,defaultWidth:"wide",formattingValues:yye,defaultFormattingWidth:"wide"})};function Vm(t){return(n,r={})=>{const s=r.width,a=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=n.match(a);if(!i)return null;const o=i[0],c=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(c)?_ye(c,f=>f.test(o)):wye(c,f=>f.test(o));let m;m=t.valueCallback?t.valueCallback(u):u,m=r.valueCallback?r.valueCallback(m):m;const h=n.slice(o.length);return{value:m,rest:h}}}function wye(t,n){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&n(t[r]))return r}function _ye(t,n){for(let r=0;r<t.length;r++)if(n(t[r]))return r}function Nye(t){return(n,r={})=>{const s=n.match(t.matchPattern);if(!s)return null;const a=s[0],i=n.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const c=n.slice(a.length);return{value:o,rest:c}}}const Sye=/^(\d+)(th|st|nd|rd)?/i,Cye=/\d+/i,kye={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Pye={any:[/^b/i,/^(a|c)/i]},Aye={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Eye={any:[/1/i,/2/i,/3/i,/4/i]},Oye={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Tye={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Mye={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Rye={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Dye={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$ye={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Fye={ordinalNumber:Nye({matchPattern:Sye,parsePattern:Cye,valueCallback:t=>parseInt(t,10)}),era:Vm({matchPatterns:kye,defaultMatchWidth:"wide",parsePatterns:Pye,defaultParseWidth:"any"}),quarter:Vm({matchPatterns:Aye,defaultMatchWidth:"wide",parsePatterns:Eye,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Vm({matchPatterns:Oye,defaultMatchWidth:"wide",parsePatterns:Tye,defaultParseWidth:"any"}),day:Vm({matchPatterns:Mye,defaultMatchWidth:"wide",parsePatterns:Rye,defaultParseWidth:"any"}),dayPeriod:Vm({matchPatterns:Dye,defaultMatchWidth:"any",parsePatterns:$ye,defaultParseWidth:"any"})},Lye={code:"en-US",formatDistance:oye,formatLong:uye,formatRelative:hye,localize:bye,match:Fye,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Iye(t){const n=bi(t);return tye(n,aye(n))+1}function qye(t){const n=bi(t),r=+Ug(n)-+nye(n);return Math.round(r/Z8)+1}function eV(t,n){const r=bi(t),s=r.getFullYear(),a=py(),i=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,o=Rc(t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const c=ff(o,n),u=Rc(t,0);u.setFullYear(s,0,i),u.setHours(0,0,0,0);const m=ff(u,n);return r.getTime()>=c.getTime()?s+1:r.getTime()>=m.getTime()?s:s-1}function Bye(t,n){const r=py(),s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=eV(t,n),i=Rc(t,0);return i.setFullYear(a,0,s),i.setHours(0,0,0,0),ff(i,n)}function zye(t,n){const r=bi(t),s=+ff(r,n)-+Bye(r,n);return Math.round(s/Z8)+1}function Pn(t,n){const r=t<0?"-":"",s=Math.abs(t).toString().padStart(n,"0");return r+s}const sl={y(t,n){const r=t.getFullYear(),s=r>0?r:1-r;return Pn(n==="yy"?s%100:s,n.length)},M(t,n){const r=t.getMonth();return n==="M"?String(r+1):Pn(r+1,2)},d(t,n){return Pn(t.getDate(),n.length)},a(t,n){const r=t.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(t,n){return Pn(t.getHours()%12||12,n.length)},H(t,n){return Pn(t.getHours(),n.length)},m(t,n){return Pn(t.getMinutes(),n.length)},s(t,n){return Pn(t.getSeconds(),n.length)},S(t,n){const r=n.length,s=t.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return Pn(a,n.length)}},wd={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},mF={G:function(t,n,r){const s=t.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});default:return r.era(s,{width:"wide"})}},y:function(t,n,r){if(n==="yo"){const s=t.getFullYear(),a=s>0?s:1-s;return r.ordinalNumber(a,{unit:"year"})}return sl.y(t,n)},Y:function(t,n,r,s){const a=eV(t,s),i=a>0?a:1-a;if(n==="YY"){const o=i%100;return Pn(o,2)}return n==="Yo"?r.ordinalNumber(i,{unit:"year"}):Pn(i,n.length)},R:function(t,n){const r=J8(t);return Pn(r,n.length)},u:function(t,n){const r=t.getFullYear();return Pn(r,n.length)},Q:function(t,n,r){const s=Math.ceil((t.getMonth()+1)/3);switch(n){case"Q":return String(s);case"QQ":return Pn(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,n,r){const s=Math.ceil((t.getMonth()+1)/3);switch(n){case"q":return String(s);case"qq":return Pn(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,n,r){const s=t.getMonth();switch(n){case"M":case"MM":return sl.M(t,n);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(t,n,r){const s=t.getMonth();switch(n){case"L":return String(s+1);case"LL":return Pn(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(t,n,r,s){const a=zye(t,s);return n==="wo"?r.ordinalNumber(a,{unit:"week"}):Pn(a,n.length)},I:function(t,n,r){const s=qye(t);return n==="Io"?r.ordinalNumber(s,{unit:"week"}):Pn(s,n.length)},d:function(t,n,r){return n==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):sl.d(t,n)},D:function(t,n,r){const s=Iye(t);return n==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):Pn(s,n.length)},E:function(t,n,r){const s=t.getDay();switch(n){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(t,n,r,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(n){case"e":return String(i);case"ee":return Pn(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,n,r,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(n){case"c":return String(i);case"cc":return Pn(i,n.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,n,r){const s=t.getDay(),a=s===0?7:s;switch(n){case"i":return String(a);case"ii":return Pn(a,n.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(t,n,r){const a=t.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,n,r){const s=t.getHours();let a;switch(s===12?a=wd.noon:s===0?a=wd.midnight:a=s/12>=1?"pm":"am",n){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,n,r){const s=t.getHours();let a;switch(s>=17?a=wd.evening:s>=12?a=wd.afternoon:s>=4?a=wd.morning:a=wd.night,n){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,n,r){if(n==="ho"){let s=t.getHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return sl.h(t,n)},H:function(t,n,r){return n==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):sl.H(t,n)},K:function(t,n,r){const s=t.getHours()%12;return n==="Ko"?r.ordinalNumber(s,{unit:"hour"}):Pn(s,n.length)},k:function(t,n,r){let s=t.getHours();return s===0&&(s=24),n==="ko"?r.ordinalNumber(s,{unit:"hour"}):Pn(s,n.length)},m:function(t,n,r){return n==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):sl.m(t,n)},s:function(t,n,r){return n==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):sl.s(t,n)},S:function(t,n){return sl.S(t,n)},X:function(t,n,r){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(n){case"X":return fF(s);case"XXXX":case"XX":return sc(s);default:return sc(s,":")}},x:function(t,n,r){const s=t.getTimezoneOffset();switch(n){case"x":return fF(s);case"xxxx":case"xx":return sc(s);default:return sc(s,":")}},O:function(t,n,r){const s=t.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+hF(s,":");default:return"GMT"+sc(s,":")}},z:function(t,n,r){const s=t.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+hF(s,":");default:return"GMT"+sc(s,":")}},t:function(t,n,r){const s=Math.trunc(t.getTime()/1e3);return Pn(s,n.length)},T:function(t,n,r){const s=t.getTime();return Pn(s,n.length)}};function hF(t,n=""){const r=t>0?"-":"+",s=Math.abs(t),a=Math.trunc(s/60),i=s%60;return i===0?r+String(a):r+String(a)+n+Pn(i,2)}function fF(t,n){return t%60===0?(t>0?"-":"+")+Pn(Math.abs(t)/60,2):sc(t,n)}function sc(t,n=""){const r=t>0?"-":"+",s=Math.abs(t),a=Pn(Math.trunc(s/60),2),i=Pn(s%60,2);return r+a+n+i}const pF=(t,n)=>{switch(t){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});default:return n.date({width:"full"})}},tV=(t,n)=>{switch(t){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});default:return n.time({width:"full"})}},Vye=(t,n)=>{const r=t.match(/(P+)(p+)?/)||[],s=r[1],a=r[2];if(!a)return pF(t,n);let i;switch(s){case"P":i=n.dateTime({width:"short"});break;case"PP":i=n.dateTime({width:"medium"});break;case"PPP":i=n.dateTime({width:"long"});break;default:i=n.dateTime({width:"full"});break}return i.replace("{{date}}",pF(s,n)).replace("{{time}}",tV(a,n))},Uye={p:tV,P:Vye},Kye=/^D+$/,Wye=/^Y+$/,Hye=["D","DD","YY","YYYY"];function Gye(t){return Kye.test(t)}function Yye(t){return Wye.test(t)}function Qye(t,n,r){const s=Xye(t,n,r);if(console.warn(s),Hye.includes(t))throw new RangeError(s)}function Xye(t,n,r){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${n}\`) for formatting ${s} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Zye=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Jye=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eje=/^'([^]*?)'?$/,tje=/''/g,nje=/[a-zA-Z]/;function ch(t,n,r){const s=py(),a=s.locale??Lye,i=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,c=bi(t);if(!sye(c))throw new RangeError("Invalid time value");let u=n.match(Jye).map(h=>{const f=h[0];if(f==="p"||f==="P"){const x=Uye[f];return x(h,a.formatLong)}return h}).join("").match(Zye).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const f=h[0];if(f==="'")return{isToken:!1,value:rje(h)};if(mF[f])return{isToken:!0,value:h};if(f.match(nje))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:h}});a.localize.preprocessor&&(u=a.localize.preprocessor(c,u));const m={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return u.map(h=>{if(!h.isToken)return h.value;const f=h.value;(Yye(f)||Gye(f))&&Qye(f,n,String(t));const x=mF[f[0]];return x(c,f,a.localize,m)}).join("")}function rje(t){const n=t.match(eje);return n?n[1].replace(tje,"'"):t}function sje({organizationId:t}){const[n,r]=v.useState("monthly"),{hasFeature:s}=Ol(t),{formatAmount:a}=fr(t),i=s("analytics_export"),{data:o,isLoading:c,isError:u}=$e({queryKey:["/api/organizations",t,"analytics","dashboard"],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/analytics/dashboard`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch analytics");return S.json()}}),{data:m,isLoading:h}=$e({queryKey:["/api/organizations",t,"analytics","branches"],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/analytics/branches`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch branch analytics");return S.json()}}),{data:f,isLoading:x}=$e({queryKey:["/api/organizations",t,"analytics","staff"],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/analytics/staff`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch staff analytics");return S.json()}}),{data:j,isLoading:b}=$e({queryKey:["/api/organizations",t,"analytics","trends",n],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/analytics/trends?period=${n}`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch trends");return S.json()}}),{data:g,isLoading:y}=$e({queryKey:["/api/organizations",t,"analytics","institution-health"],queryFn:async()=>{const S=await fetch(`/api/organizations/${t}/analytics/institution-health`,{credentials:"include"});if(!S.ok)throw new Error("Failed to fetch health data");return S.json()}}),C=S=>a(S||0),k=S=>`${(S||0).toFixed(1)}%`,N=()=>{if(!j)return[];const S=new Set([...Object.keys(j.applications),...Object.keys(j.disbursements),...Object.keys(j.collections)]);return Array.from(S).sort().map(E=>({period:E,applications:j.applications[E]||0,disbursements:j.disbursements[E]?.amount||0,collections:j.collections[E]?.amount||0}))},P=()=>o?[{name:"Pending",value:o.pending_loans,color:"#f59e0b"},{name:"Approved",value:o.approved_loans,color:"#3b82f6"},{name:"Disbursed",value:o.disbursed_loans,color:"#22c55e"}].filter(S=>S.value>0):[],w=()=>{if(!o||!m||!f)return;let S=`ANALYTICS REPORT
`;S+=`Generated: ${ch(new Date,"yyyy-MM-dd HH:mm")}

`,S+=`SUMMARY METRICS
`,S+=`Total Members,${o.total_members}
`,S+=`Active Loans,${o.disbursed_loans}
`,S+=`Pending Applications,${o.pending_loans}
`,S+=`Total Disbursed,${o.total_disbursed}
`,S+=`Total Collected,${o.total_repaid}
`,S+=`Collection Rate,${o.collection_rate}%
`,S+=`Default Count,${o.default_count}

`,S+=`BRANCH PERFORMANCE
`,S+=`Branch,Members,Loans,Disbursed,Collected,Default Rate
`,m.forEach(U=>{S+=`${U.branch_name},${U.member_count},${U.loan_count},${U.total_disbursed},${U.total_collected},${U.default_rate}%
`}),S+=`
`,S+=`STAFF PERFORMANCE
`,S+=`Staff,Processed,Approved,Disbursed,Collected
`,f.forEach(U=>{S+=`${U.staff_name},${U.loans_processed},${U.loans_approved},${U.total_disbursed},${U.total_collected}
`});const E=new Blob([S],{type:"text/csv"}),R=URL.createObjectURL(E),T=document.createElement("a");T.href=R,T.download=`analytics-report-${ch(new Date,"yyyy-MM-dd")}.csv`,T.click(),URL.revokeObjectURL(R)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-analytics-title",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Performance metrics and insights"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),i&&e.jsxs(B,{variant:"outline",onClick:w,disabled:!o,children:[e.jsx($a,{className:"mr-2 h-4 w-4"}),"Export Report"]})]})]}),g&&!y&&e.jsx(oe,{className:`border-l-4 ${g.health_status==="excellent"?"border-l-green-500 bg-green-50/50":g.health_status==="good"?"border-l-blue-500 bg-blue-50/50":g.health_status==="fair"?"border-l-yellow-500 bg-yellow-50/50":"border-l-red-500 bg-red-50/50"}`,children:e.jsx(de,{className:"pt-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`text-4xl font-bold ${g.health_status==="excellent"?"text-green-600":g.health_status==="good"?"text-blue-600":g.health_status==="fair"?"text-yellow-600":"text-red-600"}`,children:g.health_score}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Institution Health Score"}),e.jsx(ze,{variant:g.health_status==="excellent"?"default":g.health_status==="good"?"secondary":g.health_status==="fair"?"outline":"destructive",children:g.health_status.toUpperCase()})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"PAR Ratio"}),e.jsx("p",{className:"font-semibold",children:k(g.metrics.par_ratio)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Loan/Deposit Ratio"}),e.jsx("p",{className:"font-semibold",children:k(g.metrics.loan_to_deposit_ratio)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Collection Efficiency"}),e.jsx("p",{className:"font-semibold",children:k(g.metrics.collection_efficiency)})]})]})]})})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:c?e.jsxs(e.Fragment,{children:[e.jsx(bt,{className:"h-32"}),e.jsx(bt,{className:"h-32"}),e.jsx(bt,{className:"h-32"}),e.jsx(bt,{className:"h-32"})]}):u?e.jsx(oe,{className:"md:col-span-4",children:e.jsxs(de,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(La,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-medium",children:"Failed to load analytics"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please try again later"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Total Members"}),e.jsx(pn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-members",children:o?.total_members||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active members"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Active Loans"}),e.jsx(lW,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-active-loans",children:o?.disbursed_loans||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently disbursed"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Pending Applications"}),e.jsx(bn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o?.pending_loans||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Avg Loan Size"}),e.jsx(ho,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g?C(g.loan_stats.average_loan_size):"-"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Per loan"})]})]})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium",children:"Total Disbursed"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:C(o?.total_disbursed||0)})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium",children:"Total Collected"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:C(o?.total_repaid||0)})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium",children:"Collection Rate"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-collection-rate",children:k(o?.collection_rate||0)})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium",children:"Defaults"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600","data-testid":"text-default-rate",children:o?.default_count||0})})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs(oe,{className:"lg:col-span-2",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Trend Analysis"}),e.jsx(dt,{children:"Applications, disbursements, and collections over time"})]}),e.jsxs(Qe,{value:n,onValueChange:r,children:[e.jsx(He,{className:"w-32",children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"daily",children:"Daily"}),e.jsx(ee,{value:"weekly",children:"Weekly"}),e.jsx(ee,{value:"monthly",children:"Monthly"})]})]})]}),e.jsx(de,{children:b?e.jsx(bt,{className:"h-64"}):e.jsx(HR,{width:"100%",height:280,children:e.jsxs(Xve,{data:N(),children:[e.jsx(F8,{strokeDasharray:"3 3"}),e.jsx(my,{dataKey:"period",tick:{fontSize:12}}),e.jsx(hy,{tick:{fontSize:12}}),e.jsx(ri,{formatter:(S,E)=>[E==="applications"?S:C(S),E.charAt(0).toUpperCase()+E.slice(1)]}),e.jsx(pc,{}),e.jsx(Pl,{dataKey:"disbursements",fill:"#3b82f6",name:"Disbursements"}),e.jsx(Pl,{dataKey:"collections",fill:"#22c55e",name:"Collections"})]})})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Loan Status"}),e.jsx(dt,{children:"Distribution by status"})]}),e.jsxs(de,{children:[c?e.jsx(bt,{className:"h-48"}):e.jsx(HR,{width:"100%",height:200,children:e.jsxs(Zve,{children:[e.jsx(Ao,{data:P(),cx:"50%",cy:"50%",innerRadius:40,outerRadius:70,dataKey:"value",label:({name:S,value:E})=>`${S}: ${E}`,children:P().map((S,E)=>e.jsx(Bv,{fill:S.color},`cell-${E}`))}),e.jsx(ri,{})]})}),e.jsx("div",{className:"flex justify-center gap-4 mt-4",children:P().map(S=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:S.color}}),e.jsx("span",{className:"text-sm",children:S.name})]},S.name))})]})]})]}),e.jsxs($s,{defaultValue:"branches",className:"w-full",children:[e.jsxs(vs,{children:[e.jsxs(_t,{value:"branches",className:"gap-2",children:[e.jsx(Yn,{className:"h-4 w-4"}),"Branch Performance"]}),e.jsxs(_t,{value:"staff",className:"gap-2",children:[e.jsx(pn,{className:"h-4 w-4"}),"Staff Performance"]})]}),e.jsx(Nt,{value:"branches",className:"mt-6",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Branch Performance"}),e.jsx(dt,{children:"Metrics by branch location"})]}),e.jsx(de,{children:h?e.jsx(bt,{className:"h-48"}):m&&m.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Branch"}),e.jsx(Q,{className:"text-right",children:"Members"}),e.jsx(Q,{className:"text-right",children:"Loans"}),e.jsx(Q,{className:"text-right",children:"Disbursed"}),e.jsx(Q,{className:"text-right",children:"Collected"}),e.jsx(Q,{className:"text-right",children:"Default Rate"})]})}),e.jsx(Pt,{children:m.map(S=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:S.branch_name}),e.jsx(V,{className:"text-right",children:S.member_count}),e.jsx(V,{className:"text-right",children:S.loan_count}),e.jsx(V,{className:"text-right",children:C(S.total_disbursed)}),e.jsx(V,{className:"text-right",children:C(S.total_collected)}),e.jsx(V,{className:"text-right",children:e.jsx(ze,{variant:S.default_rate>10?"destructive":"secondary",children:k(S.default_rate)})})]},S.branch_id))})]})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No branch data available"})})]})}),e.jsx(Nt,{value:"staff",className:"mt-6",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Staff Performance"}),e.jsx(dt,{children:"Individual staff metrics"})]}),e.jsx(de,{children:x?e.jsx(bt,{className:"h-48"}):f&&f.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Staff"}),e.jsx(Q,{className:"text-right",children:"Processed"}),e.jsx(Q,{className:"text-right",children:"Approved"}),e.jsx(Q,{className:"text-right",children:"Disbursed"}),e.jsx(Q,{className:"text-right",children:"Collected"})]})}),e.jsx(Pt,{children:f.map(S=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:S.staff_name}),e.jsx(V,{className:"text-right",children:S.loans_processed}),e.jsx(V,{className:"text-right",children:S.loans_approved}),e.jsx(V,{className:"text-right",children:C(S.total_disbursed)}),e.jsx(V,{className:"text-right",children:C(S.total_collected)})]},S.staff_id))})]})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No staff data available"})})]})})]})]})}const aje=me.object({recipient_phone:me.string().min(10,"Phone number is required"),recipient_name:me.string().optional(),message:me.string().min(1,"Message is required").max(160,"Message must be 160 characters or less"),notification_type:me.string().default("custom")}),ije=me.object({name:me.string().min(1,"Template name is required"),template_type:me.string().min(1,"Template type is required"),message_template:me.string().min(1,"Message template is required")}),oje=me.object({recipient_group:me.string().min(1,"Please select a recipient group"),message:me.string().min(1,"Message is required").max(320,"Message must be 320 characters or less"),template_id:me.string().optional()});function lje({organizationId:t}){const{toast:n}=Xt(),{symbol:r}=fr(t),[s,a]=v.useState(!1),[i,o]=v.useState(!1),[c,u]=v.useState(null),{canWrite:m}=_r(t,Nr.SMS),{hasFeature:h}=Ol(t),f=h("bulk_sms"),{data:x,isLoading:j,isError:b}=$e({queryKey:["/api/organizations",t,"sms"],queryFn:async()=>{const L=await fetch(`/api/organizations/${t}/sms`,{credentials:"include"});if(!L.ok)throw new Error("Failed to fetch SMS messages");return L.json()}}),{data:g,isLoading:y}=$e({queryKey:["/api/organizations",t,"sms","templates"],queryFn:async()=>{const L=await fetch(`/api/organizations/${t}/sms/templates`,{credentials:"include"});if(!L.ok)throw new Error("Failed to fetch templates");return L.json()}}),{data:C}=$e({queryKey:["/api/organizations",t,"members"],queryFn:async()=>{const L=await fetch(`/api/organizations/${t}/members`,{credentials:"include"});if(!L.ok)throw new Error("Failed to fetch members");return L.json()}}),k=$n({resolver:Fn(aje),defaultValues:{recipient_phone:"",recipient_name:"",message:"",notification_type:"custom"}}),N=$n({resolver:Fn(ije),defaultValues:{name:"",template_type:"payment_reminder",message_template:""}}),P=$n({resolver:Fn(oje),defaultValues:{recipient_group:"",message:"",template_id:""}}),w=P.watch("template_id");g?.find(L=>L.id===w);const S=L=>{const q=g?.find($=>$.id===L);q&&P.setValue("message",q.message_template)},E=Le({mutationFn:async L=>Be("POST",`/api/organizations/${t}/sms`,L),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"sms"]}),a(!1),k.reset(),n({title:"SMS sent successfully"})},onError:()=>{n({title:"Failed to send SMS",variant:"destructive"})}}),R=Le({mutationFn:async L=>Be("POST",`/api/organizations/${t}/sms/templates`,L),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"sms","templates"]}),o(!1),N.reset(),n({title:"Template created successfully"})},onError:()=>{n({title:"Failed to create template",variant:"destructive"})}}),T=Le({mutationFn:async()=>(await Be("POST",`/api/organizations/${t}/sms/templates/seed-defaults`)).json(),onSuccess:L=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"sms","templates"]}),n({title:"Default templates created",description:`Created ${L.created} templates, ${L.skipped} already existed`})},onError:()=>{n({title:"Failed to create default templates",variant:"destructive"})}}),U=Le({mutationFn:async L=>(await Be("POST",`/api/organizations/${t}/sms/bulk`,{recipient_type:L.recipient_group,message:L.message})).json(),onSuccess:L=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"sms"]}),u({sent:L.sent_count,failed:L.failed_count}),n({title:"Bulk SMS sent",description:`Sent: ${L.sent_count}, Failed: ${L.failed_count}`})},onError:()=>{n({title:"Failed to send bulk SMS",variant:"destructive"})}}),M=L=>{switch(L){case"sent":return"default";case"pending":return"secondary";case"failed":return"destructive";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-sms-title",children:"SMS Notifications"}),e.jsx("p",{className:"text-muted-foreground",children:"Send and manage SMS messages"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),m&&e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsxs(B,{variant:"outline",onClick:()=>o(!0),"data-testid":"button-add-template",className:"shrink-0",children:[e.jsx(tn,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"New Template"}),e.jsx("span",{className:"sm:hidden",children:"New"})]}),e.jsxs(B,{onClick:()=>a(!0),"data-testid":"button-send-sms",className:"shrink-0",children:[e.jsx(Cd,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Send SMS"}),e.jsx("span",{className:"sm:hidden",children:"Send"})]})]})]})]}),e.jsxs($s,{defaultValue:"compose",className:"w-full",children:[e.jsxs(vs,{children:[e.jsxs(_t,{value:"compose",className:"gap-2",children:[e.jsx(Cd,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Compose"}),e.jsx("span",{className:"sm:hidden",children:"Send"})]}),e.jsxs(_t,{value:"messages",className:"gap-2",children:[e.jsx(cl,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"History"}),e.jsx("span",{className:"sm:hidden",children:"Hist"})]}),e.jsxs(_t,{value:"templates",className:"gap-2",children:[e.jsx(tn,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Templates"}),e.jsx("span",{className:"sm:hidden",children:"Tpls"})]})]}),e.jsx(Nt,{value:"compose",className:"mt-6",children:f?e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Compose Message"}),e.jsx(dt,{children:"Send SMS to a group of members"})]}),e.jsx(de,{children:e.jsx(Qn,{...P,children:e.jsxs("form",{onSubmit:P.handleSubmit(L=>U.mutate(L)),className:"space-y-4",children:[e.jsx(je,{control:P.control,name:"recipient_group",render:({field:L})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Recipients"}),e.jsxs(Qe,{onValueChange:L.onChange,value:L.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-recipient-group",children:e.jsx(Xe,{placeholder:"Select recipient group"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all_members",children:"All Members"}),e.jsx(ee,{value:"active_loans",children:"Members with Active Loans"}),e.jsx(ee,{value:"overdue_loans",children:"Members with Overdue Loans"}),e.jsx(ee,{value:"pending_payments",children:"Members with Pending Payments"}),e.jsx(ee,{value:"recent_deposits",children:"Members with Recent Deposits"}),e.jsx(ee,{value:"recent_withdrawals",children:"Members with Recent Withdrawals"}),e.jsx(ee,{value:"new_members",children:"New Members (Last 30 Days)"})]})]}),e.jsx(Ne,{})]})}),g&&g.length>0&&e.jsx(je,{control:P.control,name:"template_id",render:({field:L})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Use Template (Optional)"}),e.jsxs(Qe,{onValueChange:q=>{L.onChange(q),q&&S(q)},value:L.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-template",children:e.jsx(Xe,{placeholder:"Select a template"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"",children:"No template"}),g.map(q=>e.jsx(ee,{value:q.id,children:q.name},q.id))]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:P.control,name:"message",render:({field:L})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Message (",320-(L.value?.length||0)," chars left)"]}),e.jsx(ye,{children:e.jsx(fn,{...L,placeholder:"Type your message here... Use placeholders like {{name}}, {{amount}}, {{due_date}}",className:"resize-none min-h-[120px]","data-testid":"input-bulk-message"})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Available placeholders: ","{{name}}",", ","{{member_number}}",", ","{{phone}}",", ","{{amount}}",", ","{{due_date}}"]}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full",disabled:U.isPending,"data-testid":"button-send-bulk",children:U.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Cd,{className:"mr-2 h-4 w-4"}),"Send to Group"]})})]})})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Quick Actions"}),e.jsx(dt,{children:"Common SMS scenarios"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(B,{variant:"outline",className:"justify-start h-auto py-3",onClick:()=>{P.setValue("recipient_group","overdue_loans"),P.setValue("message",`Dear {{name}}, your loan payment of ${r} {{amount}} is overdue. Please make payment immediately to avoid penalties. Thank you.`)},children:e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(La,{className:"h-4 w-4 text-destructive"}),"Overdue Payment Reminder"]}),e.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:"Send to members with overdue loans"})]})}),e.jsx(B,{variant:"outline",className:"justify-start h-auto py-3",onClick:()=>{P.setValue("recipient_group","pending_payments"),P.setValue("message",`Dear {{name}}, your loan payment of ${r} {{amount}} is due on {{due_date}}. Please ensure timely payment. Thank you for banking with us.`)},children:e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(cl,{className:"h-4 w-4 text-yellow-500"}),"Payment Due Reminder"]}),e.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:"Send to members with upcoming payments"})]})}),e.jsx(B,{variant:"outline",className:"justify-start h-auto py-3",onClick:()=>{P.setValue("recipient_group","all_members"),P.setValue("message","Dear {{name}}, this is a reminder from your sacco. For inquiries, please contact us. Thank you for your continued membership.")},children:e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(pn,{className:"h-4 w-4 text-primary"}),"General Announcement"]}),e.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:"Send to all members"})]})}),e.jsx(B,{variant:"outline",className:"justify-start h-auto py-3",onClick:()=>{P.setValue("recipient_group","new_members"),P.setValue("message","Welcome to our Sacco, {{name}}! Your member number is {{member_number}}. We're excited to have you. For any assistance, please contact us.")},children:e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(pn,{className:"h-4 w-4 text-green-500"}),"Welcome New Members"]}),e.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:"Send to members who joined recently"})]})}),e.jsx(B,{variant:"outline",className:"justify-start h-auto py-3",onClick:()=>{P.setValue("recipient_group","recent_deposits"),P.setValue("message",`Dear {{name}}, your deposit of ${r} {{amount}} has been received and credited to your account. Thank you for saving with us.`)},children:e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(cl,{className:"h-4 w-4 text-green-600"}),"Deposit Confirmation"]}),e.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:"Thank members for recent deposits"})]})}),e.jsx(B,{variant:"outline",className:"justify-start h-auto py-3",onClick:()=>{P.setValue("recipient_group","recent_withdrawals"),P.setValue("message",`Dear {{name}}, your withdrawal of ${r} {{amount}} has been processed. Your new balance will reflect shortly. Thank you for banking with us.`)},children:e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.jsx(cl,{className:"h-4 w-4 text-blue-500"}),"Withdrawal Notification"]}),e.jsx("p",{className:"text-xs text-muted-foreground font-normal",children:"Notify members about withdrawals"})]})})]}),c&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Last Bulk SMS Result"}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"text-green-600",children:["Sent: ",c.sent]}),e.jsxs("span",{className:"text-destructive",children:["Failed: ",c.failed]})]})]})]})]})]}):e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(La,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Bulk SMS Not Available"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Bulk SMS functionality is not included in your current plan. Please upgrade to the Professional plan or higher to access this feature."})]})})}),e.jsx(Nt,{value:"messages",className:"mt-6",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Message History"}),e.jsx(dt,{children:"All SMS notifications sent"})]}),e.jsx(de,{children:j?e.jsx(bt,{className:"h-48"}):b?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(La,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-medium",children:"Failed to load messages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please try again later"})]}):x&&x.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Recipient"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Phone"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Type"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Message"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Date"})]})}),e.jsx(Pt,{children:x.map(L=>e.jsxs(qe,{children:[e.jsxs(V,{children:[e.jsx("div",{children:L.recipient_name||"-"}),e.jsx("div",{className:"text-xs text-muted-foreground sm:hidden",children:L.recipient_phone})]}),e.jsx(V,{className:"font-mono text-sm hidden sm:table-cell",children:L.recipient_phone}),e.jsx(V,{className:"hidden md:table-cell",children:e.jsx(ze,{variant:"outline",className:"capitalize",children:L.notification_type})}),e.jsx(V,{className:"max-w-xs truncate hidden lg:table-cell",children:L.message}),e.jsx(V,{children:e.jsx(ze,{variant:M(L.status),className:"capitalize",children:L.status})}),e.jsx(V,{className:"hidden sm:table-cell",children:new Date(L.created_at).toLocaleDateString()})]},L.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(cl,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Send your first SMS notification"}),e.jsxs(B,{onClick:()=>a(!0),children:[e.jsx(Cd,{className:"mr-2 h-4 w-4"}),"Send SMS"]})]})})]})}),e.jsx(Nt,{value:"templates",className:"mt-6",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Message Templates"}),e.jsx(dt,{children:"Reusable SMS templates"})]}),e.jsx(de,{children:y?e.jsx(bt,{className:"h-48"}):g&&g.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Name"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Type"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Template"}),e.jsx(Q,{children:"Status"})]})}),e.jsx(Pt,{children:g.map(L=>e.jsxs(qe,{children:[e.jsxs(V,{className:"font-medium",children:[e.jsx("div",{children:L.name}),e.jsx("div",{className:"text-xs text-muted-foreground sm:hidden capitalize",children:L.template_type.replace("_"," ")})]}),e.jsx(V,{className:"hidden sm:table-cell",children:e.jsx(ze,{variant:"outline",className:"capitalize",children:L.template_type.replace("_"," ")})}),e.jsx(V,{className:"max-w-md truncate hidden md:table-cell",children:L.message_template}),e.jsx(V,{children:e.jsx(ze,{variant:L.is_active?"default":"secondary",children:L.is_active?"Active":"Inactive"})})]},L.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(tn,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No templates yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Create default templates or add your own"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{onClick:()=>T.mutate(),disabled:T.isPending,children:[T.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Create Default Templates"]}),e.jsxs(B,{variant:"outline",onClick:()=>o(!0),children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Custom Template"]})]})]})})]})})]}),e.jsx(Vt,{open:s,onOpenChange:a,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Send SMS"}),e.jsx(Qt,{children:"Send a notification to a member"})]}),e.jsx(Qn,{...k,children:e.jsxs("form",{onSubmit:k.handleSubmit(L=>E.mutate(L)),className:"space-y-4",children:[e.jsx(je,{control:k.control,name:"recipient_phone",render:({field:L})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone Number"}),e.jsx(ye,{children:e.jsx(re,{...L,placeholder:"+254700000000","data-testid":"input-phone"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:k.control,name:"recipient_name",render:({field:L})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Recipient Name (Optional)"}),e.jsx(ye,{children:e.jsx(re,{...L,placeholder:"John Doe","data-testid":"input-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:k.control,name:"message",render:({field:L})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Message (",160-(L.value?.length||0)," chars left)"]}),e.jsx(ye,{children:e.jsx(fn,{...L,placeholder:"Your message...",className:"resize-none","data-testid":"input-message"})}),e.jsx(Ne,{})]})}),e.jsxs(nn,{children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(B,{type:"submit",disabled:E.isPending,"data-testid":"button-submit-sms",children:E.isPending?"Sending...":"Send SMS"})]})]})})]})}),e.jsx(Vt,{open:i,onOpenChange:o,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Create Template"}),e.jsx(Qt,{children:"Create a reusable SMS template"})]}),e.jsx(Qn,{...N,children:e.jsxs("form",{onSubmit:N.handleSubmit(L=>R.mutate(L)),className:"space-y-4",children:[e.jsx(je,{control:N.control,name:"name",render:({field:L})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Template Name"}),e.jsx(ye,{children:e.jsx(re,{...L,placeholder:"Payment Reminder","data-testid":"input-template-name"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:N.control,name:"template_type",render:({field:L})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Type"}),e.jsxs(Qe,{onValueChange:L.onChange,value:L.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-template-type",children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"payment_reminder",children:"Payment Reminder"}),e.jsx(ee,{value:"overdue_notice",children:"Overdue Notice"}),e.jsx(ee,{value:"loan_approved",children:"Loan Approved"}),e.jsx(ee,{value:"loan_disbursed",children:"Loan Disbursed"}),e.jsx(ee,{value:"welcome",children:"Welcome"}),e.jsx(ee,{value:"custom",children:"Custom"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:N.control,name:"message_template",render:({field:L})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Message Template"}),e.jsx(ye,{children:e.jsx(fn,{...L,placeholder:"Dear {name}, your payment of {amount} is due...",className:"resize-none","data-testid":"input-template-message"})}),e.jsx(Ne,{})]})}),e.jsxs(nn,{children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(B,{type:"submit",disabled:R.isPending,"data-testid":"button-submit-template",children:R.isPending?"Creating...":"Create Template"})]})]})})]})})]})}function cje({organizationId:t}){const{toast:n}=Xt(),{formatAmount:r}=fr(t),[s,a]=v.useState(null),[i,o]=v.useState(""),[c,u]=v.useState(""),[m,h]=v.useState(""),{canWrite:f}=_r(t,Nr.DEFAULTS),{data:x,isLoading:j}=$e({queryKey:["/api/organizations",t,"defaults","due-today"],queryFn:async()=>{const M=await fetch(`/api/organizations/${t}/defaults/due-today`,{credentials:"include"});if(!M.ok)throw new Error("Failed to fetch due today");return M.json()},staleTime:5e3,refetchOnMount:"always"}),{data:b,isLoading:g,isError:y}=$e({queryKey:["/api/organizations",t,"defaults"],queryFn:async()=>{const M=await fetch(`/api/organizations/${t}/defaults`,{credentials:"include"});if(!M.ok)throw new Error("Failed to fetch defaults");return M.json()},staleTime:5e3,refetchOnMount:"always"}),{data:C}=$e({queryKey:["/api/organizations",t,"defaults","summary"],queryFn:async()=>{const M=await fetch(`/api/organizations/${t}/defaults/summary`,{credentials:"include"});if(!M.ok)throw new Error("Failed to fetch summary");return M.json()},staleTime:5e3,refetchOnMount:"always"}),{data:k}=$e({queryKey:["/api/organizations",t,"staff"],queryFn:async()=>{const M=await fetch(`/api/organizations/${t}/staff`,{credentials:"include"});if(!M.ok)throw new Error("Failed to fetch staff");return M.json()}}),N=Le({mutationFn:async M=>Be("PUT",`/api/organizations/${t}/defaults/${M.id}`,M),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"defaults"]}),a(null),o(""),u(""),h(""),n({title:"Default record updated"})},onError:()=>{n({title:"Failed to update record",variant:"destructive"})}}),P=M=>r(M||0),w=M=>{switch(M){case"overdue":return"destructive";case"in_collection":return"secondary";case"resolved":return"default";case"written_off":return"outline";default:return"secondary"}},S=M=>{a(M),o(M.collection_notes||""),u(M.status),h(M.assigned_to_id||"")},E=()=>{s&&N.mutate({id:s.id,status:c,collection_notes:i,assigned_to_id:m||void 0})},R=x?.due_today||[],T=x?.overdue||[],U=R.reduce((M,L)=>M+L.amount_due,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-defaults-title",children:"Defaults & Collections"}),e.jsx("p",{className:"text-muted-foreground",children:"Track overdue loans, due instalments, and manage collections"})]}),e.jsx(tr,{organizationId:t})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Due Today"}),e.jsx(bn,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[R.length," ",R.length===1?"loan":"loans"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[P(U)," total due"]})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Overdue Loans"}),e.jsx(CW,{className:"h-4 w-4 text-orange-500"})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[T.length," ",T.length===1?"loan":"loans"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Past payment date"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Total Defaulted"}),e.jsx(Ur,{className:"h-4 w-4 text-destructive"})]}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-defaulted",children:C?.total_defaulted||0})})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Total Penalties"}),e.jsx(La,{className:"h-4 w-4 text-red-500"})]}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:P(C?.total_penalties||0)})})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(bn,{className:"h-5 w-5 text-blue-500"}),"Instalments Due Today"]}),e.jsx(dt,{children:"Loans with payments due today or pending collection"})]}),e.jsx(de,{children:j?e.jsx(bt,{className:"h-48"}):R.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Loan #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{children:"Frequency"}),e.jsx(Q,{className:"text-right",children:"Instalment Amount"}),e.jsx(Q,{className:"text-right",children:"Outstanding Balance"}),e.jsx(Q,{children:"Contact"})]})}),e.jsx(Pt,{children:R.map(M=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono",children:M.application_number}),e.jsx(V,{children:M.member?`${M.member.first_name} ${M.member.last_name}`:"-"}),e.jsx(V,{className:"capitalize",children:M.frequency}),e.jsx(V,{className:"text-right font-medium",children:P(M.instalment_amount)}),e.jsx(V,{className:"text-right",children:P(M.outstanding_balance)}),e.jsx(V,{children:M.member?.phone&&e.jsx(B,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx("a",{href:`tel:${M.member.phone}`,children:e.jsx(ic,{className:"h-4 w-4"})})})})]},M.loan_id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(ps,{className:"h-12 w-12 text-green-500 mb-4"}),e.jsx("h3",{className:"font-medium",children:"No instalments due today"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All payments are up to date"})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(bn,{className:"h-5 w-5 text-orange-500"}),"Overdue Instalments (",T.length,")"]}),e.jsx(dt,{children:"Loans with missed payment dates that need attention"})]}),e.jsx(de,{children:j?e.jsx(bt,{className:"h-48"}):T.length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Loan #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{children:"Frequency"}),e.jsx(Q,{children:"Days Overdue"}),e.jsx(Q,{className:"text-right",children:"Amount Due"}),e.jsx(Q,{className:"text-right",children:"Outstanding Balance"}),e.jsx(Q,{children:"Contact"})]})}),e.jsx(Pt,{children:T.map(M=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono",children:M.application_number}),e.jsx(V,{children:M.member?`${M.member.first_name} ${M.member.last_name}`:"-"}),e.jsx(V,{className:"capitalize",children:M.frequency}),e.jsx(V,{children:e.jsxs(ze,{variant:"destructive",children:[M.days_overdue," ",M.days_overdue===1?"day":"days"]})}),e.jsx(V,{className:"text-right font-medium",children:P(M.amount_due)}),e.jsx(V,{className:"text-right",children:P(M.outstanding_balance)}),e.jsx(V,{children:M.member?.phone&&e.jsx(B,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx("a",{href:`tel:${M.member.phone}`,children:e.jsx(ic,{className:"h-4 w-4"})})})})]},M.loan_id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(ps,{className:"h-12 w-12 text-green-500 mb-4"}),e.jsx("h3",{className:"font-medium",children:"No overdue instalments"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All payments are on schedule"})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Ur,{className:"h-5 w-5 text-destructive"}),"Active Defaults (",(b||[]).filter(M=>M.status!=="resolved"&&M.status!=="written_off").length,")"]}),e.jsx(dt,{children:"Loans currently flagged as defaulted requiring collection action"})]}),e.jsx(de,{children:g?e.jsx(bt,{className:"h-48"}):y?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(La,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-medium",children:"Failed to load defaults"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please try again later"})]}):(b||[]).filter(M=>M.status!=="resolved"&&M.status!=="written_off").length>0?e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Loan #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{children:"Days Overdue"}),e.jsx(Q,{className:"text-right",children:"Amount Overdue"}),e.jsx(Q,{className:"text-right",children:"Penalty"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{children:"Assigned To"}),e.jsx(Q,{children:"Actions"})]})}),e.jsx(Pt,{children:(b||[]).filter(M=>M.status!=="resolved"&&M.status!=="written_off").map(M=>e.jsxs(qe,{"data-testid":`row-default-${M.id}`,children:[e.jsx(V,{className:"font-mono",children:M.loan?.application_number||M.loan_id}),e.jsx(V,{children:M.loan?.member?`${M.loan.member.first_name} ${M.loan.member.last_name}`:"-"}),e.jsx(V,{children:e.jsxs(ze,{variant:M.days_overdue>60?"destructive":"secondary",children:[M.days_overdue," ",M.days_overdue===1?"day":"days"]})}),e.jsx(V,{className:"text-right font-medium",children:P(M.amount_overdue)}),e.jsx(V,{className:"text-right",children:P(M.penalty_amount)}),e.jsx(V,{children:e.jsx(ze,{variant:w(M.status),className:"capitalize",children:M.status.replace("_"," ")})}),e.jsx(V,{children:M.assigned_to_id&&k?.find(L=>L.id===M.assigned_to_id)?.first_name||"-"}),e.jsx(V,{children:e.jsxs("div",{className:"flex gap-2",children:[f&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>S(M),"data-testid":`button-update-${M.id}`,children:"Update"}),M.loan?.member?.phone&&e.jsx(B,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx("a",{href:`tel:${M.loan.member.phone}`,children:e.jsx(ic,{className:"h-4 w-4"})})})]})})]},M.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(ps,{className:"h-12 w-12 text-green-500 mb-4"}),e.jsx("h3",{className:"font-medium",children:"No active defaults"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All loans are in good standing"})]})})]}),(b||[]).filter(M=>M.status==="resolved"||M.status==="written_off").length>0&&e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-5 w-5 text-green-500"}),"Resolved Defaults (",(b||[]).filter(M=>M.status==="resolved"||M.status==="written_off").length,")"]}),e.jsx(dt,{children:"Previously defaulted loans that have been resolved or written off"})]}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Loan #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{children:"Days Overdue"}),e.jsx(Q,{className:"text-right",children:"Amount Overdue"}),e.jsx(Q,{className:"text-right",children:"Penalty"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{children:"Actions"})]})}),e.jsx(Pt,{children:(b||[]).filter(M=>M.status==="resolved"||M.status==="written_off").map(M=>e.jsxs(qe,{className:"opacity-75","data-testid":`row-resolved-${M.id}`,children:[e.jsx(V,{className:"font-mono",children:M.loan?.application_number||M.loan_id}),e.jsx(V,{children:M.loan?.member?`${M.loan.member.first_name} ${M.loan.member.last_name}`:"-"}),e.jsx(V,{children:e.jsxs(ze,{variant:"outline",children:[M.days_overdue," ",M.days_overdue===1?"day":"days"]})}),e.jsx(V,{className:"text-right font-medium",children:P(M.amount_overdue)}),e.jsx(V,{className:"text-right",children:P(M.penalty_amount)}),e.jsx(V,{children:e.jsx(ze,{variant:w(M.status),className:"capitalize",children:M.status.replace("_"," ")})}),e.jsx(V,{children:e.jsxs("div",{className:"flex gap-2",children:[f&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>S(M),"data-testid":`button-update-resolved-${M.id}`,children:"Update"}),M.loan?.member?.phone&&e.jsx(B,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx("a",{href:`tel:${M.loan.member.phone}`,children:e.jsx(ic,{className:"h-4 w-4"})})})]})})]},M.id))})]})})})]}),e.jsx(Vt,{open:!!s,onOpenChange:M=>!M&&a(null),children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Update Default Record"}),e.jsxs(Qt,{children:["Update collection status for ",s?.loan?.application_number]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(Qe,{value:c,onValueChange:u,children:[e.jsx(He,{"data-testid":"select-status",children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"overdue",children:"Overdue"}),e.jsx(ee,{value:"in_collection",children:"In Collection"}),e.jsx(ee,{value:"resolved",children:"Resolved"}),e.jsx(ee,{value:"written_off",children:"Written Off"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Assign To"}),e.jsxs(Qe,{value:m,onValueChange:h,children:[e.jsx(He,{"data-testid":"select-assigned-to",children:e.jsx(Xe,{placeholder:"Select staff"})}),e.jsx(Ge,{children:k?.map(M=>e.jsxs(ee,{value:M.id,children:[M.first_name," ",M.last_name]},M.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Collection Notes"}),e.jsx(fn,{value:i,onChange:M=>o(M.target.value),placeholder:"Notes about collection attempts...",className:"resize-none","data-testid":"input-notes"})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>a(null),children:"Cancel"}),e.jsx(B,{onClick:E,disabled:N.isPending,"data-testid":"button-save-default",children:N.isPending?"Saving...":"Save Changes"})]})]})})]})}function dje({organizationId:t}){const{toast:n}=Xt(),{formatAmount:r}=fr(t),[s,a]=v.useState("overview"),[i,o]=v.useState(!1),[c,u]=v.useState(!1),[m,h]=v.useState(!1),[f,x]=v.useState(!1),[j,b]=v.useState(!1),[g,y]=v.useState(null),[C,k]=v.useState(null),{canWrite:N}=_r(t,Nr.HR),[P,w]=v.useState({leave_type_id:"",start_date:"",end_date:"",reason:""}),[S,E]=v.useState({staff_id:"",basic_salary:"",house_allowance:"",transport_allowance:"",other_allowances:"",nhif_deduction:"",nssf_deduction:"",paye_tax:"",other_deductions:""}),[R,T]=v.useState({staff_id:"",action_type:"",incident_date:"",description:""}),[U,M]=v.useState({staff_id:"",training_name:"",training_type:"",provider:"",start_date:"",end_date:"",cost:""}),{data:L}=$e({queryKey:["/api/organizations",t,"hr","reports","summary"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/reports/summary`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch summary");return G.json()}}),{data:q,isLoading:$}=$e({queryKey:["/api/organizations",t,"hr","staff"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/staff`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch staff");return G.json()}}),{data:D}=$e({queryKey:["/api/organizations",t,"hr","leave-requests"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/leave-requests`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch leave requests");return G.json()}}),{data:z}=$e({queryKey:["/api/organizations",t,"hr","leave-types"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/leave-types`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch leave types");return G.json()}}),{data:J}=$e({queryKey:["/api/organizations",t,"hr","attendance"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/attendance`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch attendance");return G.json()}}),{data:I}=$e({queryKey:["/api/organizations",t,"hr","payroll-configs"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/payroll-configs`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch payroll");return G.json()}}),{data:X}=$e({queryKey:["/api/organizations",t,"hr","disciplinary"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/disciplinary`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch disciplinary");return G.json()}}),{data:ne}=$e({queryKey:["/api/organizations",t,"hr","training"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/training`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch training");return G.json()}}),{data:W}=$e({queryKey:["/api/organizations",t,"hr","pay-periods"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/pay-periods`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch pay periods");return G.json()}}),{data:H}=$e({queryKey:["/api/organizations",t,"hr","payslips"],queryFn:async()=>{const G=await fetch(`/api/organizations/${t}/hr/payslips`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch payslips");return G.json()}}),fe=Le({mutationFn:async G=>{await Be("PUT",`/api/organizations/${t}/hr/staff/${G}/lock`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","staff"]}),n({title:"Success",description:"Staff account locked"})}}),Pe=Le({mutationFn:async G=>{await Be("PUT",`/api/organizations/${t}/hr/staff/${G}/unlock`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","staff"]}),n({title:"Success",description:"Staff account unlocked"})}}),Re=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/attendance/clock-in`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","attendance"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","reports","summary"]}),n({title:"Clocked In",description:"You have successfully clocked in"})},onError:G=>{n({title:"Error",description:G.message||"Failed to clock in",variant:"destructive"})}}),Ie=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/attendance/clock-out`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","attendance"]}),n({title:"Clocked Out",description:"You have successfully clocked out"})},onError:G=>{n({title:"Error",description:G.message||"Failed to clock out",variant:"destructive"})}}),Ce=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/leave-requests`,P)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-requests"]}),o(!1),w({leave_type_id:"",start_date:"",end_date:"",reason:""}),n({title:"Success",description:"Leave request submitted"})},onError:G=>{n({title:"Error",description:G.message||"Failed to submit leave request",variant:"destructive"})}});Le({mutationFn:async G=>{await Be("PUT",`/api/organizations/${t}/hr/leave-requests/${G}/approve`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-requests"]}),n({title:"Success",description:"Leave request approved"})}}),Le({mutationFn:async G=>{await Be("PUT",`/api/organizations/${t}/hr/leave-requests/${G}/reject`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-requests"]}),n({title:"Success",description:"Leave request rejected"})}}),Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/leave-balances/initialize`)},onSuccess:()=>{n({title:"Success",description:"Leave balances initialized for all staff"})}});const Y=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/payroll-configs`,{...S,basic_salary:parseFloat(S.basic_salary)||0,house_allowance:parseFloat(S.house_allowance)||0,transport_allowance:parseFloat(S.transport_allowance)||0,other_allowances:parseFloat(S.other_allowances)||0,nhif_deduction:parseFloat(S.nhif_deduction)||0,nssf_deduction:parseFloat(S.nssf_deduction)||0,paye_tax:parseFloat(S.paye_tax)||0,other_deductions:parseFloat(S.other_deductions)||0})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","payroll-configs"]}),u(!1),E({staff_id:"",basic_salary:"",house_allowance:"",transport_allowance:"",other_allowances:"",nhif_deduction:"",nssf_deduction:"",paye_tax:"",other_deductions:""}),n({title:"Success",description:"Payroll configuration saved"})},onError:G=>{n({title:"Error",description:G.message||"Failed to save payroll config",variant:"destructive"})}}),ie=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/disciplinary`,R)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","disciplinary"]}),h(!1),T({staff_id:"",action_type:"",incident_date:"",description:""}),n({title:"Success",description:"Disciplinary record created"})},onError:G=>{n({title:"Error",description:G.message||"Failed to create disciplinary record",variant:"destructive"})}}),Ee=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/training`,{...U,cost:U.cost?parseFloat(U.cost):null})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","training"]}),x(!1),M({staff_id:"",training_name:"",training_type:"",provider:"",start_date:"",end_date:"",cost:""}),n({title:"Success",description:"Training record created"})},onError:G=>{n({title:"Error",description:G.message||"Failed to create training record",variant:"destructive"})}}),Ke=Le({mutationFn:async G=>{await Be("POST",`/api/organizations/${t}/hr/pay-periods/generate-monthly?year=${G}`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","pay-periods"]}),n({title:"Success",description:"Pay periods generated for the year"})},onError:G=>{n({title:"Error",description:G.message||"Failed to generate pay periods",variant:"destructive"})}}),Te=Le({mutationFn:async G=>{await Be("POST",`/api/organizations/${t}/hr/pay-periods/${G}/run-payroll`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","pay-periods"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","payslips"]}),n({title:"Success",description:"Payroll processed successfully"})},onError:G=>{n({title:"Error",description:G.message||"Failed to run payroll",variant:"destructive"})}}),ct=Le({mutationFn:async G=>{await Be("POST",`/api/organizations/${t}/hr/pay-periods/${G}/approve`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","pay-periods"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","payslips"]}),n({title:"Success",description:"Payroll approved"})},onError:G=>{n({title:"Error",description:G.message||"Failed to approve payroll",variant:"destructive"})}}),ut=Le({mutationFn:async G=>{await Be("POST",`/api/organizations/${t}/hr/pay-periods/${G}/disburse`,{method:"savings_account"})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","pay-periods"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","payslips"]}),n({title:"Success",description:"Salaries disbursed to staff accounts"})},onError:G=>{n({title:"Error",description:G.message||"Failed to disburse payroll",variant:"destructive"})}}),Dt=Le({mutationFn:async G=>{await Be("POST",`/api/organizations/${t}/hr/payslips/${G}/email`)},onSuccess:()=>{n({title:"Success",description:"Payslip emailed to staff member"})},onError:G=>{n({title:"Error",description:G.message||"Failed to email payslip",variant:"destructive"})}}),be=G=>{const F={pending:"secondary",approved:"default",rejected:"destructive",cancelled:"outline",completed:"default",in_progress:"secondary",scheduled:"outline"};return e.jsx(ze,{variant:F[G]||"outline",className:"capitalize",children:G.replace("_"," ")})},pt=G=>{const Ue={open:{variant:"outline",label:"Open"},processing:{variant:"secondary",label:"Processing"},approved:{variant:"default",label:"Approved",className:"bg-blue-600"},paid:{variant:"default",label:"Paid",className:"bg-green-600"},draft:{variant:"outline",label:"Draft"}}[G]||{variant:"outline",label:G};return e.jsx(ze,{variant:Ue.variant,className:Ue.className,children:Ue.label})},te=G=>r(G);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"HR Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your workforce, attendance, payroll, and more"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tr,{organizationId:t}),e.jsxs(B,{variant:"outline",onClick:()=>Re.mutate(),disabled:Re.isPending,className:"gap-2",children:[e.jsx(EW,{className:"h-4 w-4"}),"Clock In"]}),e.jsxs(B,{variant:"outline",onClick:()=>Ie.mutate(),disabled:Ie.isPending,className:"gap-2",children:[e.jsx(Rd,{className:"h-4 w-4"}),"Clock Out"]})]})]}),e.jsxs($s,{value:s,onValueChange:a,className:"w-full",children:[e.jsx("div",{className:"border-b",children:e.jsxs(vs,{className:"h-auto p-0 bg-transparent w-full justify-start gap-0 rounded-none",children:[e.jsxs(_t,{value:"overview",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:bg-transparent rounded-none px-4 py-3 gap-2",children:[e.jsx(Ri,{className:"h-4 w-4"}),"Overview"]}),e.jsxs(_t,{value:"staff",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:bg-transparent rounded-none px-4 py-3 gap-2",children:[e.jsx(pn,{className:"h-4 w-4"}),"Staff"]}),e.jsxs(_t,{value:"attendance",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:bg-transparent rounded-none px-4 py-3 gap-2",children:[e.jsx(bn,{className:"h-4 w-4"}),"Attendance"]}),e.jsxs(_t,{value:"payroll",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:bg-transparent rounded-none px-4 py-3 gap-2",children:[e.jsx(ho,{className:"h-4 w-4"}),"Payroll"]}),e.jsxs(_t,{value:"disciplinary",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:bg-transparent rounded-none px-4 py-3 gap-2",children:[e.jsx(Dd,{className:"h-4 w-4"}),"Disciplinary"]}),e.jsxs(_t,{value:"training",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:bg-transparent rounded-none px-4 py-3 gap-2",children:[e.jsx(ob,{className:"h-4 w-4"}),"Training"]})]})}),e.jsxs(Nt,{value:"overview",className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(oe,{className:"border-l-4 border-l-blue-500",children:e.jsx(de,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Staff"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:L?.total_staff||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{className:"text-green-600",children:[L?.active_staff||0," active"]})," / ",e.jsxs("span",{className:"text-gray-500",children:[L?.inactive_staff||0," inactive"]})]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900/20 flex items-center justify-center",children:e.jsx(pn,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(oe,{className:"border-l-4 border-l-amber-500",children:e.jsx(de,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pending Leave"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:L?.pending_leave_requests||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[L?.staff_on_leave_today||0," on leave today"]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-amber-100 dark:bg-amber-900/20 flex items-center justify-center",children:e.jsx(oo,{className:"h-6 w-6 text-amber-600"})})]})})}),e.jsx(oe,{className:"border-l-4 border-l-green-500",children:e.jsx(de,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Clocked In Today"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:L?.clocked_in_today||0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["of ",L?.active_staff||0," active staff"]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/20 flex items-center justify-center",children:e.jsx($W,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(oe,{className:"border-l-4 border-l-purple-500",children:e.jsx(de,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Pending Actions"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:(L?.pending_trainings||0)+(L?.unresolved_disciplinary||0)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[L?.pending_trainings||0," training, ",L?.unresolved_disciplinary||0," disciplinary"]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-purple-100 dark:bg-purple-900/20 flex items-center justify-center",children:e.jsx(La,{className:"h-6 w-6 text-purple-600"})})]})})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{className:"text-lg",children:"Quick Actions"}),e.jsx(dt,{children:"Common HR tasks at your fingertips"})]}),e.jsx(de,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(B,{variant:"outline",className:"h-auto py-4 flex flex-col gap-2",onClick:()=>o(!0),children:[e.jsx(oo,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Request Leave"})]}),N&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",className:"h-auto py-4 flex flex-col gap-2",onClick:()=>u(!0),children:[e.jsx(ho,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Configure Payroll"})]}),e.jsxs(B,{variant:"outline",className:"h-auto py-4 flex flex-col gap-2",onClick:()=>h(!0),children:[e.jsx(Dd,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Add Disciplinary"})]}),e.jsxs(B,{variant:"outline",className:"h-auto py-4 flex flex-col gap-2",onClick:()=>x(!0),children:[e.jsx(ob,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Add Training"})]})]})]})})]})]}),e.jsx(Nt,{value:"staff",className:"mt-6",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx(_e,{children:"Staff Directory"}),e.jsx(dt,{children:"View and manage staff accounts"})]})})}),e.jsx(de,{children:$?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):q&&q.length>0?e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{className:"bg-muted/50",children:[e.jsx(Q,{className:"font-semibold",children:"Staff #"}),e.jsx(Q,{className:"font-semibold",children:"Name"}),e.jsx(Q,{className:"font-semibold",children:"Email"}),e.jsx(Q,{className:"font-semibold",children:"Role"}),e.jsx(Q,{className:"font-semibold",children:"Status"}),N&&e.jsx(Q,{className:"font-semibold text-right",children:"Actions"})]})}),e.jsx(Pt,{children:q.map(G=>e.jsxs(qe,{className:"hover:bg-muted/30",children:[e.jsx(V,{className:"font-mono text-sm",children:G.staff_number}),e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-primary",children:[G.first_name[0],G.last_name[0]]})}),e.jsxs("span",{className:"font-medium",children:[G.first_name," ",G.last_name]})]})}),e.jsx(V,{className:"text-muted-foreground",children:G.email}),e.jsx(V,{children:e.jsx(ze,{variant:"outline",className:"capitalize",children:G.role})}),e.jsx(V,{children:e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx(ze,{variant:G.is_active?"default":"secondary",children:G.is_active?"Active":"Inactive"}),G.is_locked&&e.jsxs(ze,{variant:"destructive",className:"gap-1",children:[e.jsx(hl,{className:"h-3 w-3"})," Locked"]})]})}),N&&e.jsx(V,{className:"text-right",children:G.is_locked?e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>Pe.mutate(G.id),className:"gap-1",children:[e.jsx(SL,{className:"h-4 w-4"})," Unlock"]}):e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>fe.mutate(G.id),className:"gap-1 text-destructive hover:text-destructive",children:[e.jsx(hl,{className:"h-4 w-4"})," Lock"]})})]},G.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(pn,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Staff Found"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Staff members will appear here once added"})]})})]})}),e.jsxs(Nt,{value:"attendance",className:"mt-6 space-y-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Attendance Records"}),e.jsx("p",{className:"text-muted-foreground",children:"Track daily attendance and work hours"})]})}),e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:J&&J.length>0?e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{className:"bg-muted/50",children:[e.jsx(Q,{className:"font-semibold",children:"Date"}),e.jsx(Q,{className:"font-semibold",children:"Employee"}),e.jsx(Q,{className:"font-semibold",children:"Clock In"}),e.jsx(Q,{className:"font-semibold",children:"Clock Out"}),e.jsx(Q,{className:"font-semibold",children:"Status"}),e.jsx(Q,{className:"font-semibold",children:"Notes"})]})}),e.jsx(Pt,{children:J.map(G=>e.jsxs(qe,{className:"hover:bg-muted/30",children:[e.jsx(V,{className:"font-medium",children:new Date(G.date).toLocaleDateString()}),e.jsx(V,{children:G.staff_name||"You"}),e.jsx(V,{className:"font-mono text-sm",children:G.clock_in||"-"}),e.jsx(V,{className:"font-mono text-sm",children:G.clock_out||"-"}),e.jsx(V,{children:be(G.status)}),e.jsxs(V,{className:"text-muted-foreground text-sm",children:[G.late_minutes>0&&e.jsxs("span",{className:"text-amber-600",children:["Late: ",G.late_minutes,"m"]}),G.overtime_minutes>0&&e.jsxs("span",{className:"text-green-600 ml-2",children:["OT: ",G.overtime_minutes,"m"]})]})]},G.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(bn,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Attendance Records"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Clock in to start tracking attendance"})]})})})]}),e.jsxs(Nt,{value:"payroll",className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Payroll Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Process salaries, manage pay periods, and view payslips"})]}),e.jsx("div",{className:"flex gap-2",children:N&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",onClick:()=>u(!0),className:"gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Staff Salary"]}),e.jsxs(B,{onClick:()=>Ke.mutate(new Date().getFullYear()),disabled:Ke.isPending,className:"gap-2",children:[e.jsx(oo,{className:"h-4 w-4"})," Generate Periods"]})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"pb-3",children:[e.jsx(_e,{className:"text-lg",children:"Pay Periods"}),e.jsx(dt,{children:"Monthly pay cycles for salary processing"})]}),e.jsx(de,{children:W&&W.length>0?e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{className:"bg-muted/50",children:[e.jsx(Q,{className:"font-semibold",children:"Period"}),e.jsx(Q,{className:"font-semibold",children:"Pay Date"}),e.jsx(Q,{className:"font-semibold text-right",children:"Staff"}),e.jsx(Q,{className:"font-semibold text-right",children:"Total Net"}),e.jsx(Q,{className:"font-semibold",children:"Status"}),N&&e.jsx(Q,{className:"font-semibold text-right",children:"Actions"})]})}),e.jsx(Pt,{children:W.map(G=>e.jsxs(qe,{className:"hover:bg-muted/30",children:[e.jsx(V,{className:"font-medium",children:G.name}),e.jsx(V,{children:new Date(G.pay_date).toLocaleDateString()}),e.jsx(V,{className:"text-right",children:G.staff_count}),e.jsx(V,{className:"text-right font-mono font-semibold",children:te(G.total_net)}),e.jsx(V,{children:pt(G.status)}),N&&e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[G.status==="open"&&e.jsx(B,{size:"sm",variant:"outline",onClick:()=>Te.mutate(G.id),disabled:Te.isPending,children:"Run Payroll"}),G.status==="processing"&&e.jsx(B,{size:"sm",variant:"default",onClick:()=>ct.mutate(G.id),disabled:ct.isPending,children:"Approve"}),G.status==="approved"&&e.jsx(B,{size:"sm",variant:"default",onClick:()=>ut.mutate(G.id),disabled:ut.isPending,className:"bg-green-600 hover:bg-green-700",children:"Disburse"}),G.status==="paid"&&e.jsx(ze,{variant:"default",className:"bg-green-600",children:"Completed"})]})})]},G.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(oo,{className:"h-7 w-7 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold",children:"No Pay Periods"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Generate monthly pay periods to start processing payroll"}),N&&e.jsxs(B,{onClick:()=>Ke.mutate(new Date().getFullYear()),className:"mt-4 gap-2",children:[e.jsx(oo,{className:"h-4 w-4"})," Generate ",new Date().getFullYear()," Periods"]})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"pb-3",children:[e.jsx(_e,{className:"text-lg",children:"Salary Configurations"}),e.jsx(dt,{children:"Staff salary structures and deductions"})]}),e.jsx(de,{children:I&&I.length>0?e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{className:"bg-muted/50",children:[e.jsx(Q,{className:"font-semibold",children:"Employee"}),e.jsx(Q,{className:"font-semibold text-right",children:"Basic"}),e.jsx(Q,{className:"font-semibold text-right",children:"Allowances"}),e.jsx(Q,{className:"font-semibold text-right",children:"Deductions"}),e.jsx(Q,{className:"font-semibold text-right",children:"Net Salary"})]})}),e.jsx(Pt,{children:I.map(G=>e.jsxs(qe,{className:"hover:bg-muted/30",children:[e.jsx(V,{className:"font-medium",children:G.staff_name}),e.jsx(V,{className:"text-right font-mono",children:te(G.basic_salary)}),e.jsxs(V,{className:"text-right font-mono text-green-600",children:["+",te(G.house_allowance+G.transport_allowance+G.other_allowances)]}),e.jsxs(V,{className:"text-right font-mono text-red-600",children:["-",te(G.total_deductions)]}),e.jsx(V,{className:"text-right font-mono font-semibold",children:te(G.net_salary)})]},G.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(ho,{className:"h-7 w-7 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold",children:"No Salary Configurations"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Configure staff salaries before running payroll"}),N&&e.jsxs(B,{onClick:()=>u(!0),className:"mt-4 gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Add Salary Configuration"]})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"pb-3",children:[e.jsx(_e,{className:"text-lg",children:"Recent Payslips"}),e.jsx(dt,{children:"Generated payslips for processed periods"})]}),e.jsx(de,{children:H&&H.length>0?e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{className:"bg-muted/50",children:[e.jsx(Q,{className:"font-semibold",children:"Employee"}),e.jsx(Q,{className:"font-semibold",children:"Period"}),e.jsx(Q,{className:"font-semibold text-right",children:"Gross"}),e.jsx(Q,{className:"font-semibold text-right",children:"Deductions"}),e.jsx(Q,{className:"font-semibold text-right",children:"Net"}),e.jsx(Q,{className:"font-semibold",children:"Status"}),e.jsx(Q,{className:"font-semibold text-right",children:"Actions"})]})}),e.jsx(Pt,{children:H.map(G=>e.jsxs(qe,{className:"hover:bg-muted/30",children:[e.jsx(V,{className:"font-medium",children:G.staff_name}),e.jsx(V,{children:G.pay_period}),e.jsx(V,{className:"text-right font-mono",children:te(G.gross_salary)}),e.jsxs(V,{className:"text-right font-mono text-red-600",children:["-",te(G.total_deductions)]}),e.jsx(V,{className:"text-right font-mono font-semibold",children:te(G.net_salary)}),e.jsx(V,{children:pt(G.status)}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(B,{size:"sm",variant:"ghost",onClick:()=>{y(G),b(!0)},title:"View Payslip",children:e.jsx(Ts,{className:"h-4 w-4"})}),e.jsx(B,{size:"sm",variant:"ghost",onClick:()=>Dt.mutate(G.id),disabled:Dt.isPending,title:"Email Payslip",children:e.jsx(ja,{className:"h-4 w-4"})})]})})]},G.id))})]})}):e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"No payslips generated yet. Run payroll to generate payslips."})})]})]}),e.jsxs(Nt,{value:"disciplinary",className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Disciplinary Records"}),e.jsx("p",{className:"text-muted-foreground",children:"Track warnings, suspensions, and actions"})]}),N&&e.jsxs(B,{onClick:()=>h(!0),className:"gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Add Record"]})]}),e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:X&&X.length>0?e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{className:"bg-muted/50",children:[e.jsx(Q,{className:"font-semibold",children:"Employee"}),e.jsx(Q,{className:"font-semibold",children:"Action Type"}),e.jsx(Q,{className:"font-semibold",children:"Incident Date"}),e.jsx(Q,{className:"font-semibold",children:"Description"}),e.jsx(Q,{className:"font-semibold",children:"Status"})]})}),e.jsx(Pt,{children:X.map(G=>e.jsxs(qe,{className:"hover:bg-muted/30",children:[e.jsx(V,{className:"font-medium",children:G.staff_name}),e.jsx(V,{children:e.jsx(ze,{variant:G.action_type==="warning"?"secondary":"destructive",className:"capitalize",children:G.action_type})}),e.jsx(V,{children:new Date(G.incident_date).toLocaleDateString()}),e.jsx(V,{className:"max-w-[300px] truncate text-muted-foreground",children:G.description}),e.jsx(V,{children:e.jsx(ze,{variant:G.is_resolved?"default":"outline",children:G.is_resolved?"Resolved":"Pending"})})]},G.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(Dd,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Disciplinary Records"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Disciplinary actions will appear here"})]})})})]}),e.jsxs(Nt,{value:"training",className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Training Records"}),e.jsx("p",{className:"text-muted-foreground",children:"Track training programs and certifications"})]}),N&&e.jsxs(B,{onClick:()=>x(!0),className:"gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Add Training"]})]}),e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:ne&&ne.length>0?e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{className:"bg-muted/50",children:[e.jsx(Q,{className:"font-semibold",children:"Employee"}),e.jsx(Q,{className:"font-semibold",children:"Training Name"}),e.jsx(Q,{className:"font-semibold",children:"Type"}),e.jsx(Q,{className:"font-semibold",children:"Duration"}),e.jsx(Q,{className:"font-semibold",children:"Status"})]})}),e.jsx(Pt,{children:ne.map(G=>e.jsxs(qe,{className:"hover:bg-muted/30",children:[e.jsx(V,{className:"font-medium",children:G.staff_name}),e.jsx(V,{children:G.training_name}),e.jsx(V,{children:e.jsx(ze,{variant:"outline",className:"capitalize",children:G.training_type||"General"})}),e.jsxs(V,{className:"text-muted-foreground",children:[new Date(G.start_date).toLocaleDateString(),G.end_date&&` - ${new Date(G.end_date).toLocaleDateString()}`]}),e.jsx(V,{children:be(G.status)})]},G.id))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(ob,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Training Records"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Training programs will appear here"}),N&&e.jsxs(B,{onClick:()=>x(!0),className:"mt-4 gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Add Training"]})]})})})]})]}),e.jsx(Vt,{open:i,onOpenChange:o,children:e.jsxs(It,{className:"sm:max-w-md",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Request Leave"}),e.jsx(Qt,{children:"Submit a new leave request for approval"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Leave Type"}),e.jsxs(Qe,{value:P.leave_type_id,onValueChange:G=>w({...P,leave_type_id:G}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select leave type"})}),e.jsx(Ge,{children:z?.map(G=>e.jsx(ee,{value:G.id,children:G.name},G.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Start Date"}),e.jsx(re,{type:"date",value:P.start_date,onChange:G=>w({...P,start_date:G.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"End Date"}),e.jsx(re,{type:"date",value:P.end_date,onChange:G=>w({...P,end_date:G.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Reason (Optional)"}),e.jsx(fn,{value:P.reason,onChange:G=>w({...P,reason:G.target.value}),placeholder:"Reason for leave..."})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>Ce.mutate(),disabled:Ce.isPending,children:"Submit Request"})]})]})}),e.jsx(Vt,{open:c,onOpenChange:u,children:e.jsxs(It,{className:"sm:max-w-lg",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Payroll Configuration"}),e.jsx(Qt,{children:"Configure salary structure for an employee"})]}),e.jsxs("div",{className:"space-y-4 py-4 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Employee"}),e.jsxs(Qe,{value:S.staff_id,onValueChange:G=>E({...S,staff_id:G}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select employee"})}),e.jsx(Ge,{children:q?.map(G=>e.jsxs(ee,{value:G.id,children:[G.first_name," ",G.last_name]},G.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Basic Salary"}),e.jsx(re,{type:"number",value:S.basic_salary,onChange:G=>E({...S,basic_salary:G.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"House Allowance"}),e.jsx(re,{type:"number",value:S.house_allowance,onChange:G=>E({...S,house_allowance:G.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Transport Allowance"}),e.jsx(re,{type:"number",value:S.transport_allowance,onChange:G=>E({...S,transport_allowance:G.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Other Allowances"}),e.jsx(re,{type:"number",value:S.other_allowances,onChange:G=>E({...S,other_allowances:G.target.value}),placeholder:"0.00"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Deductions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"NHIF"}),e.jsx(re,{type:"number",value:S.nhif_deduction,onChange:G=>E({...S,nhif_deduction:G.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"NSSF"}),e.jsx(re,{type:"number",value:S.nssf_deduction,onChange:G=>E({...S,nssf_deduction:G.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"PAYE Tax"}),e.jsx(re,{type:"number",value:S.paye_tax,onChange:G=>E({...S,paye_tax:G.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Other Deductions"}),e.jsx(re,{type:"number",value:S.other_deductions,onChange:G=>E({...S,other_deductions:G.target.value}),placeholder:"0.00"})]})]})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>Y.mutate(),disabled:Y.isPending,children:"Save Configuration"})]})]})}),e.jsx(Vt,{open:m,onOpenChange:h,children:e.jsxs(It,{className:"sm:max-w-md",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Add Disciplinary Record"}),e.jsx(Qt,{children:"Document a disciplinary action"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Employee"}),e.jsxs(Qe,{value:R.staff_id,onValueChange:G=>T({...R,staff_id:G}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select employee"})}),e.jsx(Ge,{children:q?.map(G=>e.jsxs(ee,{value:G.id,children:[G.first_name," ",G.last_name]},G.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Action Type"}),e.jsxs(Qe,{value:R.action_type,onValueChange:G=>T({...R,action_type:G}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select type"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"warning",children:"Warning"}),e.jsx(ee,{value:"written_warning",children:"Written Warning"}),e.jsx(ee,{value:"suspension",children:"Suspension"}),e.jsx(ee,{value:"termination",children:"Termination"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Incident Date"}),e.jsx(re,{type:"date",value:R.incident_date,onChange:G=>T({...R,incident_date:G.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Description"}),e.jsx(fn,{value:R.description,onChange:G=>T({...R,description:G.target.value}),placeholder:"Describe the incident..."})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>ie.mutate(),disabled:ie.isPending,children:"Save Record"})]})]})}),e.jsx(Vt,{open:f,onOpenChange:x,children:e.jsxs(It,{className:"sm:max-w-md",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Add Training Record"}),e.jsx(Qt,{children:"Document a training program or certification"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Employee"}),e.jsxs(Qe,{value:U.staff_id,onValueChange:G=>M({...U,staff_id:G}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select employee"})}),e.jsx(Ge,{children:q?.map(G=>e.jsxs(ee,{value:G.id,children:[G.first_name," ",G.last_name]},G.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Training Name"}),e.jsx(re,{value:U.training_name,onChange:G=>M({...U,training_name:G.target.value}),placeholder:"e.g., Leadership Development"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Training Type"}),e.jsxs(Qe,{value:U.training_type,onValueChange:G=>M({...U,training_type:G}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select type"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"internal",children:"Internal"}),e.jsx(ee,{value:"external",children:"External"}),e.jsx(ee,{value:"certification",children:"Certification"}),e.jsx(ee,{value:"workshop",children:"Workshop"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Provider"}),e.jsx(re,{value:U.provider,onChange:G=>M({...U,provider:G.target.value}),placeholder:"Training provider"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Start Date"}),e.jsx(re,{type:"date",value:U.start_date,onChange:G=>M({...U,start_date:G.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"End Date"}),e.jsx(re,{type:"date",value:U.end_date,onChange:G=>M({...U,end_date:G.target.value})})]})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>Ee.mutate(),disabled:Ee.isPending,children:"Save Record"})]})]})}),e.jsx(Vt,{open:j,onOpenChange:b,children:e.jsxs(It,{className:"sm:max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"h-5 w-5"}),"Payslip Details"]}),e.jsxs(Qt,{children:[g?.staff_name," - ",g?.pay_period]})]}),g&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"border rounded-lg p-4 space-y-3 bg-muted/30",children:[e.jsxs("div",{className:"text-center border-b pb-3",children:[e.jsx("h3",{className:"font-bold text-lg",children:"PAYSLIP"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Pay Period: ",g.pay_period]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Pay Date: ",g.pay_date?new Date(g.pay_date).toLocaleDateString():"N/A"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Employee:"}),e.jsx("span",{className:"font-medium text-right",children:g.staff_name})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2 text-green-600",children:"Earnings"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Basic Salary"}),e.jsx("span",{className:"font-mono",children:te(g.basic_salary||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"House Allowance"}),e.jsx("span",{className:"font-mono",children:te(g.house_allowance||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Transport Allowance"}),e.jsx("span",{className:"font-mono",children:te(g.transport_allowance||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Other Allowances"}),e.jsx("span",{className:"font-mono",children:te(g.other_allowances||0)})]}),e.jsxs("div",{className:"flex justify-between font-semibold border-t pt-1",children:[e.jsx("span",{children:"Gross Salary"}),e.jsx("span",{className:"font-mono text-green-600",children:te(g.gross_salary||0)})]})]})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2 text-red-600",children:"Deductions"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"NHIF"}),e.jsx("span",{className:"font-mono",children:te(g.nhif_deduction||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"NSSF"}),e.jsx("span",{className:"font-mono",children:te(g.nssf_deduction||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"PAYE Tax"}),e.jsx("span",{className:"font-mono",children:te(g.paye_tax||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Loan Deductions"}),e.jsx("span",{className:"font-mono",children:te(g.loan_deductions||0)})]}),(g.shortage_deductions||0)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Shortage Deductions"}),e.jsx("span",{className:"font-mono",children:te(g.shortage_deductions||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Other Deductions"}),e.jsx("span",{className:"font-mono",children:te(g.other_deductions||0)})]}),e.jsxs("div",{className:"flex justify-between font-semibold border-t pt-1",children:[e.jsx("span",{children:"Total Deductions"}),e.jsxs("span",{className:"font-mono text-red-600",children:["-",te(g.total_deductions||0)]})]})]})]}),e.jsx("div",{className:"border-t pt-3 bg-primary/5 -mx-4 px-4 py-2 rounded-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-lg",children:"Net Salary"}),e.jsx("span",{className:"font-mono font-bold text-lg text-primary",children:te(g.net_salary||0)})]})})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Status: ",g.status]}),g.paid_at&&e.jsxs("span",{children:["Paid: ",new Date(g.paid_at).toLocaleDateString()]})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsxs(B,{variant:"outline",onClick:()=>Dt.mutate(g?.id),disabled:Dt.isPending||!g,className:"gap-2",children:[e.jsx(ja,{className:"h-4 w-4"})," Email"]}),e.jsxs(B,{variant:"outline",onClick:()=>window.print(),className:"gap-2",children:[e.jsx(tC,{className:"h-4 w-4"})," Print"]}),e.jsx(B,{onClick:()=>b(!1),children:"Close"})]})]})})]})}function uje({organizationId:t}){const{toast:n}=Xt(),{hasPermission:r}=_r(t,Nr.LEAVE),s=r("leave:read"),a=r("leave:write"),i=r("leave:approve"),[o,c]=v.useState("requests"),[u,m]=v.useState("all"),[h,f]=v.useState("all"),[x,j]=v.useState(""),[b,g]=v.useState(null),[y,C]=v.useState(1),k=10,[N,P]=v.useState(!1),[w,S]=v.useState(!1),[E,R]=v.useState(null),[T,U]=v.useState({staff_id:"",leave_type_id:"",start_date:"",end_date:"",days_requested:"",reason:""}),[M,L]=v.useState({name:"",code:"",days_per_year:"",is_paid:!0,carry_over_allowed:!1,max_carry_over_days:"0",description:""}),{data:q}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const be=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!be.ok)throw new Error("Failed to fetch branches");return be.json()}});v.useEffect(()=>{q&&q.length===1&&f(q[0].id)},[q]);const{data:$}=$e({queryKey:["/api/organizations",t,"hr","staff"],queryFn:async()=>{const be=await fetch(`/api/organizations/${t}/hr/staff`,{credentials:"include"});if(!be.ok)throw new Error("Failed to fetch staff");return be.json()}}),{data:D,isLoading:z}=$e({queryKey:["/api/organizations",t,"hr","leave-requests"],queryFn:async()=>{const be=await fetch(`/api/organizations/${t}/hr/leave-requests`,{credentials:"include"});if(!be.ok)throw new Error("Failed to fetch leave requests");return be.json()}}),{data:J}=$e({queryKey:["/api/organizations",t,"hr","leave-types"],queryFn:async()=>{const be=await fetch(`/api/organizations/${t}/hr/leave-types`,{credentials:"include"});if(!be.ok)throw new Error("Failed to fetch leave types");return be.json()}}),{data:I}=$e({queryKey:["/api/organizations",t,"hr","leave-balances"],queryFn:async()=>{const be=await fetch(`/api/organizations/${t}/hr/leave-balances`,{credentials:"include"});if(!be.ok)throw new Error("Failed to fetch leave balances");return be.json()}}),X=Le({mutationFn:async()=>{const be={leave_type_id:T.leave_type_id,start_date:T.start_date,end_date:T.end_date,days_requested:parseFloat(T.days_requested)||0,reason:T.reason||null};T.staff_id&&(be.staff_id=T.staff_id),await Be("POST",`/api/organizations/${t}/hr/leave-requests`,be)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-requests"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-balances"]}),P(!1),U({staff_id:"",leave_type_id:"",start_date:"",end_date:"",days_requested:"",reason:""}),n({title:"Success",description:"Leave request submitted"})},onError:be=>{n({title:"Error",description:be.message||"Failed to submit leave request",variant:"destructive"})}}),ne=Le({mutationFn:async be=>{await Be("PUT",`/api/organizations/${t}/hr/leave-requests/${be}/approve`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-requests"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-balances"]}),n({title:"Success",description:"Leave request approved"})}}),W=Le({mutationFn:async be=>{await Be("PUT",`/api/organizations/${t}/hr/leave-requests/${be}/reject`,{rejection_reason:""})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-requests"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-balances"]}),n({title:"Success",description:"Leave request rejected"})}}),H=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/hr/leave-balances/initialize`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-balances"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-types"]}),n({title:"Success",description:"Leave balances initialized for all staff"})},onError:be=>{n({title:"Error",description:be.message||"Failed to initialize leave balances",variant:"destructive"})}}),fe=Le({mutationFn:async()=>{const be={name:M.name,code:M.code,days_per_year:parseInt(M.days_per_year)||0,is_paid:M.is_paid,carry_over_allowed:M.carry_over_allowed,max_carry_over_days:parseInt(M.max_carry_over_days)||0,description:M.description||null};E?await Be("PUT",`/api/organizations/${t}/hr/leave-types/${E.id}`,be):await Be("POST",`/api/organizations/${t}/hr/leave-types`,be)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"hr","leave-types"]}),S(!1),R(null),Pe(),n({title:"Success",description:E?"Leave type updated":"Leave type created"})},onError:be=>{n({title:"Error",description:be.message||"Failed to save leave type",variant:"destructive"})}}),Pe=()=>{L({name:"",code:"",days_per_year:"",is_paid:!0,carry_over_allowed:!1,max_carry_over_days:"0",description:""})},Re=be=>{R(be),L({name:be.name,code:be.code,days_per_year:be.days_per_year.toString(),is_paid:be.is_paid,carry_over_allowed:be.carry_over_allowed||!1,max_carry_over_days:(be.max_carry_over_days||0).toString(),description:be.description||""}),S(!0)},Ie=()=>{R(null),Pe(),S(!0)},Ce=(be,pt)=>{if(!be||!pt)return 0;const te=new Date(be),G=new Date(pt),F=Math.abs(G.getTime()-te.getTime());return Math.ceil(F/(1e3*60*60*24))+1},Y=(be,pt)=>{const te={...T,[be]:pt};te.start_date&&te.end_date&&(te.days_requested=Ce(te.start_date,te.end_date).toString()),U(te)},ie=be=>$?.find(pt=>pt.id===be)?.branch_id,Ee=D?.filter(be=>{if(u!=="all"&&be.status!==u)return!1;if(h!=="all"){const pt=ie(be.staff_id);if(pt&&pt!==h)return!1}return!0})||[],Ke=I?.filter(be=>{if(h!=="all"){const pt=ie(be.staff_id);if(pt&&pt!==h)return!1}if(x){const pt=x.toLowerCase();return be.staff_name?.toLowerCase().includes(pt)}return!0})||[],Te=$?.filter(be=>!(h!=="all"&&be.branch_id&&be.branch_id!==h))||[],ct=Ee.filter(be=>be.status==="pending").length,ut=Ee.filter(be=>be.status==="approved").length,Dt=be=>{switch(be){case"pending":return e.jsxs(ze,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:[e.jsx(bn,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return e.jsxs(ze,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(fs,{className:"h-3 w-3 mr-1"}),"Approved"]});case"rejected":return e.jsxs(ze,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[e.jsx(rs,{className:"h-3 w-3 mr-1"}),"Rejected"]});default:return e.jsx(ze,{variant:"outline",children:be})}};return s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Leave Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Review, approve, and manage staff leave requests"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),q&&q.length>1&&e.jsxs(Qe,{value:h,onValueChange:be=>{f(be),C(1)},children:[e.jsxs(He,{className:"w-[180px]",children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),e.jsx(Xe,{placeholder:"Filter by branch"})]}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Branches"}),q?.map(be=>e.jsx(ee,{value:be.id,children:be.name},be.id))]})]}),a&&e.jsxs(B,{onClick:()=>P(!0),className:"gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Request Leave"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Pending Requests"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:ct})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Approved"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:ut})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Leave Types"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:J?.length||0})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Staff with Balances"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:new Set(I?.map(be=>be.staff_id)).size||0})})]})]}),e.jsxs($s,{value:o,onValueChange:c,children:[e.jsxs(vs,{children:[e.jsxs(_t,{value:"requests",className:"gap-2",children:[e.jsx(oo,{className:"h-4 w-4"})," Leave Requests"]}),e.jsxs(_t,{value:"balances",className:"gap-2",children:[e.jsx(pn,{className:"h-4 w-4"})," Leave Balances"]}),e.jsxs(_t,{value:"types",className:"gap-2",children:[e.jsx(Kd,{className:"h-4 w-4"})," Leave Types"]})]}),e.jsx(Nt,{value:"requests",className:"mt-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Leave Requests"}),e.jsx(dt,{children:"View and manage staff leave requests"})]}),e.jsxs(Qe,{value:u,onValueChange:m,children:[e.jsx(He,{className:"w-[150px]",children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Status"}),e.jsx(ee,{value:"pending",children:"Pending"}),e.jsx(ee,{value:"approved",children:"Approved"}),e.jsx(ee,{value:"rejected",children:"Rejected"})]})]})]})}),e.jsx(de,{children:z?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):Ee.length>0?e.jsx("div",{className:"rounded-md border",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Staff"}),e.jsx(Q,{children:"Leave Type"}),e.jsx(Q,{children:"Dates"}),e.jsx(Q,{children:"Days"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:Ee.map(be=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:be.staff_name||"Unknown"}),e.jsx(V,{children:be.leave_type_name||"Leave"}),e.jsxs(V,{children:[new Date(be.start_date).toLocaleDateString()," - ",new Date(be.end_date).toLocaleDateString()]}),e.jsx(V,{children:be.days_requested}),e.jsx(V,{children:Dt(be.status)}),e.jsx(V,{className:"text-right",children:be.status==="pending"&&i&&e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(B,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>ne.mutate(be.id),disabled:ne.isPending,children:[e.jsx(fs,{className:"h-4 w-4 mr-1"})," Approve"]}),e.jsxs(B,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>W.mutate(be.id),disabled:W.isPending,children:[e.jsx(rs,{className:"h-4 w-4 mr-1"})," Reject"]})]})})]},be.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(oo,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Leave Requests"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Staff leave requests will appear here when submitted"})]})})]})}),e.jsx(Nt,{value:"balances",className:"mt-4",children:(()=>{const be=Ke.reduce((G,F)=>{const Ue=F.staff_id;return G[Ue]||(G[Ue]={staff_name:F.staff_name||"Unknown",balances:[]}),G[Ue].balances.push(F),G},{}),pt=Object.entries(be),te=b?be[b]:null;if(b&&te){const G=te.balances.reduce((Ue,Z)=>Ue+Z.entitled_days,0),F=te.balances.reduce((Ue,Z)=>Ue+Z.used_days,0);return e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>g(null),className:"gap-1 px-2",children:[e.jsx($r,{className:"h-4 w-4"})," Back"]}),e.jsxs("div",{children:[e.jsx(_e,{children:te.staff_name}),e.jsx(dt,{children:"Leave balances for the current year"})]})]})}),e.jsxs(de,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"rounded-lg border bg-blue-50 dark:bg-blue-950/30 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-400",children:G}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Entitled"})]}),e.jsxs("div",{className:"rounded-lg border bg-amber-50 dark:bg-amber-950/30 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-700 dark:text-amber-400",children:F}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Used"})]}),e.jsxs("div",{className:"rounded-lg border bg-green-50 dark:bg-green-950/30 p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:G-F}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Remaining"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Leave Type"}),e.jsx(Q,{className:"text-center",children:"Entitled"}),e.jsx(Q,{className:"text-center",children:"Used"}),e.jsx(Q,{className:"text-center",children:"Remaining"}),e.jsx(Q,{className:"text-right",children:"Usage"})]})}),e.jsx(Pt,{children:te.balances.map(Ue=>{const Z=Ue.entitled_days>0?Math.round(Ue.used_days/Ue.entitled_days*100):0;return e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:Ue.leave_type_name||"Leave"}),e.jsx(V,{className:"text-center",children:Ue.entitled_days}),e.jsx(V,{className:"text-center",children:Ue.used_days}),e.jsx(V,{className:"text-center",children:e.jsx(ze,{variant:Ue.remaining_days<=0?"destructive":Ue.remaining_days<=3?"outline":"default",children:Ue.remaining_days})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("div",{className:"w-16 h-2 rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${Z>=100?"bg-destructive":Z>=75?"bg-amber-500":"bg-primary"}`,style:{width:`${Math.min(Z,100)}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground w-8",children:[Z,"%"]})]})})]},Ue.id)})})]})})]})]})}return e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Leave Balances"}),e.jsx(dt,{children:"Select a staff member to view their leave balances"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative w-[250px]",children:[e.jsx(za,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search staff...",value:x,onChange:G=>{j(G.target.value),C(1)},className:"pl-9"})]}),e.jsxs(B,{onClick:()=>H.mutate(),disabled:H.isPending,variant:"outline",size:"sm",children:[e.jsx(mi,{className:"h-4 w-4 mr-1"}),H.isPending?"Initializing...":"Initialize / Refresh Balances"]})]})]})}),e.jsx(de,{children:pt.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border divide-y",children:pt.slice((y-1)*k,y*k).map(([G,{staff_name:F,balances:Ue}])=>{const Z=Ue.reduce((Je,ae)=>Je+ae.remaining_days,0),xe=Ue.reduce((Je,ae)=>Je+ae.entitled_days,0),Ae=Ue.reduce((Je,ae)=>Je+ae.used_days,0);return e.jsxs("button",{onClick:()=>g(G),className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(pn,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:F}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Ae," of ",xe," days used"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ze,{variant:Z<=0?"destructive":"default",children:[Z," days remaining"]}),e.jsx(Os,{className:"h-4 w-4 text-muted-foreground"})]})]},G)})}),pt.length>k&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(y-1)*k+1,"-",Math.min(y*k,pt.length)," of ",pt.length," staff"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{variant:"outline",size:"sm",onClick:()=>C(G=>Math.max(1,G-1)),disabled:y<=1,children:e.jsx(vi,{className:"h-4 w-4"})}),Array.from({length:Math.ceil(pt.length/k)},(G,F)=>F+1).filter(G=>G===1||G===Math.ceil(pt.length/k)||Math.abs(G-y)<=1).map((G,F,Ue)=>e.jsxs("span",{children:[F>0&&Ue[F-1]!==G-1&&e.jsx("span",{className:"px-1 text-muted-foreground",children:"..."}),e.jsx(B,{variant:G===y?"default":"outline",size:"sm",className:"w-8 h-8 p-0",onClick:()=>C(G),children:G})]},G)),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>C(G=>Math.min(Math.ceil(pt.length/k),G+1)),disabled:y>=Math.ceil(pt.length/k),children:e.jsx(Os,{className:"h-4 w-4"})})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pn,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Leave Balances"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:'Click "Initialize / Refresh Balances" above to set up leave entitlements for all active staff'})]})})]})})()}),e.jsx(Nt,{value:"types",className:"mt-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Leave Types Configuration"}),e.jsx(dt,{children:"Define leave types and how many days each staff member is entitled to per year"})]}),a&&e.jsxs(B,{onClick:Ie,size:"sm",className:"gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Add Leave Type"]})]})}),e.jsx(de,{children:J&&J.length>0?e.jsx("div",{className:"rounded-md border",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Name"}),e.jsx(Q,{children:"Code"}),e.jsx(Q,{className:"text-center",children:"Days / Year"}),e.jsx(Q,{className:"text-center",children:"Paid"}),e.jsx(Q,{className:"text-center",children:"Carry Over"}),a&&e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:J.map(be=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:be.name}),e.jsx(V,{children:e.jsx(ze,{variant:"outline",children:be.code})}),e.jsx(V,{className:"text-center font-semibold",children:be.days_per_year}),e.jsx(V,{className:"text-center",children:be.is_paid?e.jsx(ze,{variant:"default",className:"bg-green-100 text-green-700 hover:bg-green-100",children:"Paid"}):e.jsx(ze,{variant:"outline",className:"text-muted-foreground",children:"Unpaid"})}),e.jsx(V,{className:"text-center",children:be.carry_over_allowed?`Yes (${be.max_carry_over_days} days max)`:"No"}),a&&e.jsx(V,{className:"text-right",children:e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>Re(be),children:e.jsx(Ba,{className:"h-4 w-4"})})})]},be.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Kd,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Leave Types"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Leave types will be automatically created when you first access this page"})]})})]})})]}),e.jsx(Vt,{open:w,onOpenChange:be=>{S(be),be||(R(null),Pe())},children:e.jsxs(It,{className:"sm:max-w-md",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:E?"Edit Leave Type":"Add Leave Type"}),e.jsx(Qt,{children:E?"Update the leave type details":"Create a new leave type with days per year entitlement"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Name"}),e.jsx(re,{value:M.name,onChange:be=>L({...M,name:be.target.value}),placeholder:"e.g. Annual Leave"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Code"}),e.jsx(re,{value:M.code,onChange:be=>L({...M,code:be.target.value.toUpperCase()}),placeholder:"e.g. ANNUAL",disabled:!!E})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Days Per Year"}),e.jsx(re,{type:"number",value:M.days_per_year,onChange:be=>L({...M,days_per_year:be.target.value}),placeholder:"Number of days staff are entitled to"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This is how many days of this leave type each staff member gets per year"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.is_paid,onChange:be=>L({...M,is_paid:be.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Paid Leave"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.carry_over_allowed,onChange:be=>L({...M,carry_over_allowed:be.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Allow Carry Over"})]})]}),M.carry_over_allowed&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Max Carry Over Days"}),e.jsx(re,{type:"number",value:M.max_carry_over_days,onChange:be=>L({...M,max_carry_over_days:be.target.value})})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>{S(!1),R(null),Pe()},children:"Cancel"}),e.jsx(B,{onClick:()=>fe.mutate(),disabled:fe.isPending||!M.name||!M.code||!M.days_per_year,children:fe.isPending?"Saving...":E?"Update":"Create"})]})]})}),e.jsx(Vt,{open:N,onOpenChange:P,children:e.jsxs(It,{className:"sm:max-w-md",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Request Leave"}),e.jsx(Qt,{children:"Submit a leave request for a staff member"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Staff Member"}),e.jsxs(Qe,{value:T.staff_id,onValueChange:be=>U({...T,staff_id:be}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select staff member"})}),e.jsx(Ge,{children:Te.map(be=>e.jsxs(ee,{value:be.id,children:[be.first_name," ",be.last_name," (",be.staff_number,")"]},be.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Leave Type"}),e.jsxs(Qe,{value:T.leave_type_id,onValueChange:be=>U({...T,leave_type_id:be}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select leave type"})}),e.jsx(Ge,{children:J?.map(be=>e.jsxs(ee,{value:be.id,children:[be.name," (",be.days_per_year," days/year)"]},be.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Start Date"}),e.jsx(re,{type:"date",value:T.start_date,onChange:be=>Y("start_date",be.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"End Date"}),e.jsx(re,{type:"date",value:T.end_date,onChange:be=>Y("end_date",be.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Days Requested"}),e.jsx(re,{type:"number",value:T.days_requested,onChange:be=>U({...T,days_requested:be.target.value}),placeholder:"Auto-calculated from dates"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Reason (Optional)"}),e.jsx(fn,{value:T.reason,onChange:be=>U({...T,reason:be.target.value}),placeholder:"Reason for leave..."})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>X.mutate(),disabled:X.isPending||!T.staff_id||!T.leave_type_id||!T.start_date||!T.end_date,children:"Submit Request"})]})]})})]}):e.jsx(oe,{children:e.jsx(de,{className:"py-8 text-center text-muted-foreground",children:"You don't have permission to view leave requests."})})}function mje({organizationId:t}){const{toast:n}=Xt(),{currency:r,symbol:s}=fr(t),{hasPermission:a}=_r(t,Nr.EXPENSES),i=a("expenses:read"),o=a("expenses:write"),c=a("expenses:approve"),[u,m]=v.useState("expenses"),[h,f]=v.useState("all"),[x,j]=v.useState("all"),[b,g]=v.useState(""),[y,C]=v.useState(""),[k,N]=v.useState(1),P=20,[w,S]=v.useState("list"),[E,R]=v.useState(null),[T,U]=v.useState(null),[M,L]=v.useState({category_id:"",branch_id:"",amount:"",expense_date:new Date().toISOString().split("T")[0],description:"",vendor:"",receipt_number:"",payment_method:"",payment_reference:"",notes:"",is_recurring:!1,recurrence_interval:"",next_due_date:""}),[q,$]=v.useState({name:"",description:"",is_active:!0}),{data:D}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const te=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});if(!te.ok)throw new Error("Failed to fetch branches");return te.json()}});v.useEffect(()=>{D&&D.length===1&&j(D[0].id)},[D]);const{data:z,isLoading:J}=$e({queryKey:["/api/organizations",t,"expenses","categories"],queryFn:async()=>{const te=await fetch(`/api/organizations/${t}/expenses/categories`,{credentials:"include"});if(!te.ok)throw new Error("Failed to fetch categories");return te.json()}}),{data:I,isLoading:X}=$e({queryKey:["/api/organizations",t,"expenses",h,x,b,y,k,P],queryFn:async()=>{const te=new URLSearchParams({page:String(k),page_size:String(P)});h!=="all"&&te.set("status",h),x!=="all"&&te.set("branch_id",x),b&&te.set("start_date",b),y&&te.set("end_date",y);const G=await fetch(`/api/organizations/${t}/expenses?${te}`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch expenses");return G.json()}}),ne=I?.items,W=Le({mutationFn:async()=>{const te={...M,amount:parseFloat(M.amount)||0,branch_id:M.branch_id||null,vendor:M.vendor||null,receipt_number:M.receipt_number||null,payment_method:M.payment_method||null,payment_reference:M.payment_reference||null,notes:M.notes||null,recurrence_interval:M.recurrence_interval||null,next_due_date:M.next_due_date||null};await Be("POST",`/api/organizations/${t}/expenses`,te)},onSuccess:()=>{N(1),Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses"]}),S("list"),ie(),n({title:"Success",description:"Expense created"})},onError:te=>{n({title:"Error",description:te.message||"Failed to create expense",variant:"destructive"})}}),H=Le({mutationFn:async()=>{const te={...M,amount:parseFloat(M.amount)||0,branch_id:M.branch_id||null,vendor:M.vendor||null,receipt_number:M.receipt_number||null,payment_method:M.payment_method||null,payment_reference:M.payment_reference||null,notes:M.notes||null,recurrence_interval:M.recurrence_interval||null,next_due_date:M.next_due_date||null};await Be("PUT",`/api/organizations/${t}/expenses/${E?.id}`,te)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses"]}),S("list"),R(null),ie(),n({title:"Success",description:"Expense updated"})},onError:te=>{n({title:"Error",description:te.message||"Failed to update expense",variant:"destructive"})}}),fe=Le({mutationFn:async te=>{await Be("DELETE",`/api/organizations/${t}/expenses/${te}`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses"]}),n({title:"Success",description:"Expense deleted"})}}),Pe=Le({mutationFn:async te=>{await Be("POST",`/api/organizations/${t}/expenses/${te}/approve`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses"]}),n({title:"Success",description:"Expense approved"})}}),Re=Le({mutationFn:async te=>{await Be("POST",`/api/organizations/${t}/expenses/${te}/reject`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses"]}),n({title:"Success",description:"Expense rejected"})}}),Ie=Le({mutationFn:async()=>{await Be("POST",`/api/organizations/${t}/expenses/categories`,q)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses","categories"]}),S("list"),Ee(),n({title:"Success",description:"Category created"})},onError:te=>{n({title:"Error",description:te.message||"Failed to create category",variant:"destructive"})}}),Ce=Le({mutationFn:async()=>{await Be("PUT",`/api/organizations/${t}/expenses/categories/${T?.id}`,q)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses","categories"]}),S("list"),U(null),Ee(),n({title:"Success",description:"Category updated"})}}),Y=Le({mutationFn:async te=>{await Be("DELETE",`/api/organizations/${t}/expenses/categories/${te}`)},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"expenses","categories"]}),n({title:"Success",description:"Category deleted"})},onError:te=>{n({title:"Error",description:te.message||"Cannot delete category with expenses",variant:"destructive"})}}),ie=()=>{L({category_id:"",branch_id:"",amount:"",expense_date:new Date().toISOString().split("T")[0],description:"",vendor:"",receipt_number:"",payment_method:"",payment_reference:"",notes:"",is_recurring:!1,recurrence_interval:"",next_due_date:""})},Ee=()=>{$({name:"",description:"",is_active:!0})},Ke=te=>{R(te),L({category_id:te.category_id,branch_id:te.branch_id||"",amount:te.amount.toString(),expense_date:te.expense_date,description:te.description,vendor:te.vendor||"",receipt_number:te.receipt_number||"",payment_method:te.payment_method||"",payment_reference:te.payment_reference||"",notes:te.notes||"",is_recurring:te.is_recurring||!1,recurrence_interval:te.recurrence_interval||"",next_due_date:te.next_due_date||""}),S("expense_form")},Te=te=>{U(te),$({name:te.name,description:te.description||"",is_active:te.is_active}),S("category_form")},ct=ne||[],ut=I?.total_amount??0,Dt=I?.pending_count??0,be=I?.approved_total??0,pt=te=>{switch(te){case"pending":return e.jsxs(ze,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:[e.jsx(bn,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return e.jsxs(ze,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(fs,{className:"h-3 w-3 mr-1"}),"Approved"]});case"rejected":return e.jsxs(ze,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[e.jsx(rs,{className:"h-3 w-3 mr-1"}),"Rejected"]});default:return e.jsx(ze,{variant:"outline",children:te})}};return i?w==="expense_form"?e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{S("list"),R(null),ie()},children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:E?"Edit Expense":"Add Expense"}),e.jsx("p",{className:"text-muted-foreground",children:E?`Editing: ${E.expense_number}`:"Enter expense details"})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Expense Details"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Category *"}),e.jsxs(Qe,{value:M.category_id,onValueChange:te=>L({...M,category_id:te}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select category"})}),e.jsx(Ge,{children:z?.filter(te=>te.is_active).map(te=>e.jsx(ee,{value:te.id,children:te.name},te.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Branch"}),e.jsxs(Qe,{value:M.branch_id||"none",onValueChange:te=>L({...M,branch_id:te==="none"?"":te}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select branch"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"none",children:"No branch"}),D?.map(te=>e.jsx(ee,{value:te.id,children:te.name},te.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:`Amount (${r}) *`}),e.jsx(re,{type:"number",value:M.amount,onChange:te=>L({...M,amount:te.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Date *"}),e.jsx(re,{type:"date",value:M.expense_date,onChange:te=>L({...M,expense_date:te.target.value})})]})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Description"})}),e.jsx(de,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Description *"}),e.jsx(fn,{value:M.description,onChange:te=>L({...M,description:te.target.value}),placeholder:"What was this expense for?"})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Payment Details"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Vendor"}),e.jsx(re,{value:M.vendor,onChange:te=>L({...M,vendor:te.target.value}),placeholder:"Vendor name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Receipt Number"}),e.jsx(re,{value:M.receipt_number,onChange:te=>L({...M,receipt_number:te.target.value}),placeholder:"Receipt #"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Payment Method"}),e.jsxs(Qe,{value:M.payment_method,onValueChange:te=>L({...M,payment_method:te}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select method"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"cash",children:"Cash"}),e.jsx(ee,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Payment Reference"}),e.jsx(re,{value:M.payment_reference,onChange:te=>L({...M,payment_reference:te.target.value}),placeholder:"Transaction ID"})]})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Additional"})}),e.jsx(de,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Notes"}),e.jsx(fn,{value:M.notes,onChange:te=>L({...M,notes:te.target.value}),placeholder:"Additional notes..."})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Recurring Settings"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(mi,{className:"h-4 w-4"}),"Recurring Expense"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Set this expense to repeat automatically"})]}),e.jsx(ts,{checked:M.is_recurring,onCheckedChange:te=>L({...M,is_recurring:te})})]}),M.is_recurring&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Interval *"}),e.jsxs(Qe,{value:M.recurrence_interval,onValueChange:te=>L({...M,recurrence_interval:te}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select interval"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"daily",children:"Daily"}),e.jsx(ee,{value:"weekly",children:"Weekly"}),e.jsx(ee,{value:"monthly",children:"Monthly"}),e.jsx(ee,{value:"quarterly",children:"Quarterly"}),e.jsx(ee,{value:"yearly",children:"Yearly"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Next Due Date *"}),e.jsx(re,{type:"date",value:M.next_due_date,onChange:te=>L({...M,next_due_date:te.target.value})})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(B,{variant:"outline",onClick:()=>{S("list"),R(null),ie()},children:"Cancel"}),e.jsxs(B,{onClick:()=>E?H.mutate():W.mutate(),disabled:W.isPending||H.isPending||!M.category_id||!M.amount||!M.description,children:[E?"Update":"Create"," Expense"]})]})]}):w==="category_form"?e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{S("list"),U(null),Ee()},children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:T?"Edit Category":"Add Category"}),e.jsx("p",{className:"text-muted-foreground",children:T?`Editing: ${T.name}`:"Define an expense category"})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Category Details"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Name *"}),e.jsx(re,{value:q.name,onChange:te=>$({...q,name:te.target.value}),placeholder:"e.g., Office Supplies"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Description"}),e.jsx(fn,{value:q.description,onChange:te=>$({...q,description:te.target.value}),placeholder:"Category description..."})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(B,{variant:"outline",onClick:()=>{S("list"),U(null),Ee()},children:"Cancel"}),e.jsxs(B,{onClick:()=>T?Ce.mutate():Ie.mutate(),disabled:Ie.isPending||Ce.isPending||!q.name,children:[T?"Update":"Create"," Category"]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Expenses Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Track and manage organizational expenses"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),D&&D.length>1&&e.jsxs(Qe,{value:x,onValueChange:te=>{j(te),N(1)},children:[e.jsxs(He,{className:"w-[180px]",children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),e.jsx(Xe,{placeholder:"Filter by branch"})]}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Branches"}),D?.map(te=>e.jsx(ee,{value:te.id,children:te.name},te.id))]})]}),o&&e.jsxs(B,{onClick:()=>{ie(),R(null),S("expense_form")},className:"gap-2",children:[e.jsx(mn,{className:"h-4 w-4"})," Add Expense"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Total Expenses"})}),e.jsx(de,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[s," ",ut.toLocaleString()]})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Pending Approval"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Dt})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Approved Total"})}),e.jsx(de,{children:e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[s," ",be.toLocaleString()]})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Categories"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:z?.length||0})})]})]}),e.jsxs($s,{value:u,onValueChange:m,children:[e.jsxs(vs,{children:[e.jsxs(_t,{value:"expenses",className:"gap-2",children:[e.jsx(Ei,{className:"h-4 w-4"})," Expenses"]}),e.jsxs(_t,{value:"categories",className:"gap-2",children:[e.jsx(dE,{className:"h-4 w-4"})," Categories"]})]}),e.jsx(Nt,{value:"expenses",className:"mt-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Expense Records"}),e.jsx(dt,{children:I?`${I.total} expenses found`:"View and manage expense entries"})]}),e.jsxs(Qe,{value:h,onValueChange:te=>{f(te),N(1)},children:[e.jsx(He,{className:"w-[150px]",children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Status"}),e.jsx(ee,{value:"pending",children:"Pending"}),e.jsx(ee,{value:"approved",children:"Approved"}),e.jsx(ee,{value:"rejected",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"From"}),e.jsx(re,{type:"date",value:b,onChange:te=>{g(te.target.value),N(1)},className:"w-[160px]"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"To"}),e.jsx(re,{type:"date",value:y,onChange:te=>{C(te.target.value),N(1)},className:"w-[160px]"})]}),(b||y)&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>{g(""),C(""),N(1)},children:"Clear dates"})]})]})}),e.jsx(de,{children:X?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-12 w-full"}),e.jsx(bt,{className:"h-12 w-full"})]}):ct.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Expense #"}),e.jsx(Q,{children:"Date"}),e.jsx(Q,{children:"Category"}),e.jsx(Q,{children:"Description"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:ct.map(te=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[te.expense_number,te.is_recurring&&e.jsxs(ze,{variant:"outline",className:"text-xs gap-1",children:[e.jsx(mi,{className:"h-3 w-3"}),te.recurrence_interval]})]})}),e.jsx(V,{children:new Date(te.expense_date).toLocaleDateString()}),e.jsx(V,{children:te.category_name}),e.jsx(V,{className:"max-w-[200px] truncate",children:te.description}),e.jsxs(V,{className:"text-right font-medium",children:[s," ",te.amount.toLocaleString()]}),e.jsx(V,{children:pt(te.status)}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[te.status==="pending"&&c&&e.jsxs(e.Fragment,{children:[e.jsx(B,{size:"sm",variant:"ghost",className:"text-green-600 h-8 w-8 p-0",onClick:()=>Pe.mutate(te.id),children:e.jsx(fs,{className:"h-4 w-4"})}),e.jsx(B,{size:"sm",variant:"ghost",className:"text-red-600 h-8 w-8 p-0",onClick:()=>Re.mutate(te.id),children:e.jsx(rs,{className:"h-4 w-4"})})]}),te.status==="pending"&&o&&e.jsxs(e.Fragment,{children:[e.jsx(B,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>Ke(te),children:e.jsx(Ba,{className:"h-4 w-4"})}),e.jsx(B,{size:"sm",variant:"ghost",className:"text-red-600 h-8 w-8 p-0",onClick:()=>fe.mutate(te.id),children:e.jsx(ba,{className:"h-4 w-4"})})]})]})})]},te.id))})]})}),I&&I.total_pages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(k-1)*P+1," to ",Math.min(k*P,I.total)," of ",I.total]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>N(k-1),disabled:k===1,children:[e.jsx(vi,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm px-3",children:["Page ",k," of ",I.total_pages]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>N(k+1),disabled:k>=I.total_pages,children:["Next",e.jsx(Os,{className:"h-4 w-4 ml-1"})]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ei,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Expenses"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create your first expense to get started"})]})})]})}),e.jsx(Nt,{value:"categories",className:"mt-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Expense Categories"}),e.jsx(dt,{children:"Organize expenses by category"})]}),o&&e.jsxs(B,{size:"sm",onClick:()=>{Ee(),U(null),S("category_form")},children:[e.jsx(mn,{className:"h-4 w-4 mr-2"})," Add Category"]})]})}),e.jsx(de,{children:J?e.jsx("div",{className:"space-y-3",children:e.jsx(bt,{className:"h-12 w-full"})}):z&&z.length>0?e.jsx("div",{className:"rounded-md border",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Name"}),e.jsx(Q,{children:"Description"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:z.map(te=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:te.name}),e.jsx(V,{className:"max-w-[200px] truncate",children:te.description||"-"}),e.jsx(V,{children:e.jsx(ze,{variant:te.is_active?"default":"secondary",children:te.is_active?"Active":"Inactive"})}),e.jsx(V,{className:"text-right",children:o&&e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(B,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>Te(te),children:e.jsx(Ba,{className:"h-4 w-4"})}),e.jsx(B,{size:"sm",variant:"ghost",className:"text-red-600 h-8 w-8 p-0",onClick:()=>Y.mutate(te.id),children:e.jsx(ba,{className:"h-4 w-4"})})]})})]},te.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(dE,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Categories"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create expense categories to organize your expenses"})]})})]})})]})]}):e.jsx(oe,{children:e.jsx(de,{className:"py-8 text-center text-muted-foreground",children:"You don't have permission to view expenses."})})}function hje({organizationId:t}){const[n,r]=v.useState("all"),[s,a]=v.useState("all"),[i,o]=v.useState(""),[c,u]=v.useState(""),[m,h]=v.useState(1),[f,x]=v.useState(null),j=20;v.useEffect(()=>{const R=setTimeout(()=>{u(i),i!==c&&h(1)},300);return()=>clearTimeout(R)},[i]);const{data:b,isLoading:g,isError:y}=$e({queryKey:["/api/organizations",t,"audit-logs",m,n,s,c],queryFn:async()=>{const R=new URLSearchParams({page:m.toString(),limit:j.toString()});n!=="all"&&R.append("action",n),s!=="all"&&R.append("entity_type",s),c&&R.append("search",c);const T=await fetch(`/api/organizations/${t}/audit-logs?${R}`,{credentials:"include"});if(!T.ok)throw new Error("Failed to fetch audit logs");return T.json()}}),{data:C}=$e({queryKey:["/api/organizations",t,"audit-logs","summary"],queryFn:async()=>{const R=await fetch(`/api/organizations/${t}/audit-logs/summary`,{credentials:"include"});if(!R.ok)throw new Error("Failed to fetch summary");return R.json()}}),k=R=>{const T=R.toLowerCase();return T.includes("create")||T.includes("deposit")?"default":T.includes("update")||T.includes("edit")?"secondary":T.includes("delete")||T.includes("remove")||T.includes("suspend")?"destructive":T.includes("login")||T.includes("logout")?"outline":(T.includes("withdraw"),"secondary")},N=R=>R.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase()),P=b?.logs,w=C?.by_action?Object.keys(C.by_action):[],S=C?.by_entity?Object.keys(C.by_entity):[],E=R=>{h(R)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-audit-title",children:"Audit Logs"}),e.jsx("p",{className:"text-muted-foreground",children:"Track all system activities"})]}),e.jsx(tr,{organizationId:t})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium",children:"Total Actions"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-actions",children:b?.total||C?.total_actions||0})})]}),C?.by_action&&Object.entries(C.by_action).slice(0,2).map(([R,T])=>e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium capitalize",children:N(R)})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:T})})]},R))]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Activity Log"}),e.jsx(dt,{children:b?.total?`${b.total} total records`:"Complete audit trail"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(za,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search...",value:i,onChange:R=>o(R.target.value),className:"pl-9 w-48","data-testid":"input-search"})]}),e.jsxs(Qe,{value:n,onValueChange:R=>{r(R),h(1)},children:[e.jsx(He,{className:"w-40","data-testid":"filter-action",children:e.jsx(Xe,{placeholder:"Action"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Actions"}),w.map(R=>e.jsx(ee,{value:R,children:N(R)},R))]})]}),e.jsxs(Qe,{value:s,onValueChange:R=>{a(R),h(1)},children:[e.jsx(He,{className:"w-40","data-testid":"filter-entity",children:e.jsx(Xe,{placeholder:"Entity"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Entities"}),S.map(R=>e.jsx(ee,{value:R,className:"capitalize",children:R},R))]})]})]})]})}),e.jsx(de,{children:g?e.jsx(bt,{className:"h-48"}):y?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(La,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-medium",children:"Failed to load audit logs"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please try again later"})]}):P&&P.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"hidden sm:table-cell",children:"Date/Time"}),e.jsx(Q,{children:"User"}),e.jsx(Q,{children:"Action"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Entity"}),e.jsx(Q,{className:"min-w-[200px] hidden lg:table-cell",children:"Details"}),e.jsx(Q,{className:"hidden md:table-cell",children:"View"})]})}),e.jsx(Pt,{children:P.map(R=>e.jsxs(qe,{"data-testid":`row-log-${R.id}`,className:"cursor-pointer hover:bg-muted/50",onClick:()=>x(R),children:[e.jsx(V,{className:"whitespace-nowrap hidden sm:table-cell",children:new Date(R.created_at).toLocaleString()}),e.jsxs(V,{children:[e.jsx("div",{children:R.staff?`${R.staff.first_name} ${R.staff.last_name}`:"System"}),e.jsx("div",{className:"text-xs text-muted-foreground sm:hidden",children:new Date(R.created_at).toLocaleDateString()})]}),e.jsx(V,{children:e.jsx(ze,{variant:k(R.action),children:N(R.action)})}),e.jsx(V,{className:"capitalize hidden md:table-cell",children:R.entity_type||"-"}),e.jsx(V,{className:"text-sm text-muted-foreground max-w-[300px] hidden lg:table-cell",children:R.details&&R.details!=="-"?e.jsx("span",{className:"line-clamp-2",children:R.details}):R.entity_id?e.jsxs("span",{className:"font-mono text-xs",children:["ID: ",R.entity_id.substring(0,8),"..."]}):"-"}),e.jsx(V,{className:"hidden md:table-cell",children:e.jsx(B,{variant:"ghost",size:"sm",onClick:T=>{T.stopPropagation(),x(R)},children:e.jsx(Ts,{className:"h-4 w-4"})})})]},R.id))})]})}),b&&b.total_pages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(m-1)*j+1," to ",Math.min(m*j,b.total)," of ",b.total," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>E(m-1),disabled:m===1,children:[e.jsx(vi,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm px-3",children:["Page ",m," of ",b.total_pages]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>E(m+1),disabled:m>=b.total_pages,children:["Next",e.jsx(Os,{className:"h-4 w-4 ml-1"})]})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(eh,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium",children:"No audit logs"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||n!=="all"||s!=="all"?"No logs match your search or filters":"System activities will appear here"})]})})]}),e.jsx(Vt,{open:!!f,onOpenChange:R=>!R&&x(null),children:e.jsxs(It,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[e.jsx(qt,{children:e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(eh,{className:"h-5 w-5"}),"Audit Log Details"]})}),f&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Date & Time"}),e.jsx("p",{className:"text-sm",children:new Date(f.created_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Performed By"}),e.jsx("p",{className:"text-sm",children:f.staff?`${f.staff.first_name} ${f.staff.last_name}`:"System"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Action"}),e.jsx(ze,{variant:k(f.action),children:N(f.action)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Entity Type"}),e.jsx("p",{className:"text-sm capitalize",children:f.entity_type||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Entity ID"}),e.jsx("p",{className:"text-sm font-mono break-all",children:f.entity_id||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"IP Address"}),e.jsx("p",{className:"text-sm font-mono",children:f.ip_address||"-"})]})]}),f.details&&f.details!=="-"&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Summary"}),e.jsx("p",{className:"text-sm bg-muted p-3 rounded-md",children:f.details})]}),f.old_values&&Object.keys(f.old_values).length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Previous Values"}),e.jsx("div",{className:"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-900 rounded-md p-3 overflow-x-auto",children:e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:Object.entries(f.old_values).map(([R,T])=>e.jsxs("tr",{className:"border-b border-red-100 dark:border-red-900/50 last:border-0",children:[e.jsx("td",{className:"py-1.5 pr-3 font-medium text-red-700 dark:text-red-400 whitespace-nowrap align-top",children:R.replace(/_/g," ").replace(/\b\w/g,U=>U.toUpperCase())}),e.jsx("td",{className:"py-1.5 text-red-600 dark:text-red-300 break-all",children:typeof T=="object"?JSON.stringify(T,null,2):String(T??"-")})]},R))})})})]}),f.new_values&&Object.keys(f.new_values).length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"New Values"}),e.jsx("div",{className:"bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-900 rounded-md p-3 overflow-x-auto",children:e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:Object.entries(f.new_values).map(([R,T])=>e.jsxs("tr",{className:"border-b border-green-100 dark:border-green-900/50 last:border-0",children:[e.jsx("td",{className:"py-1.5 pr-3 font-medium text-green-700 dark:text-green-400 whitespace-nowrap align-top",children:R.replace(/_/g," ").replace(/\b\w/g,U=>U.toUpperCase())}),e.jsx("td",{className:"py-1.5 text-green-600 dark:text-green-300 break-all",children:typeof T=="object"?JSON.stringify(T,null,2):String(T??"-")})]},R))})})})]}),f.user_agent&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"User Agent"}),e.jsx("p",{className:"text-xs font-mono bg-muted p-2 rounded-md break-all",children:f.user_agent})]})]})]})})]})}const fje=$c("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ns=v.forwardRef(({className:t,variant:n,...r},s)=>e.jsx("div",{ref:s,role:"alert",className:We(fje({variant:n}),t),...r}));Ns.displayName="Alert";const ui=v.forwardRef(({className:t,...n},r)=>e.jsx("h5",{ref:r,className:We("mb-1 font-medium leading-none tracking-tight",t),...n}));ui.displayName="AlertTitle";const Ss=v.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:We("text-sm [&_p]:leading-relaxed",t),...n}));Ss.displayName="AlertDescription";const pje=me.object({member_id:me.string().min(1,"Member is required"),account_type:me.enum(["savings","shares","deposits"]),amount:me.string().min(1,"Amount is required"),payment_method:me.enum(["cash","mpesa","bank_transfer","cheque"]),mpesa_phone:me.string().optional(),reference:me.string().optional()}),xje=me.object({member_id:me.string().min(1,"Member is required"),account_type:me.enum(["savings","shares","deposits"]),amount:me.string().min(1,"Amount is required"),payment_method:me.enum(["cash","mpesa","bank_transfer","cheque"]),reference:me.string().optional()}),gje=me.object({loan_id:me.string().min(1,"Loan is required"),amount:me.string().min(1,"Amount is required"),payment_method:me.enum(["cash","mpesa","bank_transfer","cheque"]),reference:me.string().optional()});function vje({organizationId:t}){const{toast:n}=Xt(),{canRead:r,canWrite:s,isLoading:a}=_r(t,Nr.TELLER_STATION),{isAdmin:i}=wC(t),{hasFeature:o}=Ol(t),{currency:c,symbol:u}=fr(t),m=o("mpesa_integration"),h=o("bank_integration"),[f,x]=v.useState(""),[j,b]=v.useState(null),[g,y]=v.useState("deposit"),[C,k]=v.useState(null),[N,P]=v.useState(null),[w,S]=v.useState(!1),[E,R]=v.useState(()=>{try{return localStorage.getItem(`banky_counter_${t}`)||null}catch{return null}}),[T,U]=v.useState(""),[M,L]=v.useState(!1),{data:q}=$e({queryKey:["/api/organizations",t,"staff","me"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/staff/me`,{credentials:"include"});return se.ok?se.json():null}}),$=r,{data:D}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});return se.ok?se.json():[]},enabled:i});v.useEffect(()=>{D&&D.length===1&&!C&&k(D[0].id)},[D]);const{data:z}=$e({queryKey:["/api/organizations",t,"staff"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/staff`,{credentials:"include"});return se.ok?se.json():[]},enabled:i}),{data:J}=$e({queryKey:["/api/organizations",t,"staff","handover-list"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/staff/tellers`,{credentials:"include"});return se.ok?se.json():[]}}),{data:I,refetch:X}=$e({queryKey:["/api/organizations",t,"floats","active-counters"],queryFn:async()=>{const se=q?.branch_id||C||"",et=await fetch(`/api/organizations/${t}/floats/active-counters?branch_id=${se}`,{credentials:"include"});return et.ok?et.json():[]},enabled:!!(q?.branch_id||C)}),ne=z?.filter(se=>se.role?.toLowerCase()==="teller"&&(!C||se.branch_id===C))||[],W=i&&N?N:q?.id,H=I?.find(se=>se.staff_id===W);v.useEffect(()=>{if(!E&&H){R(H.counter_number);try{localStorage.setItem(`banky_counter_${t}`,H.counter_number)}catch{}}else if(E&&I&&!H&&I.find(et=>et.counter_number===E&&et.staff_id!==W)){R(null);try{localStorage.removeItem(`banky_counter_${t}`)}catch{}}},[H,I,E,W,t]);const{data:fe,isLoading:Pe,isError:Re}=$e({queryKey:["/api/organizations",t,"members"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/members`,{credentials:"include"});if(!se.ok)throw new Error("Failed to fetch members");return se.json()}}),{data:Ie,isLoading:Ce}=$e({queryKey:["/api/organizations",t,"transactions","today",i?N:q?.id],queryFn:async()=>{let se=`/api/organizations/${t}/transactions?today=true`;i&&N?se+=`&teller_id=${N}`:!i&&q?.id&&(se+=`&teller_id=${q.id}`);const et=await fetch(se,{credentials:"include"});if(!et.ok)return[];const Mt=await et.json();return Array.isArray(Mt)?Mt:Mt.items||[]},enabled:i||!!q}),{data:Y}=$e({queryKey:["/api/organizations",t,"loans","active"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/loans?status=disbursed&page_size=100`,{credentials:"include"});if(!se.ok)return[];const et=await se.json();return et.data||et}}),{data:ie,refetch:Ee}=$e({queryKey:["/api/organizations",t,"floats",i&&N?`teller/${N}`:"my"],queryFn:async()=>{const se=i&&N?`/api/organizations/${t}/floats/teller/${N}`:`/api/organizations/${t}/floats/my`,et=await fetch(se,{credentials:"include"});return et.ok?et.json():null}}),{data:Ke=[],refetch:Te}=$e({queryKey:["/api/organizations",t,"queue-tickets",q?.branch_id],queryFn:async()=>{if(!q?.branch_id)return[];const se=await fetch(`/api/organizations/${t}/queue-tickets?branch_id=${q.branch_id}&status=waiting,serving`,{credentials:"include"});return se.ok?se.json():[]},enabled:!!q?.branch_id,refetchInterval:1e4}),ct=Ke.find(se=>se.status==="serving"&&se.teller_id===q?.id),ut=Ke.filter(se=>se.status==="waiting").length,Dt=(se,et)=>{if("speechSynthesis"in window){const Ht=`Ticket number ${se.split("").join(" ")}, please go to counter number ${et}`;window.speechSynthesis.cancel();const on=new SpeechSynthesisUtterance(Ht);on.rate=.9,on.pitch=1,on.volume=1;const Zn=new SpeechSynthesisUtterance(Ht);Zn.rate=.9,Zn.pitch=1,Zn.volume=1,on.onend=()=>{setTimeout(()=>{window.speechSynthesis.speak(Zn)},800)},window.speechSynthesis.speak(on)}},be=Le({mutationFn:async()=>{if(!q?.branch_id)throw new Error("No branch assigned");let se=`/api/organizations/${t}/queue-tickets/call-next?branch_id=${q.branch_id}`;Qr&&(se+=`&counter_number=${encodeURIComponent(Qr)}`);const et=await fetch(se,{method:"POST",credentials:"include"});if(!et.ok)throw new Error((await et.json()).detail||"Failed to call next");return et.json()},onSuccess:se=>{se.success?(n({title:"Calling Customer",description:`Ticket ${se.ticket.ticket_number} - ${se.ticket.member_name||"Guest"}`}),Dt(se.ticket.ticket_number,Qr||se.ticket.counter_number||"1")):n({title:"Queue Empty",description:se.message}),Te()},onError:se=>{n({title:"Error",description:se.message,variant:"destructive"})}}),pt=Le({mutationFn:async se=>{const et=await fetch(`/api/organizations/${t}/queue-tickets/${se}/complete`,{method:"POST",credentials:"include"});if(!et.ok)throw new Error((await et.json()).detail||"Failed to complete");return et.json()},onSuccess:()=>{n({title:"Complete",description:"Customer service completed"}),Te()},onError:se=>{n({title:"Error",description:se.message,variant:"destructive"})}}),te=$n({resolver:Fn(pje),defaultValues:{member_id:"",account_type:"savings",amount:"",payment_method:"cash",mpesa_phone:"",reference:""}}),G=te.watch("payment_method"),[F,Ue]=v.useState(!1);v.useEffect(()=>{G==="mpesa"&&j?.phone&&te.setValue("mpesa_phone",j.phone)},[G,j]);const Z=$n({resolver:Fn(xje),defaultValues:{member_id:"",account_type:"savings",amount:"",payment_method:"cash",reference:""}}),xe=$n({resolver:Fn(gje),defaultValues:{loan_id:"",amount:"",payment_method:"cash",reference:""}}),Ae=async()=>{const se=te.getValues("mpesa_phone"),et=te.getValues("amount");if(!se||!et){n({title:"Please enter phone number and amount",variant:"destructive"});return}Ue(!0);try{const Mt=await Be("POST",`/api/organizations/${t}/mpesa/stk-push`,{phone:se,amount:parseFloat(et),account_reference:j?.member_number||"Deposit",description:`Deposit for ${j?.first_name||"Member"}`}),Ht=await Mt.json();Ht.success||Mt.ok?n({title:"M-Pesa prompt sent! Deposit will reflect automatically once payment is confirmed."}):n({title:Ht.message||"Failed to send M-Pesa prompt",variant:"destructive"})}catch(Mt){n({title:Mt.message||"Failed to initiate M-Pesa",variant:"destructive"})}finally{Ue(!1)}},Je=Le({mutationFn:async se=>Be("POST",`/api/organizations/${t}/transactions`,{...se,amount:parseFloat(se.amount),transaction_type:"deposit",...i&&N?{teller_id:N}:{}}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"transactions"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),Ee(),te.reset(),b(null),n({title:"Deposit recorded successfully"})},onError:se=>{n({title:se.message||"Failed to record deposit",variant:"destructive"})}}),ae=Le({mutationFn:async se=>{const et=parseFloat(se.amount),Mt=ie?.current_balance||0;if(et>Mt)throw new Error(`Insufficient float balance. Available: ${u} ${Mt.toLocaleString()}`);return Be("POST",`/api/organizations/${t}/transactions`,{...se,amount:et,transaction_type:"withdrawal",...i&&N?{teller_id:N}:{}})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"transactions"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),Ee(),Z.reset(),b(null),n({title:"Withdrawal recorded successfully"})},onError:se=>{n({title:se.message||"Failed to record withdrawal",variant:"destructive"})}}),Me=Le({mutationFn:async se=>Be("POST",`/api/organizations/${t}/repayments`,{loan_id:se.loan_id,amount:parseFloat(se.amount),payment_method:se.payment_method,reference:se.reference}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"repayments"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"loans"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"loan-applications"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"members"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"transactions"]}),xe.reset(),n({title:"Loan repayment recorded successfully"})},onError:se=>{n({title:se.message||"Failed to record repayment",variant:"destructive"})}}),lt=fe?.filter(se=>{const et=f.toLowerCase();return se.member_number.toLowerCase().includes(et)||se.first_name.toLowerCase().includes(et)||se.last_name.toLowerCase().includes(et)||se.phone?.toLowerCase().includes(et)||se.email?.toLowerCase().includes(et)||se.id_number?.toLowerCase().includes(et)}).slice(0,5),Zt=se=>{b(se),x(""),te.setValue("member_id",se.id),Z.setValue("member_id",se.id)},sn=Ie?.filter(se=>se.transaction_type==="deposit")||[],_n=Ie?.filter(se=>se.transaction_type==="withdrawal")||[];sn.reduce((se,et)=>se+Number(et.amount),0),_n.reduce((se,et)=>se+Number(et.amount),0);const Ka=j?Y?.filter(se=>se.member_id===j.id&&se.status==="disbursed"):[],[Wa,Fs]=v.useState(!1),[Oo,ta]=v.useState(!1),[Hr,Ls]=v.useState(""),[wi,Is]=v.useState(""),[as,Gr]=v.useState(""),[To,Mo]=v.useState(""),[Vc,na]=v.useState(!1),[nr,wa]=v.useState(null),[ys,Sr]=v.useState(""),[is,ra]=v.useState(""),[Ln,Cr]=v.useState([{action:"deduct",amount:""}]),[qs,_a]=v.useState(""),[sa,Ro]=v.useState(!1),[Ha,Do]=v.useState(""),[Yr,_i]=v.useState(""),[Ni,$o]=v.useState(""),[ce,At]=v.useState(""),{data:$t,refetch:Tn}=$e({queryKey:["/api/organizations",t,"shortages","my"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/shortages/my`,{credentials:"include"});return se.ok?se.json():{shortages:[],total_pending:0,total_held:0,total_outstanding:0}}}),St=Le({mutationFn:async()=>{if(!ie)throw new Error("No float to reconcile");return await(await Be("POST",`/api/organizations/${t}/floats/${ie.id}/reconcile`,{physical_count:parseFloat(Hr),notes:wi,return_to_vault:!0})).json()},onSuccess:se=>{if(Ee(),Tn(),se.requires_approval){if(Fs(!1),se.shortage_id)wa(se.shortage_id);else{const et=$t?.shortages?.find(Mt=>Mt.status==="pending");et&&wa(et.id)}na(!0),n({title:"Shortage Detected - Manager Approval Required",description:`Shortage of ${u} ${Math.abs(se.variance).toLocaleString()} requires manager approval to close the day.`,variant:"destructive"})}else{Fs(!1),Ls(""),Is("");const et=se.variance||0,Mt=et<0?"Shortage":et>0?"Overage":"Balanced";n({title:"Float reconciled successfully",description:`${Mt}: ${u} ${Math.abs(et).toLocaleString()} - Cash returned to vault`})}},onError:()=>{n({title:"Failed to reconcile float",variant:"destructive"})}}),dn=Le({mutationFn:async()=>{if(!nr)throw new Error("No shortage to approve");const se=$t?.shortages?.find(Ht=>Ht.id===nr)?.shortage_amount||0,et=Ln.map(Ht=>({action:Ht.action,amount:parseFloat(Ht.amount)||(Ln.length===1?se:0)}));return await(await Be("POST",`/api/organizations/${t}/shortages/${nr}/approve`,{staff_number:is,pin:ys,distributions:et,notes:qs})).json()},onSuccess:se=>{Ee(),Tn(),na(!1),wa(null),Sr(""),ra(""),Cr([{action:"deduct",amount:""}]),_a(""),Ls(""),Is(""),n({title:"Shortage Approved",description:se.message})},onError:se=>{n({title:"Approval Failed",description:se?.message||"Invalid credentials or insufficient permissions",variant:"destructive"})}}),nt=Le({mutationFn:async()=>{if(!ie)throw new Error("No float to revert");return await(await Be("POST",`/api/organizations/${t}/floats/${ie.id}/reopen`)).json()},onSuccess:()=>{Ee(),Tn(),na(!1),wa(null),Sr(""),ra(""),_a(""),Ls(""),Is(""),n({title:"Reconciliation Reverted",description:"You can now redo the end-of-day reconciliation."})},onError:se=>{n({title:"Revert Failed",description:se?.message||"Failed to revert reconciliation",variant:"destructive"})}}),xn=Le({mutationFn:async()=>Be("POST",`/api/organizations/${t}/floats/my/request-replenishment`,{amount:parseFloat(as),reason:To}),onSuccess:()=>{ta(!1),Gr(""),Mo(""),n({title:"Replenishment request submitted"})},onError:()=>{n({title:"Failed to submit request",variant:"destructive"})}}),{data:En,refetch:Xn}=$e({queryKey:["/api/organizations",t,"shift-handovers","pending"],queryFn:async()=>{const se=await fetch(`/api/organizations/${t}/shift-handovers?status=pending`,{credentials:"include"});return se.ok?se.json():{handovers:[]}}}),ir=En?.handovers?.filter(se=>se.from_staff_id!==q?.id)||[],Bs=En?.handovers?.filter(se=>se.from_staff_id===q?.id)||[],Lr=Le({mutationFn:async se=>Be("POST",`/api/organizations/${t}/shift-handovers/${se}/cancel`),onSuccess:()=>{Ee(),Xn(),n({title:"Handover Cancelled",description:"The pending handover has been cancelled."})},onError:se=>{n({title:"Cancel Failed",description:se?.message||"Failed to cancel handover",variant:"destructive"})}}),kr=Le({mutationFn:async()=>Be("POST",`/api/organizations/${t}/shift-handovers`,{to_staff_id:Ha,amount:parseFloat(Yr),notes:Ni||void 0}),onSuccess:()=>{Ro(!1),Do(""),_i(""),$o(""),At(""),Ee(),Xn(),n({title:"Handover Initiated",description:"Waiting for receiving teller to accept."})},onError:se=>{n({title:"Handover Failed",description:se?.message||"Failed to initiate handover",variant:"destructive"})}}),Mn=Le({mutationFn:async({handoverId:se,action:et,notes:Mt})=>Be("POST",`/api/organizations/${t}/shift-handovers/${se}/acknowledge`,{action:et,notes:Mt}),onSuccess:(se,et)=>{Ee(),Xn(),n({title:et.action==="accept"?"Handover Accepted":"Handover Rejected",description:et.action==="accept"?"Cash has been added to your float.":"The handover has been rejected."})},onError:se=>{n({title:"Action Failed",description:se?.message||"Failed to process handover",variant:"destructive"})}});if(a)return e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(bt,{className:"h-8 w-48"}),e.jsx(bt,{className:"h-64 w-full"})]});if(w&&j)return e.jsx(f6,{organizationId:t,memberId:j.id,onBack:()=>S(!1)});if(!$)return e.jsx("div",{className:"flex flex-col items-center justify-center h-full p-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx(Dd,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Access Restricted"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The Teller Station is only available to staff members with the Teller role. Please contact your administrator if you need access."}),e.jsxs(ze,{variant:"outline",className:"text-sm",children:["Your role: ",q?.role||"Unknown"]})]})});if(i&&(!C||!N)){const se=D?.find(et=>et.id===C);return e.jsx("div",{className:"flex flex-col items-center justify-center h-full p-8",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(oe,{children:[e.jsxs(we,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 p-3 bg-primary/10 rounded-full w-fit",children:e.jsx(xa,{className:"h-8 w-8 text-primary"})}),e.jsx(_e,{className:"text-2xl",children:"Teller Station Setup"}),e.jsx(dt,{children:"Select a branch and teller to operate as before accessing the teller station"})]}),e.jsxs(de,{className:"space-y-6",children:[!(D&&D.length===1)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Branch"}),e.jsxs(Qe,{value:C||"",onValueChange:et=>{k(et||null),P(null)},children:[e.jsx(He,{className:"w-full",children:e.jsx(Xe,{placeholder:"Select a branch"})}),e.jsx(Ge,{children:D?.map(et=>e.jsxs(ee,{value:et.id,children:[et.name," (",et.code,")"]},et.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Teller"}),e.jsxs(Qe,{value:N||"",onValueChange:et=>P(et||null),disabled:!C,children:[e.jsx(He,{className:"w-full",children:e.jsx(Xe,{placeholder:C?"Select a teller":"Select a branch first"})}),e.jsx(Ge,{children:ne.length>0?ne.map(et=>e.jsxs(ee,{value:et.id,children:[et.first_name," ",et.last_name]},et.id)):e.jsxs("div",{className:"px-2 py-4 text-center text-sm text-muted-foreground",children:["No tellers found in ",se?.name||"this branch"]})})]}),C&&ne.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"No tellers are assigned to this branch. Please assign staff with the Teller role first."})]}),C&&N&&e.jsxs(Ns,{children:[e.jsx(yr,{className:"h-4 w-4"}),e.jsx(Ss,{children:"Ready to proceed to the teller station"})]})]})]})})})}const In=i&&N?N:q?.id,or=I?.find(se=>se.staff_id===In),Qr=E||(or?or.counter_number:null);if(!Qr){const se=Mt=>{const Ht=I?.find(on=>on.counter_number===String(Mt));return Ht?Ht.staff_id===In?{mine:!0,name:"You"}:{mine:!1,name:Ht.staff_name||"Another teller"}:null},et=()=>{if(!T.trim())return!1;const Mt=I?.find(Ht=>Ht.counter_number===T.trim());return Mt&&Mt.staff_id!==In};return e.jsx("div",{className:"flex flex-col items-center justify-center h-full p-8",children:e.jsx("div",{className:"w-full max-w-sm",children:e.jsxs(oe,{children:[e.jsxs(we,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 p-3 bg-primary/10 rounded-full w-fit",children:e.jsx(xa,{className:"h-8 w-8 text-primary"})}),e.jsx(_e,{className:"text-2xl",children:"Select Your Counter"}),e.jsx(dt,{children:"Choose your counter number before starting"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[1,2,3,4,5,6,7,8].map(Mt=>{const Ht=se(Mt),on=Ht&&!Ht.mine;return e.jsxs("div",{className:"relative",children:[e.jsx(B,{variant:T===String(Mt)?"default":on?"ghost":"outline",className:`h-12 w-full text-lg font-bold ${on?"opacity-40 cursor-not-allowed line-through":""}`,onClick:()=>!on&&U(String(Mt)),disabled:!!on,children:Mt}),Ht&&e.jsx("span",{className:`absolute -bottom-1 left-0 right-0 text-[10px] text-center truncate px-1 ${Ht.mine?"text-green-600":"text-red-500"}`,children:Ht.name})]},Mt)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(re,{placeholder:"Or type counter number",value:T,onChange:Mt=>U(Mt.target.value),className:"text-center font-medium"})}),et()&&e.jsxs("p",{className:"text-sm text-red-500 text-center",children:["Counter ",T," is already in use by ",I?.find(Mt=>Mt.counter_number===T.trim())?.staff_name||"another teller"]}),e.jsx(B,{className:"w-full",size:"lg",disabled:!T.trim()||!!et()||M,"data-testid":"button-start-teller-station",onClick:async()=>{L(!0);try{const Mt=new URLSearchParams({counter_number:T.trim()});i&&N&&Mt.set("staff_id",N);const Ht=await fetch(`/api/organizations/${t}/floats/set-counter?${Mt.toString()}`,{method:"POST",credentials:"include"});if(!Ht.ok){const on=await Ht.json();n({title:"Counter Unavailable",description:on.detail||"Failed to set counter",variant:"destructive"}),X();return}R(T.trim());try{localStorage.setItem(`banky_counter_${t}`,T.trim())}catch{}X()}catch(Mt){n({title:"Error",description:Mt.message,variant:"destructive"})}finally{L(!1)}},children:M?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Entering Station..."]}):"Start Teller Station"})]})]})})})}return e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-bold",children:"Teller Station"})}),e.jsx(tr,{organizationId:t})]}),i&&e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xa,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(Qe,{value:C||"",onValueChange:se=>{k(se||null),P(null)},children:[e.jsx(He,{className:"w-[180px] h-8 text-xs",children:e.jsx(Xe,{placeholder:"Select branch"})}),e.jsx(Ge,{children:D?.map(se=>e.jsx(ee,{value:se.id,children:se.name},se.id))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(Qe,{value:N||"",onValueChange:se=>P(se||null),disabled:!C,children:[e.jsx(He,{className:"w-[200px] h-8 text-xs",children:e.jsx(Xe,{placeholder:C?"Select teller":"Select branch first"})}),e.jsx(Ge,{children:ne.map(se=>e.jsxs(ee,{value:se.id,children:[se.first_name," ",se.last_name]},se.id))})]})]})]})}),q?.branch_id&&e.jsxs("div",{className:"mb-3 p-2 border rounded-lg flex flex-wrap items-center justify-between gap-2 bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs(ze,{variant:"outline",className:"text-xs font-bold",children:["Counter ",Qr]}),e.jsx(Sx,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Queue:"}),e.jsxs(ze,{variant:"secondary",className:"text-xs",children:[ut," waiting"]})]}),ct?e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-blue-50 dark:bg-blue-950 rounded text-sm",children:[e.jsx(kL,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-bold",children:ct.ticket_number}),e.jsx("span",{className:"text-muted-foreground",children:ct.member_name||"Guest"}),e.jsxs(B,{size:"sm",className:"h-6 text-xs bg-green-600 hover:bg-green-700",onClick:()=>pt.mutate(ct.id),disabled:pt.isPending,children:[e.jsx(yr,{className:"h-3 w-3 mr-1"}),"Done"]})]}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"No customer being served"})]}),e.jsxs(B,{size:"sm",onClick:()=>be.mutate(),disabled:be.isPending||ut===0,className:"h-7 text-xs gap-1",children:[e.jsx(TW,{className:"h-3 w-3"}),be.isPending?"Calling...":"Call Next"]})]}),ie?.status==="pending_approval"?e.jsxs(Ns,{variant:"destructive",className:"mb-4",children:[e.jsx(Dd,{className:"h-4 w-4"}),e.jsxs(ui,{children:["Shortage ",u," ",$t?.total_pending?.toLocaleString()||"0","  Manager Approval Required"]}),e.jsx(Ss,{children:e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(B,{size:"sm",variant:"outline",onClick:()=>{const se=$t?.shortages?.find(et=>et.status==="pending");se&&(wa(se.id),na(!0))},children:"Request Manager Approval"}),e.jsxs(B,{size:"sm",variant:"ghost",onClick:()=>nt.mutate(),disabled:nt.isPending,"data-testid":"button-redo-reconciliation",children:[e.jsx(mi,{className:"h-3 w-3 mr-1"}),nt.isPending?"Reverting...":"Redo Count"]})]})})]}):$t&&$t.total_outstanding>0?e.jsxs(Ns,{variant:"destructive",className:"mb-4",children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsxs(ui,{children:["Outstanding Shortages: ",u," ",$t.total_outstanding.toLocaleString()]}),e.jsx(Ss,{children:$t.total_held>0&&e.jsxs("span",{children:["Held (awaiting resolution): ",u," ",$t.total_held.toLocaleString()]})})]}):null,ir.length>0&&e.jsxs(Ns,{className:"mb-4 border-blue-500/50 bg-blue-50 dark:bg-blue-900/10",children:[e.jsx(ml,{className:"h-4 w-4 text-blue-600"}),e.jsx(ui,{className:"text-blue-700 dark:text-blue-400",children:"Pending Shift Handovers"}),e.jsx(Ss,{children:e.jsx("div",{className:"space-y-2 mt-2",children:ir.map(se=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-background rounded border",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:se.from_staff_name||"Unknown"}),e.jsx("span",{className:"mx-2",children:"wants to hand over"}),e.jsxs("span",{className:"font-bold text-green-600",children:[u," ",se.amount.toLocaleString()]}),se.notes&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",se.notes,")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{size:"sm",variant:"default",onClick:()=>Mn.mutate({handoverId:se.id,action:"accept"}),disabled:Mn.isPending,children:"Accept"}),e.jsx(B,{size:"sm",variant:"outline",onClick:()=>Mn.mutate({handoverId:se.id,action:"reject"}),disabled:Mn.isPending,children:"Reject"})]})]},se.id))})})]}),Bs.length>0&&e.jsxs(Ns,{className:"mb-4 border-amber-500/50 bg-amber-50 dark:bg-amber-900/10",children:[e.jsx(ml,{className:"h-4 w-4 text-amber-600"}),e.jsx(ui,{className:"text-amber-700 dark:text-amber-400",children:"Outgoing Handovers (Pending)"}),e.jsx(Ss,{children:e.jsx("div",{className:"space-y-2 mt-2",children:Bs.map(se=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-background rounded border",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm",children:"Waiting for "}),e.jsx("span",{className:"font-medium",children:se.to_staff_name||"Unknown"}),e.jsx("span",{className:"text-sm",children:" to accept "}),e.jsxs("span",{className:"font-bold text-green-600",children:[u," ",se.amount.toLocaleString()]})]}),e.jsx(B,{size:"sm",variant:"destructive",onClick:()=>Lr.mutate(se.id),disabled:Lr.isPending,children:"Cancel"})]},se.id))})})]}),ie&&e.jsxs("div",{className:"mb-4 p-3 border-2 border-primary/20 bg-primary/5 rounded-lg",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:"Cash Float"}),e.jsx(ze,{variant:ie.status==="open"?"default":ie.status==="pending_approval"?"destructive":"secondary",className:"text-xs",children:ie.status==="open"?"Active":ie.status==="pending_approval"?"Pending Approval":"Reconciled"}),e.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(",Ie?.length||0," transactions today)"]})]}),ie.status==="open"&&s&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:()=>ta(!0),children:"Request Cash"}),e.jsxs(B,{size:"sm",variant:"secondary",className:"h-7 text-xs",onClick:()=>Ro(!0),children:[e.jsx(ml,{className:"h-3 w-3 mr-1"}),"Handover"]}),e.jsxs(B,{size:"sm",variant:"default",className:"h-7 text-xs",onClick:()=>Fs(!0),children:[e.jsx(yr,{className:"h-3 w-3 mr-1"}),"End of Day"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Opening:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[u," ",ie.opening_balance.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Deposits:"}),e.jsxs("span",{className:"ml-1 font-medium text-green-600",children:["+",ie.deposits_in.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Withdrawals:"}),e.jsxs("span",{className:"ml-1 font-medium text-red-600",children:["-",ie.withdrawals_out.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Replenish:"}),e.jsxs("span",{className:"ml-1 font-medium text-blue-600",children:["+",ie.replenishments.toLocaleString()]})]}),e.jsxs("div",{className:"ml-auto bg-background px-3 py-1 rounded border",children:[e.jsx("span",{className:"text-muted-foreground",children:"Balance:"}),e.jsxs("span",{className:"ml-1 font-bold text-primary",children:[u," ",ie.current_balance.toLocaleString()]})]})]})]}),Wa&&ie&&e.jsxs(oe,{className:"mb-6 border-2 border-orange-500/20 bg-orange-50 dark:bg-orange-900/10",children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(yr,{className:"h-5 w-5 text-orange-600"}),"End of Day Reconciliation"]}),e.jsx(dt,{children:"Count your physical cash and close the day"})]}),e.jsx(de,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-4 bg-background rounded-lg border",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expected Cash Balance"}),e.jsxs("p",{className:"text-2xl font-bold",children:[u," ",ie.current_balance.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Opening (",ie.opening_balance.toLocaleString(),") + Deposits (",ie.deposits_in.toLocaleString(),") + Replenishments (",ie.replenishments.toLocaleString(),") - Withdrawals (",ie.withdrawals_out.toLocaleString(),")"]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:["Physical Cash Count (",c,")"]}),e.jsx(re,{type:"number",step:"0.01",placeholder:"Enter counted amount",value:Hr,onChange:se=>Ls(se.target.value)})]}),Hr&&e.jsxs("div",{className:`p-3 rounded-lg ${parseFloat(Hr)===ie.current_balance?"bg-green-100 dark:bg-green-900/20":parseFloat(Hr)<ie.current_balance?"bg-red-100 dark:bg-red-900/20":"bg-yellow-100 dark:bg-yellow-900/20"}`,children:[e.jsx("p",{className:"text-sm font-medium",children:parseFloat(Hr)===ie.current_balance?"Balanced":parseFloat(Hr)<ie.current_balance?"Shortage":"Overage"}),e.jsxs("p",{className:"text-lg font-bold",children:[u," ",Math.abs(parseFloat(Hr)-ie.current_balance).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes (Optional)"}),e.jsx(re,{placeholder:"Any notes about the reconciliation",value:wi,onChange:se=>Is(se.target.value)})]}),e.jsx("div",{className:"p-4 rounded-lg border bg-blue-50 dark:bg-blue-950/30",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(hl,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx("span",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Cash returns to vault automatically"}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:["All remaining cash will be returned to the branch vault. Tomorrow starts fresh with ",u," 0 until a supervisor allocates new float."]})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>Fs(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>St.mutate(),disabled:!Hr||St.isPending,children:St.isPending?"Reconciling...":"Complete Reconciliation"})]})]})]})})]}),Oo&&e.jsxs(oe,{className:"mb-6 border-2 border-blue-500/20 bg-blue-50 dark:bg-blue-900/10",children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(ho,{className:"h-5 w-5 text-blue-600"}),"Request Cash Replenishment"]}),e.jsx(dt,{children:"Request additional cash from your supervisor"})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:["Amount Needed (",c,")"]}),e.jsx(re,{type:"number",step:"0.01",placeholder:"Enter amount",value:as,onChange:se=>Gr(se.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Reason"}),e.jsx(re,{placeholder:"Why do you need more cash?",value:To,onChange:se=>Mo(se.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(B,{variant:"outline",onClick:()=>ta(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>xn.mutate(),disabled:!as||!To||xn.isPending,children:xn.isPending?"Submitting...":"Submit Request"})]})]})]}),!ie&&e.jsx(oe,{className:"mb-6 border-2 border-yellow-500/20 bg-yellow-50 dark:bg-yellow-900/10",children:e.jsx(de,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ys,{className:"h-6 w-6 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"No Cash Float Allocated"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please request a cash float from your supervisor before processing withdrawals."})]})]})})}),i&&!N&&e.jsxs("div",{className:"mb-2 p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md text-sm text-blue-700 dark:text-blue-300",children:["Showing totals for ",e.jsx("strong",{children:"all tellers"})," organization-wide. Select a teller above to see their individual stats."]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(oe,{className:"lg:col-span-1",children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(za,{className:"h-5 w-5"}),"Member Lookup"]}),e.jsx(dt,{children:"Search by name, member number, ID number, phone or email"})]}),e.jsx(de,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(re,{placeholder:"Search member...",value:f,onChange:se=>x(se.target.value)}),f&&lt&&lt.length>0&&e.jsx("div",{className:"border rounded-md divide-y",children:lt.map(se=>e.jsxs("button",{className:"w-full p-3 text-left hover:bg-muted transition-colors",onClick:()=>Zt(se),children:[e.jsxs("div",{className:"font-medium",children:[se.first_name," ",se.last_name]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[se.member_number,"  ",se.phone]})]},se.id))}),Pe&&f&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"Loading members..."}),Re&&e.jsx("div",{className:"text-sm text-destructive text-center py-4",children:'Unable to load members. Your role may need the "Members: Read" permission. Contact your administrator.'}),f&&f.length>=2&&!Pe&&!Re&&(!lt||lt.length===0)&&e.jsxs("div",{className:"text-sm text-muted-foreground text-center py-4",children:['No members found matching "',f,'"']}),j&&e.jsx(oe,{className:"bg-muted/50",children:e.jsxs(de,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:"h-10 w-10 rounded-full bg-primary flex items-center justify-center text-primary-foreground font-bold",children:[j.first_name[0],j.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:[j.first_name," ",j.last_name]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:j.member_number})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Savings:"}),e.jsxs("span",{className:"font-medium",children:[u," ",(j.savings_balance||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Shares:"}),e.jsxs("span",{className:"font-medium",children:[u," ",(j.shares_balance||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Deposits:"}),e.jsxs("span",{className:"font-medium",children:[u," ",(j.deposits_balance||0).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(B,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>S(!0),children:"View Statement"}),e.jsx(B,{variant:"ghost",size:"sm",className:"flex-1",onClick:()=>b(null),children:"Clear"})]})]})})]})})]}),e.jsxs(oe,{className:"lg:col-span-2",children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Quick Transactions"}),e.jsx(dt,{children:"Process member transactions quickly"})]}),e.jsx(de,{children:e.jsxs($s,{value:g,onValueChange:y,children:[e.jsxs(vs,{className:"grid w-full grid-cols-4",children:[e.jsxs(_t,{value:"deposit",className:"flex items-center gap-2",children:[e.jsx(jL,{className:"h-4 w-4"}),"Deposit"]}),e.jsxs(_t,{value:"withdrawal",className:"flex items-center gap-2",children:[e.jsx(Mu,{className:"h-4 w-4"}),"Withdrawal"]}),e.jsxs(_t,{value:"repayment",className:"flex items-center gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"Loan Repayment"]})]}),e.jsxs(Nt,{value:"deposit",className:"mt-4",children:[i&&!N&&e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md text-sm mb-4",children:[e.jsx("strong",{children:"Admin Notice:"})," Please select a teller from the dropdown above before processing transactions. Transactions must be linked to a teller's float for proper cash tracking and accountability."]}),e.jsx(Qn,{...te,children:e.jsxs("form",{onSubmit:te.handleSubmit(se=>Je.mutate(se)),className:"space-y-4",children:[!j&&e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md text-sm",children:"Please select a member from the lookup first"}),j&&e.jsxs("div",{className:"p-3 bg-muted rounded-md",children:[e.jsxs("span",{className:"font-medium",children:[j.first_name," ",j.last_name]}),e.jsxs("span",{className:"text-muted-foreground",children:[" (",j.member_number,")"]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:te.control,name:"account_type",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Account Type"}),e.jsxs(Qe,{onValueChange:se.onChange,value:se.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"savings",children:"Savings"}),e.jsx(ee,{value:"shares",children:"Shares"}),e.jsx(ee,{value:"deposits",children:"Fixed Deposits"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:te.control,name:"amount",render:({field:se})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Amount (",c,")"]}),e.jsx(ye,{children:e.jsx(re,{...se,type:"number",min:"1",placeholder:"0.00"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:te.control,name:"payment_method",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Payment Method"}),e.jsxs(Qe,{onValueChange:se.onChange,value:se.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"cash",children:"Cash"}),m&&e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),h&&e.jsx(ee,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:te.control,name:"reference",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Reference (Optional)"}),e.jsx(ye,{children:e.jsx(re,{...se,placeholder:"Receipt code, cheque no."})}),e.jsx(Ne,{})]})})]}),G==="mpesa"&&e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"M-Pesa Payment"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{control:te.control,name:"mpesa_phone",render:({field:se})=>e.jsxs(ge,{className:"flex-1",children:[e.jsx(ye,{children:e.jsx(re,{...se,placeholder:"Phone number (e.g., 0712345678)"})}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"button",variant:"outline",onClick:Ae,disabled:F||!j,className:"shrink-0",children:F?"Sending...":"Send STK Push"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Send an M-Pesa payment prompt to member's phone, then enter the confirmation code as reference"})]}),s&&G!=="mpesa"?e.jsx(B,{type:"submit",className:"w-full",disabled:!j||Je.isPending||i&&!N,children:Je.isPending?"Processing...":"Record Deposit"}):G==="mpesa"?Je.isPending?e.jsx(B,{className:"w-full",disabled:!0,children:"Processing deposit..."}):null:e.jsxs("div",{className:"p-3 bg-muted rounded-md text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(hl,{className:"h-4 w-4"}),"You don't have permission to process deposits"]})]})})]}),e.jsxs(Nt,{value:"withdrawal",className:"mt-4",children:[i&&!N&&e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md text-sm mb-4",children:[e.jsx("strong",{children:"Admin Notice:"})," Please select a teller from the dropdown above before processing transactions. Transactions must be linked to a teller's float for proper cash tracking and accountability."]}),e.jsx(Qn,{...Z,children:e.jsxs("form",{onSubmit:Z.handleSubmit(se=>ae.mutate(se)),className:"space-y-4",children:[!j&&e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md text-sm",children:"Please select a member from the lookup first"}),j&&e.jsxs("div",{className:"p-3 bg-muted rounded-md",children:[e.jsxs("span",{className:"font-medium",children:[j.first_name," ",j.last_name]}),e.jsxs("span",{className:"text-muted-foreground",children:[" (",j.member_number,")"]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:Z.control,name:"account_type",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Account Type"}),e.jsxs(Qe,{onValueChange:se.onChange,value:se.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsxs(ee,{value:"savings",children:["Savings (Bal: ",u," ",(j?.savings_balance||0).toLocaleString(),")"]}),e.jsxs(ee,{value:"shares",children:["Shares (Bal: ",u," ",(j?.shares_balance||0).toLocaleString(),")"]}),e.jsxs(ee,{value:"deposits",children:["Fixed Deposits (Bal: ",u," ",(j?.deposits_balance||0).toLocaleString(),")"]})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Z.control,name:"amount",render:({field:se})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Amount (",c,")"]}),e.jsx(ye,{children:e.jsx(re,{...se,type:"number",min:"1",placeholder:"0.00"})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:Z.control,name:"payment_method",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Payment Method"}),e.jsxs(Qe,{onValueChange:se.onChange,value:se.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"cash",children:"Cash"}),m&&e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),h&&e.jsx(ee,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Z.control,name:"reference",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Reference (Optional)"}),e.jsx(ye,{children:e.jsx(re,{...se,placeholder:"Receipt code, cheque no."})}),e.jsx(Ne,{})]})})]}),s?e.jsx(B,{type:"submit",className:"w-full",variant:"destructive",disabled:!j||ae.isPending||i&&!N,children:ae.isPending?"Processing...":"Process Withdrawal"}):e.jsxs("div",{className:"p-3 bg-muted rounded-md text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(hl,{className:"h-4 w-4"}),"You don't have permission to process withdrawals"]})]})})]}),e.jsxs(Nt,{value:"repayment",className:"mt-4",children:[i&&!N&&e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md text-sm mb-4",children:[e.jsx("strong",{children:"Admin Notice:"})," Please select a teller from the dropdown above before processing transactions. Transactions must be linked to a teller's float for proper cash tracking and accountability."]}),e.jsx(Qn,{...xe,children:e.jsxs("form",{onSubmit:xe.handleSubmit(se=>Me.mutate(se)),className:"space-y-4",children:[!j&&e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md text-sm",children:"Please select a member from the lookup first to see their active loans"}),j&&Ka&&Ka.length===0&&e.jsx("div",{className:"p-4 bg-muted rounded-md text-sm",children:"This member has no active loans requiring repayment"}),j&&Ka&&Ka.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(je,{control:xe.control,name:"loan_id",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Select Loan"}),e.jsxs(Qe,{onValueChange:se.onChange,value:se.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select a loan"})})}),e.jsx(Ge,{children:Ka.map(et=>e.jsxs(ee,{value:et.id,children:[et.loan_number," - Outstanding: ",u," ",(et.outstanding_balance||0).toLocaleString()]},et.id))})]}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:xe.control,name:"amount",render:({field:se})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Repayment Amount (",c,")"]}),e.jsx(ye,{children:e.jsx(re,{...se,type:"number",min:"1",placeholder:"0.00"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:xe.control,name:"payment_method",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Payment Method"}),e.jsxs(Qe,{onValueChange:se.onChange,value:se.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"cash",children:"Cash"}),m&&e.jsx(ee,{value:"mpesa",children:"M-Pesa"}),h&&e.jsx(ee,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(ee,{value:"cheque",children:"Cheque"})]})]}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:xe.control,name:"reference",render:({field:se})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Reference (Optional)"}),e.jsx(ye,{children:e.jsx(re,{...se,placeholder:"M-Pesa code, receipt no."})}),e.jsx(Ne,{})]})}),s?e.jsx(B,{type:"submit",className:"w-full",disabled:Me.isPending||i&&!N,children:Me.isPending?"Processing...":"Record Repayment"}):e.jsxs("div",{className:"p-3 bg-muted rounded-md text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(hl,{className:"h-4 w-4"}),"You don't have permission to process repayments"]})]})]})})]})]})})]})]}),e.jsxs(oe,{className:"mt-6",children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Ei,{className:"h-5 w-5"}),"Today's Transactions"]}),e.jsx(dt,{children:"Your transactions processed today"})]}),e.jsx(de,{children:Ce?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((se,et)=>e.jsx(bt,{className:"h-12 w-full"},et))}):Ie&&Ie.length>0?e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Transaction #"}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Account"}),e.jsx(Q,{className:"text-right",children:"Amount"}),e.jsx(Q,{children:"Time"})]})}),e.jsx(Pt,{children:Ie.slice(0,10).map(se=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:se.transaction_number}),e.jsx(V,{children:e.jsx(ze,{variant:se.transaction_type==="deposit"?"default":"destructive",children:se.transaction_type})}),e.jsx(V,{className:"capitalize",children:se.account_type}),e.jsxs(V,{className:`text-right font-medium ${se.transaction_type==="deposit"?"text-green-600":"text-red-600"}`,children:[se.transaction_type==="deposit"?"+":"-",u," ",se.amount.toLocaleString()]}),e.jsx(V,{className:"text-muted-foreground",children:new Date(se.created_at).toLocaleTimeString()})]},se.id))})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No transactions processed yet today"})})]})]}),e.jsx(Vt,{open:Vc,onOpenChange:na,children:e.jsxs(It,{className:"sm:max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(Dd,{className:"h-5 w-5 text-orange-600"}),"Manager Shortage Approval"]}),e.jsx(Qt,{children:"Enter your approval PIN and decide how to handle the shortage."})]}),(()=>{const se=$t?.shortages?.find(on=>on.id===nr),et=se?.shortage_amount||0,Mt=Ln.reduce((on,Zn)=>on+(parseFloat(Zn.amount)||0),0),Ht=et-Mt;return e.jsxs("div",{className:"space-y-4 py-4",children:[se&&e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsxs("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:["Total Shortage: ",u," ",et.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-300 mt-1",children:["Date: ",se.date]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"approver-staff-number",children:"Staff Number"}),e.jsx(re,{id:"approver-staff-number",placeholder:"Enter staff number or ADMIN",value:is,onChange:on=>ra(on.target.value),autoFocus:!0,"data-testid":"input-approver-staff-number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"approver-pin",children:"Approval PIN"}),e.jsx(re,{id:"approver-pin",type:"password",inputMode:"numeric",maxLength:6,placeholder:"Enter 4-6 digit PIN",value:ys,onChange:on=>Sr(on.target.value),"data-testid":"input-approver-pin"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Distribution"}),Ln.length<3&&e.jsxs(B,{type:"button",variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>{const on=Ln.map(Na=>Na.action),Zn=["deduct","hold","expense"].find(Na=>!on.includes(Na))||"hold",Ga=Ln.reduce((Na,Wi)=>Na+(parseFloat(Wi.amount)||0),0),Pr=Math.max(0,et-Ga);Cr([...Ln,{action:Zn,amount:Pr>0?Pr.toString():""}])},"data-testid":"button-split-shortage",children:[e.jsx(mn,{className:"h-3 w-3 mr-1"})," Split"]})]}),Ln.map((on,Zn)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Qe,{value:on.action,onValueChange:Ga=>{const Pr=[...Ln];Pr[Zn]={...Pr[Zn],action:Ga},Cr(Pr)},children:[e.jsx(He,{className:"w-[160px]",children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"deduct",children:"Salary Deduction"}),e.jsx(ee,{value:"hold",children:"Hold"}),e.jsx(ee,{value:"expense",children:"Write Off"})]})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:u}),e.jsx(re,{type:"number",inputMode:"decimal",className:"pl-10",placeholder:Ln.length===1?et.toLocaleString():"0",value:on.amount,onChange:Ga=>{const Pr=[...Ln];Pr[Zn]={...Pr[Zn],amount:Ga.target.value},Ln.length===1&&(Pr[0].amount=Ga.target.value||et.toString()),Cr(Pr)},"data-testid":`input-dist-amount-${Zn}`})]}),Ln.length>1&&e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:()=>Cr(Ln.filter((Ga,Pr)=>Pr!==Zn)),children:e.jsx(rs,{className:"h-3 w-3"})})]},Zn)),Ln.length>1&&e.jsx("div",{className:`text-xs ${Math.abs(Ht)<.01?"text-green-600":"text-red-600"} font-medium`,children:Math.abs(Ht)<.01?"Amounts match the shortage total":Ht>0?`${u} ${Ht.toLocaleString()} remaining to allocate`:`${u} ${Math.abs(Ht).toLocaleString()} over-allocated`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"approval-notes",children:"Notes (Optional)"}),e.jsx(re,{id:"approval-notes",placeholder:"Add any notes...",value:qs,onChange:on=>_a(on.target.value)})]})]})})(),e.jsxs("div",{className:"flex flex-col gap-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{na(!1),Sr(""),ra(""),Cr([{action:"deduct",amount:""}]),_a("")},children:"Cancel"}),e.jsx(B,{onClick:()=>dn.mutate(),disabled:!ys||!is||dn.isPending||(()=>{if(Ln.length<=1)return!1;const se=$t?.shortages?.find(Mt=>Mt.id===nr)?.shortage_amount||0,et=Ln.reduce((Mt,Ht)=>Mt+(parseFloat(Ht.amount)||0),0);return Math.abs(et-se)>.01})(),"data-testid":"button-approve-shortage",children:dn.isPending?"Approving...":"Approve & Close Day"})]}),e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>nt.mutate(),disabled:nt.isPending,className:"text-destructive hover:text-destructive w-full","data-testid":"button-reject-redo-count",children:[e.jsx(mi,{className:"h-3 w-3 mr-1"}),nt.isPending?"Reverting...":"Reject & Ask Teller to Recount"]})]})]})}),e.jsx(Vt,{open:sa,onOpenChange:Ro,children:e.jsxs(It,{className:"max-w-md",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(ml,{className:"h-5 w-5"}),"Shift Handover"]}),e.jsx(Qt,{children:"Transfer cash from your float to another teller"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your Current Balance"}),e.jsxs("p",{className:"text-xl font-bold",children:[u," ",ie?.current_balance?.toLocaleString()||0]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Hand Over To"}),Ha?e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md bg-muted",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[(J||[]).find(se=>se.id===Ha)?.first_name," ",(J||[]).find(se=>se.id===Ha)?.last_name]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:(J||[]).find(se=>se.id===Ha)?.email||(J||[]).find(se=>se.id===Ha)?.role})]}),e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>Do(""),children:"Change"})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{placeholder:"Search by name or email...",value:ce,onChange:se=>At(se.target.value)}),ce&&e.jsxs("div",{className:"border rounded-md divide-y max-h-48 overflow-y-auto",children:[(J||[]).filter(se=>{if(se.id===q?.id)return!1;const et=ce.toLowerCase(),Mt=`${se.first_name} ${se.last_name}`.toLowerCase(),Ht=(se.email||"").toLowerCase();return Mt.includes(et)||Ht.includes(et)}).slice(0,5).map(se=>e.jsxs("button",{className:"w-full p-3 text-left hover:bg-muted transition-colors",onClick:()=>{Do(se.id),At("")},children:[e.jsxs("div",{className:"font-medium",children:[se.first_name," ",se.last_name]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[se.role,se.email?`  ${se.email}`:""]})]},se.id)),(J||[]).filter(se=>{if(se.id===q?.id)return!1;const et=ce.toLowerCase(),Mt=`${se.first_name} ${se.last_name}`.toLowerCase(),Ht=(se.email||"").toLowerCase();return Mt.includes(et)||Ht.includes(et)}).length===0&&e.jsx("div",{className:"p-3 text-center text-muted-foreground",children:"No staff found"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Se,{htmlFor:"handover-amount",children:["Amount (",c,")"]}),e.jsx(re,{id:"handover-amount",type:"number",step:"0.01",placeholder:"Enter amount to handover",value:Yr,onChange:se=>_i(se.target.value)}),Yr&&parseFloat(Yr)>(ie?.current_balance||0)&&e.jsx("p",{className:"text-sm text-red-500",children:"Amount exceeds your current balance"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"handover-notes",children:"Notes (Optional)"}),e.jsx(re,{id:"handover-notes",placeholder:"Reason for handover...",value:Ni,onChange:se=>$o(se.target.value)})]})]}),e.jsxs(nn,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{Ro(!1),Do(""),_i(""),$o(""),At("")},children:"Cancel"}),e.jsx(B,{onClick:()=>kr.mutate(),disabled:!Ha||!Yr||parseFloat(Yr)<=0||parseFloat(Yr)>(ie?.current_balance||0)||kr.isPending,children:kr.isPending?"Processing...":"Initiate Handover"})]})]})})]})}const yje=me.object({staff_id:me.string().min(1,"Staff is required"),amount:me.string().min(1,"Amount is required"),notes:me.string().optional()}),jje=me.object({amount:me.string().min(1,"Amount is required"),notes:me.string().optional()}),bje=me.object({branch_id:me.string().min(1,"Branch is required"),amount:me.string().min(1,"Amount is required"),source:me.string().min(1,"Source is required"),reference:me.string().optional(),notes:me.string().optional()});function wje({organizationId:t}){const{toast:n}=Xt(),{canWrite:r}=_r(t,Nr.FLOAT_MANAGEMENT),{currency:s,symbol:a}=fr(t),[i,o]=v.useState(!1),[c,u]=v.useState(!1),[m,h]=v.useState(!1),[f,x]=v.useState(null),[j,b]=v.useState(null),[g,y]=v.useState("floats"),{data:C,isLoading:k}=$e({queryKey:["/api/organizations",t,"floats"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/floats`,{credentials:"include"});return ae.ok?ae.json():[]}}),{data:N}=$e({queryKey:["/api/organizations",t,"staff"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/staff`,{credentials:"include"});return ae.ok?ae.json():[]}}),{data:P,refetch:w}=$e({queryKey:["/api/organizations",t,"floats","pending-requests"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/floats/pending-requests`,{credentials:"include"});return ae.ok?ae.json():[]}}),{data:S,refetch:E}=$e({queryKey:["/api/organizations",t,"vaults"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/vaults`,{credentials:"include"});return ae.ok?ae.json():{vaults:[]}}}),{data:R,refetch:T}=$e({queryKey:["/api/organizations",t,"pending-vault-returns"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/pending-vault-returns`,{credentials:"include"});return ae.ok?ae.json():{pending_returns:[],count:0}}}),{data:U,refetch:M}=$e({queryKey:["/api/organizations",t,"shift-handovers"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/shift-handovers`,{credentials:"include"});return ae.ok?ae.json():{handovers:[]}}}),{data:L,refetch:q}=$e({queryKey:["/api/organizations",t,"daily-cash-position"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/daily-cash-position`,{credentials:"include"});return ae.ok?ae.json():{report_date:"",branches:[],totals:{vault_balance:0,float_allocated:0,deposits_received:0,withdrawals_paid:0,total_cash_in_hand:0}}}}),{data:$}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/branches`,{credentials:"include"});return ae.ok?ae.json():[]}}),{data:D}=$e({queryKey:["/api/organizations",t,"shortages","pending",j],queryFn:async()=>{if(!j)return{shortages:[],total_pending:0,total_held:0,total_outstanding:0};const ae=await fetch(`/api/organizations/${t}/shortages/pending/${j}`,{credentials:"include"});return ae.ok?ae.json():{shortages:[],total_pending:0,total_held:0,total_outstanding:0}},enabled:!!j}),{data:z,isLoading:J}=$e({queryKey:["/api/organizations",t,"shortages","held"],queryFn:async()=>{const ae=await fetch(`/api/organizations/${t}/shortages/held`,{credentials:"include"});return ae.ok?ae.json():{shortages:[],total_held:0}}}),[I,X]=v.useState(null),[ne,W]=v.useState("deduct"),[H,fe]=v.useState(""),[Pe,Re]=v.useState(""),[Ie,Ce]=v.useState(""),Y=Le({mutationFn:async({shortageId:ae,action:Me,pin:lt,staffNumber:Zt,notes:sn})=>Be("POST",`/api/organizations/${t}/shortages/${ae}/approve`,{action:Me,pin:lt,staff_number:Zt,notes:sn}),onSuccess:(ae,Me)=>{const lt=Me.action==="deduct"?"Salary deduction":"Expense write-off";n({title:`${lt} applied successfully`}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"shortages","held"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"floats"]}),X(null),fe(""),Re(""),Ce("")},onError:ae=>{n({title:Vn(ae),variant:"destructive"})}}),ie=$n({resolver:Fn(yje),defaultValues:{staff_id:"",amount:"",notes:""}}),Ee=$n({resolver:Fn(jje),defaultValues:{amount:"",notes:""}}),Ke=$n({resolver:Fn(bje),defaultValues:{branch_id:"",amount:"",source:"",reference:"",notes:""}});v.useEffect(()=>{$&&$.length===1&&!Ke.getValues("branch_id")&&Ke.setValue("branch_id",$[0].id)},[$]);const Te=Le({mutationFn:async ae=>Be("POST",`/api/organizations/${t}/floats/allocate`,{staff_id:ae.staff_id,amount:parseFloat(ae.amount),notes:ae.notes}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"floats"]}),ie.reset(),o(!1),n({title:"Float allocated successfully"})},onError:()=>{n({title:"Failed to allocate float",variant:"destructive"})}}),ct=Le({mutationFn:async ae=>{if(!f)throw new Error("No float selected");return Be("POST",`/api/organizations/${t}/floats/${f.id}/replenish`,{amount:parseFloat(ae.amount),notes:ae.notes})},onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"floats"]}),Ee.reset(),u(!1),x(null),n({title:"Float replenished successfully"})},onError:()=>{n({title:"Failed to replenish float",variant:"destructive"})}}),ut=Le({mutationFn:async ae=>Be("POST",`/api/organizations/${t}/floats/${ae}/reopen`,{}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"floats"]}),n({title:"Float reopened successfully"})},onError:()=>{n({title:"Failed to reopen float",variant:"destructive"})}}),Dt=Le({mutationFn:async ae=>Be("POST",`/api/organizations/${t}/floats/requests/${ae}/approve`,{}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"floats"]}),w(),n({title:"Replenishment approved"})},onError:ae=>{n({title:"Failed to approve request",description:Vn(ae),variant:"destructive"})}}),be=Le({mutationFn:async ae=>Be("POST",`/api/organizations/${t}/floats/requests/${ae}/reject`,{}),onSuccess:()=>{w(),n({title:"Request rejected"})},onError:ae=>{n({title:"Failed to reject request",description:Vn(ae),variant:"destructive"})}}),pt=Le({mutationFn:async ae=>Be("POST",`/api/organizations/${t}/vaults/deposit`,{branch_id:ae.branch_id,amount:parseFloat(ae.amount),source:ae.source,reference:ae.reference,notes:ae.notes}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"vaults"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"daily-cash-position"]}),Ke.reset(),h(!1),n({title:"Vault deposit recorded successfully"})},onError:()=>{n({title:"Failed to record vault deposit",variant:"destructive"})}}),te=Le({mutationFn:async ae=>Be("POST",`/api/organizations/${t}/pending-vault-returns/${ae}/review`,{action:"accept"}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"vaults"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"floats"]}),T(),q(),n({title:"Vault return accepted - vault balance updated"})},onError:()=>{n({title:"Failed to accept vault return",variant:"destructive"})}}),G=Le({mutationFn:async ae=>Be("POST",`/api/organizations/${t}/pending-vault-returns/${ae}/review`,{action:"reject",notes:"Rejected by manager"}),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"floats"]}),T(),n({title:"Vault return rejected - teller can reconcile again"})},onError:()=>{n({title:"Failed to reject vault return",variant:"destructive"})}}),F=N?.filter(ae=>ae.role==="teller")||[],Ue=C?.reduce((ae,Me)=>ae+Me.current_balance,0)||0,Z=C?.reduce((ae,Me)=>ae+Me.deposits_in,0)||0,xe=C?.reduce((ae,Me)=>ae+Me.withdrawals_out,0)||0;if(k)return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(bt,{className:"h-8 w-48"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(ae=>e.jsx(bt,{className:"h-24"},ae))}),e.jsx(bt,{className:"h-64"})]});const Ae=R?.count||0,Je=P?.length||0;return e.jsxs("div",{className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold tracking-tight",children:"Float Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage teller floats, vault cash, and daily operations"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(tr,{organizationId:t}),r&&e.jsxs(Vt,{open:m,onOpenChange:h,children:[e.jsx(lo,{asChild:!0,children:e.jsxs(B,{variant:"outline",children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Add to Vault"]})}),e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Add Money to Vault"}),e.jsx(Qt,{children:"Record a cash deposit to a branch vault"})]}),e.jsx(Qn,{...Ke,children:e.jsxs("form",{onSubmit:Ke.handleSubmit(ae=>pt.mutate(ae)),className:"space-y-4",children:[!($&&$.length===1)&&e.jsx(je,{control:Ke.control,name:"branch_id",render:({field:ae})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Branch"}),e.jsxs(Qe,{onValueChange:ae.onChange,value:ae.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select branch"})})}),e.jsx(Ge,{children:$?.map(Me=>e.jsx(ee,{value:Me.id,children:Me.name},Me.id))})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Ke.control,name:"amount",render:({field:ae})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Amount (",s,")"]}),e.jsx(ye,{children:e.jsx(re,{type:"number",step:"0.01",placeholder:"0.00",...ae})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Ke.control,name:"source",render:({field:ae})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Source"}),e.jsxs(Qe,{onValueChange:ae.onChange,value:ae.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select source"})})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"bank_withdrawal",children:"Bank Withdrawal"}),e.jsx(ee,{value:"head_office",children:"Head Office Transfer"}),e.jsx(ee,{value:"safe",children:"Safe"}),e.jsx(ee,{value:"other",children:"Other"})]})]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Ke.control,name:"reference",render:({field:ae})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Reference (Optional)"}),e.jsx(ye,{children:e.jsx(re,{placeholder:"Bank slip no., receipt no.",...ae})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Ke.control,name:"notes",render:({field:ae})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Notes (Optional)"}),e.jsx(ye,{children:e.jsx(fn,{placeholder:"Any additional notes...",...ae})}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full",disabled:pt.isPending,children:pt.isPending?"Recording...":"Record Vault Deposit"})]})})]})]}),r&&e.jsxs(Vt,{open:i,onOpenChange:o,children:[e.jsx(lo,{asChild:!0,children:e.jsxs(B,{children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Allocate Float"]})}),e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Allocate Cash Float"}),e.jsx(Qt,{children:"Allocate cash to a teller for the day"})]}),e.jsx(Qn,{...ie,children:e.jsxs("form",{onSubmit:ie.handleSubmit(ae=>Te.mutate(ae)),className:"space-y-4",children:[e.jsx(je,{control:ie.control,name:"staff_id",render:({field:ae})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Teller"}),e.jsxs(Qe,{onValueChange:Me=>{ae.onChange(Me),b(Me)},value:ae.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select teller"})})}),e.jsx(Ge,{children:F.map(Me=>e.jsxs(ee,{value:Me.id,children:[Me.first_name," ",Me.last_name," (",Me.staff_number,")"]},Me.id))})]}),e.jsx(Ne,{})]})}),D&&D.total_outstanding>0&&e.jsxs(Ns,{variant:"destructive",children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsx(ui,{children:"Outstanding Shortages Warning"}),e.jsxs(Ss,{children:["This teller has outstanding cash shortages totaling"," ",e.jsxs("strong",{children:[a," ",D.total_outstanding.toLocaleString()]}),".",D.total_pending>0&&e.jsxs("span",{className:"block mt-1",children:["Pending approval: ",a," ",D.total_pending.toLocaleString()]}),D.total_held>0&&e.jsxs("span",{className:"block mt-1",children:["Held (unresolved): ",a," ",D.total_held.toLocaleString()]})]})]}),e.jsx(je,{control:ie.control,name:"amount",render:({field:ae})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Amount (",s,")"]}),e.jsx(ye,{children:e.jsx(re,{type:"number",step:"0.01",placeholder:"0.00",...ae})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:ie.control,name:"notes",render:({field:ae})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Notes (Optional)"}),e.jsx(ye,{children:e.jsx(fn,{placeholder:"Any notes...",...ae})}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full",disabled:Te.isPending,children:Te.isPending?"Allocating...":"Allocate Float"})]})})]})]})]})]}),e.jsxs($s,{value:g,onValueChange:y,className:"space-y-4",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0 px-4 md:px-0",children:e.jsxs(vs,{className:"inline-flex w-auto min-w-full md:grid md:w-full md:grid-cols-6 h-auto flex-nowrap",children:[e.jsxs(_t,{value:"floats",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(Ys,{className:"h-4 w-4 shrink-0"}),"Floats"]}),e.jsxs(_t,{value:"vault",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(Yn,{className:"h-4 w-4 shrink-0"}),"Vault"]}),e.jsxs(_t,{value:"pending",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap relative",children:[e.jsx(bn,{className:"h-4 w-4 shrink-0"}),"Pending",Ae+Je>0&&e.jsx(ze,{variant:"destructive",className:"ml-1 h-5 w-5 p-0 flex items-center justify-center text-xs",children:Ae+Je})]}),e.jsxs(_t,{value:"held",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap relative","data-testid":"tab-held-shortages",children:[e.jsx(Es,{className:"h-4 w-4 shrink-0"}),"Held",(z?.shortages?.length??0)>0&&e.jsx(ze,{variant:"destructive",className:"ml-1 h-5 w-5 p-0 flex items-center justify-center text-xs",children:z?.shortages?.length})]}),e.jsxs(_t,{value:"handovers",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(ml,{className:"h-4 w-4 shrink-0"}),"Handovers"]}),e.jsxs(_t,{value:"report",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(tn,{className:"h-4 w-4 shrink-0"}),"Report"]})]})}),e.jsxs(Nt,{value:"floats",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 grid-cols-2 md:grid-cols-4",children:[e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Total Float Allocated"}),e.jsx(Ys,{className:"h-4 w-4 text-primary shrink-0"})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a," ",Ue.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[C?.length||0," active tellers"]})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Today's Deposits"}),e.jsx(ho,{className:"h-4 w-4 text-green-600 shrink-0"})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[a," ",Z.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cash received"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Today's Withdrawals"}),e.jsx(Mu,{className:"h-4 w-4 text-red-600 shrink-0"})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[a," ",xe.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cash paid out"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Pending Requests"}),e.jsx(bn,{className:"h-4 w-4 text-yellow-600 shrink-0"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:P?.length||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]})]}),P&&P.length>0&&e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(bn,{className:"h-5 w-5 text-yellow-600"}),"Pending Replenishment Requests"]}),e.jsx(dt,{children:"Approve or reject float replenishment requests from tellers"})]}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Teller"}),e.jsx(Q,{children:"Requested Amount"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Current Balance"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Reason"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Requested At"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:P.map(ae=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:ae.staff_name}),e.jsxs(V,{children:[a," ",ae.amount.toLocaleString()]}),e.jsxs(V,{className:"hidden sm:table-cell",children:[a," ",ae.current_balance.toLocaleString()]}),e.jsx(V,{className:"max-w-[200px] truncate hidden md:table-cell",children:ae.reason}),e.jsx(V,{className:"hidden md:table-cell",children:new Date(ae.created_at).toLocaleString()}),e.jsx(V,{className:"text-right",children:r&&e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>Dt.mutate(ae.id),disabled:Dt.isPending,children:[e.jsx(yr,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(B,{size:"sm",variant:"destructive",onClick:()=>be.mutate(ae.id),disabled:be.isPending,children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},ae.id))})]})})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(pn,{className:"h-5 w-5"}),"Today's Teller Floats"]}),e.jsx(dt,{children:"View and manage all teller cash floats for today"})]}),e.jsx(de,{children:C&&C.length>0?e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Teller"}),e.jsx(Q,{children:"Branch"}),e.jsx(Q,{children:"Opening"}),e.jsx(Q,{children:"Deposits"}),e.jsx(Q,{children:"Withdrawals"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Replenishments"}),e.jsx(Q,{children:"Current Balance"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:C.map(ae=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:ae.staff_name}),e.jsx(V,{children:ae.branch_name}),e.jsxs(V,{children:[a," ",ae.opening_balance.toLocaleString()]}),e.jsxs(V,{className:"text-green-600",children:["+",ae.deposits_in.toLocaleString()]}),e.jsxs(V,{className:"text-red-600",children:["-",ae.withdrawals_out.toLocaleString()]}),e.jsxs(V,{className:"text-blue-600 hidden md:table-cell",children:["+",ae.replenishments.toLocaleString()]}),e.jsxs(V,{className:"font-semibold",children:[a," ",ae.current_balance.toLocaleString()]}),e.jsx(V,{children:e.jsx(ze,{variant:ae.status==="open"?"default":ae.status==="pending_approval"?"destructive":ae.status==="pending_vault_return"?"outline":"secondary",children:ae.status==="open"?"Active":ae.status==="pending_approval"?"Shortage - Pending Approval":ae.status==="pending_vault_return"?"Pending Vault Return":"Reconciled"})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[r&&ae.status==="open"&&e.jsxs(Vt,{open:c&&f?.id===ae.id,onOpenChange:Me=>{u(Me),x(Me?ae:null)},children:[e.jsx(lo,{asChild:!0,children:e.jsxs(B,{size:"sm",variant:"outline",children:[e.jsx(mi,{className:"h-4 w-4 mr-1"}),"Replenish"]})}),e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Replenish Float"}),e.jsxs(Qt,{children:["Add cash to ",ae.staff_name,"'s float"]})]}),e.jsx("div",{className:"py-2 px-3 bg-muted rounded-lg mb-4",children:e.jsxs("p",{className:"text-sm",children:["Current Balance: ",e.jsxs("span",{className:"font-semibold",children:[a," ",ae.current_balance.toLocaleString()]})]})}),e.jsx(Qn,{...Ee,children:e.jsxs("form",{onSubmit:Ee.handleSubmit(Me=>ct.mutate(Me)),className:"space-y-4",children:[e.jsx(je,{control:Ee.control,name:"amount",render:({field:Me})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Amount to Add (",s,")"]}),e.jsx(ye,{children:e.jsx(re,{type:"number",step:"0.01",placeholder:"0.00",...Me})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Ee.control,name:"notes",render:({field:Me})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Notes (Optional)"}),e.jsx(ye,{children:e.jsx(fn,{placeholder:"Reason for replenishment...",...Me})}),e.jsx(Ne,{})]})}),e.jsx(B,{type:"submit",className:"w-full",disabled:ct.isPending,children:ct.isPending?"Processing...":"Replenish Float"})]})})]})]}),r&&ae.status!=="open"&&e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>ut.mutate(ae.id),disabled:ut.isPending,children:[e.jsx(mi,{className:"h-4 w-4 mr-1"}),"Reopen"]})]})})]},ae.id))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ys,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No floats allocated today"}),e.jsx("p",{className:"text-sm",children:"Allocate cash floats to tellers to get started"})]})})]})]}),e.jsxs(Nt,{value:"vault",className:"space-y-4",children:[e.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3",children:S?.vaults?.map(ae=>e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:ae.branch_name}),e.jsx(Yn,{className:"h-4 w-4 text-primary shrink-0"})]}),e.jsxs(de,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[a," ",ae.current_balance.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:ae.last_updated?`Updated: ${new Date(ae.last_updated).toLocaleString()}`:"No transactions yet"})]})]},ae.id))}),(!S?.vaults||S.vaults.length===0)&&e.jsx(oe,{children:e.jsxs(de,{className:"py-8 text-center text-muted-foreground",children:[e.jsx(Yn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No branch vaults found"}),e.jsx("p",{className:"text-sm",children:"Create branches to start managing vault cash"})]})})]}),e.jsxs(Nt,{value:"pending",className:"space-y-4",children:[Ae>0&&e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(bn,{className:"h-5 w-5 text-orange-500"}),"Pending Vault Returns (",Ae,")"]}),e.jsx(dt,{children:"Tellers waiting for vault return approval"})]}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Teller"}),e.jsx(Q,{children:"Branch"}),e.jsx(Q,{children:"Amount"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Requested"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:R?.pending_returns?.map(ae=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:ae.staff_name}),e.jsx(V,{children:ae.branch_name}),e.jsxs(V,{className:"font-semibold",children:[a," ",ae.amount.toLocaleString()]}),e.jsx(V,{className:"hidden sm:table-cell",children:new Date(ae.created_at).toLocaleString()}),e.jsx(V,{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:r&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>te.mutate(ae.id),disabled:te.isPending,children:[e.jsx(yr,{className:"h-4 w-4 mr-1"}),"Accept"]}),e.jsxs(B,{size:"sm",variant:"destructive",onClick:()=>G.mutate(ae.id),disabled:G.isPending,children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})})]},ae.id))})]})})})]}),Je>0&&e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(ho,{className:"h-5 w-5 text-blue-500"}),"Cash Replenishment Requests (",Je,")"]}),e.jsx(dt,{children:"Tellers requesting additional cash"})]}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Teller"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Current Balance"}),e.jsx(Q,{children:"Requested"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Reason"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:P?.map(ae=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:ae.staff_name}),e.jsxs(V,{className:"hidden sm:table-cell",children:[a," ",ae.current_balance.toLocaleString()]}),e.jsxs(V,{className:"font-semibold",children:[a," ",ae.amount.toLocaleString()]}),e.jsx(V,{className:"hidden md:table-cell",children:ae.reason}),e.jsx(V,{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:r&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>Dt.mutate(ae.id),disabled:Dt.isPending,children:[e.jsx(yr,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(B,{size:"sm",variant:"destructive",onClick:()=>be.mutate(ae.id),disabled:be.isPending,children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})})]},ae.id))})]})})})]}),Ae===0&&Je===0&&e.jsx(oe,{children:e.jsxs(de,{className:"py-8 text-center text-muted-foreground",children:[e.jsx(yr,{className:"h-12 w-12 mx-auto mb-4 opacity-50 text-green-500"}),e.jsx("p",{children:"No pending approvals"}),e.jsx("p",{className:"text-sm",children:"All vault returns and requests have been processed"})]})})]}),e.jsx(Nt,{value:"held",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5"}),"Held Shortages"]}),e.jsx(dt,{children:"Shortages placed on hold awaiting manager resolution. You can deduct from salary or write off as expense."})]}),e.jsx(de,{children:J?e.jsxs("div",{className:"space-y-3",children:[e.jsx(bt,{className:"h-10 w-full"}),e.jsx(bt,{className:"h-10 w-full"})]}):z?.shortages?.length?e.jsxs("div",{className:"space-y-4",children:[z.total_held>0&&e.jsxs(Ns,{children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsx(ui,{children:"Total Held"}),e.jsxs(Ss,{children:[a," ",z.total_held.toLocaleString()," across ",z.shortages.length," shortage(s)"]})]}),e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Date"}),e.jsx(Q,{children:"Teller"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Branch"}),e.jsx(Q,{children:"Amount"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Notes"}),e.jsx(Q,{children:"Action"})]})}),e.jsx(Pt,{children:z.shortages.map(ae=>e.jsxs(qe,{"data-testid":`row-held-shortage-${ae.id}`,children:[e.jsx(V,{children:new Date(ae.date).toLocaleDateString()}),e.jsx(V,{className:"font-medium",children:ae.staff_name}),e.jsx(V,{className:"hidden sm:table-cell",children:ae.branch_name||"-"}),e.jsxs(V,{className:"font-bold text-destructive",children:[a," ",ae.shortage_amount.toLocaleString()]}),e.jsx(V,{className:"text-muted-foreground text-sm max-w-[200px] truncate hidden md:table-cell",children:ae.notes||"-"}),e.jsx(V,{children:e.jsxs(Vt,{open:I===ae.id,onOpenChange:Me=>{Me||X(null)},children:[e.jsx(lo,{asChild:!0,children:e.jsx(B,{size:"sm",onClick:()=>{X(ae.id),W("deduct"),fe(""),Re(""),Ce("")},"data-testid":`button-resolve-${ae.id}`,children:"Resolve"})}),e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Resolve Held Shortage"}),e.jsxs(Qt,{children:[ae.staff_name," - ",a," ",ae.shortage_amount.toLocaleString()," on ",new Date(ae.date).toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Resolution"}),e.jsxs(Qe,{value:ne,onValueChange:W,children:[e.jsx(He,{"data-testid":"select-resolve-action",children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"deduct",children:"Deduct from Salary"}),e.jsx(ee,{value:"expense",children:"Write Off as Expense"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Your Staff Number"}),e.jsx(re,{value:Pe,onChange:Me=>Re(Me.target.value),placeholder:"Enter your staff number","data-testid":"input-resolve-staff-number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Approval PIN"}),e.jsx(re,{type:"password",value:H,onChange:Me=>fe(Me.target.value),placeholder:"Enter your PIN","data-testid":"input-resolve-pin"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes (optional)"}),e.jsx(fn,{value:Ie,onChange:Me=>Ce(Me.target.value),placeholder:"Add notes about the resolution","data-testid":"input-resolve-notes"})]}),e.jsx(B,{className:"w-full",disabled:!H||Y.isPending,onClick:()=>Y.mutate({shortageId:ae.id,action:ne,pin:H,staffNumber:Pe,notes:Ie}),"data-testid":"button-confirm-resolve",children:Y.isPending?"Processing...":ne==="deduct"?"Deduct from Salary":"Write Off as Expense"})]})]})]})})]},ae.id))})]})})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Es,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No held shortages"}),e.jsx("p",{className:"text-sm mt-1",children:"All shortages have been resolved"})]})})]})}),e.jsx(Nt,{value:"handovers",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(ml,{className:"h-5 w-5"}),"Shift Handovers"]}),e.jsx(dt,{children:"Recent shift handovers between tellers"})]}),e.jsx(de,{children:U?.handovers&&U.handovers.length>0?e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"From"}),e.jsx(Q,{children:"To"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Branch"}),e.jsx(Q,{children:"Amount"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Date"})]})}),e.jsx(Pt,{children:U.handovers.map(ae=>e.jsxs(qe,{children:[e.jsx(V,{children:ae.from_staff_name||"Unknown"}),e.jsx(V,{children:ae.to_staff_name||"Unknown"}),e.jsx(V,{className:"hidden sm:table-cell",children:ae.branch_name||"Unknown"}),e.jsxs(V,{className:"font-semibold",children:[a," ",ae.amount.toLocaleString()]}),e.jsx(V,{children:e.jsx(ze,{variant:ae.status==="accepted"?"default":ae.status==="rejected"?"destructive":"secondary",children:ae.status})}),e.jsx(V,{className:"hidden sm:table-cell",children:new Date(ae.created_at).toLocaleString()})]},ae.id))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ml,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No shift handovers yet"}),e.jsx("p",{className:"text-sm",children:"Tellers can initiate handovers from their Teller Station"})]})})]})}),e.jsx(Nt,{value:"report",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"h-5 w-5 shrink-0"}),"Daily Cash Position Report"]}),e.jsx(dt,{children:L?.report_date?`Report for ${new Date(L.report_date).toLocaleDateString()}`:"Today's cash position"})]}),e.jsxs(B,{variant:"outline",onClick:()=>q(),children:[e.jsx(mi,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),e.jsxs(de,{children:[L?.totals&&e.jsxs("div",{className:"grid gap-4 grid-cols-2 sm:grid-cols-3 md:grid-cols-5 mb-6",children:[e.jsx(oe,{className:"bg-blue-50 dark:bg-blue-900/20",children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Vault"}),e.jsxs("div",{className:"text-xl font-bold",children:[a," ",L.totals.vault_balance.toLocaleString()]})]})}),e.jsx(oe,{className:"bg-green-50 dark:bg-green-900/20",children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Float Allocated"}),e.jsxs("div",{className:"text-xl font-bold",children:[a," ",L.totals.float_allocated.toLocaleString()]})]})}),e.jsx(oe,{className:"bg-purple-50 dark:bg-purple-900/20",children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Deposits"}),e.jsxs("div",{className:"text-xl font-bold",children:[a," ",L.totals.deposits_received.toLocaleString()]})]})}),e.jsx(oe,{className:"bg-orange-50 dark:bg-orange-900/20",children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Withdrawals"}),e.jsxs("div",{className:"text-xl font-bold",children:[a," ",L.totals.withdrawals_paid.toLocaleString()]})]})}),e.jsx(oe,{className:"bg-emerald-50 dark:bg-emerald-900/20",children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Cash"}),e.jsxs("div",{className:"text-xl font-bold",children:[a," ",L.totals.total_cash_in_hand.toLocaleString()]})]})})]}),L?.branches&&L.branches.length>0?e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Branch"}),e.jsx(Q,{children:"Vault"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Float"}),e.jsx(Q,{children:"Deposits"}),e.jsx(Q,{children:"Withdrawals"}),e.jsx(Q,{children:"Total Cash"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Tellers"})]})}),e.jsx(Pt,{children:L.branches.map(ae=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:ae.branch_name}),e.jsxs(V,{children:[a," ",ae.vault_balance.toLocaleString()]}),e.jsxs(V,{className:"hidden sm:table-cell",children:[a," ",ae.float_allocated.toLocaleString()]}),e.jsxs(V,{className:"text-green-600",children:["+",a," ",ae.deposits_received.toLocaleString()]}),e.jsxs(V,{className:"text-red-600",children:["-",a," ",ae.withdrawals_paid.toLocaleString()]}),e.jsxs(V,{className:"font-bold",children:[a," ",ae.total_cash_in_hand.toLocaleString()]}),e.jsx(V,{className:"hidden sm:table-cell",children:ae.teller_count})]},ae.branch_id))})]})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(tn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No data available for today"})]})]})]})})]})]})}const xF=[{id:"transactions",label:"Transactions",description:"Deposits, Withdrawals, Loan Payments",prefix:"T",icon:xa,color:"bg-green-500 hover:bg-green-600"},{id:"loans",label:"Loans",description:"Loan Applications & Inquiries",prefix:"L",icon:tn,color:"bg-purple-500 hover:bg-purple-600"},{id:"account_opening",label:"Account Opening",description:"New Member Registration",prefix:"A",icon:Cx,color:"bg-teal-500 hover:bg-teal-600"},{id:"inquiries",label:"Inquiries",description:"General Questions",prefix:"I",icon:vW,color:"bg-orange-500 hover:bg-orange-600"}];function _je({organizationId:t,organizationName:n,branchId:r,branchName:s,isAdmin:a,onBack:i,onLogout:o}){const{toast:c}=Xt(),[u,m]=v.useState(r||null),{data:h}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const b=await(await Be("GET",`/api/organizations/${t}/branches`)).json();return Array.isArray(b)?b:[]},enabled:!r});v.useEffect(()=>{!r&&h&&h.length===1&&!u&&m(h[0].id)},[h,r]);const f=r||u;s||h?.find(j=>j.id===u)?.name;const x=Le({mutationFn:async j=>await(await Be("POST",`/api/organizations/${t}/queue-tickets`,{branch_id:f,service_category:j,priority:0})).json(),onSuccess:j=>{const g=`
        <html>
          <head>
            <title>Queue Ticket</title>
            <style>
              body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
              .ticket { border: 2px dashed #333; padding: 30px; max-width: 300px; margin: 0 auto; }
              .ticket-number { font-size: 72px; font-weight: bold; margin: 20px 0; }
              .service { font-size: 24px; color: #666; margin-bottom: 20px; }
              .date { font-size: 12px; margin-top: 20px; }
            </style>
          </head>
          <body>
            <div class="ticket">
              <div class="service">${xF.find(C=>C.id===j.service_category)?.label||j.service_category}</div>
              <div class="ticket-number">${j.ticket_number}</div>
              <div class="date">${new Date().toLocaleString()}</div>
            </div>
          </body>
        </html>
      `,y=window.open("","_blank");y&&(y.document.write(g),y.document.close(),y.print())},onError:()=>{c({title:"Failed to generate ticket",variant:"destructive"})}});return x.isPending?e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-primary/10 to-primary/5 flex items-center justify-center p-4",children:e.jsx(oe,{className:"w-full max-w-sm sm:max-w-md text-center",children:e.jsxs(de,{className:"p-8 sm:p-12 space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"animate-spin h-12 w-12 sm:h-16 sm:w-16 border-4 border-primary border-t-transparent rounded-full mx-auto"}),e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-primary",children:"Please wait..."}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground",children:"Generating your ticket"})]})})}):f?e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-primary/10 to-primary/5 flex flex-col z-50",children:[e.jsx("div",{className:"border-b bg-card/80 backdrop-blur",children:e.jsxs("div",{className:"flex items-center justify-between p-2 px-3",children:[e.jsx("div",{className:"w-16 sm:w-20",children:a&&i?e.jsxs(B,{variant:"ghost",size:"sm",onClick:i,className:"h-8 px-2 text-xs",children:[e.jsx($r,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}):null}),e.jsxs("div",{className:"flex-1 text-center py-2 sm:py-3",children:[e.jsxs("h1",{className:"text-base sm:text-xl md:text-2xl font-bold text-primary",children:["Welcome to ",n||"Our Organization"]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Select a service for your queue ticket"})]}),e.jsx("div",{className:"w-16 sm:w-20 flex justify-end",children:!a&&o?e.jsxs(B,{variant:"ghost",size:"sm",onClick:o,className:"h-8 px-2 text-xs",children:[e.jsx(Rd,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]}):null})]})}),e.jsx("div",{className:"flex-1 p-4 sm:p-6 md:p-8 flex items-center justify-center overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 md:gap-6 max-w-3xl w-full",children:xF.map(j=>{const b=j.icon;return e.jsxs("button",{onClick:()=>x.mutate(j.id),disabled:x.isPending,className:`${j.color} text-white rounded-xl sm:rounded-2xl p-4 sm:p-6 md:p-8 flex flex-col items-center justify-center gap-2 sm:gap-3 transition-all transform hover:scale-105 active:scale-95 shadow-lg disabled:opacity-50 min-h-[120px] sm:min-h-[160px] md:min-h-[200px]`,children:[e.jsx(b,{className:"h-8 w-8 sm:h-10 sm:w-10 md:h-14 md:w-14"}),e.jsx("span",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:j.label}),e.jsx("span",{className:"text-xs sm:text-sm opacity-90 text-center",children:j.description})]},j.id)})})}),e.jsxs("div",{className:"p-4 text-center text-muted-foreground text-sm border-t bg-card/80 backdrop-blur",children:[e.jsx(bn,{className:"h-4 w-4 inline-block mr-2"}),new Date().toLocaleDateString()," ",new Date().toLocaleTimeString()]})]}):e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-primary/10 to-primary/5 flex items-center justify-center p-4",children:e.jsx(oe,{className:"w-full max-w-sm sm:max-w-md",children:e.jsxs(de,{className:"p-6 sm:p-8 space-y-4 sm:space-y-6 text-center",children:[e.jsx(Yn,{className:"h-12 w-12 sm:h-16 sm:w-16 mx-auto text-primary"}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:"Select Branch"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Please select a branch to continue"}),e.jsxs(Qe,{onValueChange:j=>m(j),children:[e.jsx(He,{className:"w-full",children:e.jsx(Xe,{placeholder:"Select a branch"})}),e.jsx(Ge,{children:h?.map(j=>e.jsx(ee,{value:j.id,children:j.name},j.id))})]})]})})})}const gF=[{id:"transactions",label:"Transactions",color:"bg-green-500"},{id:"loans",label:"Loans",color:"bg-purple-500"},{id:"account_opening",label:"Account Opening",color:"bg-teal-500"},{id:"inquiries",label:"Inquiries",color:"bg-orange-500"}],Nje={transactions:"bg-green-500",loans:"bg-purple-500",account_opening:"bg-teal-500",inquiries:"bg-orange-500",deposits:"bg-green-500",withdrawals:"bg-green-500",loan_payments:"bg-green-500"},Sje={transactions:"Transactions",loans:"Loans",account_opening:"Account Opening",inquiries:"Inquiries",deposits:"Transactions",withdrawals:"Transactions",loan_payments:"Transactions"};function Cje({organizationId:t,organizationName:n,branchId:r,branchName:s,isAdmin:a,onBack:i,onLogout:o}){const[c,u]=v.useState(null),[m,h]=v.useState(new Date),[f,x]=v.useState(r||null);v.useEffect(()=>{const N=setInterval(()=>h(new Date),1e3);return()=>clearInterval(N)},[]);const{data:j}=$e({queryKey:["/api/organizations",t,"branches"],queryFn:async()=>{const P=await(await Be("GET",`/api/organizations/${t}/branches`)).json();return Array.isArray(P)?P:[]},enabled:!r});v.useEffect(()=>{!r&&j&&j.length===1&&!f&&x(j[0].id)},[j,r]);const b=r||f;s||j?.find(N=>N.id===f)?.name;const{data:g}=$e({queryKey:["/api/organizations",t,"queue-display",b],queryFn:async()=>await(await Be("GET",`/api/organizations/${t}/queue-display?branch_id=${b}`)).json(),refetchInterval:3e3,enabled:!!b}),y={};g?.waiting?g.waiting.forEach(N=>{const P=N.service_category;y[P]=(y[P]||0)+1}):g?.waiting_counts&&Object.assign(y,g.waiting_counts),v.useEffect(()=>{if(g?.serving&&g.serving.length>0){const N=g.serving[0],P=`${N.ticket_number}-${N.called_at}`;P!==c&&N.called_at&&(C(N),u(P))}},[g,c]);const C=N=>{if("speechSynthesis"in window){const P={0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine"},w=N.ticket_number.split("").map(L=>P[L]||L).join(". "),S=N.teller_number||N.counter_number||"1",E=S.replace(/[^0-9]/g,"")||S,R=`Ticket number. ${w}. Counter. ${E}. ... Ticket number. ${w}. Counter. ${E}.`,T=new SpeechSynthesisUtterance(R);T.rate=.4,T.pitch=1,T.volume=1;const U=window.speechSynthesis.getVoices(),M=U.find(L=>L.lang.startsWith("en-")&&L.name.includes("Google"))||U.find(L=>L.lang.startsWith("en"));M&&(T.voice=M),window.speechSynthesis.cancel(),window.speechSynthesis.speak(T)}},k=g?.serving||[];return b?e.jsxs("div",{className:"fixed inset-0 bg-slate-900 text-white flex flex-col overflow-hidden z-50",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 px-3 sm:p-3 sm:px-4 bg-primary",children:[e.jsx("div",{className:"w-16 sm:w-20",children:a&&i?e.jsxs(B,{variant:"ghost",size:"sm",onClick:i,className:"h-8 px-2 text-xs text-white hover:bg-white/20",children:[e.jsx($r,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}):null}),e.jsx("div",{className:"flex-1 text-center",children:e.jsx("h1",{className:"text-base sm:text-xl md:text-2xl font-bold",children:n||"Queue Display"})}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[!a&&o&&e.jsxs(B,{variant:"ghost",size:"sm",onClick:o,className:"h-8 px-2 text-xs text-white hover:bg-white/20",children:[e.jsx(Rd,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]}),e.jsx(LW,{className:"h-4 w-4 sm:h-5 sm:w-5 animate-pulse"}),e.jsx("span",{className:"text-sm sm:text-base font-mono",children:m.toLocaleTimeString()})]})]}),e.jsxs("div",{className:"flex-1 p-6 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-300",children:"Now Serving"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.length===0?e.jsx("div",{className:"col-span-2 text-center py-12 text-slate-500 text-xl",children:"No customers currently being served"}):k.map((N,P)=>e.jsxs("div",{className:`rounded-xl p-6 ${Nje[N.service_category]||"bg-slate-700"} ${P===0?"ring-4 ring-yellow-400 animate-pulse":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm opacity-80 uppercase tracking-wide",children:Sje[N.service_category]||N.service_category}),e.jsx("div",{className:"text-5xl font-bold mt-2",children:N.ticket_number})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm opacity-80",children:"Counter"}),e.jsx("div",{className:"text-4xl font-bold",children:N.teller_number||N.counter_number||"-"})]})]}),N.teller_name&&e.jsxs("div",{className:"mt-4 text-sm opacity-80",children:["Served by: ",N.teller_name]})]},`${N.ticket_number}-${P}`))})]}),e.jsx("div",{className:"space-y-4",children:(()=>{const N=Object.values(y).reduce((P,w)=>P+(w||0),0);return gF.filter(P=>{let w=y[P.id]||0;return P.id==="transactions"&&(w+=(y.deposits||0)+(y.withdrawals||0)+(y.loan_payments||0)),w>0}),N===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-300 mb-2",children:"All Clear"}),e.jsx("p",{className:"text-slate-500",children:"No customers currently waiting"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-300",children:"Waiting"}),e.jsx("div",{className:"space-y-3",children:gF.map(P=>{let w=y[P.id]||0;return P.id==="transactions"&&(w+=(y.deposits||0)+(y.withdrawals||0)+(y.loan_payments||0)),w===0?null:e.jsxs("div",{className:`rounded-lg p-4 flex items-center justify-between ${P.color} bg-opacity-30`,children:[e.jsx("span",{className:"font-medium",children:P.label}),e.jsx("span",{className:"text-2xl font-bold",children:w})]},P.id)})}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Total Waiting"}),e.jsx("div",{className:"text-4xl font-bold text-primary",children:N})]})]})})()})]}),e.jsx("div",{className:"p-4 bg-slate-800 text-center text-slate-400",children:e.jsx("div",{className:"text-lg",children:m.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})]}):e.jsx("div",{className:"fixed inset-0 bg-slate-900 flex items-center justify-center p-4",children:e.jsx(oe,{className:"w-full max-w-md bg-slate-800 border-slate-700",children:e.jsxs(de,{className:"p-8 space-y-6 text-center",children:[e.jsx(Yn,{className:"h-16 w-16 mx-auto text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Select Branch"}),e.jsx("p",{className:"text-slate-400",children:"Please select a branch to display queue"}),e.jsxs(Qe,{onValueChange:N=>x(N),children:[e.jsx(He,{className:"w-full bg-slate-700 border-slate-600 text-white",children:e.jsx(Xe,{placeholder:"Select a branch"})}),e.jsx(Ge,{children:j?.map(N=>e.jsx(ee,{value:N.id,children:N.name},N.id))})]})]})})})}function kje({organizationId:t}){const{hasFeature:n}=Ol(t),r=n("mpesa_integration"),s=n("bank_integration"),a=v.useMemo(()=>{const c=[];return r&&c.push("mpesa"),c.push("cheques"),s&&c.push("bank"),c.push("queue"),c},[r,s]),[i,o]=v.useState(()=>a[0]||"cheques");return e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold tracking-tight",children:"Teller Services"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage payments, cheques, transfers, and queue"})]}),e.jsx(tr,{organizationId:t})]}),e.jsxs($s,{value:i,onValueChange:o,children:[e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0 px-4 md:px-0",children:e.jsxs(vs,{className:"inline-flex w-auto min-w-full md:grid md:w-full md:grid-cols-4 h-auto flex-nowrap",children:[r&&e.jsxs(_t,{value:"mpesa",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(Wd,{className:"h-4 w-4 shrink-0"}),"M-Pesa"]}),e.jsxs(_t,{value:"cheques",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(tn,{className:"h-4 w-4 shrink-0"}),"Cheques"]}),s&&e.jsxs(_t,{value:"bank",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(wL,{className:"h-4 w-4 shrink-0"}),"Transfers"]}),e.jsxs(_t,{value:"queue",className:"flex items-center gap-1 text-xs md:text-sm whitespace-nowrap",children:[e.jsx(Sx,{className:"h-4 w-4 shrink-0"}),"Queue"]})]})}),r&&e.jsx(Nt,{value:"mpesa",children:e.jsx(Pje,{organizationId:t})}),e.jsx(Nt,{value:"cheques",children:e.jsx(Aje,{organizationId:t})}),s&&e.jsx(Nt,{value:"bank",children:e.jsx(Eje,{organizationId:t})}),e.jsx(Nt,{value:"queue",children:e.jsx(Oje,{organizationId:t})})]})]})}function Pje({organizationId:t}){const[n,r]=v.useState(""),[s,a]=v.useState("all"),[i,o]=v.useState(null),[c,u]=v.useState(!1),[m,h]=v.useState(""),[f,x]=v.useState(""),{toast:j}=Xt(),{symbol:b}=fr(t),g=gs(),{data:y=[],isLoading:C}=$e({queryKey:[`/api/organizations/${t}/mpesa-payments`,s,n],queryFn:async()=>{const w=new URLSearchParams;s!=="all"&&w.set("status",s),n&&w.set("search",n);const S=await fetch(`/api/organizations/${t}/mpesa-payments?${w}`);if(!S.ok)throw new Error("Failed to fetch");return S.json()}}),{data:k=[]}=$e({queryKey:[`/api/organizations/${t}/members`]}),N=Le({mutationFn:async({paymentId:w,memberId:S})=>{const E=await fetch(`/api/organizations/${t}/mpesa-payments/${w}/credit?member_id=${S}`,{method:"POST"});if(!E.ok)throw new Error((await E.json()).detail||"Failed to credit");return E.json()},onSuccess:()=>{j({title:"Success",description:"Payment credited to member"}),g.invalidateQueries({queryKey:[`/api/organizations/${t}/mpesa-payments`]}),u(!1),o(null)},onError:w=>{j({title:"Error",description:w.message,variant:"destructive"})}}),P=w=>{switch(w){case"credited":return e.jsx(ze,{className:"bg-green-500",children:"Credited"});case"unmatched":return e.jsx(ze,{variant:"destructive",children:"Unmatched"});case"pending":return e.jsx(ze,{variant:"secondary",children:"Pending"});default:return e.jsx(ze,{children:w})}};return e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Wd,{className:"h-5 w-5"}),"M-Pesa Payment Log"]}),e.jsx(dt,{children:"View and manage incoming M-Pesa payments"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(za,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search by phone, M-Pesa code, or name...",value:n,onChange:w=>r(w.target.value),className:"pl-10"})]})}),e.jsxs(Qe,{value:s,onValueChange:a,children:[e.jsx(He,{className:"w-full sm:w-40",children:e.jsx(Xe,{placeholder:"Status"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Status"}),e.jsx(ee,{value:"credited",children:"Credited"}),e.jsx(ee,{value:"unmatched",children:"Unmatched"}),e.jsx(ee,{value:"pending",children:"Pending"})]})]})]}),e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsx("div",{className:"border rounded-lg min-w-[600px] md:min-w-0",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Date/Time"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"M-Pesa Code"}),e.jsx("th",{className:"text-left p-3 font-medium hidden md:table-cell",children:"Phone"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Sender"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Amount"}),e.jsx("th",{className:"text-left p-3 font-medium hidden lg:table-cell",children:"Account Ref"}),e.jsx("th",{className:"text-left p-3 font-medium hidden md:table-cell",children:"Member"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"text-center p-4",children:"Loading..."})}):y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"text-center p-4 text-muted-foreground",children:"No M-Pesa payments found"})}):y.map(w=>e.jsxs("tr",{className:"border-t hover:bg-muted/30",children:[e.jsx("td",{className:"p-3 text-sm",children:w.created_at?new Date(w.created_at).toLocaleString():"-"}),e.jsx("td",{className:"p-3 font-mono text-sm",children:w.trans_id}),e.jsx("td",{className:"p-3 text-sm hidden md:table-cell",children:w.phone_number}),e.jsx("td",{className:"p-3 text-sm",children:w.sender_name}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[b," ",w.amount?.toLocaleString()]}),e.jsx("td",{className:"p-3 text-sm hidden lg:table-cell",children:w.bill_ref_number}),e.jsx("td",{className:"p-3 text-sm hidden md:table-cell",children:w.member_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx("td",{className:"p-3",children:P(w.status)}),e.jsx("td",{className:"p-3",children:w.status==="unmatched"&&e.jsx(B,{size:"sm",variant:"outline",onClick:()=>{o(w),u(!0)},children:"Credit"})})]},w.id))})]})})}),e.jsx(Vt,{open:c,onOpenChange:u,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Credit M-Pesa Payment"}),e.jsxs(Qt,{children:["Select the member to credit ",b," ",i?.amount?.toLocaleString()," from ",i?.phone_number]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(Se,{children:"Search Member"}),e.jsx(re,{placeholder:"Search by member number, ID number, or name...",value:f,onChange:w=>x(w.target.value),className:"mb-2"}),e.jsx(Se,{children:"Select Member"}),e.jsxs(Qe,{value:m,onValueChange:h,children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select member"})}),e.jsx(Ge,{children:k.filter(w=>{if(!f)return!0;const S=f.toLowerCase();return w.member_number?.toLowerCase().includes(S)||w.id_number?.toLowerCase().includes(S)||w.first_name?.toLowerCase().includes(S)||w.last_name?.toLowerCase().includes(S)||w.phone?.includes(S)}).slice(0,50).map(w=>e.jsxs(ee,{value:w.id,children:[w.member_number," - ",w.first_name," ",w.last_name," ",w.id_number?`(ID: ${w.id_number})`:""]},w.id))})]})]})}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>{u(!1),x("")},children:"Cancel"}),e.jsx(B,{onClick:()=>i&&m&&N.mutate({paymentId:i.id,memberId:m}),disabled:!m||N.isPending,children:N.isPending?"Processing...":"Credit to Member"})]})]})})]})]})}function Aje({organizationId:t}){const{currency:n,symbol:r}=fr(t),[s,a]=v.useState("all"),[i,o]=v.useState(!1),[c,u]=v.useState(""),[m,h]=v.useState({member_id:"",cheque_number:"",bank_name:"",bank_branch:"",drawer_name:"",amount:"",account_type:"savings",notes:""}),{toast:f}=Xt(),x=gs(),{data:j=[],isLoading:b}=$e({queryKey:[`/api/organizations/${t}/cheque-deposits`,s],queryFn:async()=>{const N=s!=="all"?`?status=${s}`:"",P=await fetch(`/api/organizations/${t}/cheque-deposits${N}`);if(!P.ok)throw new Error("Failed to fetch");return P.json()}}),{data:g=[]}=$e({queryKey:[`/api/organizations/${t}/members`]}),y=Le({mutationFn:async N=>{const P=await fetch(`/api/organizations/${t}/cheque-deposits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...N,amount:parseFloat(N.amount)})});if(!P.ok)throw new Error((await P.json()).detail||"Failed to create");return P.json()},onSuccess:()=>{f({title:"Success",description:"Cheque deposit recorded"}),x.invalidateQueries({queryKey:[`/api/organizations/${t}/cheque-deposits`]}),o(!1),h({member_id:"",cheque_number:"",bank_name:"",bank_branch:"",drawer_name:"",amount:"",account_type:"savings",notes:""})},onError:N=>{f({title:"Error",description:N.message,variant:"destructive"})}}),C=Le({mutationFn:async({chequeId:N,action:P,reason:w})=>{const S=await fetch(`/api/organizations/${t}/cheque-deposits/${N}/action`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:P,reason:w})});if(!S.ok)throw new Error((await S.json()).detail||"Failed");return S.json()},onSuccess:(N,{action:P})=>{f({title:"Success",description:`Cheque ${P}ed successfully`}),x.invalidateQueries({queryKey:[`/api/organizations/${t}/cheque-deposits`]})},onError:N=>{f({title:"Error",description:N.message,variant:"destructive"})}}),k=N=>{switch(N){case"pending":return e.jsxs(ze,{variant:"secondary",children:[e.jsx(bn,{className:"h-3 w-3 mr-1"}),"Pending"]});case"cleared":return e.jsxs(ze,{className:"bg-green-500",children:[e.jsx(yr,{className:"h-3 w-3 mr-1"}),"Cleared"]});case"bounced":return e.jsxs(ze,{variant:"destructive",children:[e.jsx(Cs,{className:"h-3 w-3 mr-1"}),"Bounced"]});case"cancelled":return e.jsx(ze,{variant:"outline",children:"Cancelled"});default:return e.jsx(ze,{children:N})}};return e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"h-5 w-5"}),"Cheque Deposits"]}),e.jsx(dt,{children:"Manage cheque deposits and clearance"})]}),e.jsxs(Vt,{open:i,onOpenChange:o,children:[e.jsx(lo,{asChild:!0,children:e.jsx(B,{className:"w-full sm:w-auto",children:"New Cheque Deposit"})}),e.jsxs(It,{className:"max-w-md",children:[e.jsx(qt,{children:e.jsx(Bt,{children:"Record Cheque Deposit"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Search Member"}),e.jsx(re,{placeholder:"Search by member number, ID number, or name...",value:c,onChange:N=>u(N.target.value),className:"mb-2"}),e.jsx(Se,{children:"Member"}),e.jsxs(Qe,{value:m.member_id,onValueChange:N=>h({...m,member_id:N}),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select member"})}),e.jsx(Ge,{children:g.filter(N=>{if(!c)return!0;const P=c.toLowerCase();return N.member_number?.toLowerCase().includes(P)||N.id_number?.toLowerCase().includes(P)||N.first_name?.toLowerCase().includes(P)||N.last_name?.toLowerCase().includes(P)||N.phone?.includes(P)}).slice(0,50).map(N=>e.jsxs(ee,{value:N.id,children:[N.member_number," - ",N.first_name," ",N.last_name," ",N.id_number?`(ID: ${N.id_number})`:""]},N.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Cheque Number"}),e.jsx(re,{value:m.cheque_number,onChange:N=>h({...m,cheque_number:N.target.value})})]}),e.jsxs("div",{children:[e.jsxs(Se,{children:["Amount (",n,")"]}),e.jsx(re,{type:"number",value:m.amount,onChange:N=>h({...m,amount:N.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Bank Name"}),e.jsx(re,{value:m.bank_name,onChange:N=>h({...m,bank_name:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(Se,{children:"Bank Branch"}),e.jsx(re,{value:m.bank_branch,onChange:N=>h({...m,bank_branch:N.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(Se,{children:"Drawer Name"}),e.jsx(re,{value:m.drawer_name,onChange:N=>h({...m,drawer_name:N.target.value}),placeholder:"Name on the cheque"})]}),e.jsxs("div",{children:[e.jsx(Se,{children:"Account Type"}),e.jsxs(Qe,{value:m.account_type,onValueChange:N=>h({...m,account_type:N}),children:[e.jsx(He,{children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"savings",children:"Savings"}),e.jsx(ee,{value:"shares",children:"Shares"}),e.jsx(ee,{value:"deposits",children:"Deposits"})]})]})]}),e.jsxs("div",{children:[e.jsx(Se,{children:"Notes"}),e.jsx(fn,{value:m.notes,onChange:N=>h({...m,notes:N.target.value})})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>y.mutate(m),disabled:y.isPending,children:y.isPending?"Saving...":"Record Deposit"})]})]})]})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs(Qe,{value:s,onValueChange:a,children:[e.jsx(He,{className:"w-full sm:w-40",children:e.jsx(Xe,{placeholder:"Status"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Status"}),e.jsx(ee,{value:"pending",children:"Pending"}),e.jsx(ee,{value:"cleared",children:"Cleared"}),e.jsx(ee,{value:"bounced",children:"Bounced"})]})]}),e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsx("div",{className:"border rounded-lg min-w-[500px] md:min-w-0",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3 font-medium hidden md:table-cell",children:"Date"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Member"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Cheque #"}),e.jsx("th",{className:"text-left p-3 font-medium hidden lg:table-cell",children:"Bank"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Amount"}),e.jsx("th",{className:"text-left p-3 font-medium hidden md:table-cell",children:"Expected Clear"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:b?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center p-4",children:"Loading..."})}):j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center p-4 text-muted-foreground",children:"No cheque deposits found"})}):j.map(N=>e.jsxs("tr",{className:"border-t hover:bg-muted/30",children:[e.jsx("td",{className:"p-3 text-sm hidden md:table-cell",children:N.deposit_date}),e.jsx("td",{className:"p-3 text-sm",children:N.member_name}),e.jsx("td",{className:"p-3 font-mono text-sm",children:N.cheque_number}),e.jsx("td",{className:"p-3 text-sm hidden lg:table-cell",children:N.bank_name}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[r," ",N.amount?.toLocaleString()]}),e.jsx("td",{className:"p-3 text-sm hidden md:table-cell",children:N.expected_clearance_date}),e.jsx("td",{className:"p-3",children:k(N.status)}),e.jsx("td",{className:"p-3",children:N.status==="pending"&&e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[e.jsx(B,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>C.mutate({chequeId:N.id,action:"clear"}),children:"Clear"}),e.jsx(B,{size:"sm",variant:"destructive",onClick:()=>C.mutate({chequeId:N.id,action:"bounce",reason:"Insufficient funds"}),children:"Bounce"})]})})]},N.id))})]})})})]})]})}function Eje({organizationId:t}){const{currency:n,symbol:r}=fr(t),[s,a]=v.useState("all"),[i,o]=v.useState(!1),[c,u]=v.useState(!1),[m,h]=v.useState(null),[f,x]=v.useState(""),[j,b]=v.useState(""),[g,y]=v.useState({transfer_type:"incoming",amount:"",bank_name:"",bank_account:"",bank_reference:"",account_type:"savings",notes:""}),{toast:C}=Xt(),k=gs(),{data:N=[],isLoading:P}=$e({queryKey:[`/api/organizations/${t}/bank-transfers`,s],queryFn:async()=>{const T=s!=="all"?`?status=${s}`:"",U=await fetch(`/api/organizations/${t}/bank-transfers${T}`);if(!U.ok)throw new Error("Failed to fetch");return U.json()}}),{data:w=[]}=$e({queryKey:[`/api/organizations/${t}/members`]}),S=Le({mutationFn:async T=>{const U=await fetch(`/api/organizations/${t}/bank-transfers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...T,amount:parseFloat(T.amount)})});if(!U.ok)throw new Error((await U.json()).detail||"Failed");return U.json()},onSuccess:()=>{C({title:"Success",description:"Bank transfer recorded"}),k.invalidateQueries({queryKey:[`/api/organizations/${t}/bank-transfers`]}),o(!1)},onError:T=>{C({title:"Error",description:T.message,variant:"destructive"})}}),E=Le({mutationFn:async({transferId:T,action:U,memberId:M})=>{const L=await fetch(`/api/organizations/${t}/bank-transfers/${T}/action`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:U,member_id:M})});if(!L.ok)throw new Error((await L.json()).detail||"Failed");return L.json()},onSuccess:()=>{C({title:"Success",description:"Transfer updated"}),k.invalidateQueries({queryKey:[`/api/organizations/${t}/bank-transfers`]}),u(!1),h(null),x("")},onError:T=>{C({title:"Error",description:T.message,variant:"destructive"})}}),R=T=>{switch(T){case"pending":return e.jsx(ze,{variant:"secondary",children:"Pending"});case"verified":return e.jsx(ze,{className:"bg-blue-500",children:"Verified"});case"credited":return e.jsx(ze,{className:"bg-green-500",children:"Credited"});case"rejected":return e.jsx(ze,{variant:"destructive",children:"Rejected"});default:return e.jsx(ze,{children:T})}};return e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(wL,{className:"h-5 w-5"}),"Bank Transfers"]}),e.jsx(dt,{children:"Manage incoming bank transfers and verification"})]}),e.jsxs(Vt,{open:i,onOpenChange:o,children:[e.jsx(lo,{asChild:!0,children:e.jsx(B,{className:"w-full sm:w-auto",children:"Record Transfer"})}),e.jsxs(It,{children:[e.jsx(qt,{children:e.jsx(Bt,{children:"Record Bank Transfer"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Bank Name"}),e.jsx(re,{value:g.bank_name,onChange:T=>y({...g,bank_name:T.target.value})})]}),e.jsxs("div",{children:[e.jsxs(Se,{children:["Amount (",n,")"]}),e.jsx(re,{type:"number",value:g.amount,onChange:T=>y({...g,amount:T.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Bank Account"}),e.jsx(re,{value:g.bank_account,onChange:T=>y({...g,bank_account:T.target.value})})]}),e.jsxs("div",{children:[e.jsx(Se,{children:"Bank Reference"}),e.jsx(re,{value:g.bank_reference,onChange:T=>y({...g,bank_reference:T.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(Se,{children:"Notes"}),e.jsx(fn,{value:g.notes,onChange:T=>y({...g,notes:T.target.value})})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>S.mutate(g),disabled:S.isPending,children:S.isPending?"Saving...":"Record Transfer"})]})]})]})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs(Qe,{value:s,onValueChange:a,children:[e.jsx(He,{className:"w-full sm:w-40",children:e.jsx(Xe,{placeholder:"Status"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Status"}),e.jsx(ee,{value:"pending",children:"Pending"}),e.jsx(ee,{value:"verified",children:"Verified"}),e.jsx(ee,{value:"credited",children:"Credited"})]})]}),e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsx("div",{className:"border rounded-lg min-w-[500px] md:min-w-0",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3 font-medium hidden md:table-cell",children:"Date"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Bank"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Reference"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Amount"}),e.jsx("th",{className:"text-left p-3 font-medium hidden md:table-cell",children:"Member"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:P?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-4",children:"Loading..."})}):N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-4 text-muted-foreground",children:"No bank transfers found"})}):N.map(T=>e.jsxs("tr",{className:"border-t hover:bg-muted/30",children:[e.jsx("td",{className:"p-3 text-sm hidden md:table-cell",children:T.transfer_date||T.created_at?.split("T")[0]}),e.jsx("td",{className:"p-3 text-sm",children:T.bank_name}),e.jsx("td",{className:"p-3 font-mono text-sm",children:T.bank_reference}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[r," ",T.amount?.toLocaleString()]}),e.jsx("td",{className:"p-3 text-sm hidden md:table-cell",children:T.member_name||e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx("td",{className:"p-3",children:R(T.status)}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[T.status==="pending"&&e.jsx(B,{size:"sm",variant:"outline",onClick:()=>E.mutate({transferId:T.id,action:"verify"}),children:"Verify"}),(T.status==="pending"||T.status==="verified")&&e.jsx(B,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{h(T),u(!0)},children:"Credit"})]})})]},T.id))})]})})}),e.jsx(Vt,{open:c,onOpenChange:u,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Credit Bank Transfer"}),e.jsxs(Qt,{children:["Select the member to credit ",r," ",m?.amount?.toLocaleString()," from ",m?.bank_name]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(Se,{children:"Search Member"}),e.jsx(re,{placeholder:"Search by member number, ID number, or name...",value:j,onChange:T=>b(T.target.value),className:"mb-2"}),e.jsx(Se,{children:"Select Member"}),e.jsxs(Qe,{value:f,onValueChange:x,children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select member"})}),e.jsx(Ge,{children:w.filter(T=>{if(!j)return!0;const U=j.toLowerCase();return T.member_number?.toLowerCase().includes(U)||T.id_number?.toLowerCase().includes(U)||T.first_name?.toLowerCase().includes(U)||T.last_name?.toLowerCase().includes(U)||T.phone?.includes(U)}).slice(0,50).map(T=>e.jsxs(ee,{value:T.id,children:[T.member_number," - ",T.first_name," ",T.last_name," ",T.id_number?`(ID: ${T.id_number})`:""]},T.id))})]})]})}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>{u(!1),b("")},children:"Cancel"}),e.jsx(B,{onClick:()=>m&&f&&E.mutate({transferId:m.id,action:"credit",memberId:f}),disabled:!f||E.isPending,children:E.isPending?"Processing...":"Credit to Member"})]})]})})]})]})}function Oje({organizationId:t}){const[n,r]=v.useState(""),{toast:s}=Xt(),a=gs(),{data:i=[]}=$e({queryKey:[`/api/organizations/${t}/branches`]});v.useEffect(()=>{i.length===1&&!n&&r(i[0].id)},[i]);const{data:o=[],isLoading:c}=$e({queryKey:[`/api/organizations/${t}/queue-tickets`,n],queryFn:async()=>{if(!n)return[];const b=await fetch(`/api/organizations/${t}/queue-tickets?branch_id=${n}`);if(!b.ok)throw new Error("Failed to fetch");return b.json()},enabled:!!n}),u=Le({mutationFn:async({branchId:b,category:g})=>{const y=new URLSearchParams({branch_id:b});g&&y.set("service_category",g);const C=await fetch(`/api/organizations/${t}/queue-tickets/call-next?${y}`,{method:"POST"});if(!C.ok)throw new Error((await C.json()).detail||"Failed");return C.json()},onSuccess:b=>{b.success?s({title:"Calling",description:`Ticket ${b.ticket.ticket_number} to counter ${b.ticket.counter_number||"1"}`}):s({title:"No tickets",description:b.message}),a.invalidateQueries({queryKey:[`/api/organizations/${t}/queue-tickets`]})},onError:b=>{s({title:"Error",description:b.message,variant:"destructive"})}}),m=Le({mutationFn:async b=>{const g=await fetch(`/api/organizations/${t}/queue-tickets/${b}/complete`,{method:"POST"});if(!g.ok)throw new Error((await g.json()).detail||"Failed");return g.json()},onSuccess:()=>{s({title:"Complete",description:"Ticket marked as completed"}),a.invalidateQueries({queryKey:[`/api/organizations/${t}/queue-tickets`]})},onError:b=>{s({title:"Error",description:b.message,variant:"destructive"})}}),h=o.filter(b=>b.status==="waiting"),f=o.filter(b=>b.status==="serving"),x=b=>{switch(b){case"waiting":return e.jsx(ze,{variant:"secondary",children:"Waiting"});case"serving":return e.jsx(ze,{className:"bg-blue-500",children:"Serving"});case"completed":return e.jsx(ze,{className:"bg-green-500",children:"Completed"});case"no_show":return e.jsx(ze,{variant:"destructive",children:"No Show"});default:return e.jsx(ze,{children:b})}},j=b=>{switch(b){case"deposits":return e.jsx(ns,{className:"h-4 w-4"});case"loans":return e.jsx(tn,{className:"h-4 w-4"});case"inquiries":return e.jsx(ic,{className:"h-4 w-4"});default:return e.jsx(Sx,{className:"h-4 w-4"})}};return e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Sx,{className:"h-5 w-5"}),"Queue Management"]}),e.jsx(dt,{children:"Manage customer queue and call next ticket"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:items-end",children:[i.length>1&&e.jsxs("div",{className:"flex-1",children:[e.jsx(Se,{children:"Select Branch"}),e.jsxs(Qe,{value:n,onValueChange:r,children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select branch"})}),e.jsx(Ge,{children:i.map(b=>e.jsx(ee,{value:b.id,children:b.name},b.id))})]})]}),n&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(B,{onClick:()=>u.mutate({branchId:n}),disabled:u.isPending,children:"Call Next"}),e.jsx(B,{variant:"outline",onClick:()=>u.mutate({branchId:n,category:"deposits"}),children:"Deposits"}),e.jsx(B,{variant:"outline",onClick:()=>u.mutate({branchId:n,category:"loans"}),children:"Loans"})]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsxs(_e,{className:"text-lg",children:["Now Serving (",f.length,")"]})}),e.jsx(de,{children:f.length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No tickets being served"}):e.jsx("div",{className:"space-y-2",children:f.map(b=>e.jsxs("div",{className:"flex items-center justify-between gap-2 p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[j(b.service_category),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-bold text-lg",children:b.ticket_number}),e.jsx("div",{className:"text-sm text-muted-foreground truncate",children:b.member_name||"Guest"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs("span",{className:"text-sm hidden sm:inline",children:["Counter ",b.counter_number||"1"]}),e.jsx(B,{size:"sm",onClick:()=>m.mutate(b.id),children:"Done"})]})]},b.id))})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsxs(_e,{className:"text-lg",children:["Waiting (",h.length,")"]})}),e.jsx(de,{children:h.length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No tickets waiting"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:h.slice(0,10).map(b=>e.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 border rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[j(b.service_category),e.jsx("span",{className:"font-medium",children:b.ticket_number}),e.jsx("span",{className:"text-sm text-muted-foreground truncate",children:b.member_name||"Guest"})]}),x(b.status)]},b.id))})})]})]})]})]})}const Tje=me.object({name:me.string().min(1,"Name is required"),code:me.string().min(1,"Code is required").max(20),description:me.string().optional(),term_months:me.coerce.number().min(1,"Term must be at least 1 month"),interest_rate:me.coerce.number().min(0,"Rate cannot be negative").max(100),min_amount:me.coerce.number().min(0),max_amount:me.coerce.number().nullable().optional(),early_withdrawal_penalty:me.coerce.number().min(0).max(100).default(0)}),Mje=me.object({member_id:me.string().min(1,"Select a member"),product_id:me.string().min(1,"Select a product"),principal_amount:me.coerce.number().min(1,"Amount is required"),notes:me.string().optional(),auto_rollover:me.boolean().default(!1)});function vF(t){return new Date(t).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"})}function Rje(t){switch(t){case"active":return e.jsx(ze,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Active"});case"matured":return e.jsx(ze,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"Matured"});case"closed":return e.jsx(ze,{className:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:"Closed"});case"withdrawn":return e.jsx(ze,{className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"Withdrawn Early"});default:return e.jsx(ze,{variant:"outline",children:t})}}function Dje({organizationId:t}){const{toast:n}=Xt(),{canWrite:r}=_r(t,Nr.FIXED_DEPOSITS),{currency:s,symbol:a,formatAmount:i}=fr(t),[o,c]=v.useState("deposits"),[u,m]=v.useState("list"),[h,f]=v.useState(!1),[x,j]=v.useState(!1),[b,g]=v.useState(null),[y,C]=v.useState(null),[k,N]=v.useState(""),[P,w]=v.useState("all"),[S,E]=v.useState(null),{data:R=[],isLoading:T}=$e({queryKey:[`/api/organizations/${t}/fixed-deposit-products`],enabled:!!t}),{data:U=[],isLoading:M}=$e({queryKey:[`/api/organizations/${t}/fixed-deposits`,P],queryFn:async()=>{const Y=P==="all"?`/api/organizations/${t}/fixed-deposits`:`/api/organizations/${t}/fixed-deposits?status=${P}`;return(await Be("GET",Y)).json()},enabled:!!t}),{data:L=[]}=$e({queryKey:[`/api/organizations/${t}/fixed-deposits/maturing-soon`],queryFn:async()=>(await Be("GET",`/api/organizations/${t}/fixed-deposits/maturing-soon`)).json(),enabled:!!t}),{data:q=[]}=$e({queryKey:[`/api/organizations/${t}/members`],queryFn:async()=>(await Be("GET",`/api/organizations/${t}/members`)).json(),enabled:!!t}),$=$n({resolver:Fn(Tje),defaultValues:{name:"",code:"",description:"",term_months:12,interest_rate:8,min_amount:1e3,max_amount:null,early_withdrawal_penalty:25}}),D=$n({resolver:Fn(Mje),defaultValues:{member_id:"",product_id:"",principal_amount:0,notes:"",auto_rollover:!1}}),z=Le({mutationFn:async Y=>(await Be("POST",`/api/organizations/${t}/fixed-deposit-products`,Y)).json(),onSuccess:()=>{n({title:"Product created successfully"}),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/fixed-deposit-products`]}),m("list"),g(null),$.reset()},onError:Y=>{n({title:"Error",description:Y.message,variant:"destructive"})}}),J=Le({mutationFn:async Y=>(await Be("PUT",`/api/organizations/${t}/fixed-deposit-products/${b?.id}`,Y)).json(),onSuccess:()=>{n({title:"Product updated successfully"}),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/fixed-deposit-products`]}),m("list"),g(null),$.reset()},onError:Y=>{n({title:"Error",description:Y.message,variant:"destructive"})}}),I=Le({mutationFn:async Y=>(await Be("POST",`/api/organizations/${t}/fixed-deposits`,{...Y,funding_source:"savings"})).json(),onSuccess:()=>{n({title:"Fixed deposit created successfully"}),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/fixed-deposits`]}),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/members`]}),f(!1),E(null),N(""),D.reset()},onError:Y=>{n({title:"Error",description:Y.message,variant:"destructive"})}}),X=Le({mutationFn:async()=>(await Be("POST",`/api/organizations/${t}/fixed-deposits/process-matured`)).json(),onSuccess:Y=>{const ie=`Processed: ${Y.processed_count} paid out, ${Y.rolled_over_count} rolled over`;n({title:"Maturity processing complete",description:ie}),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/fixed-deposits`]}),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/members`]})},onError:Y=>{n({title:"Error",description:Y.message,variant:"destructive"})}}),ne=Le({mutationFn:async({depositId:Y,earlyWithdrawal:ie})=>(await Be("POST",`/api/organizations/${t}/fixed-deposits/${Y}/close`,{early_withdrawal:ie})).json(),onSuccess:Y=>{const ie=Y.early_withdrawal?` (Penalty: ${i(Y.penalty_amount)})`:"";n({title:"Deposit closed successfully",description:`Amount paid: ${i(Y.actual_amount_paid)}${ie}`}),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/fixed-deposits`]}),j(!1),C(null)},onError:Y=>{n({title:"Error",description:Y.message,variant:"destructive"})}}),W=Y=>{g(Y),$.reset({name:Y.name,code:Y.code,description:Y.description||"",term_months:Y.term_months,interest_rate:Number(Y.interest_rate),min_amount:Number(Y.min_amount),max_amount:Y.max_amount?Number(Y.max_amount):null,early_withdrawal_penalty:Number(Y.early_withdrawal_penalty)}),m("product_form")},H=Y=>{C(Y),j(!0)},fe=q.filter(Y=>{if(k==="")return!0;const ie=k.toLowerCase();return`${Y.first_name} ${Y.last_name}`.toLowerCase().includes(ie)||Y.member_number.toLowerCase().includes(ie)||Y.phone?.toLowerCase().includes(ie)||Y.id_number?.toLowerCase().includes(ie)}),Pe=R.find(Y=>Y.id===D.watch("product_id")),Re=R.filter(Y=>Y.is_active),Ie=U.filter(Y=>Y.status==="active").reduce((Y,ie)=>Y+Number(ie.principal_amount),0),Ce=U.filter(Y=>Y.status==="active").reduce((Y,ie)=>Y+Number(ie.expected_interest),0);return u==="product_form"?e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{m("list"),g(null),$.reset()},children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:b?"Edit Fixed Deposit Product":"Create Fixed Deposit Product"}),e.jsx("p",{className:"text-muted-foreground",children:b?`Editing: ${b.name}`:"Define the terms for a new fixed deposit product"})]})]}),e.jsx(Qn,{...$,children:e.jsxs("form",{onSubmit:$.handleSubmit(Y=>b?J.mutate(Y):z.mutate(Y)),className:"space-y-6",children:[e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Basic Information"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:$.control,name:"name",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Product Name"}),e.jsx(ye,{children:e.jsx(re,{placeholder:"e.g., 12-Month Fixed Deposit",...Y})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:$.control,name:"code",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Product Code"}),e.jsx(ye,{children:e.jsx(re,{placeholder:"e.g., FD12M",...Y,disabled:!!b})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:$.control,name:"description",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Description"}),e.jsx(ye,{children:e.jsx(fn,{placeholder:"Product description...",...Y})}),e.jsx(Ne,{})]})})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Terms"})}),e.jsx(de,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:$.control,name:"term_months",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Term (Months)"}),e.jsx(ye,{children:e.jsx(re,{type:"number",...Y})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:$.control,name:"interest_rate",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Annual Interest Rate (%)"}),e.jsx(ye,{children:e.jsx(re,{type:"number",step:"0.01",...Y})}),e.jsx(Ne,{})]})})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Amount Limits"})}),e.jsx(de,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(je,{control:$.control,name:"min_amount",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:`Minimum Amount (${s})`}),e.jsx(ye,{children:e.jsx(re,{type:"number",...Y})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:$.control,name:"max_amount",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:`Maximum Amount (${s})`}),e.jsx(ye,{children:e.jsx(re,{type:"number",placeholder:"No limit",...Y,value:Y.value??""})}),e.jsx(Ne,{})]})})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Penalties"})}),e.jsx(de,{className:"space-y-4",children:e.jsx(je,{control:$.control,name:"early_withdrawal_penalty",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Early Withdrawal Penalty (% of interest)"}),e.jsx(ye,{children:e.jsx(re,{type:"number",step:"0.01",...Y})}),e.jsx(Rn,{children:"Percentage of earned interest forfeited on early withdrawal"}),e.jsx(Ne,{})]})})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(B,{type:"submit",disabled:z.isPending||J.isPending,children:b?"Update Product":"Create Product"}),e.jsx(B,{type:"button",variant:"outline",onClick:()=>{m("list"),g(null),$.reset()},children:"Cancel"})]})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Fixed Deposits"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage fixed deposit accounts and products"})]}),e.jsx(tr,{organizationId:t})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Active Deposits"}),e.jsx(Nx,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold",children:U.filter(Y=>Y.status==="active").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently held"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Total Principal"}),e.jsx(ho,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i(Ie)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In active deposits"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Expected Interest"}),e.jsx(ev,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i(Ce)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"At maturity"})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(_e,{className:"text-sm font-medium",children:"Maturing Soon"}),e.jsx(oo,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(de,{children:[e.jsx("div",{className:"text-2xl font-bold",children:L.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Within 30 days"})]})]})]}),L.length>0&&e.jsxs(Ns,{children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsxs(Ss,{children:[L.length," deposit(s) maturing within the next 30 days. Review them in the deposits tab."]})]}),e.jsxs($s,{value:o,onValueChange:c,children:[e.jsxs(vs,{children:[e.jsx(_t,{value:"deposits",children:"Member Deposits"}),e.jsx(_t,{value:"products",children:"Products"})]}),e.jsxs(Nt,{value:"deposits",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex gap-2",children:e.jsxs(Qe,{value:P,onValueChange:w,children:[e.jsx(He,{className:"w-[180px]",children:e.jsx(Xe,{placeholder:"Filter by status"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Deposits"}),e.jsx(ee,{value:"active",children:"Active"}),e.jsx(ee,{value:"matured",children:"Matured"}),e.jsx(ee,{value:"closed",children:"Closed"})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{variant:"outline",onClick:()=>X.mutate(),disabled:X.isPending,children:[e.jsx(bn,{className:"h-4 w-4 mr-2"}),X.isPending?"Processing...":"Process Matured"]}),e.jsxs(Vt,{open:h,onOpenChange:f,children:[e.jsx(lo,{asChild:!0,children:e.jsxs(B,{disabled:Re.length===0,children:[e.jsx(mn,{className:"h-4 w-4 mr-2"}),"New Fixed Deposit"]})}),e.jsxs(It,{className:"max-w-lg",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Open Fixed Deposit"}),e.jsx(Qt,{children:"Create a new fixed deposit by transferring from member's savings."})]}),e.jsxs(Ns,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:[e.jsx(Ys,{className:"h-4 w-4"}),e.jsxs(Ss,{className:"text-sm",children:[e.jsx("strong",{children:"Transfer from Savings:"})," The deposit amount will be deducted from the member's savings balance. For cash or M-Pesa deposits, use the Teller Station."]})]}),e.jsx(Qn,{...D,children:e.jsxs("form",{onSubmit:D.handleSubmit(Y=>I.mutate(Y)),className:"space-y-4",children:[S?e.jsxs("div",{className:"p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"h-10 w-10 rounded-full bg-primary flex items-center justify-center text-primary-foreground font-bold",children:[S.first_name[0],S.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:[S.first_name," ",S.last_name]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:S.member_number})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Savings Balance"}),e.jsxs("div",{className:"font-semibold",children:[a," ",(S.savings_balance||0).toLocaleString()]})]})]}),e.jsx(B,{type:"button",variant:"ghost",size:"sm",className:"mt-2",onClick:()=>{E(null),D.setValue("member_id","")},children:"Change Member"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(ve,{children:"Member"}),e.jsx(re,{placeholder:"Search by name, member number, ID or phone...",value:k,onChange:Y=>N(Y.target.value)}),k&&fe.length>0&&e.jsx("div",{className:"border rounded-md divide-y max-h-48 overflow-y-auto",children:fe.slice(0,10).map(Y=>e.jsxs("button",{type:"button",className:"w-full p-3 text-left hover:bg-muted transition-colors",onClick:()=>{E(Y),D.setValue("member_id",Y.id),N("")},children:[e.jsxs("div",{className:"font-medium",children:[Y.first_name," ",Y.last_name]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[Y.member_number," ",Y.phone&&` ${Y.phone}`]})]},Y.id))}),k&&fe.length===0&&e.jsx("div",{className:"p-3 text-sm text-muted-foreground text-center border rounded-md",children:"No members found"})]}),e.jsx(je,{control:D.control,name:"product_id",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Product"}),e.jsxs(Qe,{onValueChange:Y.onChange,value:Y.value,children:[e.jsx(ye,{children:e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select product"})})}),e.jsx(Ge,{children:Re.map(ie=>e.jsxs(ee,{value:ie.id,children:[ie.name," (",ie.term_months," months @ ",ie.interest_rate,"%)"]},ie.id))})]}),Pe&&e.jsxs(Rn,{children:["Min: ",i(Number(Pe.min_amount)),Pe.max_amount&&` | Max: ${i(Number(Pe.max_amount))}`,` | Early withdrawal penalty: ${Pe.early_withdrawal_penalty}%`]}),e.jsx(Ne,{})]})}),e.jsx(je,{control:D.control,name:"principal_amount",render:({field:Y})=>{const ie=Number(Y.value)||0,Ee=S?.savings_balance||0,Ke=Pe?Number(Pe.min_amount):0,Te=Pe?.max_amount?Number(Pe.max_amount):null,ct=ie>Ee,ut=Pe&&ie>0&&ie<Ke,Dt=Te&&ie>Te;return e.jsxs(ge,{children:[e.jsx(ve,{children:`Principal Amount (${s})`}),e.jsx(ye,{children:e.jsx(re,{type:"number",...Y})}),S&&Pe&&e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:ct?"text-red-500 font-medium":"text-muted-foreground",children:["Available savings: ",a," ",Ee.toLocaleString(),ct&&" - Insufficient balance!"]}),ut&&e.jsxs("div",{className:"text-red-500 font-medium",children:["Below minimum: ",a," ",Ke.toLocaleString()]}),Dt&&e.jsxs("div",{className:"text-red-500 font-medium",children:["Exceeds maximum: ",a," ",Te.toLocaleString()]})]}),e.jsx(Ne,{})]})}}),e.jsx(je,{control:D.control,name:"auto_rollover",render:({field:Y})=>e.jsxs(ge,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(ye,{children:e.jsx(Ai,{checked:Y.value,onCheckedChange:Y.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(ve,{children:"Auto-Rollover on Maturity"}),e.jsx(Rn,{children:"When the deposit matures, automatically open a new deposit with the same principal. Interest will be paid to savings."})]})]})}),e.jsx(je,{control:D.control,name:"notes",render:({field:Y})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Notes (Optional)"}),e.jsx(ye,{children:e.jsx(fn,{...Y})}),e.jsx(Ne,{})]})}),e.jsx(nn,{children:e.jsx(B,{type:"submit",disabled:I.isPending,children:I.isPending?"Creating...":"Create Deposit"})})]})})]})]})]})]}),M?e.jsx("div",{className:"space-y-2",children:[1,2,3].map(Y=>e.jsx(bt,{className:"h-16 w-full"},Y))}):U.length===0?e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center justify-center py-10",children:[e.jsx(Nx,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No fixed deposits found"})]})}):e.jsx(oe,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"hidden sm:table-cell",children:"Deposit #"}),e.jsx(Q,{children:"Member"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Product"}),e.jsx(Q,{className:"text-right",children:"Principal"}),e.jsx(Q,{className:"text-right hidden lg:table-cell",children:"Interest Rate"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Maturity Date"}),e.jsx(Q,{className:"text-right hidden lg:table-cell",children:"Maturity Amount"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{className:"text-right",children:"Actions"})]})}),e.jsx(Pt,{children:U.map(Y=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium hidden sm:table-cell",children:Y.deposit_number}),e.jsx(V,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Y.member_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:Y.member_number}),e.jsx("div",{className:"text-xs text-muted-foreground md:hidden",children:Y.product_name})]})}),e.jsx(V,{className:"hidden md:table-cell",children:Y.product_name}),e.jsx(V,{className:"text-right",children:i(Number(Y.principal_amount))}),e.jsxs(V,{className:"text-right hidden lg:table-cell",children:[Y.interest_rate,"%"]}),e.jsx(V,{className:"hidden md:table-cell",children:vF(Y.maturity_date)}),e.jsx(V,{className:"text-right hidden lg:table-cell",children:i(Number(Y.maturity_amount))}),e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[Rje(Y.status),Y.auto_rollover&&Y.status==="active"&&e.jsx(ze,{variant:"outline",className:"text-xs",children:"Rollover"}),Y.rollover_count>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["#",Y.rollover_count]})]})}),e.jsxs(V,{className:"text-right",children:[Y.status==="active"&&e.jsx(B,{variant:"outline",size:"sm",onClick:()=>H(Y),children:"Close"}),Y.status==="closed"&&Y.early_withdrawal&&e.jsxs("span",{className:"text-xs text-yellow-600",children:["Penalty: ",i(Number(Y.penalty_amount))]})]})]},Y.id))})]})})})]}),e.jsxs(Nt,{value:"products",className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:r&&e.jsxs(B,{onClick:()=>{g(null),$.reset(),m("product_form")},children:[e.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Product"]})}),T?e.jsx("div",{className:"space-y-2",children:[1,2,3].map(Y=>e.jsx(bt,{className:"h-16 w-full"},Y))}):R.length===0?e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center justify-center py-10",children:[e.jsx(Ys,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No fixed deposit products defined yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create a product to start accepting fixed deposits"})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:R.map(Y=>e.jsxs(oe,{className:Y.is_active?"":"opacity-60",children:[e.jsx(we,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(_e,{className:"text-lg",children:Y.name}),e.jsx(dt,{children:Y.code})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Y.is_active?e.jsx(ze,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Active"}):e.jsx(ze,{variant:"outline",className:"bg-gray-50 text-gray-500",children:"Inactive"}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>W(Y),children:e.jsx(Ba,{className:"h-4 w-4"})})]})]})}),e.jsxs(de,{className:"space-y-2",children:[Y.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:Y.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Term:"}),e.jsxs("span",{className:"font-medium ml-2",children:[Y.term_months," months"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Rate:"}),e.jsxs("span",{className:"font-medium ml-2",children:[Y.interest_rate,"% p.a."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Min:"}),e.jsx("span",{className:"font-medium ml-2",children:i(Number(Y.min_amount))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Penalty:"}),e.jsxs("span",{className:"font-medium ml-2",children:[Y.early_withdrawal_penalty,"%"]})]})]})]})]},Y.id))})]})]}),e.jsx(Vt,{open:x,onOpenChange:j,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Close Fixed Deposit"}),e.jsxs(Qt,{children:["Close deposit #",y?.deposit_number," for ",y?.member_name]})]}),y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Principal:"}),e.jsx("span",{className:"font-medium ml-2",children:i(Number(y.principal_amount))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expected Interest:"}),e.jsx("span",{className:"font-medium ml-2",children:i(Number(y.expected_interest))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Maturity Date:"}),e.jsx("span",{className:"font-medium ml-2",children:vF(y.maturity_date)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Maturity Amount:"}),e.jsx("span",{className:"font-medium ml-2",children:i(Number(y.maturity_amount))})]})]}),new Date(y.maturity_date)>new Date&&e.jsxs(Ns,{variant:"destructive",children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsx(Ss,{children:"This deposit has not matured yet. Closing now will incur an early withdrawal penalty on the interest earned."})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(B,{onClick:()=>ne.mutate({depositId:y.id,earlyWithdrawal:new Date(y.maturity_date)>new Date}),disabled:ne.isPending,children:ne.isPending?"Closing...":"Close Deposit"})]})]})]})})]})}function vc({title:t,description:n,action:r}){return e.jsxs("div",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:t}),n&&e.jsx("p",{className:"text-muted-foreground mt-1",children:n})]}),r&&e.jsx("div",{className:"mt-4 sm:mt-0",children:r})]})}function $je({organizationId:t}){const{toast:n}=Xt(),{canWrite:r}=_r(t,Nr.CHART_OF_ACCOUNTS),[s,a]=v.useState("accounts"),[i,o]=v.useState(!1),[c,u]=v.useState(!1),[m,h]=v.useState(null),[f,x]=v.useState("all"),[j,b]=v.useState({startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],asOfDate:new Date().toISOString().split("T")[0]}),[g,y]=v.useState({code:"",name:"",account_type:"asset",description:""}),{data:C,isLoading:k}=$e({queryKey:["/api/organizations",t,"accounting","accounts"],queryFn:async()=>{const D=await fetch(`/api/organizations/${t}/accounting/accounts`);if(!D.ok)throw new Error("Failed to load accounts");return D.json()}}),{data:N,isLoading:P}=$e({queryKey:["/api/organizations",t,"accounting","trial-balance",j.asOfDate],queryFn:async()=>{const D=await fetch(`/api/organizations/${t}/accounting/reports/trial-balance?as_of_date=${j.asOfDate}`);if(!D.ok)throw new Error("Failed to load trial balance");return D.json()},enabled:s==="trial-balance"}),{data:w,isLoading:S}=$e({queryKey:["/api/organizations",t,"accounting","income-statement",j.startDate,j.endDate],queryFn:async()=>{const D=await fetch(`/api/organizations/${t}/accounting/reports/income-statement?start_date=${j.startDate}&end_date=${j.endDate}`);if(!D.ok)throw new Error("Failed to load income statement");return D.json()},enabled:s==="income-statement"}),{data:E,isLoading:R}=$e({queryKey:["/api/organizations",t,"accounting","balance-sheet",j.asOfDate],queryFn:async()=>{const D=await fetch(`/api/organizations/${t}/accounting/reports/balance-sheet?as_of_date=${j.asOfDate}`);if(!D.ok)throw new Error("Failed to load balance sheet");return D.json()},enabled:s==="balance-sheet"}),{data:T,isLoading:U}=$e({queryKey:["/api/organizations",t,"accounting","ledger",m?.id],queryFn:async()=>{const D=await fetch(`/api/organizations/${t}/accounting/accounts/${m?.id}/ledger`);if(!D.ok)throw new Error("Failed to load ledger");return D.json()},enabled:!!m&&c}),M=Le({mutationFn:async D=>Be("POST",`/api/organizations/${t}/accounting/accounts`,D),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"accounting","accounts"]}),o(!1),y({code:"",name:"",account_type:"asset",description:""}),n({title:"Account created successfully"})},onError:D=>{n({title:"Failed to create account",description:D.message,variant:"destructive"})}}),L=C?.filter(D=>f==="all"||D.account_type===f)||[],q={asset:"bg-blue-100 text-blue-800",liability:"bg-red-100 text-red-800",equity:"bg-purple-100 text-purple-800",income:"bg-green-100 text-green-800",expense:"bg-orange-100 text-orange-800"},$=D=>new Intl.NumberFormat("en-KE",{minimumFractionDigits:2,maximumFractionDigits:2}).format(D);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(vc,{title:"Chart of Accounts",description:"Manage your organization's general ledger accounts and view financial reports",action:e.jsx(tr,{organizationId:t})}),e.jsxs($s,{value:s,onValueChange:a,children:[e.jsxs(vs,{className:"grid w-full grid-cols-4",children:[e.jsxs(_t,{value:"accounts",className:"flex items-center gap-2",children:[e.jsx(dW,{className:"h-4 w-4"}),"Accounts"]}),e.jsxs(_t,{value:"trial-balance",className:"flex items-center gap-2",children:[e.jsx(RW,{className:"h-4 w-4"}),"Trial Balance"]}),e.jsxs(_t,{value:"income-statement",className:"flex items-center gap-2",children:[e.jsx(ev,{className:"h-4 w-4"}),"Income Statement"]}),e.jsxs(_t,{value:"balance-sheet",className:"flex items-center gap-2",children:[e.jsx(tn,{className:"h-4 w-4"}),"Balance Sheet"]})]}),e.jsxs(Nt,{value:"accounts",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(Qe,{value:f,onValueChange:x,children:[e.jsx(He,{className:"w-48",children:e.jsx(Xe,{placeholder:"Filter by type"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"all",children:"All Types"}),e.jsx(ee,{value:"asset",children:"Assets"}),e.jsx(ee,{value:"liability",children:"Liabilities"}),e.jsx(ee,{value:"equity",children:"Equity"}),e.jsx(ee,{value:"income",children:"Income"}),e.jsx(ee,{value:"expense",children:"Expenses"})]})]}),r&&e.jsxs(B,{onClick:()=>o(!0),children:[e.jsx(mn,{className:"h-4 w-4 mr-2"}),"Add Account"]})]}),e.jsx(oe,{children:e.jsx(de,{className:"p-0",children:k?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ln,{className:"h-8 w-8 animate-spin"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Code"}),e.jsx(Q,{children:"Account Name"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Type"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Normal Balance"}),e.jsx(Q,{className:"text-right",children:"Current Balance"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Status"}),e.jsx(Q,{children:"Actions"})]})}),e.jsx(Pt,{children:L.map(D=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono",children:D.code}),e.jsxs(V,{className:"font-medium",children:[e.jsx("div",{children:D.name}),e.jsx("div",{className:"text-xs text-muted-foreground md:hidden",children:D.account_type})]}),e.jsx(V,{className:"hidden md:table-cell",children:e.jsx(ze,{className:q[D.account_type],children:D.account_type})}),e.jsx(V,{className:"capitalize hidden lg:table-cell",children:D.normal_balance}),e.jsx(V,{className:"text-right font-mono",children:$(D.current_balance||0)}),e.jsx(V,{className:"hidden sm:table-cell",children:D.is_system?e.jsx(ze,{variant:"secondary",children:"System"}):e.jsx(ze,{variant:D.is_active?"default":"outline",children:D.is_active?"Active":"Inactive"})}),e.jsx(V,{children:e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>{h(D),u(!0)},children:[e.jsx(Ts,{className:"h-4 w-4 mr-1"}),"Ledger"]})})]},D.id))})]})})})})]}),e.jsx(Nt,{value:"trial-balance",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(_e,{children:"Trial Balance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{children:"As of:"}),e.jsx(re,{type:"date",value:j.asOfDate,onChange:D=>b({...j,asOfDate:D.target.value}),className:"w-40"})]})]})}),e.jsx(de,{children:P?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ln,{className:"h-8 w-8 animate-spin"})}):N?e.jsxs(e.Fragment,{children:[e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Code"}),e.jsx(Q,{children:"Account Name"}),e.jsx(Q,{children:"Type"}),e.jsx(Q,{className:"text-right",children:"Debit"}),e.jsx(Q,{className:"text-right",children:"Credit"})]})}),e.jsxs(Pt,{children:[N.entries.map(D=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono",children:D.account_code}),e.jsx(V,{children:D.account_name}),e.jsx(V,{children:e.jsx(ze,{className:q[D.account_type],children:D.account_type})}),e.jsx(V,{className:"text-right font-mono",children:D.debit_balance>0?$(D.debit_balance):"-"}),e.jsx(V,{className:"text-right font-mono",children:D.credit_balance>0?$(D.credit_balance):"-"})]},D.account_id)),e.jsxs(qe,{className:"font-bold bg-muted",children:[e.jsx(V,{colSpan:3,children:"Total"}),e.jsx(V,{className:"text-right font-mono",children:$(N.total_debits)}),e.jsx(V,{className:"text-right font-mono",children:$(N.total_credits)})]})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(ze,{variant:N.is_balanced?"default":"destructive",children:N.is_balanced?"Balanced":"Not Balanced"})})]}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No data available"})})]})}),e.jsx(Nt,{value:"income-statement",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(_e,{children:"Income Statement (Profit & Loss)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{children:"From:"}),e.jsx(re,{type:"date",value:j.startDate,onChange:D=>b({...j,startDate:D.target.value}),className:"w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{children:"To:"}),e.jsx(re,{type:"date",value:j.endDate,onChange:D=>b({...j,endDate:D.target.value}),className:"w-40"})]})]})]})}),e.jsx(de,{children:S?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ln,{className:"h-8 w-8 animate-spin"})}):w?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-green-700",children:"Revenue"}),e.jsx(kt,{children:e.jsxs(Pt,{children:[w.income.map(D=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono w-24",children:D.account_code}),e.jsx(V,{children:D.account_name}),e.jsx(V,{className:"text-right font-mono w-32",children:$(D.amount)})]},D.account_id)),e.jsxs(qe,{className:"font-bold bg-green-50",children:[e.jsx(V,{colSpan:2,children:"Total Revenue"}),e.jsx(V,{className:"text-right font-mono",children:$(w.total_income)})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-red-700",children:"Expenses"}),e.jsx(kt,{children:e.jsxs(Pt,{children:[w.expenses.map(D=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono w-24",children:D.account_code}),e.jsx(V,{children:D.account_name}),e.jsx(V,{className:"text-right font-mono w-32",children:$(D.amount)})]},D.account_id)),e.jsxs(qe,{className:"font-bold bg-red-50",children:[e.jsx(V,{colSpan:2,children:"Total Expenses"}),e.jsx(V,{className:"text-right font-mono",children:$(w.total_expenses)})]})]})})]}),e.jsx(oe,{className:w.net_income>=0?"bg-green-50":"bg-red-50",children:e.jsx(de,{className:"py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-lg",children:"Net Income"}),e.jsx("span",{className:`font-bold text-2xl font-mono ${w.net_income>=0?"text-green-700":"text-red-700"}`,children:$(w.net_income)})]})})})]}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No data available"})})]})}),e.jsx(Nt,{value:"balance-sheet",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(_e,{children:"Balance Sheet"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{children:"As of:"}),e.jsx(re,{type:"date",value:j.asOfDate,onChange:D=>b({...j,asOfDate:D.target.value}),className:"w-40"})]})]})}),e.jsx(de,{children:R?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ln,{className:"h-8 w-8 animate-spin"})}):E?e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-blue-700",children:"Assets"}),e.jsx(kt,{children:e.jsxs(Pt,{children:[E.assets.map(D=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono w-20",children:D.account_code}),e.jsx(V,{children:D.account_name}),e.jsx(V,{className:"text-right font-mono w-28",children:$(D.balance)})]},D.account_id)),e.jsxs(qe,{className:"font-bold bg-blue-50",children:[e.jsx(V,{colSpan:2,children:"Total Assets"}),e.jsx(V,{className:"text-right font-mono",children:$(E.total_assets)})]})]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-red-700",children:"Liabilities"}),e.jsx(kt,{children:e.jsxs(Pt,{children:[E.liabilities.map(D=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono w-20",children:D.account_code}),e.jsx(V,{children:D.account_name}),e.jsx(V,{className:"text-right font-mono w-28",children:$(D.balance)})]},D.account_id)),e.jsxs(qe,{className:"font-bold bg-red-50",children:[e.jsx(V,{colSpan:2,children:"Total Liabilities"}),e.jsx(V,{className:"text-right font-mono",children:$(E.total_liabilities)})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 text-purple-700",children:"Equity"}),e.jsx(kt,{children:e.jsxs(Pt,{children:[E.equity.map(D=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono w-20",children:D.account_code}),e.jsx(V,{children:D.account_name}),e.jsx(V,{className:"text-right font-mono w-28",children:$(D.balance)})]},D.account_id)),e.jsxs(qe,{children:[e.jsx(V,{className:"font-mono",children:"-"}),e.jsx(V,{children:"Retained Earnings"}),e.jsx(V,{className:"text-right font-mono",children:$(E.retained_earnings)})]}),e.jsxs(qe,{className:"font-bold bg-purple-50",children:[e.jsx(V,{colSpan:2,children:"Total Equity"}),e.jsx(V,{className:"text-right font-mono",children:$(E.total_equity+E.retained_earnings)})]})]})})]})]})]}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No data available"})})]})})]}),e.jsx(Vt,{open:i,onOpenChange:o,children:e.jsxs(It,{children:[e.jsx(qt,{children:e.jsx(Bt,{children:"Add New Account"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Account Code"}),e.jsx(re,{value:g.code,onChange:D=>y({...g,code:D.target.value}),placeholder:"e.g., 1050"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Account Type"}),e.jsxs(Qe,{value:g.account_type,onValueChange:D=>y({...g,account_type:D}),children:[e.jsx(He,{children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"asset",children:"Asset"}),e.jsx(ee,{value:"liability",children:"Liability"}),e.jsx(ee,{value:"equity",children:"Equity"}),e.jsx(ee,{value:"income",children:"Income"}),e.jsx(ee,{value:"expense",children:"Expense"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Account Name"}),e.jsx(re,{value:g.name,onChange:D=>y({...g,name:D.target.value}),placeholder:"e.g., Petty Cash"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Description (Optional)"}),e.jsx(fn,{value:g.description,onChange:D=>y({...g,description:D.target.value}),placeholder:"Description of this account"})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsxs(B,{onClick:()=>M.mutate(g),disabled:M.isPending||!g.code||!g.name,children:[M.isPending?e.jsx(ln,{className:"h-4 w-4 animate-spin mr-2"}):null,"Create Account"]})]})]})}),e.jsx(Vt,{open:c,onOpenChange:u,children:e.jsxs(It,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(qt,{children:e.jsxs(Bt,{children:["Account Ledger: ",m?.code," - ",m?.name]})}),U?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ln,{className:"h-8 w-8 animate-spin"})}):T?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(oe,{children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Opening Balance"}),e.jsx("div",{className:"text-lg font-bold",children:$(T.opening_balance)})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Debits"}),e.jsx("div",{className:"text-lg font-bold text-blue-600",children:$(T.total_debits)})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Credits"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:$(T.total_credits)})]})}),e.jsx(oe,{children:e.jsxs(de,{className:"pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Closing Balance"}),e.jsx("div",{className:"text-lg font-bold",children:$(T.closing_balance)})]})})]}),e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Date"}),e.jsx(Q,{children:"Entry #"}),e.jsx(Q,{children:"Description"}),e.jsx(Q,{className:"text-right",children:"Debit"}),e.jsx(Q,{className:"text-right",children:"Credit"}),e.jsx(Q,{className:"text-right",children:"Balance"})]})}),e.jsx(Pt,{children:T.entries.length===0?e.jsx(qe,{children:e.jsx(V,{colSpan:6,className:"text-center text-muted-foreground",children:"No transactions found"})}):T.entries.map((D,z)=>e.jsxs(qe,{children:[e.jsx(V,{children:new Date(D.date).toLocaleDateString()}),e.jsx(V,{className:"font-mono",children:D.entry_number}),e.jsx(V,{children:D.description}),e.jsx(V,{className:"text-right font-mono",children:D.debit>0?$(D.debit):"-"}),e.jsx(V,{className:"text-right font-mono",children:D.credit>0?$(D.credit):"-"}),e.jsx(V,{className:"text-right font-mono",children:$(D.balance)})]},z))})]})]}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No ledger data available"})]})})]})}var Qk="Collapsible",[Fje,nV]=Kr(Qk),[Lje,Xk]=Fje(Qk),rV=v.forwardRef((t,n)=>{const{__scopeCollapsible:r,open:s,defaultOpen:a,disabled:i,onOpenChange:o,...c}=t,[u=!1,m]=Zs({prop:s,defaultProp:a,onChange:o});return e.jsx(Lje,{scope:r,disabled:i,contentId:jr(),open:u,onOpenToggle:v.useCallback(()=>m(h=>!h),[m]),children:e.jsx(gt.div,{"data-state":t2(u),"data-disabled":i?"":void 0,...c,ref:n})})});rV.displayName=Qk;var sV="CollapsibleTrigger",Zk=v.forwardRef((t,n)=>{const{__scopeCollapsible:r,...s}=t,a=Xk(sV,r);return e.jsx(gt.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":t2(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...s,ref:n,onClick:ot(t.onClick,a.onOpenToggle)})});Zk.displayName=sV;var Jk="CollapsibleContent",e2=v.forwardRef((t,n)=>{const{forceMount:r,...s}=t,a=Xk(Jk,t.__scopeCollapsible);return e.jsx(Rs,{present:r||a.open,children:({present:i})=>e.jsx(Ije,{...s,ref:n,present:i})})});e2.displayName=Jk;var Ije=v.forwardRef((t,n)=>{const{__scopeCollapsible:r,present:s,children:a,...i}=t,o=Xk(Jk,r),[c,u]=v.useState(s),m=v.useRef(null),h=cn(n,m),f=v.useRef(0),x=f.current,j=v.useRef(0),b=j.current,g=o.open||c,y=v.useRef(g),C=v.useRef(void 0);return v.useEffect(()=>{const k=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(k)},[]),wr(()=>{const k=m.current;if(k){C.current=C.current||{transitionDuration:k.style.transitionDuration,animationName:k.style.animationName},k.style.transitionDuration="0s",k.style.animationName="none";const N=k.getBoundingClientRect();f.current=N.height,j.current=N.width,y.current||(k.style.transitionDuration=C.current.transitionDuration,k.style.animationName=C.current.animationName),u(s)}},[o.open,s]),e.jsx(gt.div,{"data-state":t2(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g,...i,ref:h,style:{"--radix-collapsible-content-height":x?`${x}px`:void 0,"--radix-collapsible-content-width":b?`${b}px`:void 0,...t.style},children:g&&a})});function t2(t){return t?"open":"closed"}var aV=rV,qje=Zk,Bje=e2;const zje=aV,Vje=Zk,Uje=e2,hx=20;function Kje({organizationId:t}){const{toast:n}=Xt(),{canWrite:r}=_r(t,Nr.JOURNAL_ENTRIES),[s,a]=v.useState(!1),[i,o]=v.useState(null),[c,u]=v.useState(ch(new Date,"yyyy-MM-dd")),[m,h]=v.useState(""),[f,x]=v.useState(""),[j,b]=v.useState(1),[g,y]=v.useState([{account_id:"",debit:"",credit:"",memo:""},{account_id:"",debit:"",credit:"",memo:""}]),{data:C,isLoading:k}=$e({queryKey:["/api/organizations",t,"accounting","journal-entries",j],queryFn:async()=>{const D=(j-1)*hx,z=await fetch(`/api/organizations/${t}/accounting/journal-entries?limit=${hx}&offset=${D}`,{credentials:"include"});if(!z.ok)throw new Error("Failed to fetch journal entries");return z.json()}}),{data:N}=$e({queryKey:["/api/organizations",t,"accounting","accounts"],queryFn:async()=>{const D=await fetch(`/api/organizations/${t}/accounting/accounts`,{credentials:"include"});if(!D.ok)throw new Error("Failed to fetch accounts");return D.json()}}),P=N?.filter(D=>!D.is_header)||[],w=Le({mutationFn:async D=>Be("POST",`/api/organizations/${t}/accounting/journal-entries`,D),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"accounting","journal-entries"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"accounting","accounts"]}),E(),n({title:"Journal entry created successfully"})},onError:D=>{n({title:"Failed to create journal entry",description:D.message,variant:"destructive"})}}),S=Le({mutationFn:async D=>Be("POST",`/api/organizations/${t}/accounting/journal-entries/${D}/reverse`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"accounting","journal-entries"]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"accounting","accounts"]}),n({title:"Journal entry reversed successfully"})},onError:()=>{n({title:"Failed to reverse journal entry",variant:"destructive"})}}),E=()=>{a(!1),u(ch(new Date,"yyyy-MM-dd")),h(""),x(""),y([{account_id:"",debit:"",credit:"",memo:""},{account_id:"",debit:"",credit:"",memo:""}])},R=()=>{y([...g,{account_id:"",debit:"",credit:"",memo:""}])},T=D=>{g.length>2&&y(g.filter((z,J)=>J!==D))},U=(D,z,J)=>{const I=[...g];I[D]={...I[D],[z]:J},z==="debit"&&J?I[D].credit="":z==="credit"&&J&&(I[D].debit=""),y(I)},M=()=>{if(!m.trim()){n({title:"Description is required",variant:"destructive"});return}const D=g.filter(I=>I.account_id&&(parseFloat(I.debit)>0||parseFloat(I.credit)>0));if(D.length<2){n({title:"At least 2 valid lines are required",variant:"destructive"});return}const z=D.reduce((I,X)=>I+(parseFloat(X.debit)||0),0),J=D.reduce((I,X)=>I+(parseFloat(X.credit)||0),0);if(Math.abs(z-J)>.01){n({title:"Entry must be balanced",description:`Debit: ${z.toFixed(2)}, Credit: ${J.toFixed(2)}`,variant:"destructive"});return}w.mutate({entry_date:c,description:m,reference:f||void 0,lines:D.map(I=>({account_id:I.account_id,debit:I.debit||"0",credit:I.credit||"0",memo:I.memo||void 0}))})},L=g.reduce((D,z)=>D+(parseFloat(z.debit)||0),0),q=g.reduce((D,z)=>D+(parseFloat(z.credit)||0),0),$=Math.abs(L-q)<.01;return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ln,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Journal Entries"}),e.jsx("p",{className:"text-muted-foreground",children:"View and create accounting journal entries"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),r&&e.jsxs(B,{onClick:()=>a(!0),children:[e.jsx(mn,{className:"h-4 w-4 mr-2"}),"New Entry"]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"All Journal Entries"})}),e.jsxs(de,{children:[!C||C.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No journal entries found"}):e.jsx("div",{className:"space-y-2",children:C.map(D=>e.jsx(zje,{open:i===D.id,onOpenChange:z=>o(z?D.id:null),children:e.jsxs("div",{className:"border rounded-lg",children:[e.jsx(Vje,{asChild:!0,children:e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[i===D.id?e.jsx(Xg,{className:"h-4 w-4"}):e.jsx(Os,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:D.entry_number}),e.jsx("div",{className:"text-sm text-muted-foreground",children:D.description})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm",children:ch(new Date(D.entry_date),"MMM d, yyyy")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:parseFloat(D.total_debit).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[D.is_reversed&&e.jsx(ze,{variant:"secondary",children:"Reversed"}),D.source_type&&e.jsx(ze,{variant:"outline",children:D.source_type}),e.jsx(ze,{variant:D.status==="posted"?"default":"secondary",children:D.status})]})]})]})}),e.jsx(Uje,{children:e.jsxs("div",{className:"border-t p-4",children:[e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Account"}),e.jsx(Q,{className:"text-right",children:"Debit"}),e.jsx(Q,{className:"text-right",children:"Credit"}),e.jsx(Q,{children:"Memo"})]})}),e.jsx(Pt,{children:D.lines.map(z=>e.jsxs(qe,{children:[e.jsxs(V,{children:[e.jsx("span",{className:"font-mono text-sm",children:z.account_code})," ",z.account_name]}),e.jsx(V,{className:"text-right",children:parseFloat(z.debit)>0?parseFloat(z.debit).toLocaleString():""}),e.jsx(V,{className:"text-right",children:parseFloat(z.credit)>0?parseFloat(z.credit).toLocaleString():""}),e.jsx(V,{className:"text-muted-foreground",children:z.memo})]},z.id))})]}),r&&!D.is_reversed&&D.source_type==="manual"&&e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>S.mutate(D.id),disabled:S.isPending,children:[e.jsx(Jg,{className:"h-4 w-4 mr-2"}),"Reverse Entry"]})})]})})]})},D.id))}),C&&C.length>0&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",j," ",C.length<hx&&j>1?"(last page)":""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>b(D=>Math.max(1,D-1)),disabled:j===1,children:[e.jsx(vi,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>b(D=>D+1),disabled:C.length<hx,children:["Next",e.jsx(Os,{className:"h-4 w-4 ml-1"})]})]})]})]})]}),e.jsx(Vt,{open:s,onOpenChange:a,children:e.jsxs(It,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Create Journal Entry"}),e.jsx(Qt,{children:"Create a manual journal entry. Entries must be balanced (debits = credits)."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Entry Date"}),e.jsx(re,{type:"date",value:c,onChange:D=>u(D.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Reference"}),e.jsx(re,{value:f,onChange:D=>x(D.target.value),placeholder:"Optional reference"})]}),e.jsxs("div",{className:"space-y-2 col-span-1",children:[e.jsx(Se,{children:"Balance Status"}),e.jsx("div",{className:`p-2 rounded text-center ${$?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:$?"Balanced":`Difference: ${Math.abs(L-q).toFixed(2)}`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Description"}),e.jsx(fn,{value:m,onChange:D=>h(D.target.value),placeholder:"Journal entry description",rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Se,{children:"Entry Lines"}),e.jsxs(B,{type:"button",variant:"outline",size:"sm",onClick:R,children:[e.jsx(mn,{className:"h-4 w-4 mr-1"}),"Add Line"]})]}),e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{className:"w-[300px]",children:"Account"}),e.jsx(Q,{className:"w-[120px]",children:"Debit"}),e.jsx(Q,{className:"w-[120px]",children:"Credit"}),e.jsx(Q,{children:"Memo"}),e.jsx(Q,{className:"w-[50px]"})]})}),e.jsxs(Pt,{children:[g.map((D,z)=>e.jsxs(qe,{children:[e.jsx(V,{children:e.jsxs(Qe,{value:D.account_id,onValueChange:J=>U(z,"account_id",J),children:[e.jsx(He,{children:e.jsx(Xe,{placeholder:"Select account"})}),e.jsx(Ge,{children:P.map(J=>e.jsxs(ee,{value:J.id,children:[J.code," - ",J.name]},J.id))})]})}),e.jsx(V,{children:e.jsx(re,{type:"number",min:"0",step:"0.01",value:D.debit,onChange:J=>U(z,"debit",J.target.value),placeholder:"0.00"})}),e.jsx(V,{children:e.jsx(re,{type:"number",min:"0",step:"0.01",value:D.credit,onChange:J=>U(z,"credit",J.target.value),placeholder:"0.00"})}),e.jsx(V,{children:e.jsx(re,{value:D.memo,onChange:J=>U(z,"memo",J.target.value),placeholder:"Line memo"})}),e.jsx(V,{children:g.length>2&&e.jsx(B,{type:"button",variant:"ghost",size:"sm",onClick:()=>T(z),children:e.jsx(ba,{className:"h-4 w-4 text-destructive"})})})]},z)),e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:"Totals"}),e.jsx(V,{className:"font-medium",children:L.toFixed(2)}),e.jsx(V,{className:"font-medium",children:q.toFixed(2)}),e.jsx(V,{colSpan:2})]})]})]})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:E,children:"Cancel"}),e.jsxs(B,{onClick:M,disabled:w.isPending||!$,children:[w.isPending&&e.jsx(ln,{className:"h-4 w-4 mr-2 animate-spin"}),"Create Entry"]})]})]})})]})}function Wje({organizationId:t}){const{canWrite:n}=_r(t,Nr.DIVIDENDS),{symbol:r}=fr(t),[s,a]=v.useState(!1),[i,o]=v.useState(null),[c,u]=v.useState({fiscal_year:new Date().getFullYear(),declaration_date:new Date().toISOString().split("T")[0],effective_date:new Date().toISOString().split("T")[0],dividend_rate:10,distribution_type:"savings",notes:""}),{toast:m}=Xt(),h=gs(),{data:f,isLoading:x}=$e({queryKey:["/api/organizations",t,"dividends"],queryFn:async()=>{const P=await fetch(`/api/organizations/${t}/dividends`);if(!P.ok)throw new Error("Failed to load dividends");return P.json()}}),{data:j,isLoading:b}=$e({queryKey:["/api/organizations",t,"dividends",i],queryFn:async()=>{const P=await fetch(`/api/organizations/${t}/dividends/${i}`);if(!P.ok)throw new Error("Failed to load dividend details");return P.json()},enabled:!!i}),g=Le({mutationFn:async P=>{const w=await fetch(`/api/organizations/${t}/dividends/declare`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!w.ok){const S=await w.json();throw new Error(S.detail||"Failed to declare dividend")}return w.json()},onSuccess:P=>{m({title:"Dividend Declared",description:P.message}),a(!1),h.invalidateQueries({queryKey:["/api/organizations",t,"dividends"]})},onError:P=>{m({title:"Error",description:P.message,variant:"destructive"})}}),y=Le({mutationFn:async P=>{const w=await fetch(`/api/organizations/${t}/dividends/${P}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!w.ok){const S=await w.json();throw new Error(S.detail||"Failed to approve dividend")}return w.json()},onSuccess:()=>{m({title:"Dividend Approved",description:"Dividend has been approved for distribution"}),h.invalidateQueries({queryKey:["/api/organizations",t,"dividends"]})},onError:P=>{m({title:"Error",description:P.message,variant:"destructive"})}}),C=Le({mutationFn:async P=>{const w=await fetch(`/api/organizations/${t}/dividends/${P}/distribute`,{method:"POST"});if(!w.ok){const S=await w.json();throw new Error(S.detail||"Failed to distribute dividend")}return w.json()},onSuccess:P=>{m({title:"Dividend Distributed",description:P.message}),h.invalidateQueries({queryKey:["/api/organizations",t,"dividends"]}),i&&h.invalidateQueries({queryKey:["/api/organizations",t,"dividends",i]})},onError:P=>{m({title:"Error",description:P.message,variant:"destructive"})}}),k=Le({mutationFn:async P=>{const w=await fetch(`/api/organizations/${t}/dividends/${P}/cancel`,{method:"POST"});if(!w.ok){const S=await w.json();throw new Error(S.detail||"Failed to cancel dividend")}return w.json()},onSuccess:()=>{m({title:"Dividend Cancelled"}),h.invalidateQueries({queryKey:["/api/organizations",t,"dividends"]}),o(null)},onError:P=>{m({title:"Error",description:P.message,variant:"destructive"})}}),N=P=>{const w={declared:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",processing:"bg-orange-100 text-orange-800",distributed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"};return e.jsx(ze,{className:w[P]||"",children:P.toUpperCase()})};return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ln,{className:"h-8 w-8 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Dividends"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage dividend declarations and distributions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tr,{organizationId:t}),e.jsxs(Vt,{open:s,onOpenChange:a,children:[n&&e.jsx(lo,{asChild:!0,children:e.jsxs(B,{children:[e.jsx(mn,{className:"h-4 w-4 mr-2"})," Declare Dividend"]})}),e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Declare New Dividend"}),e.jsx(Qt,{children:"Declare dividend for members based on their share balance"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Fiscal Year"}),e.jsx(re,{type:"number",value:c.fiscal_year,onChange:P=>u({...c,fiscal_year:parseInt(P.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Dividend Rate (%)"}),e.jsx(re,{type:"number",step:"0.01",value:c.dividend_rate,onChange:P=>u({...c,dividend_rate:parseFloat(P.target.value)})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Declaration Date"}),e.jsx(re,{type:"date",value:c.declaration_date,onChange:P=>u({...c,declaration_date:P.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Effective Date"}),e.jsx(re,{type:"date",value:c.effective_date,onChange:P=>u({...c,effective_date:P.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Credit Dividend To"}),e.jsxs(Qe,{value:c.distribution_type,onValueChange:P=>u({...c,distribution_type:P}),children:[e.jsx(He,{children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"savings",children:"Member Savings Account"}),e.jsx(ee,{value:"shares",children:"Add to Member Shares"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Notes (Optional)"}),e.jsx(re,{value:c.notes,onChange:P=>u({...c,notes:P.target.value}),placeholder:"AGM resolution reference..."})]})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(B,{onClick:()=>g.mutate(c),disabled:g.isPending,children:[g.isPending&&e.jsx(ln,{className:"h-4 w-4 mr-2 animate-spin"}),"Declare Dividend"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Total Declarations"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:f?.length||0})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Total Distributed"})}),e.jsx(de,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[r," ",(f?.filter(P=>P.status==="distributed").reduce((P,w)=>P+w.total_dividend_amount,0)||0).toLocaleString()]})})]}),e.jsxs(oe,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(_e,{className:"text-sm font-medium text-muted-foreground",children:"Pending Distribution"})}),e.jsx(de,{children:e.jsx("div",{className:"text-2xl font-bold",children:f?.filter(P=>P.status==="approved").length||0})})]})]}),e.jsxs($s,{defaultValue:"list",children:[e.jsxs(vs,{children:[e.jsx(_t,{value:"list",children:"All Declarations"}),e.jsx(_t,{value:"details",disabled:!i,children:"View Details"})]}),e.jsx(Nt,{value:"list",children:e.jsx(oe,{children:e.jsx(de,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Fiscal Year"}),e.jsx(Q,{children:"Rate"}),e.jsx(Q,{className:"hidden md:table-cell",children:"Total Shares"}),e.jsx(Q,{children:"Total Dividend"}),e.jsx(Q,{className:"hidden lg:table-cell",children:"Members"}),e.jsx(Q,{className:"hidden sm:table-cell",children:"Credit To"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{children:"Actions"})]})}),e.jsxs(Pt,{children:[f?.map(P=>e.jsxs(qe,{children:[e.jsx(V,{className:"font-medium",children:P.fiscal_year}),e.jsxs(V,{children:[P.dividend_rate,"%"]}),e.jsxs(V,{className:"hidden md:table-cell",children:[r," ",P.total_shares_value?.toLocaleString()]}),e.jsxs(V,{children:[r," ",P.total_dividend_amount?.toLocaleString()]}),e.jsx(V,{className:"hidden lg:table-cell",children:P.member_count}),e.jsx(V,{className:"capitalize hidden sm:table-cell",children:P.distribution_type}),e.jsx(V,{children:N(P.status)}),e.jsx(V,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{size:"sm",variant:"outline",onClick:()=>o(P.id),children:e.jsx(Ts,{className:"h-4 w-4"})}),n&&P.status==="declared"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{size:"sm",variant:"default",onClick:()=>y.mutate(P.id),disabled:y.isPending,children:e.jsx(yr,{className:"h-4 w-4"})}),e.jsx(B,{size:"sm",variant:"destructive",onClick:()=>k.mutate(P.id),children:e.jsx(Cs,{className:"h-4 w-4"})})]}),n&&P.status==="approved"&&e.jsxs(B,{size:"sm",variant:"default",onClick:()=>C.mutate(P.id),disabled:C.isPending,children:[e.jsx(Cd,{className:"h-4 w-4 mr-1"})," Distribute"]})]})})]},P.id)),(!f||f.length===0)&&e.jsx(qe,{children:e.jsx(V,{colSpan:8,className:"text-center text-muted-foreground py-8",children:"No dividends declared yet"})})]})]})})})})}),e.jsx(Nt,{value:"details",children:b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ln,{className:"h-8 w-8 animate-spin"})}):j?e.jsxs("div",{className:"space-y-4",children:[e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{children:["Dividend FY",j.declaration.fiscal_year]}),e.jsxs(dt,{children:["Rate: ",j.declaration.dividend_rate,"% | Status: ",j.declaration.status," | Credit to: ",j.declaration.distribution_type]})]}),e.jsx(de,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Shares"}),e.jsxs("p",{className:"text-lg font-bold",children:[r," ",j.declaration.total_shares_value?.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Dividend"}),e.jsxs("p",{className:"text-lg font-bold",children:[r," ",j.declaration.total_dividend_amount?.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Members"}),e.jsx("p",{className:"text-lg font-bold",children:j.members.length})]})]})})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Member Dividends"})}),e.jsx(de,{className:"p-0",children:e.jsxs(kt,{children:[e.jsx(Rt,{children:e.jsxs(qe,{children:[e.jsx(Q,{children:"Member"}),e.jsx(Q,{children:"Member No."}),e.jsx(Q,{children:"Shares Balance"}),e.jsx(Q,{children:"Dividend Amount"}),e.jsx(Q,{children:"Status"}),e.jsx(Q,{children:"Credited To"})]})}),e.jsx(Pt,{children:j.members.map(P=>e.jsxs(qe,{children:[e.jsx(V,{children:P.member_name}),e.jsx(V,{children:P.member_number}),e.jsxs(V,{children:[r," ",P.shares_balance.toLocaleString()]}),e.jsxs(V,{className:"font-medium",children:[r," ",P.dividend_amount.toLocaleString()]}),e.jsx(V,{children:e.jsx(ze,{variant:P.status==="credited"?"default":"secondary",children:P.status})}),e.jsx(V,{className:"capitalize",children:P.credited_to||"-"})]},P.id))})]})})]})]}):null})]})]})}function al(t){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function Hje({organizationId:t}){const{toast:n}=Xt(),[r,s]=v.useState(!1),[a,i]=v.useState(new Date().toISOString().split("T")[0]),[o,c]=v.useState(""),[u,m]=v.useState({}),[h,f]=v.useState({}),{data:x,isLoading:j,isError:b,error:g,refetch:y}=$e({queryKey:[`/api/organizations/${t}/accounting/opening-balances/preview`]}),C=(q,$)=>{m(D=>({...D,[q]:$})),f(D=>({...D,[q]:!1}))},k=(q,$)=>{m(D=>({...D,[q]:String($)})),f(D=>({...D,[q]:!0}))},N=q=>{m($=>({...$,[q]:""})),f($=>({...$,[q]:!1}))},P=()=>{if(!x?.accounts)return;const q={...u},$={...h};let D=0,z=0;for(const I of x.accounts)I.gap!==null&&Math.abs(I.gap)>.01&&(q[I.account_code]=String(I.gap),$[I.account_code]=!0,I.account_type==="asset"?I.gap>0?D+=I.gap:z+=Math.abs(I.gap):I.gap>0?z+=I.gap:D+=Math.abs(I.gap));const J=z-D;Math.abs(J)>.01&&x.accounts.find(X=>X.account_code==="1000")&&(q[1e3]=String(Math.round(J*100)/100),$[1e3]=!0),m(q),f($)},w=q=>parseFloat(u[q]||"")||0,S=v.useMemo(()=>{if(!x?.accounts)return{debit:0,credit:0,balanced:!0};let q=0,$=0;for(const D of x.accounts){const z=w(D.account_code);z!==0&&(D.account_type==="asset"?z>0?q+=z:$+=Math.abs(z):z>0?$+=z:q+=Math.abs(z))}return{debit:q,credit:$,balanced:Math.abs(q-$)<.01}},[u,x?.accounts]),E=Object.values(u).some(q=>parseFloat(q)!==0&&q!==""),R=Le({mutationFn:async()=>{const q=(x?.accounts||[]).filter(D=>{const z=parseFloat(u[D.account_code]||"");return!isNaN(z)&&z!==0}).map(D=>({account_code:D.account_code,amount:parseFloat(u[D.account_code]),memo:h[D.account_code]?`Opening balance (auto-calculated) - ${D.account_name}`:`Opening balance (manually entered) - ${D.account_name}`}));return(await Be("POST",`/api/organizations/${t}/accounting/opening-balances/post`,{effective_date:a,notes:o||void 0,lines:q})).json()},onSuccess:q=>{n({title:"Opening Balances Posted",description:q.message}),s(!1),m({}),f({}),y(),Fe.invalidateQueries({queryKey:[`/api/organizations/${t}/accounting`]})},onError:q=>{n({title:"Error",description:q.message,variant:"destructive"}),s(!1)}});if(j)return e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(ln,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(b)return e.jsxs("div",{className:"space-y-6",children:[e.jsx(vc,{title:"Opening Balances",description:"Set up your ledger with starting balances from your previous system."}),e.jsxs(Ns,{variant:"destructive",children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsx(ui,{children:"Failed to Load"}),e.jsx(Ss,{children:g?.message||"Could not load opening balance data. Please try again."})]}),e.jsx(B,{variant:"outline",onClick:()=>y(),"data-testid":"button-retry",children:"Retry"})]});const T=x?.already_posted??!1,U={asset:"Assets",liability:"Liabilities",equity:"Equity"},L=["asset","liability","equity"].map(q=>({type:q,label:U[q]||q,accounts:(x?.accounts||[]).filter($=>$.account_type===q)})).filter(q=>q.accounts.length>0);return e.jsxs("div",{className:"space-y-4 pb-48","data-testid":"opening-balances-page",children:[e.jsx(vc,{title:"Opening Balances",description:"Set starting balances from your previous system or actual records."}),T&&e.jsxs(Ns,{className:"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950",children:[e.jsx(ps,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),e.jsx(ui,{className:"text-green-800 dark:text-green-200",children:"Opening Balances Already Posted"}),e.jsxs(Ss,{className:"text-green-700 dark:text-green-300",children:["Opening balances were posted as entry ",x?.existing_entry_number,". To re-do them, first reverse that journal entry from the Journal Entries page."]})]}),!T&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ns,{children:[e.jsx(Zg,{className:"h-4 w-4"}),e.jsx(ui,{children:"How this works"}),e.jsxs(Ss,{children:["Tap ",e.jsx("strong",{children:"Auto"})," on individual accounts, or use the button below to fill all gaps at once. The system will auto-balance to Cash/Bank if needed. All entries must balance before posting."]})]}),x?.has_gaps&&e.jsxs(B,{onClick:P,variant:"default",className:"w-full",size:"lg","data-testid":"button-apply-all",children:[e.jsx(fE,{className:"h-5 w-5 mr-2"}),"Apply All Suggestions & Auto-Balance"]})]}),L.map(q=>e.jsxs("div",{className:"space-y-2","data-testid":`group-${q.type}`,children:[e.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide px-1",children:q.label}),q.accounts.map($=>{const D=$.suggested_balance!==null,z=$.gap!==null&&Math.abs($.gap)>.01,J=u[$.account_code]||"",I=h[$.account_code]===!0,X=J!==""&&parseFloat(J)!==0,ne=X||z||u.hasOwnProperty($.account_code);return e.jsx(oe,{className:`${I?"border-green-400 dark:border-green-600":""}`,"data-testid":`account-row-${$.account_code}`,children:e.jsxs(de,{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold",children:$.account_code}),I&&e.jsx(ze,{variant:"secondary",className:"text-xs",children:"Auto"})]}),e.jsx("div",{className:"text-sm font-medium truncate",children:$.account_name})]}),!T&&e.jsxs("div",{className:"flex gap-1 shrink-0",children:[D&&z&&e.jsxs(B,{variant:"default",size:"sm",onClick:()=>k($.account_code,$.gap),"data-testid":`button-auto-${$.account_code}`,children:[e.jsx(fE,{className:"h-3.5 w-3.5 mr-1"}),"Auto"]}),!ne&&!z&&e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>C($.account_code,""),"data-testid":`button-manual-${$.account_code}`,children:[e.jsx(Ba,{className:"h-3.5 w-3.5 mr-1"}),"Enter"]}),X&&e.jsxs(B,{variant:"destructive",size:"sm",onClick:()=>N($.account_code),"data-testid":`button-clear-${$.account_code}`,children:[e.jsx(Jg,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"GL Balance"}),e.jsx("div",{className:"font-mono font-medium",children:al($.current_gl_balance)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Actual"}),e.jsx("div",{className:"font-mono font-medium",children:D?al($.suggested_balance):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Gap"}),e.jsx("div",{className:`font-mono font-medium ${z?"text-orange-600 dark:text-orange-400":""}`,children:D&&z?al($.gap):D?"Matched":"-"})]})]}),!T&&ne&&e.jsx("div",{className:"pt-1",children:e.jsx(re,{type:"number",step:"0.01",placeholder:"Enter adjustment amount",className:`text-right font-mono ${I?"border-green-500 bg-green-50 dark:bg-green-950":""}`,value:J,onChange:W=>C($.account_code,W.target.value),"data-testid":`input-amount-${$.account_code}`})})]})},$.account_code)})]},q.type)),!T&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-background border-t-2 shadow-2xl p-4","data-testid":"post-section",children:e.jsxs("div",{className:"max-w-3xl mx-auto space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("span",{children:["Dr: ",e.jsx("strong",{className:"font-mono",children:al(S.debit)})]}),e.jsxs("span",{children:["Cr: ",e.jsx("strong",{className:"font-mono",children:al(S.credit)})]})]}),e.jsx(ze,{variant:S.balanced?"default":"destructive","data-testid":"balance-status",children:S.balanced?"Balanced":`Off by ${al(Math.abs(S.debit-S.credit))}`})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(re,{type:"date",className:"w-36",value:a,onChange:q=>i(q.target.value),"data-testid":"input-effective-date"}),e.jsx(re,{placeholder:"Notes (optional)",className:"flex-1",value:o,onChange:q=>c(q.target.value),"data-testid":"input-notes"})]}),e.jsxs(B,{size:"lg",className:"w-full text-base",onClick:()=>s(!0),disabled:!S.balanced||!E,"data-testid":"button-post-opening-balances",children:[e.jsx(ml,{className:"h-5 w-5 mr-2"}),"Post Opening Balances"]})]})}),e.jsx(Vt,{open:r,onOpenChange:s,children:e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{children:"Confirm Opening Balance Entry"}),e.jsxs(Qt,{children:["This will create a journal entry for"," ",e.jsx("span",{className:"font-semibold",children:al(S.debit)})," ","(debit = credit) effective ",a,". This action can only be done once."]})]}),e.jsxs("div",{className:"py-2 space-y-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Accounts included:"}),x?.accounts.filter(q=>{const $=parseFloat(u[q.account_code]||"");return!isNaN($)&&$!==0}).map(q=>e.jsxs("div",{className:"flex justify-between text-sm px-2",children:[e.jsxs("span",{children:[q.account_code," - ",q.account_name]}),e.jsxs("span",{className:"font-mono",children:[al(parseFloat(u[q.account_code])),e.jsx(ze,{variant:"outline",className:"ml-2 text-xs",children:h[q.account_code]?"Auto":"Manual"})]})]},q.account_code))]}),e.jsxs(Ns,{children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsx(ui,{children:"One-time action"}),e.jsx(Ss,{children:"Opening balances can only be posted once. If you need to adjust later, reverse the journal entry from the Journal Entries page and re-post."})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>s(!1),"data-testid":"button-cancel-post",children:"Cancel"}),e.jsxs(B,{onClick:()=>R.mutate(),disabled:R.isPending,"data-testid":"button-confirm-post",children:[R.isPending&&e.jsx(ln,{className:"h-4 w-4 mr-2 animate-spin"}),"Confirm & Post"]})]})]})})]})}function Gje({isExpired:t,isTrial:n,trialDaysRemaining:r,message:s,onUpgrade:a}){return!s&&!t&&!(n&&r<=7)?null:t?e.jsxs("div",{className:"bg-red-600 text-white px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Cs,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium",children:s||"Your subscription has expired. Please upgrade to continue using the platform."})]}),a&&e.jsx(B,{variant:"secondary",size:"sm",onClick:a,className:"bg-white text-red-600 hover:bg-red-50",children:"Upgrade Now"})]}):n&&r<=3?e.jsxs("div",{className:"bg-amber-500 text-white px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ur,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium",children:s||`Your trial expires in ${r} day${r!==1?"s":""}. Upgrade now to avoid interruption.`})]}),a&&e.jsx(B,{variant:"secondary",size:"sm",onClick:a,className:"bg-white text-amber-600 hover:bg-amber-50",children:"Upgrade Now"})]}):n&&r<=7?e.jsxs("div",{className:"bg-blue-600 text-white px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(bn,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("span",{className:"text-sm font-medium",children:["You're on a trial. ",r," day",r!==1?"s":""," remaining."]})]}),a&&e.jsx(B,{variant:"secondary",size:"sm",onClick:a,className:"bg-white text-blue-600 hover:bg-blue-50",children:"View Plans"})]}):null}const Yje=[{value:"KES",label:"KES - Kenyan Shilling"},{value:"USD",label:"USD - US Dollar"},{value:"UGX",label:"UGX - Ugandan Shilling"},{value:"TZS",label:"TZS - Tanzanian Shilling"},{value:"NGN",label:"NGN - Nigerian Naira"},{value:"GHS",label:"GHS - Ghanaian Cedi"},{value:"ZAR",label:"ZAR - South African Rand"},{value:"GBP",label:"GBP - British Pound"},{value:"EUR",label:"EUR - Euro"}];function Qje({organizationId:t,organizationName:n,onComplete:r,onFinalize:s}){const{toast:a}=Xt(),i=gs(),[o,c]=v.useState(1),[u,m]=v.useState({name:n,currency:"KES",email:"",phone:""}),[h,f]=v.useState({name:"Head Office",code:"HO",address:""}),[x,j]=v.useState({orgUpdated:!1,branchCreated:!1}),b=Le({mutationFn:async()=>Be("PATCH",`/api/organizations/${t}`,{name:u.name,currency:u.currency,email:u.email||void 0,phone:u.phone||void 0}),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/organizations/my"]}),j(C=>({...C,orgUpdated:!0})),c(2)},onError:()=>{a({title:"Failed to update organization details",variant:"destructive"})}}),g=Le({mutationFn:async()=>Be("POST",`/api/organizations/${t}/branches`,{name:h.name,code:h.code,address:h.address||void 0}),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/organizations",t,"branches"]}),j(C=>({...C,branchCreated:!0})),c(3)},onError:()=>{a({title:"Failed to create branch",variant:"destructive"})}}),y=C=>{localStorage.setItem(`onboarding_dismissed_${t}`,"true"),s(C)};return e.jsx(Vt,{open:!0,onOpenChange:C=>{C||y(!x.branchCreated)},children:e.jsxs(It,{className:"sm:max-w-lg","data-testid":"onboarding-wizard",children:[e.jsxs(qt,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary",children:e.jsx(Yn,{className:"h-5 w-5 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsxs(Bt,{"data-testid":"onboarding-title",children:[o===1&&"Organization Details",o===2&&"Create Your First Branch",o===3&&"You're All Set!"]}),e.jsx(Qt,{"data-testid":"onboarding-step-indicator",children:o<3?`Step ${o} of 3`:"Setup Complete"})]})]}),e.jsx("div",{className:"flex gap-1 mt-3",children:[1,2,3].map(C=>e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${C<=o?"bg-primary":"bg-muted"}`,"data-testid":`onboarding-progress-${C}`},C))})]}),o===1&&e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"org-name",children:"Organization Name"}),e.jsx(re,{id:"org-name",value:u.name,onChange:C=>m(k=>({...k,name:C.target.value})),placeholder:"Your organization name","data-testid":"input-org-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"org-currency",children:"Currency"}),e.jsxs(Qe,{value:u.currency,onValueChange:C=>m(k=>({...k,currency:C})),children:[e.jsx(He,{id:"org-currency","data-testid":"select-org-currency",children:e.jsx(Xe,{})}),e.jsx(Ge,{children:Yje.map(C=>e.jsx(ee,{value:C.value,"data-testid":`currency-option-${C.value}`,children:C.label},C.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"org-email",children:"Organization Email"}),e.jsx(re,{id:"org-email",type:"email",value:u.email,onChange:C=>m(k=>({...k,email:C.target.value})),placeholder:"info@yourorganization.com","data-testid":"input-org-email"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"org-phone",children:"Organization Phone"}),e.jsx(re,{id:"org-phone",value:u.phone,onChange:C=>m(k=>({...k,phone:C.target.value})),placeholder:"+254 700 000 000","data-testid":"input-org-phone"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 pt-2",children:[e.jsx(B,{variant:"ghost",onClick:()=>y(!x.branchCreated),"data-testid":"button-setup-later",children:"Set up later"}),e.jsx(B,{onClick:()=>b.mutate(),disabled:!u.name||b.isPending,"data-testid":"button-onboarding-next-1",children:b.isPending?"Saving...":"Next"})]})]}),o===2&&e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create your first branch to start managing operations. You can add more branches later."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"branch-name",children:"Branch Name"}),e.jsx(re,{id:"branch-name",value:h.name,onChange:C=>{const k=C.target.value,N=k.replace(/[^A-Za-z0-9]/g,"").toUpperCase().slice(0,10)||"BR";f(P=>({...P,name:k,code:N}))},placeholder:"e.g. Head Office","data-testid":"input-branch-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"branch-address",children:"Branch Address"}),e.jsx(re,{id:"branch-address",value:h.address,onChange:C=>f(k=>({...k,address:C.target.value})),placeholder:"123 Main Street, City","data-testid":"input-branch-address"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 pt-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>c(1),"data-testid":"button-onboarding-back-2",children:"Back"}),e.jsx(B,{variant:"ghost",onClick:()=>y(!0),"data-testid":"button-skip-branch",children:"Skip this step"})]}),e.jsx(B,{onClick:()=>g.mutate(),disabled:!h.name||g.isPending,"data-testid":"button-onboarding-next-2",children:g.isPending?"Creating...":"Next"})]})]}),o===3&&e.jsxs("div",{className:"space-y-5 py-2",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(ps,{className:"h-8 w-8 text-green-600 dark:text-green-400"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-base font-medium mb-1",children:"Setup Complete"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your organization is ready to go. Here's what was configured:"})]}),e.jsxs("div",{className:"space-y-2 rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x.orgUpdated?e.jsx(ps,{className:"h-4 w-4 text-green-600 dark:text-green-400 shrink-0"}):e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-muted-foreground/30 shrink-0"}),e.jsx("span",{className:"text-sm","data-testid":"checklist-org-details",children:"Organization details updated"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x.branchCreated?e.jsx(ps,{className:"h-4 w-4 text-green-600 dark:text-green-400 shrink-0"}):e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-muted-foreground/30 shrink-0"}),e.jsx("span",{className:"text-sm","data-testid":"checklist-branch",children:"First branch created"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Quick Links"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs(B,{variant:"outline",className:"justify-start gap-2",onClick:()=>y(!1),"data-testid":"link-add-staff",children:[e.jsx(pn,{className:"h-4 w-4"}),"Add Staff Members"]}),e.jsxs(B,{variant:"outline",className:"justify-start gap-2",onClick:()=>y(!1),"data-testid":"link-create-loan-products",children:[e.jsx(ns,{className:"h-4 w-4"}),"Create Loan Products"]}),e.jsxs(B,{variant:"outline",className:"justify-start gap-2",onClick:()=>y(!1),"data-testid":"link-register-members",children:[e.jsx(Cx,{className:"h-4 w-4"}),"Register Members"]})]})]}),e.jsx(B,{className:"w-full",onClick:()=>y(!1),"data-testid":"button-go-to-dashboard",children:"Go to Dashboard"})]})]})})}const Xje=[{label:"Creating your organization",icon:Yn,duration:1200},{label:"Provisioning secure database",icon:_L,duration:2e3},{label:"Configuring security settings",icon:Es,duration:1500},{label:"Finalizing setup",icon:ps,duration:1e3}],Zje=[{label:"Saving your preferences",icon:Kd,duration:800},{label:"Configuring workspace",icon:_L,duration:1200},{label:"Finalizing setup",icon:ps,duration:800}];function yF({orgName:t,ready:n=!1,mode:r="full",onComplete:s}){const[a,i]=v.useState(0),[o,c]=v.useState(!1),[u,m]=v.useState(!1),h=v.useRef(s);h.current=s;const f=r==="full"?Xje:Zje;v.useEffect(()=>{let b;const g=y=>{y<f.length?(i(y),b=setTimeout(()=>g(y+1),f[y].duration)):m(!0)};return g(0),()=>clearTimeout(b)},[f.length]),v.useEffect(()=>{if(u&&n){c(!0);const b=setTimeout(()=>h.current(),800);return()=>clearTimeout(b)}},[u,n]);const x=r==="full"?o?"All Set!":"Setting Up Your Organization":o?"You're All Set!":"Finishing Up",j=o?`${t} is ready to go`:r==="full"?`Preparing ${t} for you`:"Just a moment while we finalize everything";return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background",children:e.jsxs("div",{className:"w-full max-w-md mx-4 text-center",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-primary mx-auto mb-6",children:e.jsx(Yn,{className:"h-8 w-8 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold mb-1",children:x}),e.jsx("p",{className:"text-muted-foreground mb-10 text-sm",children:j}),e.jsx("div",{className:"space-y-3 text-left mb-10",children:f.map((b,g)=>{const y=b.icon,C=a===g&&!o,k=a>g||o,N=u&&!n&&g===f.length-1;return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-all duration-300 ${C||N?"bg-primary/5 border border-primary/20":k?"opacity-60":"opacity-30"}`,children:[e.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full transition-colors duration-300 ${k&&!N?"bg-primary/10 text-primary":C||N?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:k&&!N?e.jsx(ps,{className:"h-4 w-4"}):C||N?e.jsx(ln,{className:"h-4 w-4 animate-spin"}):e.jsx(y,{className:"h-4 w-4"})}),e.jsx("span",{className:`text-sm font-medium transition-colors duration-300 ${C||N?"text-foreground":"text-muted-foreground"}`,children:b.label})]},g)})}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all duration-500 ease-out",style:{width:o?"100%":`${(a+(u?1:0))/f.length*100}%`}})})]})})}var Eo="Accordion",Jje=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[n2,ebe,tbe]=pf(Eo),[xy]=Kr(Eo,[tbe,nV]),r2=nV(),iV=le.forwardRef((t,n)=>{const{type:r,...s}=t,a=s,i=s;return e.jsx(n2.Provider,{scope:t.__scopeAccordion,children:r==="multiple"?e.jsx(abe,{...i,ref:n}):e.jsx(sbe,{...a,ref:n})})});iV.displayName=Eo;var[oV,nbe]=xy(Eo),[lV,rbe]=xy(Eo,{collapsible:!1}),sbe=le.forwardRef((t,n)=>{const{value:r,defaultValue:s,onValueChange:a=()=>{},collapsible:i=!1,...o}=t,[c,u]=Zs({prop:r,defaultProp:s,onChange:a});return e.jsx(oV,{scope:t.__scopeAccordion,value:c?[c]:[],onItemOpen:u,onItemClose:le.useCallback(()=>i&&u(""),[i,u]),children:e.jsx(lV,{scope:t.__scopeAccordion,collapsible:i,children:e.jsx(cV,{...o,ref:n})})})}),abe=le.forwardRef((t,n)=>{const{value:r,defaultValue:s,onValueChange:a=()=>{},...i}=t,[o=[],c]=Zs({prop:r,defaultProp:s,onChange:a}),u=le.useCallback(h=>c((f=[])=>[...f,h]),[c]),m=le.useCallback(h=>c((f=[])=>f.filter(x=>x!==h)),[c]);return e.jsx(oV,{scope:t.__scopeAccordion,value:o,onItemOpen:u,onItemClose:m,children:e.jsx(lV,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(cV,{...i,ref:n})})})}),[ibe,gy]=xy(Eo),cV=le.forwardRef((t,n)=>{const{__scopeAccordion:r,disabled:s,dir:a,orientation:i="vertical",...o}=t,c=le.useRef(null),u=cn(c,n),m=ebe(r),f=bf(a)==="ltr",x=ot(t.onKeyDown,j=>{if(!Jje.includes(j.key))return;const b=j.target,g=m().filter(R=>!R.ref.current?.disabled),y=g.findIndex(R=>R.ref.current===b),C=g.length;if(y===-1)return;j.preventDefault();let k=y;const N=0,P=C-1,w=()=>{k=y+1,k>P&&(k=N)},S=()=>{k=y-1,k<N&&(k=P)};switch(j.key){case"Home":k=N;break;case"End":k=P;break;case"ArrowRight":i==="horizontal"&&(f?w():S());break;case"ArrowDown":i==="vertical"&&w();break;case"ArrowLeft":i==="horizontal"&&(f?S():w());break;case"ArrowUp":i==="vertical"&&S();break}const E=k%C;g[E].ref.current?.focus()});return e.jsx(ibe,{scope:r,disabled:s,direction:a,orientation:i,children:e.jsx(n2.Slot,{scope:r,children:e.jsx(gt.div,{...o,"data-orientation":i,ref:u,onKeyDown:s?void 0:x})})})}),Kg="AccordionItem",[obe,s2]=xy(Kg),dV=le.forwardRef((t,n)=>{const{__scopeAccordion:r,value:s,...a}=t,i=gy(Kg,r),o=nbe(Kg,r),c=r2(r),u=jr(),m=s&&o.value.includes(s)||!1,h=i.disabled||t.disabled;return e.jsx(obe,{scope:r,open:m,disabled:h,triggerId:u,children:e.jsx(aV,{"data-orientation":i.orientation,"data-state":xV(m),...c,...a,ref:n,disabled:h,open:m,onOpenChange:f=>{f?o.onItemOpen(s):o.onItemClose(s)}})})});dV.displayName=Kg;var uV="AccordionHeader",mV=le.forwardRef((t,n)=>{const{__scopeAccordion:r,...s}=t,a=gy(Eo,r),i=s2(uV,r);return e.jsx(gt.h3,{"data-orientation":a.orientation,"data-state":xV(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:n})});mV.displayName=uV;var VS="AccordionTrigger",hV=le.forwardRef((t,n)=>{const{__scopeAccordion:r,...s}=t,a=gy(Eo,r),i=s2(VS,r),o=rbe(VS,r),c=r2(r);return e.jsx(n2.ItemSlot,{scope:r,children:e.jsx(qje,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...c,...s,ref:n})})});hV.displayName=VS;var fV="AccordionContent",pV=le.forwardRef((t,n)=>{const{__scopeAccordion:r,...s}=t,a=gy(Eo,r),i=s2(fV,r),o=r2(r);return e.jsx(Bje,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...o,...s,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});pV.displayName=fV;function xV(t){return t?"open":"closed"}var lbe=iV,cbe=dV,dbe=mV,gV=hV,vV=pV;const yV=lbe,a2=v.forwardRef(({className:t,...n},r)=>e.jsx(cbe,{ref:r,className:We("border-b",t),...n}));a2.displayName="AccordionItem";const i2=v.forwardRef(({className:t,children:n,...r},s)=>e.jsx(dbe,{className:"flex",children:e.jsxs(gV,{ref:s,className:We("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...r,children:[n,e.jsx(Xg,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));i2.displayName=gV.displayName;const o2=v.forwardRef(({className:t,children:n,...r},s)=>e.jsx(vV,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:We("pb-4 pt-0",t),children:n})}));o2.displayName=vV.displayName;const ube=[{name:"admin",description:"Full access to all features and settings. This role has unrestricted access to every part of the system.",icon:Es,color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",capabilities:["Complete access to all modules and features","Manage staff, branches, and organization settings","Create and manage roles and permissions","View all reports and analytics","Perform all financial operations"],permissions:["* (all permissions)"]},{name:"manager",description:"Branch and department management with full loan lifecycle control. Ideal for branch managers or department heads.",icon:pn,color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",capabilities:["View dashboard and manage branches","View and manage members and view staff","Full loan lifecycle: create, approve, reject, and disburse loans","Manage repayments and guarantors","Handle transactions, deposits, and withdrawals","Manage defaults and loan restructuring","Send SMS notifications","View reports and analytics","Manage float allocation and approve shortage requests","View salary deductions"],cannotDo:["Cannot manage staff records","Cannot manage organization settings or roles","Cannot access HR, leave, or expense management","Cannot manage chart of accounts or journal entries"],permissions:["dashboard:read","branches:read","branches:write","members:read","members:write","staff:read","loan_products:read","loans:read","loans:write","loans:process","loans:approve","loans:reject","repayments:read","repayments:write","guarantors:read","guarantors:write","transactions:read","transactions:write","defaults:read","defaults:write","restructure:read","restructure:write","sms:read","sms:write","reports:read","analytics:read","float_management:read","float_management:write","shortage_approval:write","salary_deductions:read"]},{name:"loan_officer",description:"Handles loan applications and member management. Can create and disburse loans but cannot approve or reject them.",icon:xa,color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",capabilities:["Create and manage loan applications","Disburse approved loans (M-Pesa, bank, cash)","View and manage members","Process transactions","View repayments","Manage loan products","Handle loan restructuring"],cannotDo:["Cannot approve loan applications","Cannot reject loan applications","Cannot access reports, analytics, or dashboard","Cannot manage branches or staff","Cannot manage float or teller station"],permissions:["loans:read","loans:write","loans:process","members:read","members:write","transactions:read","transactions:write","repayments:read","loan_products:read","loan_products:write","restructure:read","restructure:write"]},{name:"teller",description:"Handles day-to-day transactions at the counter. Focused on deposits, withdrawals, and loan repayments.",icon:ns,color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",capabilities:["Access teller station for deposits, withdrawals, and repayments","View member information","Process loan repayments","Record transactions"],cannotDo:["Cannot create or manage loan applications","Cannot approve or reject loans","Cannot manage members, staff, or branches","Cannot access reports or analytics"],permissions:["teller_station:read","teller_station:write","members:read","repayments:read","repayments:write","transactions:read","transactions:write"]},{name:"reviewer",description:"Reviews and decides on loan applications. Can approve or reject but cannot create or disburse loans.",icon:tn,color:"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200",capabilities:["Review loan applications","Approve loan applications","Reject loan applications with reasons","View member details and guarantor information","View repayment history and defaults","Access reports and analytics for informed decisions"],cannotDo:["Cannot create loan applications","Cannot disburse loans","Cannot process transactions","Cannot manage members or staff"],permissions:["branches:read","members:read","staff:read","loan_products:read","loans:read","loans:approve","loans:reject","repayments:read","guarantors:read","defaults:read","restructure:read","reports:read","analytics:read"]},{name:"accountant",description:"Manages financial records and transactions. Focused on accounting, reports, and reconciliation.",icon:uW,color:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200",capabilities:["View and process transactions","Manage repayments","Handle defaults and write-offs","View member, staff, and loan information","Access financial reports and analytics"],cannotDo:["Cannot create or manage loan applications","Cannot approve or reject loans","Cannot manage members or staff","Cannot send SMS notifications","Cannot manage float or teller station"],permissions:["branches:read","members:read","staff:read","loan_products:read","loans:read","transactions:read","transactions:write","repayments:read","repayments:write","defaults:read","defaults:write","reports:read","analytics:read"]},{name:"auditor",description:"Read-only access across key modules for auditing and compliance purposes.",icon:Ts,color:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",capabilities:["View branches, members, staff, and loan products","View loan applications and repayments","View transactions","View defaults and restructuring records","View reports and analytics","View audit logs for complete traceability"],cannotDo:["Cannot create, edit, or delete any records","Cannot approve or reject anything","Cannot process transactions","Cannot change settings"],permissions:["branches:read","members:read","staff:read","loan_products:read","loans:read","transactions:read","repayments:read","defaults:read","restructure:read","reports:read","analytics:read","audit:read"]},{name:"hr",description:"Human resources management including staff records, leave management, and salary deductions.",icon:fh,color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200",capabilities:["View branches and manage staff records","Full HR management (performance reviews, records)","Manage leave requests (view, create, approve)","Manage salary deductions","View analytics"],cannotDo:["Cannot access loan or transaction features","Cannot view member financial data","Cannot access reports or audit logs","Cannot manage branches or settings"],permissions:["branches:read","staff:read","staff:write","hr:read","hr:write","analytics:read","leave:read","leave:write","leave:approve","salary_deductions:read","salary_deductions:write"]},{name:"supervisor",description:"Team supervisor focused on oversight and leave management for their team.",icon:bW,color:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200",capabilities:["View dashboard","View branches and staff","Manage and approve leave requests"],cannotDo:["Cannot access loan, transaction, or financial features","Cannot manage members or staff records","Cannot access reports or analytics","Cannot manage organization settings"],permissions:["dashboard:read","branches:read","staff:read","leave:read","leave:write","leave:approve"]},{name:"staff",description:"Basic staff access with minimal read permissions. Suitable for general employees.",icon:pn,color:"bg-slate-100 text-slate-800 dark:bg-slate-900 dark:text-slate-200",capabilities:["View branches and members","View staff directory","View loan products and loan applications","Submit leave requests"],cannotDo:["Cannot create or manage loans","Cannot process transactions","Cannot manage members or staff","Cannot access reports, analytics, or settings","Cannot approve anything"],permissions:["branches:read","members:read","staff:read","loan_products:read","loans:read","leave:read","leave:write"]},{name:"kiosk_operator",description:"Limited role for queue ticketing kiosk operations only.",icon:bn,color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",capabilities:["Access the ticketing kiosk interface","Manage queue display"],cannotDo:["Cannot access any other system features"],permissions:["ticketing:access","ticketing:display"]}],mbe={"dashboard:read":{label:"Dashboard: View",description:"View the main dashboard with overview statistics",icon:Ri},"branches:read":{label:"Branches: View",description:"View branch information and details",icon:vr},"branches:write":{label:"Branches: Manage",description:"Create, edit, and delete branches",icon:vr},"staff:read":{label:"Staff: View",description:"View staff member profiles and details",icon:pn},"staff:write":{label:"Staff: Manage",description:"Add, edit, and manage staff members",icon:pn},"members:read":{label:"Members: View",description:"View member profiles, balances, and history",icon:pn},"members:write":{label:"Members: Manage",description:"Register new members, edit member details",icon:pn},"members:activate":{label:"Members: Activate",description:"Activate member accounts",icon:yr},"members:suspend":{label:"Members: Suspend",description:"Suspend member accounts",icon:Cs},"loan_products:read":{label:"Loan Products: View",description:"View loan product configurations",icon:tn},"loan_products:write":{label:"Loan Products: Manage",description:"Create and configure loan products",icon:tn},"loans:read":{label:"Loans: View",description:"View loan applications and their status",icon:xa},"loans:write":{label:"Loans: Create/Edit",description:"Create new loan applications and edit existing ones",icon:xa},"loans:process":{label:"Loans: Disburse",description:"Disburse approved loans via M-Pesa, bank transfer, or cash",icon:xa},"loans:approve":{label:"Loans: Approve",description:"Approve pending loan applications",icon:yr},"loans:reject":{label:"Loans: Reject",description:"Reject pending loan applications with a reason",icon:Cs},"repayments:read":{label:"Repayments: View",description:"View loan repayment records and schedules",icon:md},"repayments:write":{label:"Repayments: Record",description:"Record loan repayment transactions",icon:md},"guarantors:read":{label:"Guarantors: View",description:"View loan guarantor information",icon:pn},"guarantors:write":{label:"Guarantors: Manage",description:"Add and manage loan guarantors",icon:pn},"transactions:read":{label:"Transactions: View",description:"View all financial transactions",icon:ns},"transactions:write":{label:"Transactions: Process",description:"Create deposits, withdrawals, and transfers",icon:ns},"fixed_deposits:read":{label:"Fixed Deposits: View",description:"View fixed deposit accounts and maturity details",icon:vr},"fixed_deposits:write":{label:"Fixed Deposits: Manage",description:"Create and manage fixed deposit accounts",icon:vr},"dividends:read":{label:"Dividends: View",description:"View dividend declarations and distributions",icon:md},"dividends:write":{label:"Dividends: Manage",description:"Declare and distribute dividends",icon:md},"chart_of_accounts:read":{label:"Chart of Accounts: View",description:"View the chart of accounts",icon:tn},"chart_of_accounts:write":{label:"Chart of Accounts: Manage",description:"Create and edit accounts in the chart of accounts",icon:tn},"journal_entries:read":{label:"Journal Entries: View",description:"View journal entries and general ledger",icon:tn},"journal_entries:write":{label:"Journal Entries: Create",description:"Create manual journal entries",icon:tn},"teller_station:read":{label:"Teller Station: View",description:"View teller station interface",icon:ns},"teller_station:write":{label:"Teller Station: Operate",description:"Process deposits, withdrawals, and repayments at the counter",icon:ns},"float_management:read":{label:"Float Management: View",description:"View cash float allocations and vault balance",icon:vr},"float_management:write":{label:"Float Management: Manage",description:"Allocate floats, manage vault cash, handle replenishment",icon:vr},"shortage_approval:write":{label:"Shortage Approval",description:"Approve or reject cash shortage reports from tellers",icon:yr},"defaults:read":{label:"Defaults: View",description:"View overdue loans and default reports",icon:Cs},"defaults:write":{label:"Defaults: Manage",description:"Manage loan defaults and collections",icon:Cs},"restructure:read":{label:"Restructure: View",description:"View loan restructuring records",icon:tn},"restructure:write":{label:"Restructure: Manage",description:"Restructure loans (extend terms, adjust rates)",icon:tn},"sms:read":{label:"SMS: View",description:"View SMS logs and templates",icon:tn},"sms:write":{label:"SMS: Send",description:"Send SMS notifications to members",icon:tn},"reports:read":{label:"Reports: View",description:"Access financial reports (Trial Balance, Income Statement, Balance Sheet)",icon:Ri},"analytics:read":{label:"Analytics: View",description:"Access performance analytics and dashboards",icon:Ri},"audit:read":{label:"Audit Logs: View",description:"View audit trail of all system actions",icon:Ts},"hr:read":{label:"HR: View",description:"View HR records and staff performance",icon:fh},"hr:write":{label:"HR: Manage",description:"Manage staff HR records and performance reviews",icon:fh},"leave:read":{label:"Leave: View",description:"View leave requests and balances",icon:bn},"leave:write":{label:"Leave: Request",description:"Submit leave requests",icon:bn},"leave:approve":{label:"Leave: Approve",description:"Approve or reject staff leave requests",icon:yr},"expenses:read":{label:"Expenses: View",description:"View expense records",icon:ns},"expenses:write":{label:"Expenses: Create",description:"Create and submit expense records",icon:ns},"expenses:approve":{label:"Expenses: Approve",description:"Approve or reject expense requests",icon:yr},"settings:read":{label:"Settings: View",description:"View organization settings",icon:Kd},"settings:write":{label:"Settings: Manage",description:"Change organization settings and configuration",icon:Kd},"roles:read":{label:"Roles: View",description:"View roles and their permissions",icon:Es},"roles:write":{label:"Roles: Manage",description:"Create, edit, and delete roles",icon:Es},"salary_deductions:read":{label:"Salary Deductions: View",description:"View salary deduction configurations",icon:md},"salary_deductions:write":{label:"Salary Deductions: Manage",description:"Create and manage salary deductions",icon:md},"ticketing:access":{label:"Ticketing: Access",description:"Access the queue ticketing kiosk",icon:bn},"ticketing:display":{label:"Ticketing: Display",description:"View the queue display screen",icon:bn}};function hbe({onBack:t}){const[n,r]=v.useState(""),s=ube.filter(o=>o.name.toLowerCase().includes(n.toLowerCase())||o.description.toLowerCase().includes(n.toLowerCase())||o.capabilities.some(c=>c.toLowerCase().includes(n.toLowerCase()))),a=Object.entries(mbe).filter(([o,c])=>o.toLowerCase().includes(n.toLowerCase())||c.label.toLowerCase().includes(n.toLowerCase())||c.description.toLowerCase().includes(n.toLowerCase())),i={};return a.forEach(([o,c])=>{const u=o.split(":")[0].replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase());i[u]||(i[u]=[]),i[u].push([o,c])}),e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:t,children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Roles & Permissions Guide"}),e.jsx("p",{className:"text-muted-foreground",children:"Understand what each role can do and how permissions work"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(za,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(re,{placeholder:"Search roles or permissions...",value:n,onChange:o=>r(o.target.value),className:"pl-10"})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5"}),"How Roles & Permissions Work"]})}),e.jsxs(de,{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Each staff member is assigned a ",e.jsx("span",{className:"font-medium text-foreground",children:"role"})," that determines what they can see and do in the system. Roles contain a set of ",e.jsx("span",{className:"font-medium text-foreground",children:"permissions"})," that control access to specific features."]}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg border p-3 space-y-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:"System Roles"}),e.jsx("p",{children:"Pre-configured roles that come with recommended permissions. You can customize their permissions but cannot delete them."})]}),e.jsxs("div",{className:"rounded-lg border p-3 space-y-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:"Custom Roles"}),e.jsx("p",{children:"Create your own roles with specific permissions tailored to your organization's needs."})]})]}),e.jsxs("div",{className:"rounded-lg bg-muted/50 border p-3 space-y-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:"Separation of Duties"}),e.jsxs("p",{children:["For security, loan processing is split across roles. For example, a ",e.jsx("span",{className:"font-medium",children:"Loan Officer"})," can create and disburse loans, while a ",e.jsx("span",{className:"font-medium",children:"Reviewer"})," approves or rejects them. This ensures no single person controls the entire loan lifecycle."]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["System Roles (",s.length,")"]}),e.jsx("div",{className:"grid gap-4",children:s.map(o=>{const c=o.icon;return e.jsxs(oe,{children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`rounded-lg p-2 ${o.color}`,children:e.jsx(c,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx(_e,{className:"text-base capitalize",children:o.name.replace(/_/g," ")}),e.jsx(dt,{children:o.description})]})]})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-700 dark:text-green-400 mb-2",children:"What this role can do:"}),e.jsx("ul",{className:"space-y-1",children:o.capabilities.map((u,m)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx(yr,{className:"h-4 w-4 text-green-500 mt-0.5 shrink-0"}),u]},m))})]}),o.cannotDo&&o.cannotDo.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-700 dark:text-red-400 mb-2",children:"Limitations:"}),e.jsx("ul",{className:"space-y-1",children:o.cannotDo.map((u,m)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx(Cs,{className:"h-4 w-4 text-red-400 mt-0.5 shrink-0"}),u]},m))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Permissions:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:o.permissions.map(u=>e.jsx(ze,{variant:"outline",className:"text-xs",children:u},u))})]})]})]},o.name)})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"All Permissions Reference"}),e.jsx(oe,{children:e.jsx(de,{className:"pt-6",children:e.jsx(yV,{type:"multiple",className:"w-full",children:Object.entries(i).map(([o,c])=>e.jsxs(a2,{value:o,children:[e.jsxs(i2,{className:"text-sm font-medium",children:[o,e.jsx(ze,{variant:"secondary",className:"ml-2",children:c.length})]}),e.jsx(o2,{children:e.jsx("div",{className:"space-y-3",children:c.map(([u,m])=>{const h=m.icon;return e.jsxs("div",{className:"flex items-start gap-3 p-2 rounded-lg hover:bg-muted/50",children:[e.jsx(h,{className:"h-4 w-4 text-muted-foreground mt-0.5 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:m.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:m.description}),e.jsx(ze,{variant:"outline",className:"text-xs mt-1",children:u})]})]},u)})})})]},o))})})})]})]})}const fbe={Dashboard:["dashboard:read"],Branches:["branches:read","branches:write"],Staff:["staff:read","staff:write"],Members:["members:read","members:write","members:activate","members:suspend"],"Loan Products":["loan_products:read","loan_products:write"],Loans:["loans:read","loans:write","loans:process","loans:approve","loans:reject"],Repayments:["repayments:read","repayments:write"],Guarantors:["guarantors:read","guarantors:write"],Transactions:["transactions:read","transactions:write"],"Fixed Deposits":["fixed_deposits:read","fixed_deposits:write"],Dividends:["dividends:read","dividends:write"],"Chart of Accounts":["chart_of_accounts:read","chart_of_accounts:write"],"Journal Entries":["journal_entries:read","journal_entries:write"],"Teller Station":["teller_station:read","teller_station:write"],"Float Management":["float_management:read","float_management:write"],"Shortage Approval":["shortage_approval:write"],Defaults:["defaults:read","defaults:write"],Restructure:["restructure:read","restructure:write"],SMS:["sms:read","sms:write"],Reports:["reports:read"],Analytics:["analytics:read"],Audit:["audit:read"],HR:["hr:read","hr:write"],Leave:["leave:read","leave:write","leave:approve"],Expenses:["expenses:read","expenses:write","expenses:approve"],Settings:["settings:read","settings:write"],Roles:["roles:read","roles:write"]};function pbe({organizationId:t}){const{toast:n}=Xt(),[r,s]=v.useState("list"),[a,i]=v.useState(null),[o,c]=v.useState(""),[u,m]=v.useState(""),[h,f]=v.useState([]),{canWrite:x}=_r(t,Nr.ROLES),{data:j,isLoading:b}=$e({queryKey:["/api/organizations",t,"roles"],queryFn:async()=>{const T=await fetch(`/api/organizations/${t}/roles`,{credentials:"include"});if(!T.ok)throw new Error("Failed to fetch roles");return T.json()}}),g=Le({mutationFn:async T=>Be("POST",`/api/organizations/${t}/roles`,T),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"roles"]}),N(),n({title:"Role created successfully"})},onError:()=>{n({title:"Failed to create role",variant:"destructive"})}}),y=Le({mutationFn:async({id:T,data:U})=>Be("PATCH",`/api/organizations/${t}/roles/${T}`,U),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"roles"]}),N(),n({title:"Role updated successfully"})},onError:()=>{n({title:"Failed to update role",variant:"destructive"})}}),C=Le({mutationFn:async T=>Be("DELETE",`/api/organizations/${t}/roles/${T}`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"roles"]}),n({title:"Role deleted successfully"})},onError:()=>{n({title:"Failed to delete role",variant:"destructive"})}}),k=Le({mutationFn:async T=>Be("POST",`/api/organizations/${t}/roles/${T}/reset`),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"roles"]}),n({title:"Role reset to default permissions"})},onError:()=>{n({title:"Failed to reset role",variant:"destructive"})}}),N=()=>{s("list"),i(null),c(""),m(""),f([])},P=()=>{i(null),c(""),m(""),f([]),s("form")},w=T=>{i(T),c(T.name),m(T.description||""),f(T.permissions),s("form")},S=()=>{if(!o.trim()){n({title:"Role name is required",variant:"destructive"});return}a?y.mutate({id:a.id,data:{name:o,description:u,permissions:h}}):g.mutate({name:o,description:u,permissions:h})},E=T=>{f(U=>U.includes(T)?U.filter(M=>M!==T):[...U,T])},R=T=>{const U=T.every(M=>h.includes(M));f(U?M=>M.filter(L=>!T.includes(L)):M=>Array.from(new Set([...M,...T])))};return b?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(ln,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):r==="docs"?e.jsx(hbe,{onBack:()=>s("list")}):r==="form"?e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:N,children:e.jsx($r,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:a?"Edit Role":"Create New Role"}),e.jsx("p",{className:"text-muted-foreground",children:a?"Update role details and permissions":"Define a new role with specific permissions"})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Basic Information"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"role-name",children:"Role Name"}),e.jsx(re,{id:"role-name",value:o,onChange:T=>c(T.target.value),placeholder:"e.g., Senior Loan Officer",disabled:a?.is_system})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"role-description",children:"Description"}),e.jsx(fn,{id:"role-description",value:u,onChange:T=>m(T.target.value),placeholder:"Describe what this role is for",rows:2})]})]})]}),e.jsxs(oe,{children:[e.jsx(we,{children:e.jsx(_e,{children:"Permissions"})}),e.jsxs(de,{className:"space-y-4",children:[e.jsx(yV,{type:"multiple",className:"w-full",children:Object.entries(fbe).map(([T,U])=>e.jsxs(a2,{value:T,children:[e.jsx(i2,{className:"text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ai,{checked:U.every(M=>h.includes(M)),onCheckedChange:()=>R(U),onClick:M=>M.stopPropagation()}),T,e.jsxs(ze,{variant:"secondary",className:"text-xs",children:[U.filter(M=>h.includes(M)).length,"/",U.length]})]})}),e.jsx(o2,{children:e.jsx("div",{className:"grid grid-cols-2 gap-2 pl-6",children:U.map(M=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ai,{id:M,checked:h.includes(M),onCheckedChange:()=>E(M)}),e.jsx("label",{htmlFor:M,className:"text-xs cursor-pointer",children:M.split(":")[1]})]},M))})})]},T))}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Selected: ",h.length," permissions"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(B,{variant:"outline",onClick:N,children:"Cancel"}),e.jsxs(B,{onClick:S,disabled:g.isPending||y.isPending,children:[(g.isPending||y.isPending)&&e.jsx(ln,{className:"h-4 w-4 mr-2 animate-spin"}),a?"Update Role":"Create Role"]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Manage Roles"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create custom roles and assign permissions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>s("docs"),children:[e.jsx(cW,{className:"h-4 w-4 mr-2"}),"Permissions Guide"]}),e.jsx(tr,{organizationId:t}),x&&e.jsxs(B,{onClick:P,children:[e.jsx(mn,{className:"h-4 w-4 mr-2"}),"Create Role"]})]})]}),e.jsx("div",{className:"grid gap-4",children:j?.map(T=>e.jsxs(oe,{children:[e.jsxs(we,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"text-base",children:T.name}),T.is_system&&e.jsxs(ze,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(hl,{className:"h-3 w-3"}),"System"]}),T.permissions.includes("*")&&e.jsx(ze,{className:"bg-green-100 text-green-800",children:"Full Access"})]}),e.jsxs("div",{className:"flex gap-2",children:[x&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>w(T),children:e.jsx(Ba,{className:"h-4 w-4"})}),x&&T.is_system&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>k.mutate(T.id),disabled:k.isPending,title:"Reset to default permissions",children:e.jsx(Jg,{className:"h-4 w-4"})}),x&&!T.is_system&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>C.mutate(T.id),disabled:C.isPending,children:e.jsx(ba,{className:"h-4 w-4 text-destructive"})})]})]}),e.jsx(dt,{children:T.description||"No description"})]}),e.jsx(de,{children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[T.permissions.includes("*")?e.jsx(ze,{variant:"outline",children:"All Permissions"}):T.permissions.slice(0,8).map(U=>e.jsx(ze,{variant:"outline",className:"text-xs",children:U},U)),!T.permissions.includes("*")&&T.permissions.length>8&&e.jsxs(ze,{variant:"outline",className:"text-xs",children:["+",T.permissions.length-8," more"]})]})})]},T.id))})]})}function xbe({organizationId:t}){const{toast:n}=Xt(),r=Le({mutationFn:async()=>(await Be("POST",`/api/organizations/${t}/trigger-auto-deduction`)).json(),onSuccess:s=>{n({title:"Auto Deduction Complete",description:`${s.deducted} loan(s) deducted, ${s.skipped} skipped (insufficient savings), ${s.errors} error(s)`})},onError:s=>{n({title:"Failed",description:s.message||"Could not run auto deduction",variant:"destructive"})}});return e.jsxs("div",{className:"pt-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>r.mutate(),disabled:r.isPending,"data-testid":"button-run-auto-deduction",children:[r.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(MW,{className:"mr-2 h-4 w-4"}),"Run Now"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Manually trigger auto loan deductions right now"})]})}function gbe({organizationId:t}){const{data:n,isLoading:r}=$e({queryKey:["/api/organizations",t,"usage"],enabled:!!t});if(r)return e.jsx(oe,{children:e.jsx(de,{className:"flex items-center justify-center py-12",children:e.jsx(ln,{className:"h-6 w-6 animate-spin text-muted-foreground"})})});if(!n)return null;const s={users:pn,"user-cog":fh,building:kW,"message-square":cl};function a(i){return i>=90?"bg-destructive":i>=70?"bg-yellow-500":"bg-primary"}return e.jsx("div",{className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Ri,{className:"h-5 w-5"}),"Plan Usage"]}),e.jsxs(dt,{children:["Your current plan: ",e.jsx("strong",{children:n.plan_name}),n.subscription_status.is_trial&&e.jsxs("span",{className:"ml-2 text-yellow-600 dark:text-yellow-400",children:["(Trial - ",n.subscription_status.trial_days_remaining," days remaining)"]})]})]}),e.jsxs(de,{children:[n.subscription_status.message&&e.jsx("div",{className:`mb-4 p-3 rounded-md text-sm ${n.subscription_status.is_expired?"bg-destructive/10 text-destructive border border-destructive/20":"bg-yellow-50 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-800"}`,children:n.subscription_status.message}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:n.usage.map(i=>{const o=s[i.icon]||pn;return e.jsxs("div",{className:"space-y-2 p-4 border rounded-md","data-testid":`usage-card-${i.label.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium text-sm",children:i.label})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i.current," / ",i.limit_display]})]}),i.limit!==null&&e.jsx("div",{className:"relative h-2 rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${a(i.percentage)}`,style:{width:`${i.percentage}%`}})}),i.limit===null&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"No limit on your current plan"}),i.percentage>=90&&i.limit!==null&&e.jsx("p",{className:"text-xs text-destructive",children:"Approaching limit - consider upgrading your plan"})]},i.label)})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(B,{variant:"outline",size:"sm",asChild:!0,"data-testid":"button-upgrade-plan",children:e.jsxs("a",{href:"/upgrade",children:[e.jsx(Mu,{className:"mr-2 h-4 w-4"}),"Upgrade Plan"]})})})]})]})})}function vbe({organizationId:t}){const{toast:n}=Xt(),[r,s]=v.useState(""),[a,i]=v.useState(!1),o=$e({queryKey:["/api/organizations",t]}),c=Le({mutationFn:async()=>(await Be("DELETE",`/api/organizations/${t}`)).json(),onSuccess:()=>{n({title:"Organization deleted",description:"The organization and all its data have been permanently removed."}),i(!1),Fe.clear(),window.location.href="/login"},onError:h=>{n({title:"Delete failed",description:h.message,variant:"destructive"})}}),u=o.data?.name??"",m=r===u&&u.length>0;return e.jsxs(oe,{className:"border-destructive/50",children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"text-destructive flex items-center gap-2",children:[e.jsx(Ur,{className:"h-5 w-5"}),"Delete Organization"]}),e.jsx(dt,{children:"Permanently delete this organization and all its data. This action cannot be undone."})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-md bg-destructive/10 p-4 text-sm space-y-2",children:[e.jsx("p",{className:"font-medium text-destructive",children:"This will permanently delete:"}),e.jsxs("ul",{className:"list-disc list-inside text-muted-foreground space-y-1",children:[e.jsx("li",{children:"All members, staff, and branch data"}),e.jsx("li",{children:"All loans, transactions, and financial records"}),e.jsx("li",{children:"All settings and configurations"}),e.jsx("li",{children:"The organization's database"})]})]}),e.jsxs(Vt,{open:a,onOpenChange:i,children:[e.jsx(lo,{asChild:!0,children:e.jsxs(B,{variant:"destructive","data-testid":"button-delete-org-trigger",children:[e.jsx(ba,{className:"mr-2 h-4 w-4"}),"Delete This Organization"]})}),e.jsxs(It,{children:[e.jsxs(qt,{children:[e.jsx(Bt,{className:"text-destructive",children:"Delete Organization"}),e.jsx(Qt,{children:"This action is permanent and cannot be undone. All data will be lost."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["To confirm, type the organization name: ",e.jsx("span",{className:"font-semibold text-foreground",children:u})]}),e.jsx(re,{value:r,onChange:h=>s(h.target.value),placeholder:"Type organization name to confirm","data-testid":"input-confirm-delete-org"})]}),e.jsxs(nn,{children:[e.jsx(B,{variant:"outline",onClick:()=>{i(!1),s("")},"data-testid":"button-cancel-delete-org",children:"Cancel"}),e.jsxs(B,{variant:"destructive",disabled:!m||c.isPending,onClick:()=>c.mutate(),"data-testid":"button-confirm-delete-org",children:[c.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ba,{className:"mr-2 h-4 w-4"}),"Permanently Delete"]})]})]})]})]})]})}function ybe({organizationId:t,isOwner:n}){const{toast:r}=Xt(),[s,a]=v.useState({}),[i,o]=v.useState(!1),[c,u]=v.useState(""),[m,h]=v.useState(!1),{data:f,isLoading:x}=$e({queryKey:["/api/organizations",t,"settings"],enabled:!!t}),{data:j}=$e({queryKey:["/api/organizations",t,"info"],queryFn:async()=>{const S=(await fetch("/api/organizations/my",{credentials:"include"}).then(E=>E.json()))?.find(E=>E.organizationId===t||E.organization?.id===t);if(S?.organization){const E=S.organization;return{staff_email_domain:E.staff_email_domain,name:E.name,phone:E.phone,email:E.email,address:E.address}}return{}},enabled:!!t});j?.staff_email_domain&&!c&&!m&&u(j.staff_email_domain);const b=Le({mutationFn:async w=>Be("PUT",`/api/organizations/${t}/settings`,w),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"settings"]}),r({title:"Settings saved successfully"}),o(!1)},onError:()=>{r({title:"Failed to save settings",variant:"destructive"})}}),g=Le({mutationFn:async w=>Be("PATCH",`/api/organizations/${t}`,w),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"info"]}),Fe.invalidateQueries({queryKey:["/api/organizations/my"]}),r({title:"Staff email domain updated"}),h(!1)},onError:()=>{r({title:"Failed to update staff email domain",variant:"destructive"})}}),y={organization_name:j?.name||"",organization_phone:j?.phone||"",organization_email:j?.email||"",organization_address:j?.address||""},C=w=>{if(s[w]!==void 0)return s[w];const S=f?.find(E=>E.setting_key===w);return S?.setting_value?S.setting_value:y[w]||""},k=w=>C(w).toLowerCase()==="true",N=(w,S)=>{a(E=>({...E,[w]:S})),o(!0)},P=()=>{b.mutate(s)};return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ln,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(vc,{title:"Organization Settings",description:"Configure your organization's preferences and integrations"}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 md:p-6",children:[e.jsxs($s,{defaultValue:"general",className:"space-y-6",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 md:mx-0 md:px-0",children:e.jsxs(vs,{className:"inline-flex h-12 items-center justify-start rounded-none bg-transparent p-0 w-auto",children:[e.jsxs(_t,{value:"general",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-general",children:[e.jsx(Yn,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"General"})]}),e.jsxs(_t,{value:"loans",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-loans",children:[e.jsx(vr,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Loans"})]}),e.jsxs(_t,{value:"members",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-members",children:[e.jsx(pn,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Members"})]}),e.jsxs(_t,{value:"sms",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-sms",children:[e.jsx(cl,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"SMS"})]}),e.jsxs(_t,{value:"email",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-email",children:[e.jsx(ja,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Email"})]}),e.jsxs(_t,{value:"mpesa",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-mpesa",children:[e.jsx(Wd,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"M-Pesa"})]}),e.jsxs(_t,{value:"hours",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-hours",children:[e.jsx(bn,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Hours"})]}),e.jsxs(_t,{value:"roles",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-roles",children:[e.jsx(Es,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Roles"})]}),e.jsxs(_t,{value:"usage",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-muted-foreground shadow-none transition-none data-[state=active]:border-b-primary data-[state=active]:text-foreground data-[state=active]:shadow-none gap-2","data-testid":"tab-usage",children:[e.jsx(Ri,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Usage"})]}),n&&e.jsxs(_t,{value:"danger",className:"relative h-12 rounded-none border-b-2 border-b-transparent bg-transparent px-4 pb-3 pt-3 font-medium text-destructive shadow-none transition-none data-[state=active]:border-b-destructive data-[state=active]:text-destructive data-[state=active]:shadow-none gap-2","data-testid":"tab-danger",children:[e.jsx(Ur,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Danger Zone"})]})]})})}),e.jsxs(Nt,{value:"general",className:"space-y-4",children:[e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Yn,{className:"h-5 w-5"})," Organization Details"]}),e.jsx(dt,{children:"Your organization's information displayed on receipts and documents"})]}),e.jsx(de,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"organization_name",children:"Organization Name"}),e.jsx(re,{id:"organization_name",value:C("organization_name"),onChange:w=>N("organization_name",w.target.value),placeholder:"e.g. Sunrise SACCO Ltd","data-testid":"input-organization-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"organization_phone",children:"Phone Number"}),e.jsx(re,{id:"organization_phone",value:C("organization_phone"),onChange:w=>N("organization_phone",w.target.value),placeholder:"e.g. +254 700 123 456","data-testid":"input-organization-phone"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"organization_email",children:"Email Address"}),e.jsx(re,{id:"organization_email",value:C("organization_email"),onChange:w=>N("organization_email",w.target.value),placeholder:"e.g. info@yoursacco.co.ke","data-testid":"input-organization-email"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"organization_website",children:"Website"}),e.jsx(re,{id:"organization_website",value:C("organization_website"),onChange:w=>N("organization_website",w.target.value),placeholder:"e.g. www.yoursacco.co.ke","data-testid":"input-organization-website"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(Se,{htmlFor:"organization_address",children:"Physical Address"}),e.jsx(re,{id:"organization_address",value:C("organization_address"),onChange:w=>N("organization_address",w.target.value),placeholder:"e.g. Kenyatta Avenue, Nairobi","data-testid":"input-organization-address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"organization_postal",children:"P.O. Box"}),e.jsx(re,{id:"organization_postal",value:C("organization_postal"),onChange:w=>N("organization_postal",w.target.value),placeholder:"e.g. 12345-00100 Nairobi","data-testid":"input-organization-postal"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"organization_registration_no",children:"Registration Number"}),e.jsx(re,{id:"organization_registration_no",value:C("organization_registration_no"),onChange:w=>N("organization_registration_no",w.target.value),placeholder:"e.g. CS/12345","data-testid":"input-organization-registration-no"})]})]})})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"General Settings"}),e.jsx(dt,{children:"Basic organization configuration"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"currency",children:"Currency"}),e.jsxs(Qe,{value:C("currency"),onValueChange:w=>{N("currency",w),N("currency_symbol",Ux(w))},children:[e.jsx(He,{id:"currency","data-testid":"select-currency",children:e.jsx(Xe,{placeholder:"Select currency"})}),e.jsx(Ge,{className:"max-h-60",children:_C.map(w=>e.jsxs(ee,{value:w.code,children:[w.code," - ",w.name]},w.code))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"date_format",children:"Date Format"}),e.jsxs(Qe,{value:C("date_format"),onValueChange:w=>N("date_format",w),children:[e.jsx(He,{id:"date_format","data-testid":"select-date-format",children:e.jsx(Xe,{placeholder:"Select format"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx(ee,{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx(ee,{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(Qe,{value:C("timezone")||"Africa/Nairobi",onValueChange:w=>N("timezone",w),children:[e.jsx(He,{id:"timezone","data-testid":"select-timezone",children:e.jsx(Xe,{placeholder:"Select timezone"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"Africa/Nairobi",children:"Africa/Nairobi (EAT)"}),e.jsx(ee,{value:"Africa/Lagos",children:"Africa/Lagos (WAT)"}),e.jsx(ee,{value:"Africa/Johannesburg",children:"Africa/Johannesburg (SAST)"}),e.jsx(ee,{value:"Africa/Cairo",children:"Africa/Cairo (EET)"}),e.jsx(ee,{value:"Africa/Accra",children:"Africa/Accra (GMT)"}),e.jsx(ee,{value:"Europe/London",children:"Europe/London (GMT/BST)"}),e.jsx(ee,{value:"Europe/Paris",children:"Europe/Paris (CET)"}),e.jsx(ee,{value:"America/New_York",children:"America/New_York (EST)"}),e.jsx(ee,{value:"America/Los_Angeles",children:"America/Los_Angeles (PST)"}),e.jsx(ee,{value:"Asia/Dubai",children:"Asia/Dubai (GST)"}),e.jsx(ee,{value:"Asia/Singapore",children:"Asia/Singapore (SGT)"}),e.jsx(ee,{value:"Asia/Tokyo",children:"Asia/Tokyo (JST)"}),e.jsx(ee,{value:"UTC",children:"UTC"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"auto_logout_minutes",children:"Auto Logout (minutes)"}),e.jsx(re,{id:"auto_logout_minutes",type:"number",value:C("auto_logout_minutes"),onChange:w=>N("auto_logout_minutes",w.target.value),placeholder:"30","data-testid":"input-auto-logout"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically log out users after this many minutes of inactivity"})]})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(ja,{className:"h-5 w-5"})," Staff Email Domain"]}),e.jsx(dt,{children:"The domain used to generate work emails for staff members (e.g. john@yourdomain.com)"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"staff_email_domain",children:"Domain"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"px-3 py-2 bg-muted border border-r-0 rounded-l-md text-muted-foreground text-sm",children:"@"}),e.jsx(re,{id:"staff_email_domain",value:c?.replace("@","")||"",onChange:w=>{u(w.target.value.replace("@","")),h(!0)},placeholder:"mysacco.co.ke",className:"rounded-l-none"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["When you add new staff, their work email will be ",e.jsxs("span",{className:"font-medium",children:["username@",c||"yourdomain.com"]})]})]}),m&&e.jsx(B,{onClick:()=>g.mutate({staff_email_domain:c}),disabled:g.isPending||!c,size:"sm",children:g.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"})," Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Um,{className:"mr-2 h-4 w-4"})," Save Domain"]})})]})]})]}),e.jsx(Nt,{value:"loans",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Loan Settings"}),e.jsx(dt,{children:"Configure loan application rules and automation"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Require Guarantors for Loans"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All loan applications must have guarantors"})]}),e.jsx(ts,{checked:k("require_guarantors"),onCheckedChange:w=>N("require_guarantors",String(w)),"data-testid":"switch-require-guarantors"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"max_guarantor_exposure",children:"Max Guarantor Exposure"}),e.jsx(re,{id:"max_guarantor_exposure",type:"number",value:C("max_guarantor_exposure"),onChange:w=>N("max_guarantor_exposure",w.target.value),placeholder:"3","data-testid":"input-max-guarantor"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Maximum number of loans a member can guarantee at once"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Auto Loan Deduction from Savings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically deduct loan repayments from member savings accounts on the instalment due date"})]}),e.jsx(ts,{checked:k("auto_loan_deduction"),onCheckedChange:w=>N("auto_loan_deduction",String(w)),"data-testid":"switch-auto-loan-deduction"})]}),k("auto_loan_deduction")&&e.jsxs("div",{className:"space-y-2 pl-4 border-l-2 border-primary/20",children:[e.jsx(Se,{htmlFor:"auto_loan_deduction_time",children:"Deduction Time"}),e.jsx(re,{id:"auto_loan_deduction_time",type:"time",value:C("auto_loan_deduction_time")||"06:00",onChange:w=>N("auto_loan_deduction_time",w.target.value),"data-testid":"input-auto-deduction-time",className:"w-40"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"What time of day to run auto-deductions (based on your organization timezone)"}),e.jsx(xbe,{organizationId:t})]})]})]})}),e.jsx(Nt,{value:"members",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Member Account Settings"}),e.jsx(dt,{children:"Configure member registration and activation rules"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Require Opening Deposit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Members must make a deposit before account activation"})]}),e.jsx(ts,{checked:k("require_opening_deposit"),onCheckedChange:w=>N("require_opening_deposit",String(w)),"data-testid":"switch-require-opening-deposit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"minimum_opening_deposit",children:"Minimum Opening Deposit"}),e.jsx(re,{id:"minimum_opening_deposit",type:"number",value:C("minimum_opening_deposit"),onChange:w=>N("minimum_opening_deposit",w.target.value),placeholder:"0","data-testid":"input-min-opening-deposit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Minimum amount required for account activation (when enabled)"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Auto-Activate on First Deposit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically activate pending accounts when they receive their first deposit"})]}),e.jsx(ts,{checked:k("auto_activate_on_deposit"),onCheckedChange:w=>N("auto_activate_on_deposit",String(w)),"data-testid":"switch-auto-activate"})]})]})]})}),e.jsx(Nt,{value:"sms",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"SMS Integration"}),e.jsx(dt,{children:"Configure SMS notifications for members and staff"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Enable SMS Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send SMS alerts for loan approvals, repayment reminders, etc."})]}),e.jsx(ts,{checked:k("sms_enabled"),onCheckedChange:w=>N("sms_enabled",String(w)),"data-testid":"switch-sms-enabled"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"sms_sender_id",children:"Sender ID / Short Code"}),e.jsx(re,{id:"sms_sender_id",value:C("sms_sender_id"),onChange:w=>N("sms_sender_id",w.target.value),placeholder:"e.g., PointifyPOS","data-testid":"input-sms-sender-id"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"sms_endpoint",children:"API Endpoint URL"}),e.jsx(re,{id:"sms_endpoint",value:C("sms_endpoint"),onChange:w=>N("sms_endpoint",w.target.value),placeholder:"https://api.smsprovider.com/send","data-testid":"input-sms-endpoint"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The full URL for sending SMS via your provider's API"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"sms_api_key",children:"API Key"}),e.jsx(re,{id:"sms_api_key",type:"password",value:C("sms_api_key"),onChange:w=>N("sms_api_key",w.target.value),placeholder:"Enter your SMS API key","data-testid":"input-sms-api-key"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your SMS provider's API key for authentication"})]}),i&&e.jsx(B,{onClick:P,disabled:b.isPending,"data-testid":"button-save-sms",children:b.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Um,{className:"mr-2 h-4 w-4"}),"Save SMS Settings"]})})]})]})}),e.jsx(Nt,{value:"email",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Email Settings"}),e.jsx(dt,{children:"Configure email notifications via Brevo"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Enable Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send email notifications for payslips, reminders, etc."})]}),e.jsx(ts,{checked:k("email_enabled"),onCheckedChange:w=>N("email_enabled",String(w)),"data-testid":"switch-email-enabled"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"brevo_api_key",children:"Brevo API Key"}),e.jsx(re,{id:"brevo_api_key",type:"password",value:C("brevo_api_key"),onChange:w=>N("brevo_api_key",w.target.value),placeholder:"Your Brevo API key","data-testid":"input-brevo-api-key"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Get your API key from ",e.jsx("a",{href:"https://app.brevo.com/settings/keys/api",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Brevo Dashboard"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"email_from_name",children:"Sender Name"}),e.jsx(re,{id:"email_from_name",value:C("email_from_name"),onChange:w=>N("email_from_name",w.target.value),placeholder:"e.g., Your Organization Name","data-testid":"input-email-from-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"email_from_address",children:"Sender Email Address"}),e.jsx(re,{id:"email_from_address",type:"email",value:C("email_from_address"),onChange:w=>N("email_from_address",w.target.value),placeholder:"e.g., noreply@yourorganization.com","data-testid":"input-email-from-address"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This email must be verified in your Brevo account"})]}),i&&e.jsx(B,{onClick:P,disabled:b.isPending,className:"w-full","data-testid":"button-save-email-settings",children:b.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Um,{className:"mr-2 h-4 w-4"}),"Save Email Settings"]})})]})]})}),e.jsx(Nt,{value:"mpesa",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"M-Pesa Integration"}),e.jsx(dt,{children:"Configure M-Pesa payment gateway for member deposits, disbursements, and reversals"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Enable M-Pesa"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow members to deposit via M-Pesa"})]}),e.jsx(ts,{checked:k("mpesa_enabled"),onCheckedChange:w=>N("mpesa_enabled",String(w)),"data-testid":"switch-mpesa-enabled"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Payment Gateway"}),e.jsxs(Qe,{value:C("mpesa_gateway")||"daraja",onValueChange:w=>N("mpesa_gateway",w),children:[e.jsx(He,{"data-testid":"select-mpesa-gateway",children:e.jsx(Xe,{placeholder:"Select payment gateway"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"daraja",children:"Direct Daraja API"}),e.jsx(ee,{value:"sunpay",children:"SunPay (Managed Gateway)"})]})]})]}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 dark:bg-blue-950/30 dark:border-blue-800 p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Zg,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5 shrink-0"}),e.jsx("div",{className:"text-sm",children:(C("mpesa_gateway")||"daraja")==="daraja"?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"Direct Daraja API"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-400",children:"Connect directly to Safaricom's Daraja API. You need to register on the Safaricom Developer Portal, create an app, get your Consumer Key, Consumer Secret, and Passkey. Best for organizations that want full control over their M-Pesa integration."})]}):e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"SunPay - Managed M-Pesa Gateway"}),e.jsxs("p",{className:"text-blue-700 dark:text-blue-400",children:["SunPay handles all the Safaricom setup for you. Simply create a free account at ",e.jsx("a",{href:"https://sunpay.co.ke",target:"_blank",rel:"noopener noreferrer",className:"underline font-medium",children:"sunpay.co.ke"}),", get your API key, and start accepting payments. Supports STK Push, C2B (Paybill), B2C (disbursements), and transaction reversals. Pricing: 1.5% per successful transaction, no monthly fees."]})]})})]})}),(C("mpesa_gateway")||"daraja")==="daraja"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_paybill",children:"Paybill Number"}),e.jsx(re,{id:"mpesa_paybill",value:C("mpesa_paybill"),onChange:w=>N("mpesa_paybill",w.target.value),placeholder:"e.g., 174379","data-testid":"input-mpesa-paybill"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_environment",children:"Environment"}),e.jsxs(Qe,{value:C("mpesa_environment")||"sandbox",onValueChange:w=>N("mpesa_environment",w),children:[e.jsx(He,{id:"mpesa_environment","data-testid":"select-mpesa-env",children:e.jsx(Xe,{placeholder:"Select environment"})}),e.jsxs(Ge,{children:[e.jsx(ee,{value:"sandbox",children:"Sandbox (Testing)"}),e.jsx(ee,{value:"production",children:"Production (Live)"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_consumer_key",children:"Consumer Key"}),e.jsx(re,{id:"mpesa_consumer_key",type:"password",value:C("mpesa_consumer_key"),onChange:w=>N("mpesa_consumer_key",w.target.value),placeholder:"Daraja API consumer key","data-testid":"input-mpesa-consumer-key"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_consumer_secret",children:"Consumer Secret"}),e.jsx(re,{id:"mpesa_consumer_secret",type:"password",value:C("mpesa_consumer_secret"),onChange:w=>N("mpesa_consumer_secret",w.target.value),placeholder:"Daraja API consumer secret","data-testid":"input-mpesa-consumer-secret"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_passkey",children:"Online Passkey"}),e.jsx(re,{id:"mpesa_passkey",type:"password",value:C("mpesa_passkey"),onChange:w=>N("mpesa_passkey",w.target.value),placeholder:"M-Pesa online passkey","data-testid":"input-mpesa-passkey"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_stk_callback_url",children:"STK Push Callback URL"}),e.jsx(re,{id:"mpesa_stk_callback_url",value:C("mpesa_stk_callback_url"),onChange:w=>N("mpesa_stk_callback_url",w.target.value),placeholder:"https://yourdomain.com/api/mpesa/stk-callback/org_id","data-testid":"input-mpesa-stk-callback"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Safaricom will send STK Push results to this URL. Format: https://yourdomain.com/api/mpesa/stk-callback/",t]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_initiator_name",children:"B2C Initiator Name"}),e.jsx(re,{id:"mpesa_initiator_name",value:C("mpesa_initiator_name"),onChange:w=>N("mpesa_initiator_name",w.target.value),placeholder:"testapi","data-testid":"input-mpesa-initiator"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required for B2C disbursements"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa_security_credential",children:"B2C Security Credential"}),e.jsx(re,{id:"mpesa_security_credential",type:"password",value:C("mpesa_security_credential"),onChange:w=>N("mpesa_security_credential",w.target.value),placeholder:"Encrypted credential","data-testid":"input-mpesa-security-credential"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required for B2C disbursements"})]})]}),e.jsxs("div",{className:"rounded-lg bg-muted p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Callback URLs"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Register these URLs in your Safaricom Daraja Portal:"}),e.jsxs("div",{className:"space-y-1 text-sm font-mono bg-background p-2 rounded",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Validation:"})," /api/mpesa/c2b/validation/",t]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Confirmation:"})," /api/mpesa/c2b/confirmation/",t]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"STK Callback:"})," /api/mpesa/stk-callback/",t]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"sunpay_api_key",children:"SunPay API Key"}),e.jsx(re,{id:"sunpay_api_key",type:"password",value:C("sunpay_api_key"),onChange:w=>N("sunpay_api_key",w.target.value),placeholder:"sp_your_api_key_here","data-testid":"input-sunpay-api-key"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Get your API key from your ",e.jsx("a",{href:"https://sunpay.co.ke/dashboard",target:"_blank",rel:"noopener noreferrer",className:"underline text-primary",children:"SunPay Dashboard"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Webhook URL"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Copy this URL and set it as your webhook/callback URL in your SunPay dashboard. BANKY will automatically receive and process payment notifications."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{readOnly:!0,value:`${window.location.origin}/api/webhooks/sunpay/${t}`,className:"font-mono text-xs","data-testid":"input-sunpay-webhook-url"}),e.jsx(B,{type:"button",variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/api/webhooks/sunpay/${t}`),r({title:"Copied!",description:"Webhook URL copied to clipboard"})},className:"shrink-0",children:e.jsx(wW,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"rounded-lg bg-muted p-4",children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4 text-green-600"}),"Supported Payment Flows"]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"STK Push"}),e.jsx("p",{className:"text-muted-foreground",children:"Send payment prompt to customer's phone for deposits and repayments"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"C2B (Paybill)"}),e.jsx("p",{className:"text-muted-foreground",children:"Customers pay via M-Pesa Paybill using their member number as account reference"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"B2C (Disbursements)"}),e.jsx("p",{className:"text-muted-foreground",children:"Send money to member's M-Pesa for loan disbursements, refunds, or cashback"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Transaction Reversal"}),e.jsx("p",{className:"text-muted-foreground",children:"Reverse completed M-Pesa transactions for refunds or corrections"})]})]})]})]})]})]})}),e.jsx(Nt,{value:"hours",className:"space-y-4",children:e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:"Working Hours"}),e.jsx(dt,{children:"Configure organization operating hours"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Require Clock In"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Staff must clock in before they can use the system"})]}),e.jsx(ts,{checked:k("require_clock_in"),onCheckedChange:w=>N("require_clock_in",String(w)),"data-testid":"switch-require-clock-in"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Enforce Working Hours"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Restrict system access to working hours only"})]}),e.jsx(ts,{checked:k("enforce_working_hours"),onCheckedChange:w=>N("enforce_working_hours",String(w)),"data-testid":"switch-enforce-hours"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Se,{children:"Allow Weekend Access"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow staff to access the system on weekends"})]}),e.jsx(ts,{checked:k("allow_weekend_access"),onCheckedChange:w=>N("allow_weekend_access",String(w)),"data-testid":"switch-weekend-access"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"working_start_time",children:"Start Time"}),e.jsx(re,{id:"working_start_time",type:"time",value:C("working_start_time")||"08:00",onChange:w=>N("working_start_time",w.target.value),"data-testid":"input-start-time"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"working_end_time",children:"End Time"}),e.jsx(re,{id:"working_end_time",type:"time",value:C("working_end_time")||"17:00",onChange:w=>N("working_end_time",w.target.value),"data-testid":"input-end-time"})]})]})]})]})}),e.jsx(Nt,{value:"roles",className:"space-y-4",children:e.jsx(pbe,{organizationId:t})}),e.jsx(Nt,{value:"usage",className:"space-y-4",children:e.jsx(gbe,{organizationId:t})}),e.jsx(Nt,{value:"danger",className:"space-y-4",children:e.jsx(vbe,{organizationId:t})})]}),e.jsx("div",{className:"fixed bottom-4 right-4 md:bottom-6 md:right-6 z-50",children:e.jsxs(B,{onClick:P,disabled:!i||b.isPending,size:"lg",className:"shadow-lg","data-testid":"button-save-settings",children:[b.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Um,{className:"mr-2 h-4 w-4"}),i?"Save Changes":"Saved"]})})]})]})}const jbe={USD:"$",KES:"KES ",NGN:"",GHS:"GH",ZAR:"R"},jF={starter:{bg:"bg-slate-50",border:"border-slate-200"},growth:{bg:"bg-blue-50",border:"border-blue-200"},professional:{bg:"bg-purple-50",border:"border-purple-200"},enterprise:{bg:"bg-amber-50",border:"border-amber-200"}},bbe=[{id:"card",label:"Card",icon:ns,description:"Visa, Mastercard, Verve"},{id:"mobile_money",label:"Mobile Money",icon:Wd,description:"M-Pesa, MTN MoMo, Airtel"}];function wbe(t,n,r){if(n==="USD")return t;const s=r[n]||1;return Math.round(t*s)}function jV(t,n,r){return t==="stripe"?"USD":t==="mpesa"?"KES":r==="card"?"USD":n||"NGN"}function EN(t,n,r,s,a,i){const o=r==="annual"&&t.annual_price>0?t.annual_price:t.monthly_price,c=jV(n,a,i);return wbe(o,c,s)}function fx(t,n,r,s){const a=jV(n,r,s);return`${jbe[a]||a+" "}${t.toLocaleString()}`}function _be(t){return t.annual_price>0}const Nbe={core_banking:"Core Banking",members:"Members Management",savings:"Savings Accounts",shares:"Share Accounts",loans:"Loans",teller_station:"Teller Station",float_management:"Float Management",fixed_deposits:"Fixed Deposits",dividends:"Dividends",analytics:"Analytics",analytics_export:"Analytics Export",sms_notifications:"SMS Notifications",bulk_sms:"Bulk SMS",expenses:"Expenses Management",leave_management:"Leave Management",payroll:"Payroll",accounting:"Accounting",audit_logs:"Audit Logs",multiple_branches:"Multiple Branches",api_access:"API Access",white_label:"White Label",custom_reports:"Custom Reports",mpesa_integration:"M-Pesa Integration",bank_integration:"Bank Integration"};function Sbe(t){return Nbe[t]||t}function ON(t){const n=(t.features?.enabled||[]).map(Sbe),r=t.features?.custom||[];return[...n,...r]}function Cbe({organizationId:t}){const{toast:n}=Xt(),[r,s]=v.useState(!1),[a,i]=v.useState(!1),[o,c]=v.useState(null),[u,m]=v.useState("monthly"),[h,f]=v.useState("mpesa"),[x,j]=v.useState("card"),[b,g]=v.useState(""),[y,C]=v.useState(""),[k,N]=v.useState("idle"),[P,w]=v.useState(null),[S,E]=v.useState({name:"",email:"",organization:"",message:""}),[R,T]=v.useState(!1);v.useEffect(()=>{const Y=new URLSearchParams(window.location.search),ie=Y.get("payment"),Ee=Y.get("payment_id");ie==="success"&&Ee?(w(Ee),N("waiting"),i(!0),f("stripe"),window.history.replaceState({},"",window.location.pathname)):ie==="cancelled"&&(n({title:"Payment Cancelled",description:"Your payment was cancelled.",variant:"destructive"}),window.history.replaceState({},"",window.location.pathname))},[]);const{data:U,isLoading:M}=$e({queryKey:["plans",t],queryFn:async()=>{const Y=await fetch(`/api/organizations/${t}/plans`,{credentials:"include"});if(!Y.ok)throw new Error("Failed to load plans");return Y.json()}}),{data:L}=$e({queryKey:["public-branding"],queryFn:async()=>{const Y=await fetch("/api/public/branding");return Y.ok?Y.json():{}}}),{data:q}=$e({queryKey:["exchange-rates"],queryFn:async()=>{const Y=await fetch("/api/exchange-rates");return Y.ok?Y.json():{base:"USD",rates:{USD:1,KES:130,NGN:1550},paystack_currency:"NGN"}},staleTime:1e3*60*30}),$=q?.rates||{USD:1,KES:130,NGN:1550},D=q?.paystack_currency||"NGN",{data:z}=$e({queryKey:["enabled-gateways"],queryFn:async()=>{const Y=await fetch("/api/admin/public/enabled-gateways");return Y.ok?Y.json():{mpesa:!0,stripe:!0,paystack:!0}}});v.useEffect(()=>{if(k!=="waiting"||!P)return;const Y=setInterval(async()=>{try{const Ee=await fetch(`/api/organizations/${t}/subscription/check-payment/${P}`,{credentials:"include"});if(!Ee.ok)return;const Ke=await Ee.json();Ke.status==="completed"?(N("success"),clearInterval(Y),Fe.invalidateQueries({queryKey:["plans",t]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"features"]}),n({title:"Payment Successful!",description:"Your subscription has been activated."})):Ke.status==="failed"&&(N("failed"),clearInterval(Y))}catch{}},3e3),ie=setTimeout(()=>{clearInterval(Y),k==="waiting"&&(N("idle"),n({title:"Payment Timeout",description:"We haven't received confirmation yet. If you paid, it may take a moment to process.",variant:"destructive"}))},12e4);return()=>{clearInterval(Y),clearTimeout(ie)}},[k,P,t]);const J=v.useRef(!1),I=v.useRef(!1),X=async()=>{if(!(!o||J.current)){J.current=!0,N("sending");try{let Y;if(h==="mpesa"){if(!b){N("idle"),J.current=!1;return}Y=await fetch(`/api/organizations/${t}/subscription/pay-mpesa`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({plan_id:o.id,phone:b,billing_period:u})})}else if(h==="stripe")Y=await fetch(`/api/organizations/${t}/subscription/pay-stripe`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({plan_id:o.id,billing_period:u})});else{if(!y){N("idle"),J.current=!1;return}Y=await fetch(`/api/organizations/${t}/subscription/pay-paystack`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({plan_id:o.id,email:y,billing_period:u,channels:[x],currency:x==="card"?"USD":void 0})})}const ie=await Y.json();if(!Y.ok){N("failed"),J.current=!1,n({title:"Payment Failed",description:ie.detail||"Failed to initiate payment",variant:"destructive"});return}if(w(ie.payment_id),h==="mpesa")N("waiting"),J.current=!1,n({title:"Check Your Phone",description:ie.message||"Enter your M-Pesa PIN to confirm"});else if(h==="stripe"&&ie.checkout_url)window.location.href=ie.checkout_url;else if(h==="paystack"&&ie.access_code){I.current=!0,i(!1);try{const Ee=window.PaystackPop;Ee?new Ee().resumeTransaction(ie.access_code,{onSuccess:()=>{I.current=!1,J.current=!1,N("waiting"),i(!0)},onCancel:()=>{I.current=!1,J.current=!1,N("idle"),i(!0)},onError:()=>{I.current=!1,J.current=!1,N("failed"),i(!0),n({title:"Payment Error",description:"Something went wrong. Please try again.",variant:"destructive"})}}):(J.current=!1,window.location.href=ie.authorization_url)}catch{J.current=!1,ie.authorization_url&&(window.location.href=ie.authorization_url)}}else J.current=!1}catch{N("failed"),J.current=!1,n({title:"Error",description:"Failed to initiate payment. Please try again.",variant:"destructive"})}}},ne=Y=>{c(Y),m("monthly");const ie=z||{mpesa:!0,stripe:!0,paystack:!0},Ee=ie.mpesa?"mpesa":ie.paystack?"paystack":ie.stripe?"stripe":"mpesa";f(Ee),j("card"),g(""),C(""),N("idle"),w(null),i(!0)},W=async Y=>{Y.preventDefault(),T(!0);try{const Ee=await(await fetch("/api/public/sales-inquiry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).json();Ee.success?(n({title:"Inquiry Sent",description:Ee.message||"We'll get back to you soon!"}),s(!1),E({name:"",email:"",organization:"",message:""})):n({title:"Error",description:Ee.error||"Failed to send inquiry.",variant:"destructive"})}catch{n({title:"Error",description:"Failed to send inquiry. Please try again later.",variant:"destructive"})}finally{T(!1)}};if(M)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ln,{className:"h-8 w-8 animate-spin text-primary"})});const H=U?.filter(Y=>Y.pricing_model==="saas")||U||[],fe=o?EN(o,h,u,$,D,x):0,Pe=o?_be(o):!1,Re=[{id:"mpesa",label:"M-Pesa",sub:"KES",icon:Wd,color:"text-green-600"},{id:"paystack",label:"Paystack",sub:D,icon:uE,color:"text-blue-600"},{id:"stripe",label:"Stripe",sub:"USD",icon:ns,color:"text-purple-600"}],Ie=z||{mpesa:!0,stripe:!0,paystack:!0},Ce=Re.filter(Y=>Ie[Y.id]);return e.jsxs("div",{className:"space-y-6 overflow-x-hidden",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"Subscription Plans"}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"Choose the plan that best fits your organization's needs"})]}),e.jsx("div",{className:"grid gap-4 md:gap-6",style:{gridTemplateColumns:"repeat(auto-fill, minmax(min(100%, 260px), 1fr))"},children:H.map(Y=>{const ie=jF[Y.plan_type]||jF.starter,Ee=Y.plan_type==="growth";return e.jsxs(oe,{className:`relative flex flex-col mt-4 ${Y.is_current?"ring-2 ring-primary shadow-lg":"hover:shadow-md transition-shadow"}`,children:[Y.is_current&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 z-10",children:e.jsxs(ze,{className:"bg-primary text-primary-foreground shadow-sm whitespace-nowrap",children:[e.jsx(_W,{className:"w-3 h-3 mr-1"}),"Current Plan"]})}),Ee&&!Y.is_current&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 z-10",children:e.jsxs(ze,{className:"bg-blue-600 text-white shadow-sm whitespace-nowrap",children:[e.jsx(DW,{className:"w-3 h-3 mr-1"}),"Popular"]})}),e.jsxs(we,{className:`${ie.bg} rounded-t-lg border-b ${ie.border} p-4 md:p-6`,children:[e.jsx(_e,{className:"text-base md:text-lg capitalize",children:Y.name}),e.jsxs(dt,{className:"pt-2",children:[e.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-foreground",children:["$",Y.monthly_price.toLocaleString()]}),e.jsx("span",{className:"text-muted-foreground text-sm",children:"/month"})]}),Y.annual_price>0&&e.jsxs("span",{className:"text-xs text-muted-foreground mt-1",children:["$",Y.annual_price.toLocaleString(),"/year"]})]}),e.jsx(de,{className:"flex-1 pt-4 md:pt-6 p-4 md:p-6",children:e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Limits"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1.5 text-sm",children:[e.jsxs("div",{className:"flex justify-between py-1 px-2 bg-muted/50 rounded",children:[e.jsx("span",{className:"text-muted-foreground text-xs md:text-sm",children:"Members"}),e.jsx("span",{className:"font-medium text-xs md:text-sm",children:Y.max_members>=999999?"Unlimited":Y.max_members.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between py-1 px-2 bg-muted/50 rounded",children:[e.jsx("span",{className:"text-muted-foreground text-xs md:text-sm",children:"Staff"}),e.jsx("span",{className:"font-medium text-xs md:text-sm",children:Y.max_staff>=999999?"Unlimited":Y.max_staff})]}),e.jsxs("div",{className:"flex justify-between py-1 px-2 bg-muted/50 rounded",children:[e.jsx("span",{className:"text-muted-foreground text-xs md:text-sm",children:"Branches"}),e.jsx("span",{className:"font-medium text-xs md:text-sm",children:Y.max_branches>=999999?"Unlimited":Y.max_branches})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Features"}),e.jsxs("ul",{className:"space-y-1.5",children:[ON(Y).slice(0,8).map((Ke,Te)=>e.jsxs("li",{className:"flex items-start gap-1.5 text-xs md:text-sm",children:[e.jsx(fs,{className:"h-3.5 w-3.5 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"break-words min-w-0",children:Ke})]},Te)),ON(Y).length>8&&e.jsxs("li",{className:"text-xs text-muted-foreground pl-5",children:["+",ON(Y).length-8," more"]})]})]})]})}),e.jsx("div",{className:"p-4 md:p-6 pt-0 mt-auto",children:Y.is_current?e.jsx(B,{className:"w-full",size:"lg",variant:"outline",disabled:!0,children:"Current Plan"}):e.jsx(B,{className:"w-full",size:"lg",variant:Y.is_upgrade?"default":"secondary",onClick:()=>ne(Y),children:Y.is_upgrade?"Upgrade Now":Y.is_downgrade?"Switch Plan":"Select Plan"})})]},Y.id)})}),e.jsx(oe,{className:"bg-gradient-to-r from-slate-900 to-slate-800 text-white",children:e.jsxs(de,{className:"flex flex-col sm:flex-row items-center justify-between gap-3 p-4 md:py-6",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold",children:"Need a custom solution?"}),e.jsx("p",{className:"text-slate-300 text-xs md:text-sm",children:"Contact our sales team for Enterprise pricing and custom development options."})]}),e.jsxs(B,{variant:"secondary",className:"whitespace-nowrap w-full sm:w-auto",onClick:()=>s(!0),children:[e.jsx(ja,{className:"h-4 w-4 mr-2"}),"Contact Sales"]})]})}),e.jsx(Vt,{open:a,onOpenChange:Y=>{!Y&&k==="waiting"||!Y&&I.current||(i(Y),Y||(N("idle"),w(null),J.current=!1))},children:e.jsxs(It,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{children:["Subscribe to ",o?.name]}),e.jsx(Qt,{children:"Choose your preferred payment method"})]}),k==="success"?e.jsxs("div",{className:"flex flex-col items-center py-6 gap-4",children:[e.jsx(ps,{className:"h-16 w-16 text-green-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Payment Successful!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Your ",o?.name," subscription is now active."]})]}),e.jsx(B,{onClick:()=>{i(!1),N("idle"),w(null),Fe.invalidateQueries({queryKey:["plans",t]}),Fe.invalidateQueries({queryKey:["/api/organizations",t,"features"]}),Fe.invalidateQueries({queryKey:["/api/auth/session",t]})},className:"mt-2",children:"Done"})]}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Payment Gateway"}),e.jsx("div",{className:`grid gap-2 ${Ce.length===1?"grid-cols-1":Ce.length===2?"grid-cols-2":"grid-cols-3"}`,children:Ce.map(Y=>{const ie=Y.icon,Ee=h===Y.id;return e.jsxs("button",{type:"button",onClick:()=>{f(Y.id),N("idle")},disabled:k==="sending"||k==="waiting",className:`flex flex-col items-center gap-1 p-3 rounded-lg border-2 transition-all ${Ee?"border-primary bg-primary/5 shadow-sm":"border-muted hover:border-muted-foreground/30"} ${k==="sending"||k==="waiting"?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[e.jsx(ie,{className:`h-5 w-5 ${Ee?Y.color:"text-muted-foreground"}`}),e.jsx("span",{className:"text-xs font-semibold",children:Y.label}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:Y.sub})]},Y.id)})})]}),h==="paystack"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Payment Method"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:bbe.map(Y=>{const ie=Y.icon,Ee=x===Y.id;return e.jsxs("button",{type:"button",onClick:()=>j(Y.id),disabled:k==="sending"||k==="waiting",className:`flex items-center gap-2 p-2.5 rounded-lg border transition-all text-left ${Ee?"border-primary bg-primary/5":"border-muted hover:border-muted-foreground/30"} ${k==="sending"||k==="waiting"?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[e.jsx(ie,{className:`h-4 w-4 flex-shrink-0 ${Ee?"text-primary":"text-muted-foreground"}`}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-medium truncate",children:Y.label}),e.jsx("div",{className:"text-[10px] text-muted-foreground truncate",children:Y.description})]})]},Y.id)})})]}),o&&e.jsxs("div",{className:"rounded-lg border p-4 bg-muted/30",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium",children:[o.name," Plan"]}),e.jsx(ze,{variant:"outline",className:"capitalize",children:u})]}),e.jsxs("div",{className:"text-2xl font-bold mt-1",children:[fx(fe,h,D,x),e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/",u==="annual"?"year":"month"]})]}),fe===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Price not set for this currency. Contact admin."})]}),Pe&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Billing Period"}),e.jsxs(Qe,{value:u,onValueChange:Y=>m(Y),disabled:k!=="idle",children:[e.jsx(He,{children:e.jsx(Xe,{})}),e.jsxs(Ge,{children:[e.jsxs(ee,{value:"monthly",children:["Monthly (",fx(o?EN(o,h,"monthly",$,D,x):0,h,D,x),"/mo)"]}),e.jsxs(ee,{value:"annual",children:["Annual (",fx(o?EN(o,h,"annual",$,D,x):0,h,D,x),"/yr)"]})]})]})]}),h==="mpesa"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"mpesa-phone",children:"M-Pesa Phone Number"}),e.jsx(re,{id:"mpesa-phone",type:"tel",placeholder:"0712345678",value:b,onChange:Y=>g(Y.target.value),disabled:k!=="idle"&&k!=="failed"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"A payment prompt will be sent to this number"})]}),h==="paystack"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"paystack-email",children:"Email Address"}),e.jsx(re,{id:"paystack-email",type:"email",placeholder:"you@example.com",value:y,onChange:Y=>C(Y.target.value),disabled:k!=="idle"&&k!=="failed"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Paystack will send a receipt to this email"})]}),k==="waiting"&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-yellow-50 border border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800",children:[e.jsx(ln,{className:"h-5 w-5 animate-spin text-yellow-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:h==="mpesa"?"Waiting for M-Pesa confirmation...":"Confirming your payment..."}),e.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:h==="mpesa"?"Check your phone and enter your M-Pesa PIN":"Please wait while we verify your payment"})]})]}),k==="failed"&&e.jsx("div",{className:"p-3 rounded-lg bg-red-50 border border-red-200 dark:bg-red-900/20 dark:border-red-800",children:e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Payment failed or was cancelled. Please try again."})}),e.jsx(B,{className:"w-full",size:"lg",disabled:h==="mpesa"&&!b||h==="paystack"&&!y||k==="sending"||k==="waiting"||fe===0,onClick:X,children:k==="sending"?e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"h-4 w-4 animate-spin mr-2"}),"Processing..."]}):k==="waiting"?e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"h-4 w-4 animate-spin mr-2"}),"Awaiting payment..."]}):e.jsxs(e.Fragment,{children:[h==="mpesa"&&e.jsx(Wd,{className:"h-4 w-4 mr-2"}),h==="stripe"&&e.jsx(ns,{className:"h-4 w-4 mr-2"}),h==="paystack"&&e.jsx(uE,{className:"h-4 w-4 mr-2"}),"Pay ",fx(fe,h,D,x),h==="stripe"&&" with Card"]})})]})]})}),e.jsx(Vt,{open:r,onOpenChange:s,children:e.jsxs(It,{className:"sm:max-w-lg",children:[e.jsxs(qt,{children:[e.jsxs(Bt,{className:"flex items-center gap-2",children:[e.jsx(ja,{className:"h-5 w-5"}),"Contact Sales"]}),e.jsx(Qt,{children:"Fill out the form below and we'll get back to you about Enterprise pricing and custom solutions."})]}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"name",children:"Your Name *"}),e.jsx(re,{id:"name",placeholder:"John Doe",value:S.name,onChange:Y=>E({...S,name:Y.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"cemail",children:"Email Address *"}),e.jsx(re,{id:"cemail",type:"email",placeholder:"john@company.com",value:S.email,onChange:Y=>E({...S,email:Y.target.value}),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"organization",children:"Organization Name"}),e.jsx(re,{id:"organization",placeholder:"Your Sacco or Bank Name",value:S.organization,onChange:Y=>E({...S,organization:Y.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{htmlFor:"message",children:"Message *"}),e.jsx(fn,{id:"message",placeholder:"Tell us about your requirements...",rows:4,value:S.message,onChange:Y=>E({...S,message:Y.target.value}),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsxs(B,{type:"submit",disabled:R,children:[R?e.jsx(ln,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Cd,{className:"h-4 w-4 mr-2"}),"Send Inquiry"]})]})]})]})})]})}function kbe({organizationId:t}){const{toast:n}=Xt(),[r,s]=v.useState({first_name:"",last_name:"",phone:""}),[a,i]=v.useState({current_password:"",new_password:"",confirm_password:""}),[o,c]=v.useState({new_pin:"",confirm_pin:""}),[u,m]=v.useState(!1),{data:h,isLoading:f}=$e({queryKey:["/api/organizations",t,"staff","me"],enabled:!!t});v.useEffect(()=>{h&&s({first_name:h.first_name||"",last_name:h.last_name||"",phone:h.phone||""})},[h]);const x=Le({mutationFn:async N=>Be("PATCH",`/api/organizations/${t}/staff/me`,N),onSuccess:()=>{Fe.invalidateQueries({queryKey:["/api/organizations",t,"staff","me"]}),m(!1),n({title:"Profile updated successfully"})},onError:N=>{n({title:"Failed to update profile",description:Vn(N),variant:"destructive"})}}),j=Le({mutationFn:async N=>Be("PUT",`/api/organizations/${t}/staff/me/password`,N),onSuccess:()=>{i({current_password:"",new_password:"",confirm_password:""}),n({title:"Password changed successfully"})},onError:N=>{n({title:"Failed to change password",description:Vn(N),variant:"destructive"})}}),b=(N,P)=>{s(w=>({...w,[N]:P})),m(!0)},g=()=>{x.mutate(r)},y=Le({mutationFn:async N=>Be("POST",`/api/organizations/${t}/staff/set-approval-pin`,N),onSuccess:()=>{c({new_pin:"",confirm_pin:""}),n({title:"Approval PIN updated successfully"})},onError:N=>{n({title:"Failed to update PIN",description:Vn(N),variant:"destructive"})}}),C=()=>{if(a.new_password!==a.confirm_password){n({title:"Passwords don't match",variant:"destructive"});return}if(a.new_password.length<6){n({title:"Password must be at least 6 characters",variant:"destructive"});return}j.mutate({current_password:a.current_password,new_password:a.new_password})},k=()=>{if(o.new_pin.length<4||o.new_pin.length>6||!/^\d+$/.test(o.new_pin)){n({title:"PIN must be 4-6 digits",variant:"destructive"});return}if(o.new_pin!==o.confirm_pin){n({title:"PINs do not match",variant:"destructive"});return}y.mutate({pin:o.new_pin})};return f?e.jsxs("div",{className:"flex-1 p-6",children:[e.jsx(vc,{title:"My Account",description:"Manage your account settings"}),e.jsx(oe,{children:e.jsx(de,{className:"py-8 flex justify-center",children:e.jsx(ln,{className:"h-6 w-6 animate-spin"})})})]}):h?e.jsxs("div",{className:"flex-1 p-6 space-y-6",children:[e.jsx(vc,{title:"My Account",description:"Manage your personal information and password"}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx($d,{className:"h-5 w-5"}),"My Profile"]}),e.jsx(dt,{children:"Update your personal information"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Staff Number"}),e.jsx(re,{value:h.staff_number,disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Email"}),e.jsx(re,{value:h.email,disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"First Name"}),e.jsx(re,{value:r.first_name,onChange:N=>b("first_name",N.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Last Name"}),e.jsx(re,{value:r.last_name,onChange:N=>b("last_name",N.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Phone"}),e.jsx(re,{value:r.phone,onChange:N=>b("phone",N.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Role"}),e.jsx(re,{value:h.role,disabled:!0,className:"bg-muted capitalize"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(B,{onClick:g,disabled:!u||x.isPending,children:[x.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Um,{className:"mr-2 h-4 w-4"}),"Save Profile"]})})]})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(mE,{className:"h-5 w-5"}),"Change Password"]}),e.jsx(dt,{children:"Update your login password"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Current Password"}),e.jsx(re,{type:"password",value:a.current_password,onChange:N=>i(P=>({...P,current_password:N.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"New Password"}),e.jsx(re,{type:"password",value:a.new_password,onChange:N=>i(P=>({...P,new_password:N.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Confirm New Password"}),e.jsx(re,{type:"password",value:a.confirm_password,onChange:N=>i(P=>({...P,confirm_password:N.target.value}))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(B,{onClick:C,disabled:!a.current_password||!a.new_password||j.isPending,children:[j.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(mE,{className:"mr-2 h-4 w-4"}),"Change Password"]})})]})]}),["manager","admin","supervisor","owner"].includes(h.role)&&e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(hh,{className:"h-5 w-5"}),"Approval PIN"]}),e.jsx(dt,{children:"Set or reset your approval PIN used for authorizing float shortages and other sensitive operations"})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"New PIN"}),e.jsx(re,{type:"password",inputMode:"numeric",maxLength:6,placeholder:"Enter 4-6 digit PIN",value:o.new_pin,onChange:N=>c(P=>({...P,new_pin:N.target.value.replace(/\D/g,"")})),"data-testid":"input-my-approval-pin"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Se,{children:"Confirm PIN"}),e.jsx(re,{type:"password",inputMode:"numeric",maxLength:6,placeholder:"Re-enter PIN",value:o.confirm_pin,onChange:N=>c(P=>({...P,confirm_pin:N.target.value.replace(/\D/g,"")})),"data-testid":"input-my-confirm-approval-pin"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(B,{onClick:k,disabled:!o.new_pin||!o.confirm_pin||y.isPending,"data-testid":"button-reset-approval-pin",children:[y.isPending?e.jsx(ln,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(hh,{className:"mr-2 h-4 w-4"}),"Set Approval PIN"]})})]})]})]}):e.jsxs("div",{className:"flex-1 p-6",children:[e.jsx(vc,{title:"My Account",description:"Manage your account settings"}),e.jsx(oe,{children:e.jsx(de,{className:"py-8 text-center text-muted-foreground",children:"Staff profile not found"})})]})}const Pbe=me.object({name:me.string().min(2,"Organization name must be at least 2 characters"),code:me.string().min(2,"Code must be at least 2 characters").max(20,"Code must be less than 20 characters").optional(),email:me.string().email("Invalid email").optional().or(me.literal("")),phone:me.string().optional(),address:me.string().optional(),staffEmailDomain:me.string().min(3,"Staff email domain is required (e.g. mysacco.co.ke)"),deploymentMode:me.enum(["saas","standalone"]),currency:me.string().default("KES")}),Abe=me.object({name:me.string().min(2).optional(),email:me.string().email().optional().or(me.literal("")),phone:me.string().optional(),address:me.string().optional(),workingHoursStart:me.string().optional(),workingHoursEnd:me.string().optional(),workingDays:me.array(me.string()).optional(),currency:me.string().optional(),financialYearStart:me.string().optional(),enforceWorkingHours:me.boolean().optional(),autoLogoutMinutes:me.string().optional(),requireTwoFactorAuth:me.boolean().optional()}),Ebe=[{title:"Dashboard",value:"dashboard",icon:AW,permissions:["dashboard:read"],feature:"core_banking"},{title:"Teller Station",value:"teller",icon:xa,permissions:["teller_station:read"],feature:"teller_station"},{title:"Float Management",value:"float-management",icon:Ys,permissions:["float_management:read"],feature:"float_management"},{title:"Teller Services",value:"teller-services",icon:Ei,permissions:["teller_station:read"],feature:"teller_station"},{title:"Ticketing Kiosk",value:"ticketing-kiosk",icon:Ei,permissions:["ticketing:access"],feature:"teller_station"},{title:"Queue Display",value:"queue-display",icon:Ei,permissions:["ticketing:display"],feature:"teller_station"},{title:"Branches",value:"branches",icon:Yn,permissions:["branches:read"],feature:"core_banking"},{title:"Staff",value:"staff",icon:pn,permissions:["staff:read"],feature:"core_banking"},{title:"Members",value:"members",icon:pn,permissions:["members:read"],feature:"members"},{title:"Loan Products",value:"loan-products",icon:ns,permissions:["loan_products:read"],feature:"loans"},{title:"Loan Applications",value:"loans",icon:tn,permissions:["loans:read"],feature:"loans"},{title:"Transactions",value:"transactions",icon:Ys,permissions:["transactions:read"],feature:"savings"},{title:"Repayments",value:"repayments",icon:Ei,permissions:["repayments:read"],feature:"loans"},{title:"Fixed Deposits",value:"fixed-deposits",icon:Ys,permissions:["fixed_deposits:read"],feature:"fixed_deposits"},{title:"Dividends",value:"dividends",icon:Ys,permissions:["dividends:read"],feature:"dividends"},{title:"Chart of Accounts",value:"chart-of-accounts",icon:tn,permissions:["chart_of_accounts:read"],feature:"accounting"},{title:"Journal Entries",value:"journal-entries",icon:eh,permissions:["journal_entries:read"],feature:"accounting"},{title:"Opening Balances",value:"opening-balances",icon:eh,permissions:["settings:write"],feature:"accounting"},{title:"Reports",value:"reports",icon:Ri,permissions:["reports:read"],feature:"analytics"},{title:"Analytics",value:"analytics",icon:Ri,permissions:["analytics:read"],feature:"analytics"},{title:"SMS Notifications",value:"sms",icon:cl,permissions:["sms:read"],feature:"sms_notifications"},{title:"Defaults & Collections",value:"defaults",icon:Ur,permissions:["defaults:read"],feature:"loans"},{title:"HR Management",value:"hr",icon:pn,permissions:["hr:read"],feature:"payroll"},{title:"Leave Management",value:"leaves",icon:oo,permissions:["leave:read"],feature:"leave_management"},{title:"Expenses",value:"expenses",icon:Ei,permissions:["expenses:read"],feature:"expenses"},{title:"Audit Logs",value:"audit",icon:eh,permissions:["audit:read"],feature:"audit_logs"},{title:"Settings",value:"settings",icon:Kd,permissions:["settings:read"],adminOnly:!0},{title:"My Account",value:"my-account",icon:yW,permissions:[],alwaysShow:!0}];function Obe({items:t,activeSection:n,onSelect:r}){const{setOpenMobile:s}=kf();return e.jsx(WX,{children:t.map(a=>e.jsx(HX,{children:e.jsxs(YX,{isActive:n===a.value,onClick:()=>{r(a.value),s(!1)},"data-testid":`nav-${a.value}`,children:[e.jsx(a.icon,{className:"h-4 w-4"}),e.jsx("span",{children:a.title})]})},a.value))})}function Tbe({plan:t,isTrial:n,trialDaysRemaining:r,onUpgrade:s}){const{setOpenMobile:a}=kf();return e.jsx(UX,{className:"p-2",children:e.jsxs("div",{className:`flex items-center justify-between px-3 py-2.5 rounded-lg border border-primary/20 bg-primary/5 cursor-pointer transition-all ${t!=="enterprise"?"hover:bg-primary/10 hover:border-primary/40":""}`,onClick:()=>{t!=="enterprise"&&(s(),a(!1))},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded font-semibold ${t==="professional"?"bg-purple-500 text-white":t==="growth"?"bg-blue-500 text-white":t==="enterprise"?"bg-amber-500 text-white":"bg-primary text-primary-foreground"}`,children:t?t.charAt(0).toUpperCase()+t.slice(1):"Starter"}),n&&r>0&&e.jsxs("span",{className:"text-xs font-medium text-primary",children:[r,"d trial"]})]}),t!=="enterprise"&&e.jsx(Os,{className:"h-4 w-4 text-primary"})]})})}function Mbe(){const{user:t,logout:n,isLoading:r}=No(),{toast:s}=Xt(),{platform_name:a}=El(),[i,o]=v.useState(!1),[c,u]=v.useState(null),[m,h]=v.useState(()=>{const G=new URLSearchParams(window.location.search);return G.get("payment")==="success"||G.get("payment")==="cancelled"?"upgrade":"dashboard"}),[f,x]=v.useState(!1),[j,b]=v.useState(!1),[g,y]=v.useState(!1),[C,k]=v.useState(""),[N,P]=v.useState("full"),[w,S]=v.useState(!1),E=gs(),R=v.useRef(m);v.useEffect(()=>{R.current!==m&&c&&(E.invalidateQueries({predicate:G=>{const F=G.queryKey;return!!(Array.isArray(F)&&F[0]==="/api/organizations"&&F[1]===c.id)}}),R.current=m)},[m,c,E]),WY(c?.id);const{data:T}=$e({queryKey:["/api/organizations",c?.id,"hr","attendance","my-status"],queryFn:async()=>{const G=await fetch(`/api/organizations/${c.id}/hr/attendance/my-status`,{credentials:"include"});if(!G.ok)throw new Error("Failed to fetch attendance status");return G.json()},enabled:!!c,refetchInterval:6e4}),U=Le({mutationFn:async()=>Be("POST",`/api/organizations/${c.id}/hr/attendance/clock-in`),onSuccess:()=>{E.invalidateQueries({queryKey:["/api/organizations",c?.id,"hr","attendance"]}),s({title:"Clocked in successfully"})},onError:()=>{s({title:"Failed to clock in",variant:"destructive"})}}),M=Le({mutationFn:async()=>Be("POST",`/api/organizations/${c.id}/hr/attendance/clock-out`),onSuccess:()=>{E.invalidateQueries({queryKey:["/api/organizations",c?.id,"hr","attendance"]}),s({title:"Clocked out successfully"})},onError:()=>{s({title:"Failed to clock out",variant:"destructive"})}}),{hasAnyPermission:L,isAdmin:q,workingHoursAllowed:$,workingHoursMessage:D,isLoading:z}=wC(c?.id||null,{deferToSession:!0}),{hasFeature:J,isLoading:I,isExpired:X,isTrial:ne,trialDaysRemaining:W,trialMessage:H,plan:fe}=Ol(c?.id,{deferToSession:!0}),Pe=Ebe.filter(G=>{if(G.alwaysShow)return!0;if(G.adminOnly&&!q)return!1;const F=G.feature;if(F){if(I)return!0;if(!J(F))return!1}return L(G.permissions)}),Re=["upgrade","settings","my-account"];v.useEffect(()=>{if(c&&!z&&!I&&Pe.length>0&&!(Re.includes(m)||Pe.some(Ue=>Ue.value===m))){const Ue=Pe.find(Z=>Z.value==="dashboard")||Pe.find(Z=>Z.value!=="my-account")||Pe[0];h(Ue.value)}},[c,z,I,Pe,m]);const{data:Ie,isLoading:Ce}=$e({queryKey:["/api/organizations/my"],enabled:!!t}),Y=$n({resolver:Fn(Pbe),defaultValues:{name:"",code:"",email:"",phone:"",address:"",deploymentMode:"saas",currency:"KES"}}),ie=Y.watch("name");v.useEffect(()=>{if(ie){const G=ie.replace(/[^A-Za-z0-9]/g,"").toUpperCase().slice(0,20)||"ORG";Y.setValue("code",G)}else Y.setValue("code","")},[ie,Y]);const Ee=$n({resolver:Fn(Abe),defaultValues:{workingDays:["monday","tuesday","wednesday","thursday","friday"]}});v.useEffect(()=>{c&&Ee.reset({name:c.name,email:c.email||"",phone:c.phone||"",address:c.address||"",workingHoursStart:c.workingHoursStart||"08:00:00",workingHoursEnd:c.workingHoursEnd||"17:00:00",workingDays:c.workingDays||["monday","tuesday","wednesday","thursday","friday"],currency:c.currency||"KES",financialYearStart:c.financialYearStart||"01-01",enforceWorkingHours:c.enforceWorkingHours||!1,autoLogoutMinutes:c.autoLogoutMinutes||"30",requireTwoFactorAuth:c.requireTwoFactorAuth||!1})},[c,Ee]),v.useEffect(()=>{Ie&&Ie.length>0&&!c&&u(Ie[0].organization)},[Ie,c]),v.useEffect(()=>{if(!c||!Ie||g||j||!Ie.find(Ue=>Ue.organization.id===c.id)?.isOwner)return;const F=`onboarding_dismissed_${c.id}`;localStorage.getItem(F)||fetch(`/api/organizations/${c.id}/branches`,{credentials:"include"}).then(Ue=>Ue.ok?Ue.json():(b(!0),null)).then(Ue=>{Ue!==null&&Array.isArray(Ue)&&Ue.length===0&&b(!0)}).catch(()=>{b(!0)})},[c,Ie,g,j]);const[Ke,Te]=v.useState(!1),ct=v.useRef(!1),ut=Le({mutationFn:async G=>Be("POST","/api/organizations",G),onSuccess:async()=>{u(null),await E.invalidateQueries({queryKey:["/api/organizations/my"]}),Y.reset(),ct.current=!0,Te(!0)},onError:()=>{y(!1),s({title:"Error",description:"Failed to create organization. Please try again.",variant:"destructive"})}}),Dt=G=>{k(G.name),o(!1),P("full"),y(!0),ct.current=!1,Te(!1),ut.mutate(G)},be=async G=>{if(b(!1),k(c?.name||""),P("finalize"),S(!1),y(!0),G&&c)try{await Be("POST",`/api/organizations/${c.id}/branches`,{name:"Main Branch",code:"BR0001"}),E.invalidateQueries({queryKey:["/api/organizations",c.id,"branches"]})}catch{}S(!0)};if(Le({mutationFn:async G=>{if(c)return Be("PATCH",`/api/organizations/${c.id}`,G)},onSuccess:()=>{E.invalidateQueries({queryKey:["/api/organizations/my"]}),s({title:"Settings saved",description:"Organization settings have been updated."})},onError:()=>{s({title:"Error",description:"Failed to update settings. Please try again.",variant:"destructive"})}}),r||Ce||c&&z)return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-6 w-6 text-primary-foreground"})}),e.jsx("p",{className:"text-lg font-medium mb-4",children:"Loading..."}),e.jsx("div",{className:"w-64 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full animate-pulse",style:{width:"60%"}})})]});if(!(Ie&&Ie.length>0))return g?e.jsx(yF,{orgName:C,ready:N==="full"?Ke:w,mode:N,onComplete:()=>{y(!1),N==="full"&&b(!0)}}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b bg-card",children:e.jsxs("div",{className:"max-w-6xl mx-auto flex h-16 items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary",children:e.jsx(vr,{className:"h-6 w-6 text-primary-foreground"})}),e.jsx("span",{className:"text-xl font-bold",children:a})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o1,{className:"h-8 w-8",children:e.jsxs(l1,{children:[(t?.firstName||t?.first_name||"")?.[0],(t?.lastName||t?.last_name||"")?.[0]]})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Welcome,"}),e.jsxs("span",{className:"text-sm font-medium ml-1",children:[t?.firstName||t?.first_name," ",t?.lastName||t?.last_name]})]})]}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>n(),"data-testid":"button-logout",children:e.jsx(Rd,{className:"h-5 w-5"})})]})]})}),e.jsx("main",{className:"max-w-6xl mx-auto p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-primary/10 mb-6",children:e.jsx(Yn,{className:"h-10 w-10 text-primary"})}),e.jsxs("h1",{className:"text-2xl font-bold mb-2",children:["Welcome to ",a]}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md mb-8",children:"Get started by setting up your organization. You can configure your institution's details, working hours, and access settings."}),e.jsxs(B,{size:"lg",onClick:()=>o(!0),"data-testid":"button-create-org",children:[e.jsx(mn,{className:"mr-2 h-5 w-5"}),"Create Organization"]})]})}),e.jsx(Vt,{open:i,onOpenChange:o,children:e.jsxs(It,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(qt,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary",children:e.jsx(Yn,{className:"h-5 w-5 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx(Bt,{className:"text-lg",children:"Create Organization"}),e.jsx(Qt,{className:"text-sm",children:"Set up your financial institution in just a few steps"})]})]})}),e.jsx(Qn,{...Y,children:e.jsxs("form",{onSubmit:Y.handleSubmit(Dt),className:"space-y-5",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(je,{control:Y.control,name:"name",render:({field:G})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Organization Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsx(re,{...G,placeholder:"e.g. Unity Sacco Ltd","data-testid":"input-create-org-name"})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsx(je,{control:Y.control,name:"email",render:({field:G})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Email"}),e.jsx(ye,{children:e.jsx(re,{...G,type:"email",placeholder:"info@mysacco.com","data-testid":"input-create-org-email"})}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Y.control,name:"phone",render:({field:G})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Phone"}),e.jsx(ye,{children:e.jsx(re,{...G,placeholder:"+254 700 000000","data-testid":"input-create-org-phone"})}),e.jsx(Ne,{})]})})]}),e.jsx(je,{control:Y.control,name:"staffEmailDomain",render:({field:G})=>e.jsxs(ge,{children:[e.jsxs(ve,{children:["Staff Email Domain ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ye,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"flex items-center justify-center px-3 h-9 bg-muted border border-r-0 rounded-l-md text-muted-foreground text-sm",children:"@"}),e.jsx(re,{...G,value:G.value?.replace("@","")||"",onChange:F=>G.onChange(F.target.value.replace("@","")),placeholder:"mysacco.co.ke",className:"rounded-l-none","data-testid":"input-create-org-staff-domain"})]})}),e.jsx(Rn,{children:"Staff emails will use this domain (e.g. john@mysacco.co.ke)"}),e.jsx(Ne,{})]})}),e.jsx(je,{control:Y.control,name:"currency",render:({field:G})=>e.jsxs(ge,{children:[e.jsx(ve,{children:"Primary Currency"}),e.jsxs(Qe,{onValueChange:G.onChange,value:G.value,children:[e.jsx(ye,{children:e.jsx(He,{"data-testid":"select-create-currency",children:e.jsx(Xe,{placeholder:"Select currency"})})}),e.jsx(Ge,{className:"max-h-60",children:_C.map(F=>e.jsxs(ee,{value:F.code,children:[F.code," - ",F.name]},F.code))})]}),e.jsx(Ne,{})]})})]}),e.jsxs(nn,{className:"flex flex-col-reverse sm:flex-row gap-2 pt-2",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>o(!1),className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(B,{type:"submit",disabled:ut.isPending,"data-testid":"button-submit-create-org",className:"w-full sm:w-auto",children:ut.isPending?"Setting up your organization...":"Create Organization"})]})]})})]})})]});const te={"--sidebar-width":"16rem","--sidebar-width-icon":"3rem"};return c&&!z&&!$?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs(oe,{className:"max-w-md mx-4",children:[e.jsxs(we,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-12 w-12 rounded-full bg-orange-100 flex items-center justify-center",children:e.jsx(bn,{className:"h-6 w-6 text-orange-600"})}),e.jsx(_e,{children:"Access Restricted"}),e.jsx(dt,{className:"mt-2",children:D||"You cannot access the system at this time."})]}),e.jsxs(de,{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please contact your administrator if you need access outside of working hours."}),e.jsxs(B,{onClick:()=>n(),variant:"outline",className:"w-full",children:[e.jsx(Rd,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})}):m==="ticketing-kiosk"&&c?e.jsx(_je,{organizationId:c.id,organizationName:c.name,branchId:t?.branch_id,branchName:t?.branchName,isAdmin:q,onBack:()=>h("dashboard"),onLogout:()=>n()}):m==="queue-display"&&c?e.jsx(Cje,{organizationId:c.id,organizationName:c.name,branchId:t?.branch_id,branchName:t?.branchName,isAdmin:q,onBack:()=>h("dashboard"),onLogout:()=>n()}):e.jsx(BX,{style:te,children:e.jsxs("div",{className:"flex flex-col h-screen w-full overflow-hidden",children:[g&&e.jsx(yF,{orgName:C,ready:N==="full"?Ke:w,mode:N,onComplete:()=>{y(!1),N==="full"&&b(!0)}}),j&&c&&!g&&e.jsx(Qje,{organizationId:c.id,organizationName:c.name,onComplete:()=>b(!1),onFinalize:be}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs(zX,{children:[e.jsxs(KX,{children:[e.jsx(bb,{children:e.jsxs("div",{className:"flex items-center gap-3 p-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary",children:e.jsx(vr,{className:"h-6 w-6 text-primary-foreground"})}),e.jsx("span",{className:"text-xl font-bold",children:a})]})}),Ie.length>1&&e.jsxs(bb,{children:[e.jsx(nO,{children:"Organization"}),e.jsx(rO,{children:e.jsxs(Qe,{value:c?.id,onValueChange:G=>{const F=Ie.find(Ue=>Ue.organizationId===G);F&&u(F.organization)},children:[e.jsx(He,{className:"w-full","data-testid":"select-organization",children:e.jsx(Xe,{placeholder:"Select organization"})}),e.jsx(Ge,{children:Ie.map(G=>e.jsx(ee,{value:G.organizationId,children:G.organization.name},G.organizationId))})]})})]}),e.jsxs(bb,{children:[e.jsx(nO,{children:"Menu"}),e.jsx(rO,{children:e.jsx(Obe,{items:Pe,activeSection:m,onSelect:h})})]})]}),e.jsx(Tbe,{plan:fe,isTrial:ne,trialDaysRemaining:W,onUpgrade:()=>h("upgrade")})]}),e.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[e.jsx(Gje,{isExpired:X,isTrial:ne,trialDaysRemaining:W,message:H,onUpgrade:()=>h("upgrade")}),!f&&t&&!t?.isStaff&&t?.is_email_verified===!1&&e.jsxs("div",{className:"flex items-center justify-between gap-2 px-4 py-2 bg-amber-50 dark:bg-amber-950/30 border-b border-amber-200 dark:border-amber-800","data-testid":"banner-email-verification",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-amber-800 dark:text-amber-200",children:[e.jsx(ja,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{children:"Please verify your email address."})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(Xs,{href:"/verify-email",children:e.jsx(B,{variant:"outline",size:"sm","data-testid":"button-verify-now",children:"Verify Now"})}),e.jsx(B,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>x(!0),"data-testid":"button-dismiss-verification",children:e.jsx(rs,{className:"h-4 w-4"})})]})]}),e.jsxs("header",{className:"flex h-12 items-center justify-between border-b bg-card px-4",children:[e.jsx(VX,{"data-testid":"button-sidebar-toggle"}),e.jsxs("div",{className:"flex items-center gap-2",children:[c&&T?.require_clock_in&&!T.clocked_in&&e.jsxs(B,{variant:"outline",size:"sm",className:"h-7 gap-1.5 text-xs border-green-200 text-green-700 hover:bg-green-50 hover:text-green-800",onClick:()=>U.mutate(),disabled:U.isPending,children:[e.jsx(bn,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:U.isPending?"Clocking in...":"Clock In"}),e.jsx("span",{className:"sm:hidden",children:"In"})]}),t?.branchName&&e.jsxs("div",{className:"hidden md:flex items-center gap-1 px-2 py-0.5 bg-primary/10 text-primary rounded text-xs font-medium",children:[e.jsx(Yn,{className:"h-3 w-3"}),t.branchName]}),e.jsx("div",{className:"h-4 w-px bg-border hidden md:block"}),c&&e.jsx(vZ,{organizationId:c.id}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o1,{className:"h-7 w-7",children:e.jsxs(l1,{className:"text-xs bg-primary/10 text-primary",children:[(t?.firstName||t?.first_name||"")?.[0],(t?.lastName||t?.last_name||"")?.[0]]})}),e.jsxs("span",{className:"text-sm hidden sm:block",children:[t?.firstName||t?.first_name," ",t?.lastName||t?.last_name]})]}),c&&T?.require_clock_in&&T.clocked_in&&!T.clocked_out&&e.jsx(B,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 text-orange-600 hover:text-orange-700 hover:bg-orange-50",onClick:()=>M.mutate(),disabled:M.isPending,title:"Clock Out",children:e.jsx(bn,{className:"h-4 w-4"})}),e.jsx(B,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>n(),"data-testid":"button-logout",children:e.jsx(Rd,{className:"h-4 w-4"})})]})]}),e.jsx("main",{className:"flex-1 overflow-auto p-4 sm:p-6",children:T?.require_clock_in&&!T?.clocked_in&&c&&!q?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-6",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-6",children:e.jsx(bn,{className:"h-12 w-12 text-primary"})}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Clock In Required"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"You need to clock in before you can access the system. Please clock in to start your work day."})]}),e.jsxs(B,{size:"lg",className:"gap-2",onClick:()=>U.mutate(),disabled:U.isPending,children:[e.jsx(bn,{className:"h-5 w-5"}),U.isPending?"Clocking in...":"Clock In Now"]})]}):e.jsxs(e.Fragment,{children:[m==="dashboard"&&c&&e.jsx(yZ,{organizationId:c.id,organizationName:c.name}),m==="teller"&&c&&e.jsx(vje,{organizationId:c.id}),m==="float-management"&&c&&e.jsx(wje,{organizationId:c.id}),m==="teller-services"&&c&&e.jsx(kje,{organizationId:c.id}),m==="settings"&&c&&e.jsx(ybe,{organizationId:c.id,isOwner:Ie?.find(G=>G.organizationId===c.id)?.isOwner??!1}),m==="upgrade"&&c&&e.jsx(Cbe,{organizationId:c.id}),m==="branches"&&c&&e.jsx(NZ,{organizationId:c.id}),m==="staff"&&c&&e.jsx(tee,{organizationId:c.id}),m==="members"&&c&&e.jsx(wee,{organizationId:c.id}),m==="loan-products"&&c&&e.jsx(Eee,{organizationId:c.id}),m==="loans"&&c&&e.jsx(xte,{organizationId:c.id}),m==="transactions"&&c&&e.jsx(vte,{organizationId:c.id}),m==="repayments"&&c&&e.jsx(bte,{organizationId:c.id}),m==="fixed-deposits"&&c&&e.jsx(Dje,{organizationId:c.id}),m==="chart-of-accounts"&&c&&e.jsx($je,{organizationId:c.id}),m==="journal-entries"&&c&&e.jsx(Kje,{organizationId:c.id}),m==="opening-balances"&&c&&e.jsx(Hje,{organizationId:c.id}),m==="dividends"&&c&&e.jsx(Wje,{organizationId:c.id}),m==="reports"&&c&&e.jsx(Mte,{organizationId:c.id}),m==="analytics"&&c&&e.jsx(sje,{organizationId:c.id}),m==="sms"&&c&&e.jsx(lje,{organizationId:c.id}),m==="defaults"&&c&&e.jsx(cje,{organizationId:c.id}),m==="hr"&&c&&e.jsx(dje,{organizationId:c.id}),m==="leaves"&&c&&e.jsx(uje,{organizationId:c.id}),m==="expenses"&&c&&e.jsx(mje,{organizationId:c.id}),m==="audit"&&c&&e.jsx(hje,{organizationId:c.id}),m==="my-account"&&c&&e.jsx(kbe,{organizationId:c.id})]})})]})]})]})})}function bF(){const[,t]=WS(),n=E9(),{toast:r}=Xt(),{platform_name:s}=El(),{user:a}=No(),i=gs(),[o,c]=v.useState("idle"),[u,m]=v.useState(""),h=new URLSearchParams(n).get("token");v.useEffect(()=>{h&&o==="idle"&&(c("verifying"),fetch(`/api/auth/verify-email/${h}`,{credentials:"include"}).then(async j=>{if(j.ok)c("success"),i.invalidateQueries({queryKey:["/api/auth/user"]});else{const b=await j.json().catch(()=>({}));m(b.detail||"Invalid or expired verification token"),c("error")}}).catch(()=>{m("Something went wrong. Please try again."),c("error")}))},[h,o]);const f=Le({mutationFn:async()=>Be("POST","/api/auth/send-verification-email"),onSuccess:()=>{r({title:"Verification email sent",description:"Please check your inbox for the verification link."})},onError:()=>{r({title:"Failed to send email",description:"Please try again later.",variant:"destructive"})}}),x=Le({mutationFn:async()=>Be("POST","/api/auth/skip-email-verification"),onSuccess:()=>{t("/")}});return h&&o==="verifying"?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:s})]}),e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center py-10",children:[e.jsx(ln,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-muted-foreground","data-testid":"text-verifying",children:"Verifying your email..."})]})})]})}):h&&o==="success"?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:s})]}),e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center py-10",children:[e.jsx(yr,{className:"h-12 w-12 text-green-500 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2","data-testid":"text-verification-success",children:"Email Verified"}),e.jsx("p",{className:"text-muted-foreground text-center mb-6",children:"Your email address has been verified successfully."}),e.jsx(B,{onClick:()=>t("/"),"data-testid":"button-continue-dashboard",children:"Continue to Dashboard"})]})})]})}):h&&o==="error"?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:s})]}),e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center py-10",children:[e.jsx(Cs,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2","data-testid":"text-verification-error",children:"Verification Failed"}),e.jsx("p",{className:"text-muted-foreground text-center mb-6",children:u}),a&&e.jsx(B,{onClick:()=>f.mutate(),disabled:f.isPending,"data-testid":"button-resend-verification",children:f.isPending?"Sending...":"Resend Verification Email"}),e.jsx(Xs,{href:"/",className:"text-sm text-muted-foreground hover:underline mt-4",children:"Go to Dashboard"})]})})]})}):a?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Verify Your Email"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:["Complete your ",s," account setup"]})]}),e.jsxs(oe,{children:[e.jsxs(we,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(ja,{className:"h-5 w-5"}),"Check Your Inbox"]}),e.jsx(dt,{children:"We've sent a verification email to your email address. Please check your inbox and click the verification link."})]}),e.jsxs(de,{className:"space-y-4",children:[e.jsx(B,{className:"w-full",onClick:()=>f.mutate(),disabled:f.isPending,"data-testid":"button-resend-verification",children:f.isPending?"Sending...":"Resend Verification Email"}),e.jsx(B,{variant:"outline",className:"w-full",onClick:()=>x.mutate(),disabled:x.isPending,"data-testid":"button-skip-verification",children:x.isPending?"...":"Set up later"})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(Xs,{href:"/",className:"text-sm text-muted-foreground hover:underline",children:"Back to Dashboard"})})]})}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary mb-4",children:e.jsx(vr,{className:"h-7 w-7 text-primary-foreground"})}),e.jsx("h1",{className:"text-2xl font-bold",children:s})]}),e.jsx(oe,{children:e.jsxs(de,{className:"flex flex-col items-center py-10",children:[e.jsx(ja,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Please Sign In"}),e.jsx("p",{className:"text-muted-foreground text-center mb-6",children:"Sign in to your account to verify your email or resend the verification link."}),e.jsx(B,{onClick:()=>t("/login"),"data-testid":"button-go-to-login",children:"Sign In"})]})})]})})}const Rbe=`<section>
<h2>1. Acceptance of Terms</h2>
<p>By accessing or using this platform ("the Service"), you agree to be bound by these Terms of Service.</p>
</section>
<section>
<h2>2. Description of Service</h2>
<p>This platform provides a cloud-based banking and Sacco management platform that enables organizations to manage members, loans, savings, fixed deposits, dividends, and other financial operations.</p>
</section>
<section>
<h2>3. Account Registration</h2>
<p>To use the Service, you must create an account and provide accurate, complete information. You are responsible for maintaining the confidentiality of your account credentials and all activities that occur under your account.</p>
</section>
<section>
<h2>4. Subscription Plans &amp; Billing</h2>
<p>The Service offers multiple subscription tiers. Subscriptions renew automatically unless cancelled. Prices are denominated in USD. Refunds are handled on a case-by-case basis within 30 days of payment.</p>
</section>
<section>
<h2>5. Data Ownership &amp; Privacy</h2>
<p>You retain all ownership rights to your data. Each organization's data is stored in an isolated database. We will not access, share, or sell your data except as necessary to provide the Service or as required by law.</p>
</section>
<section>
<h2>6. Acceptable Use</h2>
<p>You agree not to use the Service for any unlawful purpose, attempt unauthorized access, interfere with the Service, or reverse engineer the platform.</p>
</section>
<section>
<h2>7. Limitation of Liability</h2>
<p>To the maximum extent permitted by law, this platform shall not be liable for any indirect, incidental, special, or consequential damages arising from the use of the Service.</p>
</section>
<section>
<h2>8. Changes to Terms</h2>
<p>We may update these terms from time to time. We will notify you of significant changes via email or in-app notification at least 30 days before they take effect.</p>
</section>`;function wF(){const{platform_name:t}=El(),[n,r]=v.useState(""),[s,a]=v.useState(""),[i,o]=v.useState(!0);v.useEffect(()=>{fetch("/api/admin/public/legal/terms").then(m=>m.ok?m.json():null).then(m=>{m&&m.content&&(r(m.content),a(m.last_updated||""))}).catch(()=>{}).finally(()=>o(!1))},[]);const c=n||Rbe,u=s||"February 2026";return i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):e.jsx("div",{className:"fixed inset-0 bg-background overflow-y-auto",children:e.jsxs("div",{className:"w-full px-6 sm:px-10 py-10",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(Xs,{href:"/register",className:"inline-flex items-center gap-1.5 text-sm text-primary hover:underline",children:[e.jsx($r,{className:"w-4 h-4"}),"Back to registration"]})}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(tn,{className:"w-7 h-7 text-primary"}),e.jsxs("h1",{className:"text-2xl font-bold",children:[t," Terms of Service"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-8",children:["Last updated: ",u]}),e.jsx("div",{className:`bg-card border border-border rounded-xl p-6 sm:p-8 prose prose-sm max-w-none
            [&_section]:mb-6 [&_h2]:text-lg [&_h2]:font-semibold [&_h2]:text-foreground [&_h2]:mb-2
            [&_h3]:text-base [&_h3]:font-medium [&_h3]:text-foreground [&_h3]:mb-1.5
            [&_p]:text-muted-foreground [&_p]:leading-relaxed [&_p]:mb-2
            [&_ul]:list-disc [&_ul]:list-inside [&_ul]:text-muted-foreground [&_ul]:space-y-1 [&_ul]:ml-4
            [&_ol]:list-decimal [&_ol]:list-inside [&_ol]:text-muted-foreground [&_ol]:space-y-1 [&_ol]:ml-4
            [&_li]:text-muted-foreground
            [&_a]:text-primary [&_a:hover]:underline
            [&_strong]:text-foreground`,dangerouslySetInnerHTML:{__html:c}})]})})}const Dbe=`<section>
<h2>1. Introduction</h2>
<p>We are committed to protecting the privacy of our users. This Privacy Policy explains how we collect, use, store, and protect information when you use our platform.</p>
</section>
<section>
<h2>2. Information We Collect</h2>
<p>We collect account information (name, email, phone), organizational data (member records, transactions, staff data), and usage data (login activity, feature usage).</p>
</section>
<section>
<h2>3. Data Isolation &amp; Security</h2>
<p>Each organization's data is stored in a completely separate, isolated database. Data is encrypted at rest and in transit. Role-based access control and audit logging are enforced.</p>
</section>
<section>
<h2>4. How We Use Your Data</h2>
<p>We use your data to provide and maintain the Service, process transactions, send important notifications, provide support, and improve the Service based on anonymized usage patterns.</p>
</section>
<section>
<h2>5. Data Sharing</h2>
<p>We do not sell or rent your data. We may share data only with payment processors, SMS providers, infrastructure providers, or when required by law.</p>
</section>
<section>
<h2>6. Your Rights</h2>
<p>You have the right to access, correct, delete, and export your data. You may withdraw consent for optional data processing at any time.</p>
</section>
<section>
<h2>7. Changes to This Policy</h2>
<p>We may update this Privacy Policy from time to time. We will notify you of significant changes at least 30 days before they take effect.</p>
</section>`;function _F(){const{platform_name:t}=El(),[n,r]=v.useState(""),[s,a]=v.useState(""),[i,o]=v.useState(!0);v.useEffect(()=>{fetch("/api/admin/public/legal/privacy").then(m=>m.ok?m.json():null).then(m=>{m&&m.content&&(r(m.content),a(m.last_updated||""))}).catch(()=>{}).finally(()=>o(!1))},[]);const c=n||Dbe,u=s||"February 2026";return i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):e.jsx("div",{className:"fixed inset-0 bg-background overflow-y-auto",children:e.jsxs("div",{className:"w-full px-6 sm:px-10 py-10",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(Xs,{href:"/register",className:"inline-flex items-center gap-1.5 text-sm text-primary hover:underline",children:[e.jsx($r,{className:"w-4 h-4"}),"Back to registration"]})}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Es,{className:"w-7 h-7 text-primary"}),e.jsxs("h1",{className:"text-2xl font-bold",children:[t," Privacy Policy"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-8",children:["Last updated: ",u]}),e.jsx("div",{className:`bg-card border border-border rounded-xl p-6 sm:p-8 prose prose-sm max-w-none
            [&_section]:mb-6 [&_h2]:text-lg [&_h2]:font-semibold [&_h2]:text-foreground [&_h2]:mb-2
            [&_h3]:text-base [&_h3]:font-medium [&_h3]:text-foreground [&_h3]:mb-1.5
            [&_p]:text-muted-foreground [&_p]:leading-relaxed [&_p]:mb-2
            [&_ul]:list-disc [&_ul]:list-inside [&_ul]:text-muted-foreground [&_ul]:space-y-1 [&_ul]:ml-4
            [&_ol]:list-decimal [&_ol]:list-inside [&_ol]:text-muted-foreground [&_ol]:space-y-1 [&_ol]:ml-4
            [&_li]:text-muted-foreground
            [&_a]:text-primary [&_a:hover]:underline
            [&_strong]:text-foreground`,dangerouslySetInnerHTML:{__html:c}})]})})}function $be(){const{user:t,isLoading:n}=No();return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})}):t?e.jsxs(UA,{children:[e.jsx(Gs,{path:"/",component:Mbe}),e.jsx(Gs,{path:"/verify-email",component:bF}),e.jsx(Gs,{path:"/terms",component:wF}),e.jsx(Gs,{path:"/privacy",component:_F}),e.jsx(Gs,{component:SE})]}):e.jsxs(UA,{children:[e.jsx(Gs,{path:"/",component:VE}),e.jsx(Gs,{path:"/login",component:VE}),e.jsx(Gs,{path:"/register",component:BY}),e.jsx(Gs,{path:"/forgot-password",component:VY}),e.jsx(Gs,{path:"/reset-password",component:KY}),e.jsx(Gs,{path:"/verify-email",component:bF}),e.jsx(Gs,{path:"/terms",component:wF}),e.jsx(Gs,{path:"/privacy",component:_F}),e.jsx(Gs,{component:SE})]})}function Fbe(){return e.jsx(Z9,{client:Fe,children:e.jsx(XH,{children:e.jsxs(mI,{children:[e.jsx(j7,{}),e.jsx($be,{})]})})})}o9.createRoot(document.getElementById("root")).render(e.jsx(Fbe,{}));
